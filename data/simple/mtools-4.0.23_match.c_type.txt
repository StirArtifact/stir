static	O
int	O
casecmp	function
(	O
wchar_t	int
a	int
,	O
wchar_t	int
b	int
)	O
{	O
return	O
towupper	function
(	O
(	O
wint_t	int
)	O
a	int
)	O
==	O
towupper	function
(	O
(	O
wint_t	int
)	O
b	int
)	O
;	O
}	O
static	O
int	O
exactcmp	function
(	O
wchar_t	int
a	int
,	O
wchar_t	int
b	int
)	O
{	O
return	O
a	int
==	O
b	int
;	O
}	O
static	O
int	O
is_in_range	function
(	O
wchar_t	int
ch	char
,	O
const	O
wchar_t	int
*	O
*	O
p	pointer
,	O
int	O
*	O
reverse	pointer
)	O
{	O
wchar_t	int
first	int
,	O
last	int
;	O
int	O
found	int
=	O
0	int
;	O
if	O
(	O
*	O
*	O
p	pointer
==	O
'^'	O
)	O
{	O
*	O
reverse	pointer
=	O
1	int
;	O
(	O
*	O
p	pointer
)	O
++	O
;	O
}	O
else	O
*	O
reverse	pointer
=	O
0	int
;	O
while	O
(	O
(	O
first	int
=	O
*	O
*	O
p	pointer
)	O
!=	O
']'	O
)	O
{	O
if	O
(	O
!	O
first	int
)	O
return	O
0	int
;	O
if	O
(	O
*	O
(	O
++	O
(	O
*	O
p	pointer
)	O
)	O
==	O
'-'	O
)	O
{	O
last	int
=	O
*	O
(	O
++	O
(	O
*	O
p	pointer
)	O
)	O
;	O
if	O
(	O
last	int
==	O
']'	O
)	O
{	O
if	O
(	O
ch	char
==	O
first	int
||	O
ch	char
==	O
'-'	O
)	O
found	int
=	O
1	int
;	O
break	O
;	O
}	O
(	O
*	O
p	pointer
)	O
++	O
;	O
if	O
(	O
ch	char
>=	O
first	int
&&	O
ch	char
<=	O
last	int
)	O
found	int
=	O
1	int
;	O
}	O
else	O
if	O
(	O
ch	char
==	O
first	int
)	O
found	int
=	O
1	int
;	O
}	O
return	O
found	int
;	O
}	O
static	O
int	O
parse_range	function
(	O
const	O
wchar_t	int
*	O
*	O
p	pointer
,	O
const	O
wchar_t	int
*	O
s	pointer
,	O
wchar_t	int
*	O
out	pointer
,	O
int	O
(	O
*	O
compfn	pointer
)	O
(	O
wchar_t	int
a	int
,	O
wchar_t	int
b	int
)	O
)	O
{	O
int	O
reverse	pointer
;	O
const	O
wchar_t	int
*	O
p0	pointer
=	O
*	O
p	pointer
;	O
const	O
wchar_t	int
*	O
p1	pointer
=	O
*	O
p	pointer
;	O
if	O
(	O
out	pointer
)	O
*	O
out	pointer
=	O
*	O
s	pointer
;	O
if	O
(	O
is_in_range	function
(	O
*	O
s	pointer
,	O
p	pointer
,	O
&	O
reverse	pointer
)	O
)	O
return	O
1	int
^	O
reverse	pointer
;	O
if	O
(	O
compfn	pointer
==	O
exactcmp	function
)	O
return	O
reverse	pointer
;	O
if	O
(	O
is_in_range	function
(	O
(	O
wchar_t	int
)	O
towlower	function
(	O
(	O
wint_t	int
)	O
*	O
s	pointer
)	O
,	O
&	O
p0	pointer
,	O
&	O
reverse	pointer
)	O
)	O
{	O
if	O
(	O
out	pointer
)	O
*	O
out	pointer
=	O
(	O
wchar_t	int
)	O
towlower	function
(	O
(	O
wint_t	int
)	O
*	O
s	pointer
)	O
;	O
return	O
1	int
^	O
reverse	pointer
;	O
}	O
if	O
(	O
is_in_range	function
(	O
(	O
wchar_t	int
)	O
towupper	function
(	O
(	O
wint_t	int
)	O
*	O
s	pointer
)	O
,	O
&	O
p1	pointer
,	O
&	O
reverse	pointer
)	O
)	O
{	O
if	O
(	O
out	pointer
)	O
*	O
out	pointer
=	O
(	O
wchar_t	int
)	O
towupper	function
(	O
(	O
wint_t	int
)	O
*	O
s	pointer
)	O
;	O
return	O
1	int
^	O
reverse	pointer
;	O
}	O
return	O
reverse	pointer
;	O
}	O
static	O
int	O
_match	function
(	O
const	O
wchar_t	int
*	O
s	pointer
,	O
const	O
wchar_t	int
*	O
p	pointer
,	O
wchar_t	int
*	O
out	pointer
,	O
int	O
Case	char
,	O
int	O
length	int
,	O
int	O
(	O
*	O
compfn	pointer
)	O
(	O
wchar_t	int
a	int
,	O
wchar_t	int
b	int
)	O
)	O
{	O
for	O
(	O
;	O
*	O
p	pointer
!=	O
'\0'	O
&&	O
length	int
;	O
)	O
{	O
switch	O
(	O
*	O
p	pointer
)	O
{	O
case	O
'?'	O
:	O
if	O
(	O
*	O
s	pointer
==	O
'\0'	O
)	O
return	O
(	O
0	int
)	O
;	O
if	O
(	O
out	pointer
)	O
*	O
(	O
out	pointer
++	O
)	O
=	O
*	O
s	pointer
;	O
break	O
;	O
case	O
'*'	O
:	O
while	O
(	O
*	O
p	pointer
==	O
'*'	O
&&	O
length	int
)	O
{	O
p	pointer
++	O
;	O
length	int
--	O
;	O
}	O
while	O
(	O
*	O
s	pointer
)	O
{	O
if	O
(	O
_match	function
(	O
s	pointer
,	O
p	pointer
,	O
out	pointer
,	O
Case	char
,	O
length	int
,	O
compfn	pointer
)	O
)	O
return	O
1	int
;	O
if	O
(	O
out	pointer
)	O
*	O
out	pointer
++	O
=	O
*	O
s	pointer
;	O
s	pointer
++	O
;	O
}	O
continue	O
;	O
case	O
'['	O
:	O
p	pointer
++	O
;	O
length	int
--	O
;	O
if	O
(	O
!	O
parse_range	function
(	O
&	O
p	pointer
,	O
s	pointer
,	O
out	pointer
++	O
,	O
compfn	pointer
)	O
)	O
return	O
0	int
;	O
break	O
;	O
case	O
'\\'	O
:	O
p	pointer
++	O
;	O
length	int
--	O
;	O
default	O
:	O
if	O
(	O
!	O
compfn	pointer
(	O
*	O
s	pointer
,	O
*	O
p	pointer
)	O
)	O
return	O
(	O
0	int
)	O
;	O
if	O
(	O
out	pointer
)	O
*	O
(	O
out	pointer
++	O
)	O
=	O
*	O
p	pointer
;	O
break	O
;	O
}	O
p	pointer
++	O
;	O
length	int
--	O
;	O
s	pointer
++	O
;	O
}	O
if	O
(	O
out	pointer
)	O
*	O
out	pointer
=	O
'\0'	O
;	O
if	O
(	O
*	O
s	pointer
!=	O
'\0'	O
)	O
return	O
(	O
0	int
)	O
;	O
else	O
return	O
(	O
1	int
)	O
;	O
}	O
int	O
match	function
(	O
const	O
wchar_t	int
*	O
s	pointer
,	O
const	O
wchar_t	int
*	O
p	pointer
,	O
wchar_t	int
*	O
out	pointer
,	O
int	O
Case	char
,	O
int	O
length	int
)	O
{	O
int	O
(	O
*	O
compfn	pointer
)	O
(	O
wchar_t	int
a	int
,	O
wchar_t	int
b	int
)	O
;	O
if	O
(	O
Case	char
)	O
compfn	pointer
=	O
casecmp	function
;	O
else	O
compfn	pointer
=	O
casecmp	function
;	O
return	O
_match	function
(	O
s	pointer
,	O
p	pointer
,	O
out	pointer
,	O
Case	char
,	O
length	int
,	O
compfn	pointer
)	O
;	O
}	O
