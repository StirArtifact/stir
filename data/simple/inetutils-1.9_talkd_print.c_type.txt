static	O
const	O
char	O
*	O
message_types	array
[	O
]	O
=	O
{	O
D	O
(	O
LEAVE_INVITE	O
)	O
,	O
D	O
(	O
LOOK_UP	O
)	O
,	O
D	O
(	O
DELETE	O
)	O
,	O
D	O
(	O
ANNOUNCE	O
)	O
}	O
;	O
static	O
const	O
char	O
*	O
answers	array
[	O
]	O
=	O
{	O
D	O
(	O
SUCCESS	O
)	O
,	O
D	O
(	O
NOT_HERE	O
)	O
,	O
D	O
(	O
FAILED	O
)	O
,	O
D	O
(	O
MACHINE_UNKNOWN	O
)	O
,	O
D	O
(	O
PERMISSION_DENIED	O
)	O
,	O
D	O
(	O
UNKNOWN_REQUEST	O
)	O
,	O
D	O
(	O
BADVERSION	O
)	O
,	O
D	O
(	O
BADADDR	O
)	O
,	O
D	O
(	O
BADCTLADDR	O
)	O
}	O
;	O
static	O
const	O
char	O
*	O
_xlat_num	function
(	O
int	O
num	int
,	O
const	O
char	O
*	O
array	array
[	O
]	O
,	O
int	O
size	int
)	O
{	O
static	O
char	O
buf	array
[	O
64	int
]	O
;	O
if	O
(	O
num	int
>=	O
size	int
)	O
{	O
snprintf	function
(	O
buf	array
,	O
sizeof	O
buf	array
,	O
"%d"	pointer
,	O
num	int
)	O
;	O
return	O
buf	array
;	O
}	O
else	O
return	O
array	array
[	O
num	int
]	O
;	O
}	O
int	O
print_request	function
(	O
const	O
char	O
*	O
cp	pointer
,	O
CTL_MSG	struct
*	O
mp	pointer
)	O
{	O
syslog	function
(	O
LOG_DEBUG	int
,	O
"%s: %s: id %d, l_user %s, r_user %s, r_tty %s"	pointer
,	O
cp	pointer
,	O
_xlat_num	function
(	O
mp	pointer
->	O
type	char
,	O
message_types	array
,	O
NITEMS	O
(	O
message_types	array
)	O
)	O
,	O
mp	pointer
->	O
id_num	int
,	O
mp	pointer
->	O
l_name	array
,	O
mp	pointer
->	O
r_name	array
,	O
mp	pointer
->	O
r_tty	array
)	O
;	O
return	O
0	int
;	O
}	O
int	O
print_response	function
(	O
const	O
char	O
*	O
cp	pointer
,	O
CTL_RESPONSE	struct
*	O
rp	pointer
)	O
{	O
syslog	function
(	O
LOG_DEBUG	int
,	O
"%s: %s: %s, id %d"	pointer
,	O
cp	pointer
,	O
_xlat_num	function
(	O
rp	pointer
->	O
type	char
,	O
message_types	array
,	O
NITEMS	O
(	O
message_types	array
)	O
)	O
,	O
_xlat_num	function
(	O
rp	pointer
->	O
answer	char
,	O
answers	array
,	O
NITEMS	O
(	O
answers	array
)	O
)	O
,	O
ntohl	function
(	O
rp	pointer
->	O
id_num	int
)	O
)	O
;	O
return	O
0	int
;	O
}	O
