int	O
fat_free	function
(	O
Stream_t	struct
*	O
Dir	pointer
,	O
unsigned	O
int	O
fat	int
)	O
{	O
Stream_t	struct
*	O
Stream	pointer
=	O
GetFs	function
(	O
Dir	pointer
)	O
;	O
DeclareThis	O
(	O
Fs_t	struct
)	O
;	O
unsigned	O
int	O
next_no_step	int
;	O
if	O
(	O
fat	int
==	O
0	int
)	O
return	O
(	O
0	int
)	O
;	O
while	O
(	O
!	O
This	pointer
->	O
fat_error	function
)	O
{	O
next_no_step	int
=	O
fatDecode	function
(	O
This	pointer
,	O
fat	int
)	O
;	O
fatDeallocate	function
(	O
This	pointer
,	O
fat	int
)	O
;	O
if	O
(	O
next_no_step	int
>=	O
This	pointer
->	O
last_fat	int
)	O
break	O
;	O
fat	int
=	O
next_no_step	int
;	O
}	O
return	O
(	O
0	int
)	O
;	O
}	O
int	O
fatFreeWithDir	function
(	O
Stream_t	struct
*	O
Dir	pointer
,	O
struct	O
directory	struct
*	O
dir	pointer
)	O
{	O
unsigned	O
int	O
first	int
;	O
if	O
(	O
(	O
!	O
strncmp	function
(	O
dir	pointer
->	O
name	pointer
,	O
".      "	pointer
,	O
8	int
)	O
||	O
!	O
strncmp	function
(	O
dir	pointer
->	O
name	pointer
,	O
"..     "	pointer
,	O
8	int
)	O
)	O
&&	O
!	O
strncmp	function
(	O
dir	pointer
->	O
ext	array
,	O
"   "	pointer
,	O
3	int
)	O
)	O
{	O
fprintf	function
(	O
stderr	pointer
,	O
"Trying to remove . or .. entry\n"	pointer
)	O
;	O
return	O
-	O
1	int
;	O
}	O
first	int
=	O
START	O
(	O
dir	pointer
)	O
;	O
if	O
(	O
fat32RootCluster	function
(	O
Dir	pointer
)	O
)	O
first	int
|=	O
STARTHI	O
(	O
dir	pointer
)	O
<<	O
16	int
;	O
return	O
fat_free	function
(	O
Dir	pointer
,	O
first	int
)	O
;	O
}	O
int	O
fatFreeWithDirentry	function
(	O
direntry_t	struct
*	O
entry	int
)	O
{	O
return	O
fatFreeWithDir	function
(	O
entry	int
->	O
Dir	pointer
,	O
&	O
entry	int
->	O
dir	pointer
)	O
;	O
}	O
