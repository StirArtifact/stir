object	function
sSPinit	int
,	O
sSPmemory	O
;	O
object	function
make_cfun	function
(	O
void	O
(	O
*	O
self	pointer
)	O
(	O
)	O
,	O
object	function
name	int
,	O
object	function
data	int
,	O
char	O
*	O
start	pointer
,	O
int	O
size	int
)	O
{	O
object	function
cf	O
;	O
cf	O
=	O
alloc_object	function
(	O
t_cfun	O
)	O
;	O
cf	O
->	O
cf	O
.	O
cf_self	O
=	O
self	pointer
;	O
cf	O
->	O
cf	O
.	O
cf_name	O
=	O
name	int
;	O
cf	O
->	O
cf	O
.	O
cf_data	O
=	O
data	int
;	O
if	O
(	O
data	int
&&	O
type_of	function
(	O
data	int
)	O
==	O
t_cfdata	O
)	O
{	O
data	int
->	O
cfd	O
.	O
cfd_start	O
=	O
start	pointer
;	O
data	int
->	O
cfd	O
.	O
cfd_size	O
=	O
size	int
;	O
}	O
else	O
if	O
(	O
size	int
)	O
FEerror	function
(	O
"Bad call to make_cfun"	pointer
,	O
0	int
)	O
;	O
return	O
(	O
cf	O
)	O
;	O
}	O
object	function
make_sfun	function
(	O
object	function
name	int
,	O
object	function
(	O
*	O
self	pointer
)	O
(	O
)	O
,	O
int	O
argd	int
,	O
object	function
data	int
)	O
{	O
object	function
sfn	O
;	O
sfn	O
=	O
alloc_object	function
(	O
t_sfun	O
)	O
;	O
if	O
(	O
argd	int
>	O
15	int
)	O
sfn	O
->	O
d	O
.	O
t	O
=	O
(	O
int	O
)	O
t_gfun	O
;	O
sfn	O
->	O
sfn	O
.	O
sfn_self	O
=	O
self	pointer
;	O
sfn	O
->	O
sfn	O
.	O
sfn_name	O
=	O
name	int
;	O
sfn	O
->	O
sfn	O
.	O
sfn_data	O
=	O
data	int
;	O
sfn	O
->	O
sfn	O
.	O
sfn_argd	O
=	O
argd	int
;	O
return	O
(	O
sfn	O
)	O
;	O
}	O
static	O
object	function
make_vfun	function
(	O
object	function
name	int
,	O
object	function
(	O
*	O
self	pointer
)	O
(	O
)	O
,	O
int	O
argd	int
,	O
object	function
data	int
)	O
{	O
object	function
vfn	O
;	O
vfn	O
=	O
alloc_object	function
(	O
t_vfun	O
)	O
;	O
vfn	O
->	O
vfn	O
.	O
vfn_self	O
=	O
self	pointer
;	O
vfn	O
->	O
vfn	O
.	O
vfn_name	O
=	O
name	int
;	O
vfn	O
->	O
vfn	O
.	O
vfn_minargs	O
=	O
VFUN_MIN_ARGS	O
(	O
argd	int
)	O
;	O
vfn	O
->	O
vfn	O
.	O
vfn_maxargs	O
=	O
VFUN_MAX_ARGS	O
(	O
argd	int
)	O
;	O
vfn	O
->	O
vfn	O
.	O
vfn_data	O
=	O
data	int
;	O
return	O
(	O
vfn	O
)	O
;	O
}	O
object	function
make_cclosure_new	function
(	O
void	O
(	O
*	O
self	pointer
)	O
(	O
)	O
,	O
object	function
name	int
,	O
object	function
env	int
,	O
object	function
data	int
)	O
{	O
object	function
cc	O
;	O
cc	O
=	O
alloc_object	function
(	O
t_cclosure	O
)	O
;	O
cc	O
->	O
cc	O
.	O
cc_self	O
=	O
self	pointer
;	O
cc	O
->	O
cc	O
.	O
cc_name	O
=	O
name	int
;	O
cc	O
->	O
cc	O
.	O
cc_env	O
=	O
env	int
;	O
cc	O
->	O
cc	O
.	O
cc_data	O
=	O
data	int
;	O
cc	O
->	O
cc	O
.	O
cc_turbo	O
=	O
NULL	O
;	O
turbo_closure	function
(	O
cc	O
)	O
;	O
return	O
(	O
cc	O
)	O
;	O
}	O
object	function
make_cclosure	function
(	O
void	O
(	O
*	O
self	pointer
)	O
(	O
)	O
,	O
object	function
name	int
,	O
object	function
env	int
,	O
object	function
data	int
,	O
char	O
*	O
start	pointer
,	O
int	O
size	int
)	O
{	O
if	O
(	O
data	int
&&	O
type_of	function
(	O
data	int
)	O
==	O
t_cfdata	O
)	O
{	O
data	int
->	O
cfd	O
.	O
cfd_start	O
=	O
start	pointer
;	O
data	int
->	O
cfd	O
.	O
cfd_size	O
=	O
size	int
;	O
}	O
else	O
if	O
(	O
size	int
)	O
FEerror	function
(	O
"Bad call to make_cclosure"	pointer
,	O
0	int
)	O
;	O
return	O
make_cclosure_new	function
(	O
self	pointer
,	O
name	int
,	O
env	int
,	O
data	int
)	O
;	O
}	O
DEFUN_NEW	function
(	O
"MC"	pointer
,	O
object	function
,	O
fSmc	O
,	O
SI	O
,	O
2	int
,	O
2	int
,	O
NONE	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
(	O
object	function
name	int
,	O
object	function
address	O
)	O
,	O
""	pointer
)	O
{	O
dcheck_type	O
(	O
name	int
,	O
t_symbol	O
)	O
;	O
dcheck_type	O
(	O
address	O
,	O
t_fixnum	O
)	O
;	O
dcheck_type	O
(	O
sSPmemory	O
->	O
s	pointer
.	O
s_dbind	O
,	O
t_cfdata	O
)	O
;	O
name	int
=	O
make_cclosure_new	function
(	O
PADDR	O
(	O
address	O
)	O
,	O
name	int
,	O
Cnil	O
,	O
sSPmemory	O
->	O
s	pointer
.	O
s_dbind	O
)	O
;	O
RETURN1	function
(	O
name	int
)	O
;	O
}	O
static	O
object	function
MFsfun	function
(	O
object	function
sym	int
,	O
object	function
(	O
*	O
self	pointer
)	O
(	O
)	O
,	O
int	O
argd	int
,	O
object	function
data	int
)	O
{	O
object	function
sfn	O
;	O
if	O
(	O
type_of	function
(	O
sym	int
)	O
!=	O
t_symbol	O
)	O
not_a_symbol	function
(	O
sym	int
)	O
;	O
if	O
(	O
sym	int
->	O
s	pointer
.	O
s_sfdef	O
!=	O
NOT_SPECIAL	O
&&	O
sym	int
->	O
s	pointer
.	O
s_mflag	O
)	O
sym	int
->	O
s	pointer
.	O
s_sfdef	O
=	O
NOT_SPECIAL	O
;	O
sfn	O
=	O
make_sfun	function
(	O
sym	int
,	O
self	pointer
,	O
argd	int
,	O
data	int
)	O
;	O
sym	int
=	O
clear_compiler_properties	function
(	O
sym	int
,	O
sfn	O
)	O
;	O
sym	int
->	O
s	pointer
.	O
s_gfdef	O
=	O
sfn	O
;	O
sym	int
->	O
s	pointer
.	O
s_mflag	O
=	O
FALSE	O
;	O
return	O
sym	int
;	O
}	O
DEFUN_NEW	function
(	O
"MFSFUN"	pointer
,	O
object	function
,	O
fSmfsfun	O
,	O
SI	O
,	O
3	int
,	O
3	int
,	O
NONE	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
(	O
object	function
name	int
,	O
object	function
address	O
,	O
object	function
argd	int
)	O
,	O
""	pointer
)	O
{	O
dcheck_type	O
(	O
address	O
,	O
t_fixnum	O
)	O
;	O
return	O
MFsfun	function
(	O
name	int
,	O
PADDR	O
(	O
address	O
)	O
,	O
fix	function
(	O
argd	int
)	O
,	O
sSPmemory	O
->	O
s	pointer
.	O
s_dbind	O
)	O
;	O
RETURN1	function
(	O
name	int
)	O
;	O
}	O
static	O
object	function
MFvfun	function
(	O
object	function
sym	int
,	O
object	function
(	O
*	O
self	pointer
)	O
(	O
)	O
,	O
int	O
argd	int
,	O
object	function
data	int
)	O
{	O
object	function
vfn	O
;	O
if	O
(	O
type_of	function
(	O
sym	int
)	O
!=	O
t_symbol	O
)	O
not_a_symbol	function
(	O
sym	int
)	O
;	O
if	O
(	O
sym	int
->	O
s	pointer
.	O
s_sfdef	O
!=	O
NOT_SPECIAL	O
&&	O
sym	int
->	O
s	pointer
.	O
s_mflag	O
)	O
sym	int
->	O
s	pointer
.	O
s_sfdef	O
=	O
NOT_SPECIAL	O
;	O
dcheck_type	O
(	O
data	int
,	O
t_cfdata	O
)	O
;	O
vfn	O
=	O
make_vfun	function
(	O
sym	int
,	O
self	pointer
,	O
argd	int
,	O
data	int
)	O
;	O
sym	int
=	O
clear_compiler_properties	function
(	O
sym	int
,	O
vfn	O
)	O
;	O
sym	int
->	O
s	pointer
.	O
s_gfdef	O
=	O
vfn	O
;	O
sym	int
->	O
s	pointer
.	O
s_mflag	O
=	O
FALSE	O
;	O
return	O
sym	int
;	O
}	O
DEFUN_NEW	function
(	O
"MFVFUN"	pointer
,	O
object	function
,	O
fSmfvfun	O
,	O
SI	O
,	O
3	int
,	O
3	int
,	O
NONE	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
(	O
object	function
name	int
,	O
object	function
address	O
,	O
object	function
argd	int
)	O
,	O
""	pointer
)	O
{	O
MFvfun	function
(	O
name	int
,	O
PADDR	O
(	O
address	O
)	O
,	O
fix	function
(	O
argd	int
)	O
,	O
sSPmemory	O
->	O
s	pointer
.	O
s_dbind	O
)	O
;	O
RETURN1	function
(	O
name	int
)	O
;	O
}	O
static	O
object	function
MFvfun_key	function
(	O
object	function
sym	int
,	O
object	function
(	O
*	O
self	pointer
)	O
(	O
)	O
,	O
int	O
argd	int
,	O
object	function
data	int
,	O
struct	O
key	O
*	O
keys	pointer
)	O
{	O
if	O
(	O
data	int
)	O
set_key_struct	function
(	O
keys	pointer
,	O
data	int
)	O
;	O
return	O
MFvfun	function
(	O
sym	int
,	O
self	pointer
,	O
argd	int
,	O
data	int
)	O
;	O
}	O
DEFUN_NEW	function
(	O
"MFVFUN-KEY"	pointer
,	O
object	function
,	O
fSmfvfun_key	O
,	O
SI	O
,	O
4	int
,	O
4	int
,	O
NONE	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
(	O
object	function
symbol	O
,	O
object	function
address	O
,	O
object	function
argd	int
,	O
object	function
keys	pointer
)	O
,	O
""	pointer
)	O
{	O
MFvfun_key	function
(	O
symbol	O
,	O
PADDR	O
(	O
address	O
)	O
,	O
fix	function
(	O
argd	int
)	O
,	O
sSPmemory	O
->	O
s	pointer
.	O
s_dbind	O
,	O
PADDR	O
(	O
keys	pointer
)	O
)	O
;	O
RETURN1	function
(	O
symbol	O
)	O
;	O
}	O
static	O
object	function
MFnew	function
(	O
object	function
sym	int
,	O
void	O
(	O
*	O
self	pointer
)	O
(	O
)	O
,	O
object	function
data	int
)	O
{	O
object	function
cf	O
;	O
if	O
(	O
type_of	function
(	O
sym	int
)	O
!=	O
t_symbol	O
)	O
not_a_symbol	function
(	O
sym	int
)	O
;	O
if	O
(	O
sym	int
->	O
s	pointer
.	O
s_sfdef	O
!=	O
NOT_SPECIAL	O
&&	O
sym	int
->	O
s	pointer
.	O
s_mflag	O
)	O
sym	int
->	O
s	pointer
.	O
s_sfdef	O
=	O
NOT_SPECIAL	O
;	O
cf	O
=	O
alloc_object	function
(	O
t_cfun	O
)	O
;	O
cf	O
->	O
cf	O
.	O
cf_self	O
=	O
self	pointer
;	O
cf	O
->	O
cf	O
.	O
cf_name	O
=	O
sym	int
;	O
cf	O
->	O
cf	O
.	O
cf_data	O
=	O
data	int
;	O
sym	int
=	O
clear_compiler_properties	function
(	O
sym	int
,	O
cf	O
)	O
;	O
sym	int
->	O
s	pointer
.	O
s_gfdef	O
=	O
cf	O
;	O
sym	int
->	O
s	pointer
.	O
s_mflag	O
=	O
FALSE	O
;	O
return	O
sym	int
;	O
}	O
DEFUN_NEW	function
(	O
"MF"	pointer
,	O
object	function
,	O
fSmf	O
,	O
SI	O
,	O
2	int
,	O
2	int
,	O
NONE	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
(	O
object	function
name	int
,	O
object	function
addr	O
)	O
,	O
""	pointer
)	O
{	O
MFnew	function
(	O
name	int
,	O
PADDR	O
(	O
addr	O
)	O
,	O
sSPmemory	O
->	O
s	pointer
.	O
s_dbind	O
)	O
;	O
RETURN1	function
(	O
name	int
)	O
;	O
}	O
static	O
object	function
MM	function
(	O
object	function
sym	int
,	O
void	O
(	O
*	O
self	pointer
)	O
(	O
)	O
,	O
char	O
*	O
start	pointer
,	O
int	O
size	int
,	O
object	function
data	int
)	O
{	O
object	function
cf	O
;	O
if	O
(	O
type_of	function
(	O
sym	int
)	O
!=	O
t_symbol	O
)	O
not_a_symbol	function
(	O
sym	int
)	O
;	O
if	O
(	O
sym	int
->	O
s	pointer
.	O
s_sfdef	O
!=	O
NOT_SPECIAL	O
&&	O
sym	int
->	O
s	pointer
.	O
s_mflag	O
)	O
sym	int
->	O
s	pointer
.	O
s_sfdef	O
=	O
NOT_SPECIAL	O
;	O
cf	O
=	O
alloc_object	function
(	O
t_cfun	O
)	O
;	O
cf	O
->	O
cf	O
.	O
cf_self	O
=	O
self	pointer
;	O
cf	O
->	O
cf	O
.	O
cf_name	O
=	O
sym	int
;	O
cf	O
->	O
cf	O
.	O
cf_data	O
=	O
data	int
;	O
data	int
->	O
cfd	O
.	O
cfd_start	O
=	O
start	pointer
;	O
data	int
->	O
cfd	O
.	O
cfd_size	O
=	O
size	int
;	O
sym	int
=	O
clear_compiler_properties	function
(	O
sym	int
,	O
cf	O
)	O
;	O
sym	int
->	O
s	pointer
.	O
s_gfdef	O
=	O
cf	O
;	O
sym	int
->	O
s	pointer
.	O
s_mflag	O
=	O
TRUE	O
;	O
return	O
sym	int
;	O
}	O
DEFUN_NEW	function
(	O
"MM"	pointer
,	O
object	function
,	O
fSmm	O
,	O
SI	O
,	O
2	int
,	O
2	int
,	O
NONE	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
(	O
object	function
name	int
,	O
object	function
addr	O
)	O
,	O
""	pointer
)	O
{	O
MM	function
(	O
name	int
,	O
PADDR	O
(	O
addr	O
)	O
,	O
sSPmemory	O
->	O
s	pointer
.	O
s_dbind	O
->	O
cfd	O
.	O
cfd_start	O
,	O
sSPmemory	O
->	O
s	pointer
.	O
s_dbind	O
->	O
cfd	O
.	O
cfd_size	O
,	O
sSPmemory	O
->	O
s	pointer
.	O
s_dbind	O
)	O
;	O
RETURN1	function
(	O
name	int
)	O
;	O
}	O
object	function
make_function_internal	function
(	O
char	O
*	O
s	pointer
,	O
void	O
(	O
*	O
f	pointer
)	O
(	O
)	O
)	O
{	O
object	function
x	O
;	O
vs_mark	O
;	O
x	O
=	O
make_ordinary	function
(	O
s	pointer
)	O
;	O
vs_push	function
(	O
x	O
)	O
;	O
x	O
->	O
s	pointer
.	O
s_gfdef	O
=	O
make_cfun	function
(	O
f	pointer
,	O
x	O
,	O
Cnil	O
,	O
NULL	O
,	O
0	int
)	O
;	O
x	O
->	O
s	pointer
.	O
s_mflag	O
=	O
FALSE	O
;	O
vs_reset	O
;	O
return	O
(	O
x	O
)	O
;	O
}	O
object	function
make_si_sfun_internal	function
(	O
char	O
*	O
s	pointer
,	O
object	function
(	O
*	O
f	pointer
)	O
(	O
)	O
,	O
int	O
argd	int
)	O
{	O
object	function
x	O
=	O
make_si_ordinary	function
(	O
s	pointer
)	O
;	O
x	O
->	O
s	pointer
.	O
s_gfdef	O
=	O
make_sfun	function
(	O
x	O
,	O
f	pointer
,	O
argd	int
,	O
Cnil	O
)	O
;	O
x	O
->	O
s	pointer
.	O
s_mflag	O
=	O
FALSE	O
;	O
return	O
(	O
x	O
)	O
;	O
}	O
object	function
make_si_function_internal	function
(	O
char	O
*	O
s	pointer
,	O
void	O
(	O
*	O
f	pointer
)	O
(	O
)	O
)	O
{	O
object	function
x	O
;	O
vs_mark	O
;	O
x	O
=	O
make_si_ordinary	function
(	O
s	pointer
)	O
;	O
vs_push	function
(	O
x	O
)	O
;	O
x	O
->	O
s	pointer
.	O
s_gfdef	O
=	O
make_cfun	function
(	O
f	pointer
,	O
x	O
,	O
Cnil	O
,	O
NULL	O
,	O
0	int
)	O
;	O
x	O
->	O
s	pointer
.	O
s_mflag	O
=	O
FALSE	O
;	O
vs_reset	O
;	O
return	O
(	O
x	O
)	O
;	O
}	O
object	function
make_special_form_internal	function
(	O
char	O
*	O
s	pointer
,	O
void	O
(	O
*	O
f	pointer
)	O
(	O
)	O
)	O
{	O
object	function
x	O
;	O
x	O
=	O
make_ordinary	function
(	O
s	pointer
)	O
;	O
x	O
->	O
s	pointer
.	O
s_sfdef	O
=	O
f	pointer
;	O
return	O
(	O
x	O
)	O
;	O
}	O
DEFUN_NEW	function
(	O
"COMPILED-FUNCTION-NAME"	pointer
,	O
object	function
,	O
fScompiled_function_name	O
,	O
SI	O
,	O
1	int
,	O
1	int
,	O
NONE	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
(	O
object	function
fun	int
)	O
,	O
""	pointer
)	O
{	O
switch	O
(	O
type_of	function
(	O
fun	int
)	O
)	O
{	O
case	O
t_cfun	O
:	O
case	O
t_afun	O
:	O
case	O
t_closure	O
:	O
case	O
t_sfun	O
:	O
case	O
t_vfun	O
:	O
case	O
t_cclosure	O
:	O
case	O
t_gfun	O
:	O
fun	int
=	O
fun	int
->	O
cf	O
.	O
cf_name	O
;	O
break	O
;	O
default	O
:	O
FEerror	function
(	O
"~S is not a compiled-function."	pointer
,	O
1	int
,	O
fun	int
)	O
;	O
}	O
RETURN1	function
(	O
fun	int
)	O
;	O
}	O
void	O
turbo_closure	function
(	O
object	function
fun	int
)	O
{	O
object	function
l	O
,	O
*	O
block	O
;	O
int	O
n	int
;	O
if	O
(	O
1	int
)	O
{	O
BEGIN_NO_INTERRUPT	O
;	O
for	O
(	O
n	int
=	O
0	int
,	O
l	O
=	O
fun	int
->	O
cc	O
.	O
cc_env	O
;	O
!	O
endp	function
(	O
l	O
)	O
;	O
n	int
++	O
,	O
l	O
=	O
l	O
->	O
c	O
.	O
c_cdr	O
)	O
;	O
{	O
block	O
=	O
AR_ALLOC	function
(	O
alloc_relblock	O
,	O
(	O
1	int
+	O
n	int
)	O
,	O
object	function
)	O
;	O
*	O
block	O
=	O
make_fixnum	function
(	O
n	int
)	O
;	O
fun	int
->	O
cc	O
.	O
cc_turbo	O
=	O
block	O
+	O
1	int
;	O
for	O
(	O
n	int
=	O
0	int
,	O
l	O
=	O
fun	int
->	O
cc	O
.	O
cc_env	O
;	O
!	O
endp	function
(	O
l	O
)	O
;	O
n	int
++	O
,	O
l	O
=	O
l	O
->	O
c	O
.	O
c_cdr	O
)	O
fun	int
->	O
cc	O
.	O
cc_turbo	O
[	O
n	int
]	O
=	O
l	O
;	O
}	O
END_NO_INTERRUPT	O
;	O
}	O
}	O
DEFUN_NEW	function
(	O
"TURBO-CLOSURE"	pointer
,	O
object	function
,	O
fSturbo_closure	O
,	O
SI	O
,	O
1	int
,	O
1	int
,	O
NONE	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
(	O
object	function
funobj	O
)	O
,	O
""	pointer
)	O
{	O
if	O
(	O
type_of	function
(	O
funobj	O
)	O
==	O
t_cclosure	O
)	O
turbo_closure	function
(	O
funobj	O
)	O
;	O
RETURN1	function
(	O
funobj	O
)	O
;	O
}	O
void	O
gcl_init_cfun	function
(	O
void	O
)	O
{	O
}	O
