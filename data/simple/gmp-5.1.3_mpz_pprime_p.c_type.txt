static	O
int	O
isprime	function
(	O
unsigned	O
long	O
int	O
)	O
;	O
int	O
mpz_probab_prime_p	O
(	O
mpz_srcptr	pointer
n	long
,	O
int	O
reps	int
)	O
{	O
mp_limb_t	long
r	long
;	O
mpz_t	array
n2	array
;	O
if	O
(	O
mpz_cmp_ui	O
(	O
n	long
,	O
1000000L	int
)	O
<=	O
0	int
)	O
{	O
int	O
is_prime	int
;	O
if	O
(	O
mpz_cmpabs_ui	O
(	O
n	long
,	O
1000000L	int
)	O
<=	O
0	int
)	O
{	O
is_prime	int
=	O
isprime	function
(	O
mpz_get_ui	O
(	O
n	long
)	O
)	O
;	O
return	O
is_prime	int
?	O
2	int
:	O
0	int
;	O
}	O
PTR	O
(	O
n2	array
)	O
=	O
PTR	O
(	O
n	long
)	O
;	O
SIZ	O
(	O
n2	array
)	O
=	O
-	O
SIZ	O
(	O
n	long
)	O
;	O
n	long
=	O
n2	array
;	O
}	O
if	O
(	O
(	O
mpz_get_ui	O
(	O
n	long
)	O
&	O
1	int
)	O
==	O
0	int
)	O
return	O
0	int
;	O
r	long
=	O
MPN_MOD_OR_PREINV_MOD_1	O
(	O
PTR	O
(	O
n	long
)	O
,	O
(	O
mp_size_t	long
)	O
SIZ	O
(	O
n	long
)	O
,	O
(	O
mp_limb_t	long
)	O
PP	O
,	O
(	O
mp_limb_t	long
)	O
PP_INVERTED	O
)	O
;	O
if	O
(	O
r	long
%	O
3	int
==	O
0	int
||	O
r	long
%	O
5	int
==	O
0	int
||	O
r	long
%	O
7	int
==	O
0	int
||	O
r	long
%	O
11	int
==	O
0	int
||	O
r	long
%	O
13	int
==	O
0	int
||	O
r	long
%	O
17	int
==	O
0	int
||	O
r	long
%	O
19	int
==	O
0	int
||	O
r	long
%	O
23	int
==	O
0	int
||	O
r	long
%	O
29	int
==	O
0	int
||	O
r	long
%	O
31	int
==	O
0	int
||	O
r	long
%	O
37	int
==	O
0	int
||	O
r	long
%	O
41	int
==	O
0	int
||	O
r	long
%	O
43	int
==	O
0	int
||	O
r	long
%	O
47	int
==	O
0	int
||	O
r	long
%	O
53	int
==	O
0	int
)	O
{	O
return	O
0	int
;	O
}	O
{	O
unsigned	O
long	O
int	O
ln2	long
;	O
unsigned	O
long	O
int	O
q	int
;	O
mp_limb_t	long
p1	long
,	O
p0	long
,	O
p	pointer
;	O
unsigned	O
int	O
primes	array
[	O
15	int
]	O
;	O
int	O
nprimes	int
;	O
nprimes	int
=	O
0	int
;	O
p	pointer
=	O
1	int
;	O
ln2	long
=	O
mpz_sizeinbase	O
(	O
n	long
,	O
2	int
)	O
;	O
for	O
(	O
q	int
=	O
PP_FIRST_OMITTED	int
;	O
q	int
<	O
ln2	long
;	O
q	int
+=	O
2	int
)	O
{	O
if	O
(	O
isprime	function
(	O
q	int
)	O
)	O
{	O
umul_ppmm	O
(	O
p1	long
,	O
p0	long
,	O
p	pointer
,	O
q	int
)	O
;	O
if	O
(	O
p1	long
!=	O
0	int
)	O
{	O
r	long
=	O
MPN_MOD_OR_MODEXACT_1_ODD	O
(	O
PTR	O
(	O
n	long
)	O
,	O
(	O
mp_size_t	long
)	O
SIZ	O
(	O
n	long
)	O
,	O
p	pointer
)	O
;	O
while	O
(	O
--	O
nprimes	int
>=	O
0	int
)	O
if	O
(	O
r	long
%	O
primes	array
[	O
nprimes	int
]	O
==	O
0	int
)	O
{	O
ASSERT_ALWAYS	O
(	O
mpn_mod_1	O
(	O
PTR	O
(	O
n	long
)	O
,	O
(	O
mp_size_t	long
)	O
SIZ	O
(	O
n	long
)	O
,	O
(	O
mp_limb_t	long
)	O
primes	array
[	O
nprimes	int
]	O
)	O
==	O
0	int
)	O
;	O
return	O
0	int
;	O
}	O
p	pointer
=	O
q	int
;	O
nprimes	int
=	O
0	int
;	O
}	O
else	O
{	O
p	pointer
=	O
p0	long
;	O
}	O
primes	array
[	O
nprimes	int
++	O
]	O
=	O
q	int
;	O
}	O
}	O
}	O
return	O
mpz_millerrabin	O
(	O
n	long
,	O
reps	int
)	O
;	O
}	O
static	O
int	O
isprime	function
(	O
unsigned	O
long	O
int	O
t	long
)	O
{	O
unsigned	O
long	O
int	O
q	int
,	O
r	long
,	O
d	long
;	O
if	O
(	O
t	long
<	O
3	int
||	O
(	O
t	long
&	O
1	int
)	O
==	O
0	int
)	O
return	O
t	long
==	O
2	int
;	O
for	O
(	O
d	long
=	O
3	int
,	O
r	long
=	O
1	int
;	O
r	long
!=	O
0	int
;	O
d	long
+=	O
2	int
)	O
{	O
q	int
=	O
t	long
/	O
d	long
;	O
r	long
=	O
t	long
-	O
q	int
*	O
d	long
;	O
if	O
(	O
q	int
<	O
d	long
)	O
return	O
1	int
;	O
}	O
return	O
0	int
;	O
}	O
