const	O
char	O
_uuconf_errstr_rcsid	array
[	O
]	O
=	O
"$Id: errstr.c,v 1.6 2002/03/05 19:10:42 ian Rel $"	pointer
;	O
static	O
char	O
*	O
zeprint_num	function
P	O
(	O
(	O
char	O
*	O
zbuf	pointer
,	O
size_t	long
cbuf	long
,	O
int	O
ival	long
)	O
)	O
;	O
int	O
uuconf_error_string	function
(	O
pglobal	pointer
,	O
ierr	int
,	O
zbuf	pointer
,	O
cbuf	long
)	O
pointer	pointer
pglobal	pointer
;	O
int	O
ierr	int
;	O
char	O
*	O
zbuf	pointer
;	O
size_t	long
cbuf	long
;	O
{	O
struct	O
sglobal	struct
*	O
qglobal	pointer
=	O
(	O
struct	O
sglobal	struct
*	O
)	O
pglobal	pointer
;	O
const	O
char	O
*	O
zfile	pointer
;	O
size_t	long
cfile	long
;	O
const	O
char	O
*	O
zlineno	pointer
;	O
char	O
ablineno	array
[	O
100	int
]	O
;	O
size_t	long
clineno	long
;	O
const	O
char	O
*	O
zmsg	pointer
;	O
char	O
abmsg	array
[	O
100	int
]	O
;	O
size_t	long
cmsg	long
;	O
const	O
char	O
*	O
zerrno	pointer
;	O
size_t	long
cerrno	long
;	O
size_t	long
cret	long
;	O
size_t	long
ccopy	long
;	O
if	O
(	O
(	O
ierr	int
&	O
UUCONF_ERROR_FILENAME	O
)	O
==	O
0	int
||	O
qglobal	pointer
==	O
NULL	O
||	O
qglobal	pointer
->	O
zfilename	pointer
==	O
NULL	O
)	O
{	O
zfile	pointer
=	O
""	pointer
;	O
cfile	long
=	O
0	int
;	O
}	O
else	O
{	O
zfile	pointer
=	O
qglobal	pointer
->	O
zfilename	pointer
;	O
cfile	long
=	O
strlen	function
(	O
zfile	pointer
)	O
+	O
1	int
;	O
}	O
if	O
(	O
cfile	long
==	O
0	int
||	O
(	O
ierr	int
&	O
UUCONF_ERROR_LINENO	O
)	O
==	O
0	int
||	O
qglobal	pointer
==	O
NULL	O
||	O
qglobal	pointer
->	O
ilineno	int
<=	O
0	int
)	O
{	O
zlineno	pointer
=	O
""	pointer
;	O
clineno	long
=	O
0	int
;	O
}	O
else	O
{	O
zlineno	pointer
=	O
zeprint_num	function
(	O
ablineno	array
,	O
sizeof	O
ablineno	array
,	O
qglobal	pointer
->	O
ilineno	int
)	O
;	O
clineno	long
=	O
strlen	function
(	O
zlineno	pointer
)	O
+	O
1	int
;	O
}	O
switch	O
(	O
UUCONF_ERROR_VALUE	O
(	O
ierr	int
)	O
)	O
{	O
case	O
UUCONF_SUCCESS	O
:	O
zmsg	pointer
=	O
"no error"	pointer
;	O
break	O
;	O
case	O
UUCONF_NOT_FOUND	O
:	O
zmsg	pointer
=	O
"not found"	pointer
;	O
break	O
;	O
case	O
UUCONF_FOPEN_FAILED	O
:	O
zmsg	pointer
=	O
"fopen"	pointer
;	O
break	O
;	O
case	O
UUCONF_FSEEK_FAILED	O
:	O
zmsg	pointer
=	O
"fseek"	pointer
;	O
break	O
;	O
case	O
UUCONF_MALLOC_FAILED	O
:	O
zmsg	pointer
=	O
"malloc"	pointer
;	O
break	O
;	O
case	O
UUCONF_SYNTAX_ERROR	O
:	O
zmsg	pointer
=	O
"syntax error"	pointer
;	O
break	O
;	O
default	O
:	O
zmsg	pointer
=	O
zeprint_num	function
(	O
abmsg	array
,	O
sizeof	O
abmsg	array
,	O
UUCONF_ERROR_VALUE	O
(	O
ierr	int
)	O
)	O
;	O
zmsg	pointer
-=	O
sizeof	O
"error "	pointer
-	O
1	int
;	O
memcpy	function
(	O
(	O
pointer	pointer
)	O
zmsg	pointer
,	O
(	O
pointer	pointer
)	O
"error "	pointer
,	O
sizeof	O
"error "	pointer
-	O
1	int
)	O
;	O
break	O
;	O
}	O
cmsg	long
=	O
strlen	function
(	O
zmsg	pointer
)	O
;	O
if	O
(	O
cfile	long
>	O
0	int
)	O
++	O
cmsg	long
;	O
if	O
(	O
(	O
ierr	int
&	O
UUCONF_ERROR_ERRNO	O
)	O
==	O
0	int
||	O
qglobal	pointer
==	O
NULL	O
)	O
{	O
zerrno	pointer
=	O
""	pointer
;	O
cerrno	long
=	O
0	int
;	O
}	O
else	O
{	O
zerrno	pointer
=	O
strerror	function
(	O
qglobal	pointer
->	O
ierrno	int
)	O
;	O
cerrno	long
=	O
strlen	function
(	O
zerrno	pointer
)	O
+	O
2	int
;	O
}	O
cret	long
=	O
cfile	long
+	O
clineno	long
+	O
cmsg	long
+	O
cerrno	long
+	O
1	int
;	O
if	O
(	O
cbuf	long
==	O
0	int
)	O
return	O
cret	long
;	O
--	O
cbuf	long
;	O
if	O
(	O
cfile	long
>	O
0	int
)	O
{	O
ccopy	long
=	O
cfile	long
-	O
1	int
;	O
if	O
(	O
ccopy	long
>	O
cbuf	long
)	O
ccopy	long
=	O
cbuf	long
;	O
memcpy	function
(	O
(	O
pointer	pointer
)	O
zbuf	pointer
,	O
(	O
pointer	pointer
)	O
zfile	pointer
,	O
ccopy	long
)	O
;	O
zbuf	pointer
+=	O
ccopy	long
;	O
cbuf	long
-=	O
ccopy	long
;	O
if	O
(	O
cbuf	long
>	O
0	int
)	O
{	O
*	O
zbuf	pointer
++	O
=	O
':'	O
;	O
--	O
cbuf	long
;	O
}	O
}	O
if	O
(	O
clineno	long
>	O
0	int
)	O
{	O
ccopy	long
=	O
clineno	long
-	O
1	int
;	O
if	O
(	O
ccopy	long
>	O
cbuf	long
)	O
ccopy	long
=	O
cbuf	long
;	O
memcpy	function
(	O
(	O
pointer	pointer
)	O
zbuf	pointer
,	O
(	O
pointer	pointer
)	O
zlineno	pointer
,	O
ccopy	long
)	O
;	O
zbuf	pointer
+=	O
ccopy	long
;	O
cbuf	long
-=	O
ccopy	long
;	O
if	O
(	O
cbuf	long
>	O
0	int
)	O
{	O
*	O
zbuf	pointer
++	O
=	O
':'	O
;	O
--	O
cbuf	long
;	O
}	O
}	O
if	O
(	O
cbuf	long
>	O
0	int
&&	O
cfile	long
>	O
0	int
)	O
{	O
*	O
zbuf	pointer
++	O
=	O
' '	O
;	O
--	O
cbuf	long
;	O
--	O
cmsg	long
;	O
}	O
ccopy	long
=	O
cmsg	long
;	O
if	O
(	O
ccopy	long
>	O
cbuf	long
)	O
ccopy	long
=	O
cbuf	long
;	O
memcpy	function
(	O
(	O
pointer	pointer
)	O
zbuf	pointer
,	O
(	O
pointer	pointer
)	O
zmsg	pointer
,	O
ccopy	long
)	O
;	O
zbuf	pointer
+=	O
ccopy	long
;	O
cbuf	long
-=	O
ccopy	long
;	O
if	O
(	O
cerrno	long
>	O
0	int
)	O
{	O
if	O
(	O
cbuf	long
>	O
0	int
)	O
{	O
*	O
zbuf	pointer
++	O
=	O
':'	O
;	O
--	O
cbuf	long
;	O
}	O
if	O
(	O
cbuf	long
>	O
0	int
)	O
{	O
*	O
zbuf	pointer
++	O
=	O
' '	O
;	O
--	O
cbuf	long
;	O
}	O
ccopy	long
=	O
cerrno	long
-	O
2	int
;	O
if	O
(	O
ccopy	long
>	O
cbuf	long
)	O
ccopy	long
=	O
cbuf	long
;	O
memcpy	function
(	O
(	O
pointer	pointer
)	O
zbuf	pointer
,	O
(	O
pointer	pointer
)	O
zerrno	pointer
,	O
ccopy	long
)	O
;	O
zbuf	pointer
+=	O
ccopy	long
;	O
cbuf	long
-=	O
ccopy	long
;	O
}	O
*	O
zbuf	pointer
=	O
'\0'	O
;	O
return	O
cret	long
;	O
}	O
static	O
char	O
*	O
zeprint_num	function
(	O
ab	pointer
,	O
c	long
,	O
i	int
)	O
char	O
*	O
ab	pointer
;	O
size_t	long
c	long
;	O
register	O
int	O
i	int
;	O
{	O
register	O
char	O
*	O
z	pointer
;	O
z	pointer
=	O
ab	pointer
+	O
c	long
;	O
*	O
--	O
z	pointer
=	O
'\0'	O
;	O
do	O
{	O
*	O
--	O
z	pointer
=	O
i	int
%	O
10	int
+	O
'0'	O
;	O
i	int
/=	O
10	int
;	O
}	O
while	O
(	O
i	int
!=	O
0	int
)	O
;	O
return	O
z	pointer
;	O
}	O
