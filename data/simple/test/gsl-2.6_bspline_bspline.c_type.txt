gsl_bspline_workspace	struct
*	O
gsl_bspline_alloc	function
(	O
const	O
size_t	long
k	long
,	O
const	O
size_t	long
nbreak	long
)	O
{	O
if	O
(	O
k	long
==	O
0	int
)	O
{	O
GSL_ERROR_NULL	O
(	O
"k must be at least 1"	pointer
,	O
GSL_EINVAL	int
)	O
;	O
}	O
else	O
if	O
(	O
nbreak	long
<	O
2	int
)	O
{	O
GSL_ERROR_NULL	O
(	O
"nbreak must be at least 2"	pointer
,	O
GSL_EINVAL	int
)	O
;	O
}	O
else	O
{	O
gsl_bspline_workspace	struct
*	O
w	pointer
;	O
w	pointer
=	O
calloc	function
(	O
1	int
,	O
sizeof	O
(	O
gsl_bspline_workspace	struct
)	O
)	O
;	O
if	O
(	O
w	pointer
==	O
0	int
)	O
{	O
GSL_ERROR_NULL	O
(	O
"failed to allocate space for workspace"	pointer
,	O
GSL_ENOMEM	int
)	O
;	O
}	O
w	pointer
->	O
k	long
=	O
k	long
;	O
w	pointer
->	O
km1	long
=	O
k	long
-	O
1	int
;	O
w	pointer
->	O
nbreak	long
=	O
nbreak	long
;	O
w	pointer
->	O
l	long
=	O
nbreak	long
-	O
1	int
;	O
w	pointer
->	O
n	int
=	O
w	pointer
->	O
l	long
+	O
k	long
-	O
1	int
;	O
w	pointer
->	O
knots	pointer
=	O
gsl_vector_alloc	function
(	O
w	pointer
->	O
n	int
+	O
k	long
)	O
;	O
if	O
(	O
w	pointer
->	O
knots	pointer
==	O
0	int
)	O
{	O
gsl_bspline_free	function
(	O
w	pointer
)	O
;	O
GSL_ERROR_NULL	O
(	O
"failed to allocate space for knots vector"	pointer
,	O
GSL_ENOMEM	int
)	O
;	O
}	O
w	pointer
->	O
deltal	pointer
=	O
gsl_vector_alloc	function
(	O
k	long
)	O
;	O
if	O
(	O
w	pointer
->	O
deltal	pointer
==	O
0	int
)	O
{	O
gsl_bspline_free	function
(	O
w	pointer
)	O
;	O
GSL_ERROR_NULL	O
(	O
"failed to allocate space for deltal vector"	pointer
,	O
GSL_ENOMEM	int
)	O
;	O
}	O
w	pointer
->	O
deltar	pointer
=	O
gsl_vector_alloc	function
(	O
k	long
)	O
;	O
if	O
(	O
w	pointer
->	O
deltar	pointer
==	O
0	int
)	O
{	O
gsl_bspline_free	function
(	O
w	pointer
)	O
;	O
GSL_ERROR_NULL	O
(	O
"failed to allocate space for deltar vector"	pointer
,	O
GSL_ENOMEM	int
)	O
;	O
}	O
w	pointer
->	O
B	pointer
=	O
gsl_vector_alloc	function
(	O
k	long
)	O
;	O
if	O
(	O
w	pointer
->	O
B	pointer
==	O
0	int
)	O
{	O
gsl_bspline_free	function
(	O
w	pointer
)	O
;	O
GSL_ERROR_NULL	O
(	O
"failed to allocate space for temporary spline vector"	pointer
,	O
GSL_ENOMEM	int
)	O
;	O
}	O
w	pointer
->	O
A	pointer
=	O
gsl_matrix_alloc	function
(	O
k	long
,	O
k	long
)	O
;	O
if	O
(	O
w	pointer
->	O
A	pointer
==	O
0	int
)	O
{	O
gsl_bspline_free	function
(	O
w	pointer
)	O
;	O
GSL_ERROR_NULL	O
(	O
"failed to allocate space for derivative work matrix"	pointer
,	O
GSL_ENOMEM	int
)	O
;	O
}	O
w	pointer
->	O
dB	pointer
=	O
gsl_matrix_alloc	function
(	O
k	long
,	O
k	long
+	O
1	int
)	O
;	O
if	O
(	O
w	pointer
->	O
dB	pointer
==	O
0	int
)	O
{	O
gsl_bspline_free	function
(	O
w	pointer
)	O
;	O
GSL_ERROR_NULL	O
(	O
"failed to allocate space for temporary derivative matrix"	pointer
,	O
GSL_ENOMEM	int
)	O
;	O
}	O
return	O
w	pointer
;	O
}	O
}	O
void	O
gsl_bspline_free	function
(	O
gsl_bspline_workspace	struct
*	O
w	pointer
)	O
{	O
RETURN_IF_NULL	O
(	O
w	pointer
)	O
;	O
if	O
(	O
w	pointer
->	O
knots	pointer
)	O
gsl_vector_free	function
(	O
w	pointer
->	O
knots	pointer
)	O
;	O
if	O
(	O
w	pointer
->	O
deltal	pointer
)	O
gsl_vector_free	function
(	O
w	pointer
->	O
deltal	pointer
)	O
;	O
if	O
(	O
w	pointer
->	O
deltar	pointer
)	O
gsl_vector_free	function
(	O
w	pointer
->	O
deltar	pointer
)	O
;	O
if	O
(	O
w	pointer
->	O
B	pointer
)	O
gsl_vector_free	function
(	O
w	pointer
->	O
B	pointer
)	O
;	O
if	O
(	O
w	pointer
->	O
A	pointer
)	O
gsl_matrix_free	function
(	O
w	pointer
->	O
A	pointer
)	O
;	O
if	O
(	O
w	pointer
->	O
dB	pointer
)	O
gsl_matrix_free	function
(	O
w	pointer
->	O
dB	pointer
)	O
;	O
free	function
(	O
w	pointer
)	O
;	O
}	O
size_t	long
gsl_bspline_ncoeffs	function
(	O
gsl_bspline_workspace	struct
*	O
w	pointer
)	O
{	O
return	O
w	pointer
->	O
n	int
;	O
}	O
size_t	long
gsl_bspline_order	function
(	O
gsl_bspline_workspace	struct
*	O
w	pointer
)	O
{	O
return	O
w	pointer
->	O
k	long
;	O
}	O
size_t	long
gsl_bspline_nbreak	function
(	O
gsl_bspline_workspace	struct
*	O
w	pointer
)	O
{	O
return	O
w	pointer
->	O
nbreak	long
;	O
}	O
double	O
gsl_bspline_breakpoint	function
(	O
size_t	long
i	long
,	O
gsl_bspline_workspace	struct
*	O
w	pointer
)	O
{	O
size_t	long
j	long
=	O
i	long
+	O
w	pointer
->	O
k	long
-	O
1	int
;	O
return	O
gsl_vector_get	function
(	O
w	pointer
->	O
knots	pointer
,	O
j	long
)	O
;	O
}	O
int	O
gsl_bspline_knots	function
(	O
const	O
gsl_vector	struct
*	O
breakpts	pointer
,	O
gsl_bspline_workspace	struct
*	O
w	pointer
)	O
{	O
if	O
(	O
breakpts	pointer
->	O
size	long
!=	O
w	pointer
->	O
nbreak	long
)	O
{	O
GSL_ERROR	O
(	O
"breakpts vector has wrong size"	pointer
,	O
GSL_EBADLEN	int
)	O
;	O
}	O
else	O
{	O
size_t	long
i	long
;	O
for	O
(	O
i	long
=	O
0	int
;	O
i	long
<	O
w	pointer
->	O
k	long
;	O
i	long
++	O
)	O
gsl_vector_set	function
(	O
w	pointer
->	O
knots	pointer
,	O
i	long
,	O
gsl_vector_get	function
(	O
breakpts	pointer
,	O
0	int
)	O
)	O
;	O
for	O
(	O
i	long
=	O
1	int
;	O
i	long
<	O
w	pointer
->	O
l	long
;	O
i	long
++	O
)	O
{	O
gsl_vector_set	function
(	O
w	pointer
->	O
knots	pointer
,	O
w	pointer
->	O
k	long
-	O
1	int
+	O
i	long
,	O
gsl_vector_get	function
(	O
breakpts	pointer
,	O
i	long
)	O
)	O
;	O
}	O
for	O
(	O
i	long
=	O
w	pointer
->	O
n	int
;	O
i	long
<	O
w	pointer
->	O
n	int
+	O
w	pointer
->	O
k	long
;	O
i	long
++	O
)	O
gsl_vector_set	function
(	O
w	pointer
->	O
knots	pointer
,	O
i	long
,	O
gsl_vector_get	function
(	O
breakpts	pointer
,	O
w	pointer
->	O
l	long
)	O
)	O
;	O
return	O
GSL_SUCCESS	int
;	O
}	O
}	O
int	O
gsl_bspline_knots_uniform	function
(	O
const	O
double	O
a	double
,	O
const	O
double	O
b	double
,	O
gsl_bspline_workspace	struct
*	O
w	pointer
)	O
{	O
size_t	long
i	long
;	O
double	O
delta	double
;	O
double	O
x	double
;	O
delta	double
=	O
(	O
b	double
-	O
a	double
)	O
/	O
(	O
double	O
)	O
w	pointer
->	O
l	long
;	O
for	O
(	O
i	long
=	O
0	int
;	O
i	long
<	O
w	pointer
->	O
k	long
;	O
i	long
++	O
)	O
gsl_vector_set	function
(	O
w	pointer
->	O
knots	pointer
,	O
i	long
,	O
a	double
)	O
;	O
x	double
=	O
a	double
+	O
delta	double
;	O
for	O
(	O
i	long
=	O
0	int
;	O
i	long
<	O
w	pointer
->	O
l	long
-	O
1	int
;	O
i	long
++	O
)	O
{	O
gsl_vector_set	function
(	O
w	pointer
->	O
knots	pointer
,	O
w	pointer
->	O
k	long
+	O
i	long
,	O
x	double
)	O
;	O
x	double
+=	O
delta	double
;	O
}	O
for	O
(	O
i	long
=	O
w	pointer
->	O
n	int
;	O
i	long
<	O
w	pointer
->	O
n	int
+	O
w	pointer
->	O
k	long
;	O
i	long
++	O
)	O
gsl_vector_set	function
(	O
w	pointer
->	O
knots	pointer
,	O
i	long
,	O
b	double
)	O
;	O
return	O
GSL_SUCCESS	int
;	O
}	O
int	O
gsl_bspline_eval	function
(	O
const	O
double	O
x	double
,	O
gsl_vector	struct
*	O
B	pointer
,	O
gsl_bspline_workspace	struct
*	O
w	pointer
)	O
{	O
if	O
(	O
B	pointer
->	O
size	long
!=	O
w	pointer
->	O
n	int
)	O
{	O
GSL_ERROR	O
(	O
"vector B not of length n"	pointer
,	O
GSL_EBADLEN	int
)	O
;	O
}	O
else	O
{	O
size_t	long
i	long
;	O
size_t	long
istart	pointer
;	O
size_t	long
iend	pointer
;	O
int	O
error	int
;	O
error	int
=	O
gsl_bspline_eval_nonzero	function
(	O
x	double
,	O
w	pointer
->	O
B	pointer
,	O
&	O
istart	pointer
,	O
&	O
iend	pointer
,	O
w	pointer
)	O
;	O
if	O
(	O
error	int
)	O
return	O
error	int
;	O
for	O
(	O
i	long
=	O
0	int
;	O
i	long
<	O
istart	pointer
;	O
i	long
++	O
)	O
gsl_vector_set	function
(	O
B	pointer
,	O
i	long
,	O
0.0	int
)	O
;	O
for	O
(	O
i	long
=	O
istart	pointer
;	O
i	long
<=	O
iend	pointer
;	O
i	long
++	O
)	O
gsl_vector_set	function
(	O
B	pointer
,	O
i	long
,	O
gsl_vector_get	function
(	O
w	pointer
->	O
B	pointer
,	O
i	long
-	O
istart	pointer
)	O
)	O
;	O
for	O
(	O
i	long
=	O
iend	pointer
+	O
1	int
;	O
i	long
<	O
w	pointer
->	O
n	int
;	O
i	long
++	O
)	O
gsl_vector_set	function
(	O
B	pointer
,	O
i	long
,	O
0.0	int
)	O
;	O
return	O
GSL_SUCCESS	int
;	O
}	O
}	O
int	O
gsl_bspline_eval_nonzero	function
(	O
const	O
double	O
x	double
,	O
gsl_vector	struct
*	O
Bk	pointer
,	O
size_t	long
*	O
istart	pointer
,	O
size_t	long
*	O
iend	pointer
,	O
gsl_bspline_workspace	struct
*	O
w	pointer
)	O
{	O
if	O
(	O
Bk	pointer
->	O
size	long
!=	O
w	pointer
->	O
k	long
)	O
{	O
GSL_ERROR	O
(	O
"Bk vector length does not match order k"	pointer
,	O
GSL_EBADLEN	int
)	O
;	O
}	O
else	O
{	O
size_t	long
i	long
;	O
size_t	long
j	long
;	O
int	O
flag	pointer
=	O
0	int
;	O
int	O
error	int
=	O
0	int
;	O
i	long
=	O
bspline_find_interval	function
(	O
x	double
,	O
&	O
flag	pointer
,	O
w	pointer
)	O
;	O
error	int
=	O
bspline_process_interval_for_eval	function
(	O
x	double
,	O
&	O
i	long
,	O
flag	pointer
,	O
w	pointer
)	O
;	O
if	O
(	O
error	int
)	O
return	O
error	int
;	O
*	O
istart	pointer
=	O
i	long
-	O
w	pointer
->	O
k	long
+	O
1	int
;	O
*	O
iend	pointer
=	O
i	long
;	O
bspline_pppack_bsplvb	function
(	O
w	pointer
->	O
knots	pointer
,	O
w	pointer
->	O
k	long
,	O
1	int
,	O
x	double
,	O
*	O
iend	pointer
,	O
&	O
j	long
,	O
w	pointer
->	O
deltal	pointer
,	O
w	pointer
->	O
deltar	pointer
,	O
Bk	pointer
)	O
;	O
return	O
GSL_SUCCESS	int
;	O
}	O
}	O
int	O
gsl_bspline_deriv_eval	function
(	O
const	O
double	O
x	double
,	O
const	O
size_t	long
nderiv	long
,	O
gsl_matrix	struct
*	O
dB	pointer
,	O
gsl_bspline_workspace	struct
*	O
w	pointer
)	O
{	O
if	O
(	O
dB	pointer
->	O
size1	long
!=	O
w	pointer
->	O
n	int
)	O
{	O
GSL_ERROR	O
(	O
"dB matrix first dimension not of length n"	pointer
,	O
GSL_EBADLEN	int
)	O
;	O
}	O
else	O
if	O
(	O
dB	pointer
->	O
size2	long
<	O
nderiv	long
+	O
1	int
)	O
{	O
GSL_ERROR	O
(	O
"dB matrix second dimension must be at least length nderiv+1"	pointer
,	O
GSL_EBADLEN	int
)	O
;	O
}	O
else	O
{	O
size_t	long
i	long
;	O
size_t	long
j	long
;	O
size_t	long
istart	pointer
;	O
size_t	long
iend	pointer
;	O
int	O
error	int
;	O
error	int
=	O
gsl_bspline_deriv_eval_nonzero	function
(	O
x	double
,	O
nderiv	long
,	O
w	pointer
->	O
dB	pointer
,	O
&	O
istart	pointer
,	O
&	O
iend	pointer
,	O
w	pointer
)	O
;	O
if	O
(	O
error	int
)	O
return	O
error	int
;	O
for	O
(	O
j	long
=	O
0	int
;	O
j	long
<=	O
nderiv	long
;	O
j	long
++	O
)	O
{	O
for	O
(	O
i	long
=	O
0	int
;	O
i	long
<	O
istart	pointer
;	O
i	long
++	O
)	O
gsl_matrix_set	function
(	O
dB	pointer
,	O
i	long
,	O
j	long
,	O
0.0	int
)	O
;	O
for	O
(	O
i	long
=	O
istart	pointer
;	O
i	long
<=	O
iend	pointer
;	O
i	long
++	O
)	O
gsl_matrix_set	function
(	O
dB	pointer
,	O
i	long
,	O
j	long
,	O
gsl_matrix_get	function
(	O
w	pointer
->	O
dB	pointer
,	O
i	long
-	O
istart	pointer
,	O
j	long
)	O
)	O
;	O
for	O
(	O
i	long
=	O
iend	pointer
+	O
1	int
;	O
i	long
<	O
w	pointer
->	O
n	int
;	O
i	long
++	O
)	O
gsl_matrix_set	function
(	O
dB	pointer
,	O
i	long
,	O
j	long
,	O
0.0	int
)	O
;	O
}	O
return	O
GSL_SUCCESS	int
;	O
}	O
}	O
int	O
gsl_bspline_deriv_eval_nonzero	function
(	O
const	O
double	O
x	double
,	O
const	O
size_t	long
nderiv	long
,	O
gsl_matrix	struct
*	O
dB	pointer
,	O
size_t	long
*	O
istart	pointer
,	O
size_t	long
*	O
iend	pointer
,	O
gsl_bspline_workspace	struct
*	O
w	pointer
)	O
{	O
if	O
(	O
dB	pointer
->	O
size1	long
!=	O
w	pointer
->	O
k	long
)	O
{	O
GSL_ERROR	O
(	O
"dB matrix first dimension not of length k"	pointer
,	O
GSL_EBADLEN	int
)	O
;	O
}	O
else	O
if	O
(	O
dB	pointer
->	O
size2	long
<	O
nderiv	long
+	O
1	int
)	O
{	O
GSL_ERROR	O
(	O
"dB matrix second dimension must be at least length nderiv+1"	pointer
,	O
GSL_EBADLEN	int
)	O
;	O
}	O
else	O
{	O
size_t	long
i	long
;	O
size_t	long
j	long
;	O
int	O
flag	pointer
=	O
0	int
;	O
int	O
error	int
=	O
0	int
;	O
size_t	long
min_nderivk	long
;	O
i	long
=	O
bspline_find_interval	function
(	O
x	double
,	O
&	O
flag	pointer
,	O
w	pointer
)	O
;	O
error	int
=	O
bspline_process_interval_for_eval	function
(	O
x	double
,	O
&	O
i	long
,	O
flag	pointer
,	O
w	pointer
)	O
;	O
if	O
(	O
error	int
)	O
return	O
error	int
;	O
*	O
istart	pointer
=	O
i	long
-	O
w	pointer
->	O
k	long
+	O
1	int
;	O
*	O
iend	pointer
=	O
i	long
;	O
bspline_pppack_bsplvd	function
(	O
w	pointer
->	O
knots	pointer
,	O
w	pointer
->	O
k	long
,	O
x	double
,	O
*	O
iend	pointer
,	O
w	pointer
->	O
deltal	pointer
,	O
w	pointer
->	O
deltar	pointer
,	O
w	pointer
->	O
A	pointer
,	O
dB	pointer
,	O
nderiv	long
)	O
;	O
min_nderivk	long
=	O
GSL_MIN_INT	function
(	O
nderiv	long
,	O
w	pointer
->	O
k	long
-	O
1	int
)	O
;	O
for	O
(	O
j	long
=	O
min_nderivk	long
+	O
1	int
;	O
j	long
<=	O
nderiv	long
;	O
j	long
++	O
)	O
{	O
for	O
(	O
i	long
=	O
0	int
;	O
i	long
<	O
w	pointer
->	O
k	long
;	O
i	long
++	O
)	O
gsl_matrix_set	function
(	O
dB	pointer
,	O
i	long
,	O
j	long
,	O
0.0	int
)	O
;	O
}	O
return	O
GSL_SUCCESS	int
;	O
}	O
}	O
static	O
inline	O
size_t	long
bspline_find_interval	function
(	O
const	O
double	O
x	double
,	O
int	O
*	O
flag	pointer
,	O
gsl_bspline_workspace	struct
*	O
w	pointer
)	O
{	O
size_t	long
i	long
;	O
if	O
(	O
x	double
<	O
gsl_vector_get	function
(	O
w	pointer
->	O
knots	pointer
,	O
0	int
)	O
)	O
{	O
*	O
flag	pointer
=	O
-	O
1	int
;	O
return	O
0	int
;	O
}	O
for	O
(	O
i	long
=	O
w	pointer
->	O
k	long
-	O
1	int
;	O
i	long
<	O
w	pointer
->	O
k	long
+	O
w	pointer
->	O
l	long
-	O
1	int
;	O
i	long
++	O
)	O
{	O
const	O
double	O
ti	double
=	O
gsl_vector_get	function
(	O
w	pointer
->	O
knots	pointer
,	O
i	long
)	O
;	O
const	O
double	O
tip1	double
=	O
gsl_vector_get	function
(	O
w	pointer
->	O
knots	pointer
,	O
i	long
+	O
1	int
)	O
;	O
if	O
(	O
tip1	double
<	O
ti	double
)	O
{	O
GSL_ERROR	O
(	O
"knots vector is not increasing"	pointer
,	O
GSL_EINVAL	int
)	O
;	O
}	O
if	O
(	O
ti	double
<=	O
x	double
&&	O
x	double
<	O
tip1	double
)	O
break	O
;	O
if	O
(	O
ti	double
<	O
x	double
&&	O
x	double
==	O
tip1	double
&&	O
tip1	double
==	O
gsl_vector_get	function
(	O
w	pointer
->	O
knots	pointer
,	O
w	pointer
->	O
k	long
+	O
w	pointer
->	O
l	long
-	O
1	int
)	O
)	O
break	O
;	O
}	O
if	O
(	O
i	long
==	O
w	pointer
->	O
k	long
+	O
w	pointer
->	O
l	long
-	O
1	int
)	O
*	O
flag	pointer
=	O
1	int
;	O
else	O
*	O
flag	pointer
=	O
0	int
;	O
return	O
i	long
;	O
}	O
static	O
inline	O
int	O
bspline_process_interval_for_eval	function
(	O
const	O
double	O
x	double
,	O
size_t	long
*	O
i	long
,	O
const	O
int	O
flag	pointer
,	O
gsl_bspline_workspace	struct
*	O
w	pointer
)	O
{	O
if	O
(	O
flag	pointer
==	O
-	O
1	int
)	O
{	O
GSL_ERROR	O
(	O
"x outside of knot interval"	pointer
,	O
GSL_EINVAL	int
)	O
;	O
}	O
else	O
if	O
(	O
flag	pointer
==	O
1	int
)	O
{	O
if	O
(	O
x	double
<=	O
gsl_vector_get	function
(	O
w	pointer
->	O
knots	pointer
,	O
*	O
i	long
)	O
+	O
GSL_DBL_EPSILON	int
)	O
{	O
*	O
i	long
-=	O
1	int
;	O
}	O
else	O
{	O
GSL_ERROR	O
(	O
"x outside of knot interval"	pointer
,	O
GSL_EINVAL	int
)	O
;	O
}	O
}	O
if	O
(	O
gsl_vector_get	function
(	O
w	pointer
->	O
knots	pointer
,	O
*	O
i	long
)	O
==	O
gsl_vector_get	function
(	O
w	pointer
->	O
knots	pointer
,	O
*	O
i	long
+	O
1	int
)	O
)	O
{	O
GSL_ERROR	O
(	O
"knot(i) = knot(i+1) will result in division by zero"	pointer
,	O
GSL_EINVAL	int
)	O
;	O
}	O
return	O
GSL_SUCCESS	int
;	O
}	O
static	O
void	O
bspline_pppack_bsplvb	function
(	O
const	O
gsl_vector	struct
*	O
t	pointer
,	O
const	O
size_t	long
jhigh	long
,	O
const	O
size_t	long
index	long
,	O
const	O
double	O
x	double
,	O
const	O
size_t	long
left	long
,	O
size_t	long
*	O
j	long
,	O
gsl_vector	struct
*	O
deltal	pointer
,	O
gsl_vector	struct
*	O
deltar	pointer
,	O
gsl_vector	struct
*	O
biatx	pointer
)	O
{	O
size_t	long
i	long
;	O
double	O
saved	double
;	O
double	O
term	double
;	O
if	O
(	O
index	long
==	O
1	int
)	O
{	O
*	O
j	long
=	O
0	int
;	O
gsl_vector_set	function
(	O
biatx	pointer
,	O
0	int
,	O
1.0	int
)	O
;	O
}	O
for	O
(	O
;	O
*	O
j	long
<	O
jhigh	long
-	O
1	int
;	O
*	O
j	long
+=	O
1	int
)	O
{	O
gsl_vector_set	function
(	O
deltar	pointer
,	O
*	O
j	long
,	O
gsl_vector_get	function
(	O
t	pointer
,	O
left	long
+	O
*	O
j	long
+	O
1	int
)	O
-	O
x	double
)	O
;	O
gsl_vector_set	function
(	O
deltal	pointer
,	O
*	O
j	long
,	O
x	double
-	O
gsl_vector_get	function
(	O
t	pointer
,	O
left	long
-	O
*	O
j	long
)	O
)	O
;	O
saved	double
=	O
0.0	int
;	O
for	O
(	O
i	long
=	O
0	int
;	O
i	long
<=	O
*	O
j	long
;	O
i	long
++	O
)	O
{	O
term	double
=	O
gsl_vector_get	function
(	O
biatx	pointer
,	O
i	long
)	O
/	O
(	O
gsl_vector_get	function
(	O
deltar	pointer
,	O
i	long
)	O
+	O
gsl_vector_get	function
(	O
deltal	pointer
,	O
*	O
j	long
-	O
i	long
)	O
)	O
;	O
gsl_vector_set	function
(	O
biatx	pointer
,	O
i	long
,	O
saved	double
+	O
gsl_vector_get	function
(	O
deltar	pointer
,	O
i	long
)	O
*	O
term	double
)	O
;	O
saved	double
=	O
gsl_vector_get	function
(	O
deltal	pointer
,	O
*	O
j	long
-	O
i	long
)	O
*	O
term	double
;	O
}	O
gsl_vector_set	function
(	O
biatx	pointer
,	O
*	O
j	long
+	O
1	int
,	O
saved	double
)	O
;	O
}	O
return	O
;	O
}	O
static	O
void	O
bspline_pppack_bsplvd	function
(	O
const	O
gsl_vector	struct
*	O
t	pointer
,	O
const	O
size_t	long
k	long
,	O
const	O
double	O
x	double
,	O
const	O
size_t	long
left	long
,	O
gsl_vector	struct
*	O
deltal	pointer
,	O
gsl_vector	struct
*	O
deltar	pointer
,	O
gsl_matrix	struct
*	O
a	double
,	O
gsl_matrix	struct
*	O
dbiatx	pointer
,	O
const	O
size_t	long
nderiv	long
)	O
{	O
int	O
i	long
,	O
ideriv	int
,	O
il	int
,	O
j	long
,	O
jlow	int
,	O
jp1mid	int
,	O
kmm	int
,	O
ldummy	int
,	O
m	pointer
,	O
mhigh	int
;	O
double	O
factor	double
,	O
fkmm	double
,	O
sum	double
;	O
size_t	long
bsplvb_j	long
;	O
gsl_vector_view	struct
dbcol	struct
=	O
gsl_matrix_column	function
(	O
dbiatx	pointer
,	O
0	int
)	O
;	O
mhigh	int
=	O
GSL_MIN_INT	function
(	O
nderiv	long
,	O
k	long
-	O
1	int
)	O
;	O
bspline_pppack_bsplvb	function
(	O
t	pointer
,	O
k	long
-	O
mhigh	int
,	O
1	int
,	O
x	double
,	O
left	long
,	O
&	O
bsplvb_j	long
,	O
deltal	pointer
,	O
deltar	pointer
,	O
&	O
dbcol	struct
.	O
vector	struct
)	O
;	O
if	O
(	O
mhigh	int
>	O
0	int
)	O
{	O
ideriv	int
=	O
mhigh	int
;	O
for	O
(	O
m	pointer
=	O
1	int
;	O
m	pointer
<=	O
mhigh	int
;	O
m	pointer
++	O
)	O
{	O
for	O
(	O
j	long
=	O
ideriv	int
,	O
jp1mid	int
=	O
0	int
;	O
j	long
<	O
(	O
int	O
)	O
k	long
;	O
j	long
++	O
,	O
jp1mid	int
++	O
)	O
{	O
gsl_matrix_set	function
(	O
dbiatx	pointer
,	O
j	long
,	O
ideriv	int
,	O
gsl_matrix_get	function
(	O
dbiatx	pointer
,	O
jp1mid	int
,	O
0	int
)	O
)	O
;	O
}	O
ideriv	int
--	O
;	O
bspline_pppack_bsplvb	function
(	O
t	pointer
,	O
k	long
-	O
ideriv	int
,	O
2	int
,	O
x	double
,	O
left	long
,	O
&	O
bsplvb_j	long
,	O
deltal	pointer
,	O
deltar	pointer
,	O
&	O
dbcol	struct
.	O
vector	struct
)	O
;	O
}	O
jlow	int
=	O
0	int
;	O
for	O
(	O
i	long
=	O
0	int
;	O
i	long
<	O
(	O
int	O
)	O
k	long
;	O
i	long
++	O
)	O
{	O
for	O
(	O
j	long
=	O
jlow	int
;	O
j	long
<	O
(	O
int	O
)	O
k	long
;	O
j	long
++	O
)	O
{	O
gsl_matrix_set	function
(	O
a	double
,	O
j	long
,	O
i	long
,	O
0.0	int
)	O
;	O
}	O
jlow	int
=	O
i	long
;	O
gsl_matrix_set	function
(	O
a	double
,	O
i	long
,	O
i	long
,	O
1.0	int
)	O
;	O
}	O
for	O
(	O
m	pointer
=	O
1	int
;	O
m	pointer
<=	O
mhigh	int
;	O
m	pointer
++	O
)	O
{	O
kmm	int
=	O
k	long
-	O
m	pointer
;	O
fkmm	double
=	O
(	O
float	O
)	O
kmm	int
;	O
il	int
=	O
left	long
;	O
i	long
=	O
k	long
-	O
1	int
;	O
for	O
(	O
ldummy	int
=	O
0	int
;	O
ldummy	int
<	O
kmm	int
;	O
ldummy	int
++	O
)	O
{	O
factor	double
=	O
fkmm	double
/	O
(	O
gsl_vector_get	function
(	O
t	pointer
,	O
il	int
+	O
kmm	int
)	O
-	O
gsl_vector_get	function
(	O
t	pointer
,	O
il	int
)	O
)	O
;	O
for	O
(	O
j	long
=	O
0	int
;	O
j	long
<=	O
i	long
;	O
j	long
++	O
)	O
{	O
gsl_matrix_set	function
(	O
a	double
,	O
i	long
,	O
j	long
,	O
factor	double
*	O
(	O
gsl_matrix_get	function
(	O
a	double
,	O
i	long
,	O
j	long
)	O
-	O
gsl_matrix_get	function
(	O
a	double
,	O
i	long
-	O
1	int
,	O
j	long
)	O
)	O
)	O
;	O
}	O
il	int
--	O
;	O
i	long
--	O
;	O
}	O
for	O
(	O
i	long
=	O
0	int
;	O
i	long
<	O
(	O
int	O
)	O
k	long
;	O
i	long
++	O
)	O
{	O
sum	double
=	O
0	int
;	O
jlow	int
=	O
GSL_MAX_INT	function
(	O
i	long
,	O
m	pointer
)	O
;	O
for	O
(	O
j	long
=	O
jlow	int
;	O
j	long
<	O
(	O
int	O
)	O
k	long
;	O
j	long
++	O
)	O
{	O
sum	double
+=	O
gsl_matrix_get	function
(	O
a	double
,	O
j	long
,	O
i	long
)	O
*	O
gsl_matrix_get	function
(	O
dbiatx	pointer
,	O
j	long
,	O
m	pointer
)	O
;	O
}	O
gsl_matrix_set	function
(	O
dbiatx	pointer
,	O
i	long
,	O
m	pointer
,	O
sum	double
)	O
;	O
}	O
}	O
}	O
return	O
;	O
}	O
