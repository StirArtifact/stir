static	O
_gss_mech_api_desc	struct
_gss_mech_apis	array
[	O
]	O
=	O
{	O
{	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
{	O
NULL	O
,	O
NULL	O
,	O
NULL	O
}	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
}	O
}	O
;	O
_gss_mech_api_t	pointer
_gss_find_mech_no_default	function
(	O
const	O
gss_OID	pointer
oid	pointer
)	O
{	O
size_t	long
i	long
;	O
for	O
(	O
i	long
=	O
0	int
;	O
_gss_mech_apis	array
[	O
i	long
]	O
.	O
mech	pointer
;	O
i	long
++	O
)	O
if	O
(	O
gss_oid_equal	function
(	O
oid	pointer
,	O
_gss_mech_apis	array
[	O
i	long
]	O
.	O
mech	pointer
)	O
)	O
return	O
&	O
_gss_mech_apis	array
[	O
i	long
]	O
;	O
return	O
NULL	O
;	O
}	O
_gss_mech_api_t	pointer
_gss_find_mech	function
(	O
const	O
gss_OID	pointer
oid	pointer
)	O
{	O
_gss_mech_api_t	pointer
p	pointer
=	O
_gss_find_mech_no_default	function
(	O
oid	pointer
)	O
;	O
if	O
(	O
!	O
p	pointer
&&	O
_gss_mech_apis	array
[	O
0	int
]	O
.	O
mech	pointer
)	O
return	O
&	O
_gss_mech_apis	array
[	O
0	int
]	O
;	O
return	O
p	pointer
;	O
}	O
_gss_mech_api_t	pointer
_gss_find_mech_by_saslname	function
(	O
const	O
gss_buffer_t	pointer
sasl_mech_name	pointer
)	O
{	O
size_t	long
i	long
;	O
if	O
(	O
sasl_mech_name	pointer
==	O
NULL	O
||	O
sasl_mech_name	pointer
->	O
value	pointer
==	O
NULL	O
||	O
sasl_mech_name	pointer
->	O
length	int
==	O
0	int
)	O
return	O
NULL	O
;	O
for	O
(	O
i	long
=	O
0	int
;	O
_gss_mech_apis	array
[	O
i	long
]	O
.	O
mech	pointer
;	O
i	long
++	O
)	O
if	O
(	O
strlen	function
(	O
_gss_mech_apis	array
[	O
i	long
]	O
.	O
sasl_name	pointer
)	O
==	O
sasl_mech_name	pointer
->	O
length	int
&&	O
memcmp	function
(	O
_gss_mech_apis	array
[	O
i	long
]	O
.	O
sasl_name	pointer
,	O
sasl_mech_name	pointer
->	O
value	pointer
,	O
sasl_mech_name	pointer
->	O
length	int
)	O
==	O
0	int
)	O
return	O
&	O
_gss_mech_apis	array
[	O
i	long
]	O
;	O
return	O
NULL	O
;	O
}	O
OM_uint32	int
_gss_indicate_mechs1	function
(	O
OM_uint32	int
*	O
minor_status	pointer
,	O
gss_OID_set	pointer
*	O
mech_set	pointer
)	O
{	O
OM_uint32	int
maj_stat	int
;	O
int	O
i	long
;	O
for	O
(	O
i	long
=	O
0	int
;	O
_gss_mech_apis	array
[	O
i	long
]	O
.	O
mech	pointer
;	O
i	long
++	O
)	O
{	O
maj_stat	int
=	O
gss_add_oid_set_member	function
(	O
minor_status	pointer
,	O
_gss_mech_apis	array
[	O
i	long
]	O
.	O
mech	pointer
,	O
mech_set	pointer
)	O
;	O
if	O
(	O
GSS_ERROR	O
(	O
maj_stat	int
)	O
)	O
return	O
maj_stat	int
;	O
}	O
if	O
(	O
minor_status	pointer
)	O
*	O
minor_status	pointer
=	O
0	int
;	O
return	O
GSS_S_COMPLETE	int
;	O
}	O
