static	O
void	O
memory_out	function
(	O
)	O
{	O
write	function
(	O
2	int
,	O
"virtual memory exhausted\n"	pointer
,	O
25	int
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
static	O
char	O
*	O
xmalloc	function
(	O
size	int
)	O
unsigned	O
size	int
;	O
{	O
register	O
char	O
*	O
tem	pointer
=	O
malloc	function
(	O
size	int
)	O
;	O
if	O
(	O
!	O
tem	pointer
)	O
memory_out	function
(	O
)	O
;	O
return	O
tem	pointer
;	O
}	O
static	O
char	O
*	O
xrealloc	function
(	O
ptr	pointer
,	O
size	int
)	O
char	O
*	O
ptr	pointer
;	O
unsigned	O
size	int
;	O
{	O
register	O
char	O
*	O
tem	pointer
=	O
realloc	function
(	O
ptr	pointer
,	O
size	int
)	O
;	O
if	O
(	O
!	O
tem	pointer
)	O
memory_out	function
(	O
)	O
;	O
return	O
tem	pointer
;	O
}	O
static	O
char	O
*	O
tparam1	function
(	O
)	O
;	O
char	O
*	O
tparam	function
(	O
string	pointer
,	O
outstring	pointer
,	O
len	int
,	O
arg0	int
,	O
arg1	int
,	O
arg2	int
,	O
arg3	int
)	O
char	O
*	O
string	pointer
;	O
char	O
*	O
outstring	pointer
;	O
int	O
len	int
;	O
int	O
arg0	int
,	O
arg1	int
,	O
arg2	int
,	O
arg3	int
;	O
{	O
int	O
arg	array
[	O
4	int
]	O
;	O
arg	array
[	O
0	int
]	O
=	O
arg0	int
;	O
arg	array
[	O
1	int
]	O
=	O
arg1	int
;	O
arg	array
[	O
2	int
]	O
=	O
arg2	int
;	O
arg	array
[	O
3	int
]	O
=	O
arg3	int
;	O
return	O
tparam1	function
(	O
string	pointer
,	O
outstring	pointer
,	O
len	int
,	O
NULL	O
,	O
NULL	O
,	O
arg	array
)	O
;	O
}	O
char	O
*	O
BC	pointer
;	O
char	O
*	O
UP	pointer
;	O
static	O
char	O
tgoto_buf	array
[	O
50	int
]	O
;	O
char	O
*	O
tgoto	function
(	O
cm	pointer
,	O
hpos	int
,	O
vpos	int
)	O
char	O
*	O
cm	pointer
;	O
int	O
hpos	int
,	O
vpos	int
;	O
{	O
int	O
args	array
[	O
2	int
]	O
;	O
if	O
(	O
!	O
cm	pointer
)	O
return	O
NULL	O
;	O
args	array
[	O
0	int
]	O
=	O
vpos	int
;	O
args	array
[	O
1	int
]	O
=	O
hpos	int
;	O
return	O
tparam1	function
(	O
cm	pointer
,	O
tgoto_buf	array
,	O
50	int
,	O
UP	pointer
,	O
BC	pointer
,	O
args	array
)	O
;	O
}	O
static	O
char	O
*	O
tparam1	function
(	O
string	pointer
,	O
outstring	pointer
,	O
len	int
,	O
up	pointer
,	O
left	pointer
,	O
argp	pointer
)	O
char	O
*	O
string	pointer
;	O
char	O
*	O
outstring	pointer
;	O
int	O
len	int
;	O
char	O
*	O
up	pointer
,	O
*	O
left	pointer
;	O
register	O
int	O
*	O
argp	pointer
;	O
{	O
register	O
int	O
c	int
;	O
register	O
char	O
*	O
p	pointer
=	O
string	pointer
;	O
register	O
char	O
*	O
op	pointer
=	O
outstring	pointer
;	O
char	O
*	O
outend	pointer
;	O
int	O
outlen	int
=	O
0	int
;	O
register	O
int	O
tem	pointer
;	O
int	O
*	O
old_argp	pointer
=	O
argp	pointer
;	O
int	O
doleft	int
=	O
0	int
;	O
int	O
doup	int
=	O
0	int
;	O
outend	pointer
=	O
outstring	pointer
+	O
len	int
;	O
while	O
(	O
1	int
)	O
{	O
if	O
(	O
op	pointer
+	O
5	int
>=	O
outend	pointer
)	O
{	O
register	O
char	O
*	O
new	pointer
;	O
if	O
(	O
outlen	int
==	O
0	int
)	O
{	O
outlen	int
=	O
len	int
+	O
40	int
;	O
new	pointer
=	O
(	O
char	O
*	O
)	O
xmalloc	function
(	O
outlen	int
)	O
;	O
outend	pointer
+=	O
40	int
;	O
bcopy	O
(	O
outstring	pointer
,	O
new	pointer
,	O
op	pointer
-	O
outstring	pointer
)	O
;	O
}	O
else	O
{	O
outend	pointer
+=	O
outlen	int
;	O
outlen	int
*=	O
2	int
;	O
new	pointer
=	O
(	O
char	O
*	O
)	O
xrealloc	function
(	O
outstring	pointer
,	O
outlen	int
)	O
;	O
}	O
op	pointer
+=	O
new	pointer
-	O
outstring	pointer
;	O
outend	pointer
+=	O
new	pointer
-	O
outstring	pointer
;	O
outstring	pointer
=	O
new	pointer
;	O
}	O
c	int
=	O
*	O
p	pointer
++	O
;	O
if	O
(	O
!	O
c	int
)	O
break	O
;	O
if	O
(	O
c	int
==	O
'%'	O
)	O
{	O
c	int
=	O
*	O
p	pointer
++	O
;	O
tem	pointer
=	O
*	O
argp	pointer
;	O
switch	O
(	O
c	int
)	O
{	O
case	O
'd'	O
:	O
if	O
(	O
tem	pointer
<	O
10	int
)	O
goto	O
onedigit	O
;	O
if	O
(	O
tem	pointer
<	O
100	int
)	O
goto	O
twodigit	O
;	O
case	O
'3'	O
:	O
if	O
(	O
tem	pointer
>	O
999	int
)	O
{	O
*	O
op	pointer
++	O
=	O
tem	pointer
/	O
1000	int
+	O
'0'	O
;	O
tem	pointer
%=	O
1000	int
;	O
}	O
*	O
op	pointer
++	O
=	O
tem	pointer
/	O
100	int
+	O
'0'	O
;	O
case	O
'2'	O
:	O
twodigit	O
:	O
tem	pointer
%=	O
100	int
;	O
*	O
op	pointer
++	O
=	O
tem	pointer
/	O
10	int
+	O
'0'	O
;	O
onedigit	O
:	O
*	O
op	pointer
++	O
=	O
tem	pointer
%	O
10	int
+	O
'0'	O
;	O
argp	pointer
++	O
;	O
break	O
;	O
case	O
'C'	O
:	O
if	O
(	O
tem	pointer
>=	O
96	int
)	O
{	O
*	O
op	pointer
++	O
=	O
tem	pointer
/	O
96	int
;	O
tem	pointer
%=	O
96	int
;	O
}	O
case	O
'+'	O
:	O
tem	pointer
+=	O
*	O
p	pointer
++	O
;	O
case	O
'.'	O
:	O
if	O
(	O
left	pointer
)	O
{	O
while	O
(	O
tem	pointer
==	O
0	int
||	O
tem	pointer
==	O
'\n'	O
||	O
tem	pointer
==	O
'\t'	O
)	O
{	O
tem	pointer
++	O
;	O
if	O
(	O
argp	pointer
==	O
old_argp	pointer
)	O
doup	int
++	O
,	O
outend	pointer
-=	O
strlen	function
(	O
up	pointer
)	O
;	O
else	O
doleft	int
++	O
,	O
outend	pointer
-=	O
strlen	function
(	O
left	pointer
)	O
;	O
}	O
}	O
*	O
op	pointer
++	O
=	O
tem	pointer
?	O
tem	pointer
:	O
0200	int
;	O
case	O
'f'	O
:	O
argp	pointer
++	O
;	O
break	O
;	O
case	O
'b'	O
:	O
argp	pointer
--	O
;	O
break	O
;	O
case	O
'r'	O
:	O
argp	pointer
[	O
0	int
]	O
=	O
argp	pointer
[	O
1	int
]	O
;	O
argp	pointer
[	O
1	int
]	O
=	O
tem	pointer
;	O
old_argp	pointer
++	O
;	O
break	O
;	O
case	O
'>'	O
:	O
if	O
(	O
argp	pointer
[	O
0	int
]	O
>	O
*	O
p	pointer
++	O
)	O
argp	pointer
[	O
0	int
]	O
+=	O
*	O
p	pointer
;	O
p	pointer
++	O
;	O
break	O
;	O
case	O
'a'	O
:	O
tem	pointer
=	O
p	pointer
[	O
2	int
]	O
&	O
0177	int
;	O
if	O
(	O
p	pointer
[	O
1	int
]	O
==	O
'p'	O
)	O
tem	pointer
=	O
argp	pointer
[	O
tem	pointer
-	O
0100	int
]	O
;	O
if	O
(	O
p	pointer
[	O
0	int
]	O
==	O
'-'	O
)	O
argp	pointer
[	O
0	int
]	O
-=	O
tem	pointer
;	O
else	O
if	O
(	O
p	pointer
[	O
0	int
]	O
==	O
'+'	O
)	O
argp	pointer
[	O
0	int
]	O
+=	O
tem	pointer
;	O
else	O
if	O
(	O
p	pointer
[	O
0	int
]	O
==	O
'*'	O
)	O
argp	pointer
[	O
0	int
]	O
*=	O
tem	pointer
;	O
else	O
if	O
(	O
p	pointer
[	O
0	int
]	O
==	O
'/'	O
)	O
argp	pointer
[	O
0	int
]	O
/=	O
tem	pointer
;	O
else	O
argp	pointer
[	O
0	int
]	O
=	O
tem	pointer
;	O
p	pointer
+=	O
3	int
;	O
break	O
;	O
case	O
'i'	O
:	O
argp	pointer
[	O
0	int
]	O
++	O
;	O
argp	pointer
[	O
1	int
]	O
++	O
;	O
break	O
;	O
case	O
'%'	O
:	O
goto	O
ordinary	O
;	O
case	O
'n'	O
:	O
argp	pointer
[	O
0	int
]	O
^=	O
0140	int
;	O
argp	pointer
[	O
1	int
]	O
^=	O
0140	int
;	O
break	O
;	O
case	O
'm'	O
:	O
argp	pointer
[	O
0	int
]	O
^=	O
0177	int
;	O
argp	pointer
[	O
1	int
]	O
^=	O
0177	int
;	O
break	O
;	O
case	O
'B'	O
:	O
argp	pointer
[	O
0	int
]	O
+=	O
6	int
*	O
(	O
tem	pointer
/	O
10	int
)	O
;	O
break	O
;	O
case	O
'D'	O
:	O
argp	pointer
[	O
0	int
]	O
-=	O
2	int
*	O
(	O
tem	pointer
%	O
16	int
)	O
;	O
break	O
;	O
}	O
}	O
else	O
ordinary	O
:	O
*	O
op	pointer
++	O
=	O
c	int
;	O
}	O
*	O
op	pointer
=	O
0	int
;	O
while	O
(	O
doup	int
--	O
>	O
0	int
)	O
strcat	function
(	O
op	pointer
,	O
up	pointer
)	O
;	O
while	O
(	O
doleft	int
--	O
>	O
0	int
)	O
strcat	function
(	O
op	pointer
,	O
left	pointer
)	O
;	O
return	O
outstring	pointer
;	O
}	O
