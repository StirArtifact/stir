static	O
int	O
extract_label_info	function
(	O
ctf_file_t	struct
*	O
fp	pointer
,	O
const	O
ctf_lblent_t	struct
*	O
*	O
ctl	pointer
,	O
uint32_t	int
*	O
num_labels	pointer
)	O
{	O
const	O
ctf_header_t	struct
*	O
h	pointer
;	O
h	pointer
=	O
(	O
const	O
ctf_header_t	struct
*	O
)	O
fp	pointer
->	O
ctf_data	struct
.	O
cts_data	pointer
;	O
*	O
ctl	pointer
=	O
(	O
const	O
ctf_lblent_t	struct
*	O
)	O
(	O
fp	pointer
->	O
ctf_buf	pointer
+	O
h	pointer
->	O
cth_lbloff	int
)	O
;	O
*	O
num_labels	pointer
=	O
(	O
h	pointer
->	O
cth_objtoff	int
-	O
h	pointer
->	O
cth_lbloff	int
)	O
/	O
sizeof	O
(	O
ctf_lblent_t	struct
)	O
;	O
return	O
0	int
;	O
}	O
const	O
char	O
*	O
ctf_label_topmost	function
(	O
ctf_file_t	struct
*	O
fp	pointer
)	O
{	O
const	O
ctf_lblent_t	struct
*	O
ctlp	pointer
=	O
NULL	O
;	O
const	O
char	O
*	O
s	pointer
;	O
uint32_t	int
num_labels	pointer
=	O
0	int
;	O
if	O
(	O
extract_label_info	function
(	O
fp	pointer
,	O
&	O
ctlp	pointer
,	O
&	O
num_labels	pointer
)	O
<	O
0	int
)	O
return	O
NULL	O
;	O
if	O
(	O
num_labels	pointer
==	O
0	int
)	O
{	O
(	O
void	O
)	O
ctf_set_errno	function
(	O
fp	pointer
,	O
ECTF_NOLABELDATA	int
)	O
;	O
return	O
NULL	O
;	O
}	O
if	O
(	O
(	O
s	pointer
=	O
ctf_strraw	function
(	O
fp	pointer
,	O
(	O
ctlp	pointer
+	O
num_labels	pointer
-	O
1	int
)	O
->	O
ctl_label	int
)	O
)	O
==	O
NULL	O
)	O
(	O
void	O
)	O
ctf_set_errno	function
(	O
fp	pointer
,	O
ECTF_CORRUPT	int
)	O
;	O
return	O
s	pointer
;	O
}	O
int	O
ctf_label_iter	function
(	O
ctf_file_t	struct
*	O
fp	pointer
,	O
ctf_label_f	function
*	O
func	pointer
,	O
void	O
*	O
arg	pointer
)	O
{	O
const	O
ctf_lblent_t	struct
*	O
ctlp	pointer
=	O
NULL	O
;	O
uint32_t	int
i	pointer
;	O
uint32_t	int
num_labels	pointer
=	O
0	int
;	O
ctf_lblinfo_t	struct
linfo	struct
;	O
const	O
char	O
*	O
lname	pointer
;	O
int	O
rc	int
;	O
if	O
(	O
extract_label_info	function
(	O
fp	pointer
,	O
&	O
ctlp	pointer
,	O
&	O
num_labels	pointer
)	O
<	O
0	int
)	O
return	O
-	O
1	int
;	O
if	O
(	O
num_labels	pointer
==	O
0	int
)	O
return	O
(	O
ctf_set_errno	function
(	O
fp	pointer
,	O
ECTF_NOLABELDATA	int
)	O
)	O
;	O
for	O
(	O
i	pointer
=	O
0	int
;	O
i	pointer
<	O
num_labels	pointer
;	O
i	pointer
++	O
,	O
ctlp	pointer
++	O
)	O
{	O
if	O
(	O
(	O
lname	pointer
=	O
ctf_strraw	function
(	O
fp	pointer
,	O
ctlp	pointer
->	O
ctl_label	int
)	O
)	O
==	O
NULL	O
)	O
{	O
ctf_dprintf	function
(	O
"failed to decode label %u with "	pointer
"type %u\n"	pointer
,	O
ctlp	pointer
->	O
ctl_label	int
,	O
ctlp	pointer
->	O
ctl_type	int
)	O
;	O
return	O
(	O
ctf_set_errno	function
(	O
fp	pointer
,	O
ECTF_CORRUPT	int
)	O
)	O
;	O
}	O
linfo	struct
.	O
ctb_type	long
=	O
ctlp	pointer
->	O
ctl_type	int
;	O
if	O
(	O
(	O
rc	int
=	O
func	pointer
(	O
lname	pointer
,	O
&	O
linfo	struct
,	O
arg	pointer
)	O
)	O
!=	O
0	int
)	O
return	O
rc	int
;	O
}	O
return	O
0	int
;	O
}	O
typedef	O
struct	O
linfo_cb_arg	struct
{	O
const	O
char	O
*	O
lca_name	pointer
;	O
ctf_lblinfo_t	struct
*	O
lca_info	pointer
;	O
}	O
linfo_cb_arg_t	struct
;	O
static	O
int	O
label_info_cb	function
(	O
const	O
char	O
*	O
lname	pointer
,	O
const	O
ctf_lblinfo_t	struct
*	O
linfo	struct
,	O
void	O
*	O
arg	pointer
)	O
{	O
if	O
(	O
strcmp	function
(	O
lname	pointer
,	O
(	O
(	O
linfo_cb_arg_t	struct
*	O
)	O
arg	pointer
)	O
->	O
lca_name	pointer
)	O
==	O
0	int
)	O
{	O
if	O
(	O
(	O
(	O
linfo_cb_arg_t	struct
*	O
)	O
arg	pointer
)	O
->	O
lca_info	pointer
!=	O
NULL	O
)	O
memcpy	function
(	O
(	O
(	O
linfo_cb_arg_t	struct
*	O
)	O
arg	pointer
)	O
->	O
lca_info	pointer
,	O
linfo	struct
,	O
sizeof	O
(	O
ctf_lblinfo_t	struct
)	O
)	O
;	O
return	O
1	int
;	O
}	O
return	O
0	int
;	O
}	O
int	O
ctf_label_info	function
(	O
ctf_file_t	struct
*	O
fp	pointer
,	O
const	O
char	O
*	O
lname	pointer
,	O
ctf_lblinfo_t	struct
*	O
linfo	struct
)	O
{	O
linfo_cb_arg_t	struct
cb_arg	struct
;	O
int	O
rc	int
;	O
cb_arg	struct
.	O
lca_name	pointer
=	O
lname	pointer
;	O
cb_arg	struct
.	O
lca_info	pointer
=	O
linfo	struct
;	O
if	O
(	O
(	O
rc	int
=	O
ctf_label_iter	function
(	O
fp	pointer
,	O
label_info_cb	function
,	O
&	O
cb_arg	struct
)	O
)	O
<	O
0	int
)	O
return	O
rc	int
;	O
if	O
(	O
rc	int
!=	O
1	int
)	O
return	O
(	O
ctf_set_errno	function
(	O
fp	pointer
,	O
ECTF_NOLABEL	int
)	O
)	O
;	O
return	O
0	int
;	O
}	O
