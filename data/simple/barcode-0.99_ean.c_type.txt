static	O
char	O
*	O
digits	array
[	O
]	O
=	O
{	O
"3211"	pointer
,	O
"2221"	pointer
,	O
"2122"	pointer
,	O
"1411"	pointer
,	O
"1132"	pointer
,	O
"1231"	pointer
,	O
"1114"	pointer
,	O
"1312"	pointer
,	O
"1213"	pointer
,	O
"3112"	pointer
}	O
;	O
static	O
char	O
*	O
ean_mirrortab	array
[	O
]	O
=	O
{	O
"------"	pointer
,	O
"--1-11"	pointer
,	O
"--11-1"	pointer
,	O
"--111-"	pointer
,	O
"-1--11"	pointer
,	O
"-11--1"	pointer
,	O
"-111--"	pointer
,	O
"-1-1-1"	pointer
,	O
"-1-11-"	pointer
,	O
"-11-1-"	pointer
}	O
;	O
static	O
char	O
*	O
upc_mirrortab	array
[	O
]	O
=	O
{	O
"---111"	pointer
,	O
"--1-11"	pointer
,	O
"--11-1"	pointer
,	O
"--111-"	pointer
,	O
"-1--11"	pointer
,	O
"-11--1"	pointer
,	O
"-111--"	pointer
,	O
"-1-1-1"	pointer
,	O
"-1-11-"	pointer
,	O
"-11-1-"	pointer
}	O
;	O
static	O
char	O
*	O
upc_mirrortab1	array
[	O
]	O
=	O
{	O
"111---"	pointer
,	O
"11-1--"	pointer
,	O
"11--1-"	pointer
,	O
"11---1"	pointer
,	O
"1-11--"	pointer
,	O
"1--11-"	pointer
,	O
"1---11"	pointer
,	O
"1-1-1-"	pointer
,	O
"1-1--1"	pointer
,	O
"1--1-1"	pointer
}	O
;	O
static	O
char	O
*	O
upc_mirrortab2	array
[	O
]	O
=	O
{	O
"11"	pointer
,	O
"1-"	pointer
,	O
"-1"	pointer
,	O
"--"	pointer
}	O
;	O
static	O
char	O
*	O
guard	array
[	O
]	O
=	O
{	O
"0a1a"	pointer
,	O
"1a1a1"	pointer
,	O
"a1a"	pointer
}	O
;	O
static	O
char	O
*	O
guardE	array
[	O
]	O
=	O
{	O
"0a1a"	pointer
,	O
"1a1a1a"	pointer
}	O
;	O
static	O
char	O
*	O
guardS	array
[	O
]	O
=	O
{	O
"9112"	pointer
,	O
"11"	pointer
}	O
;	O
static	O
int	O
ean_make_checksum	function
(	O
char	O
*	O
text	pointer
,	O
int	O
mode	int
)	O
{	O
int	O
esum	int
=	O
0	int
,	O
osum	int
=	O
0	int
,	O
i	int
;	O
int	O
even	int
=	O
1	int
;	O
if	O
(	O
strchr	function
(	O
text	pointer
,	O
' '	O
)	O
)	O
i	int
=	O
strchr	function
(	O
text	pointer
,	O
' '	O
)	O
-	O
text	pointer
;	O
else	O
i	int
=	O
strlen	function
(	O
text	pointer
)	O
;	O
while	O
(	O
i	int
--	O
>	O
0	int
)	O
{	O
if	O
(	O
even	int
)	O
esum	int
+=	O
text	pointer
[	O
i	int
]	O
-	O
'0'	O
;	O
else	O
osum	int
+=	O
text	pointer
[	O
i	int
]	O
-	O
'0'	O
;	O
even	int
=	O
!	O
even	int
;	O
}	O
if	O
(	O
!	O
mode	int
)	O
{	O
i	int
=	O
(	O
3	int
*	O
esum	int
+	O
osum	int
)	O
%	O
10	int
;	O
return	O
(	O
10	int
-	O
i	int
)	O
%	O
10	int
;	O
}	O
else	O
{	O
i	int
=	O
(	O
3	int
*	O
esum	int
+	O
9	int
*	O
osum	int
)	O
;	O
return	O
i	int
%	O
10	int
;	O
}	O
}	O
int	O
Barcode_ean_verify	function
(	O
char	O
*	O
text	pointer
)	O
{	O
int	O
i	int
,	O
len0	int
,	O
len	int
,	O
addon	int
;	O
char	O
tmp	array
[	O
24	int
]	O
,	O
*	O
spc	pointer
;	O
len	int
=	O
strlen	function
(	O
text	pointer
)	O
;	O
spc	pointer
=	O
strchr	function
(	O
text	pointer
,	O
' '	O
)	O
;	O
if	O
(	O
spc	pointer
)	O
{	O
len0	int
=	O
spc	pointer
-	O
text	pointer
;	O
addon	int
=	O
len	int
-	O
len0	int
-	O
1	int
;	O
if	O
(	O
addon	int
!=	O
2	int
&&	O
addon	int
!=	O
5	int
)	O
return	O
-	O
1	int
;	O
for	O
(	O
i	int
=	O
len0	int
+	O
1	int
;	O
i	int
<	O
len	int
;	O
i	int
++	O
)	O
if	O
(	O
!	O
isdigit	function
(	O
text	pointer
[	O
i	int
]	O
)	O
)	O
return	O
-	O
1	int
;	O
}	O
else	O
len0	int
=	O
len	int
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
len0	int
;	O
i	int
++	O
)	O
if	O
(	O
!	O
isdigit	function
(	O
text	pointer
[	O
i	int
]	O
)	O
)	O
return	O
-	O
1	int
;	O
switch	O
(	O
len0	int
)	O
{	O
case	O
8	int
:	O
strncpy	function
(	O
tmp	array
,	O
text	pointer
,	O
7	int
)	O
;	O
tmp	array
[	O
7	int
]	O
=	O
'\0'	O
;	O
if	O
(	O
text	pointer
[	O
7	int
]	O
!=	O
(	O
ean_make_checksum	function
(	O
tmp	array
,	O
0	int
)	O
+	O
'0'	O
)	O
)	O
return	O
-	O
1	int
;	O
case	O
7	int
:	O
break	O
;	O
case	O
13	int
:	O
strncpy	function
(	O
tmp	array
,	O
text	pointer
,	O
12	int
)	O
;	O
tmp	array
[	O
12	int
]	O
=	O
'\0'	O
;	O
if	O
(	O
text	pointer
[	O
12	int
]	O
!=	O
(	O
ean_make_checksum	function
(	O
tmp	array
,	O
0	int
)	O
+	O
'0'	O
)	O
)	O
return	O
-	O
1	int
;	O
case	O
12	int
:	O
break	O
;	O
default	O
:	O
return	O
-	O
1	int
;	O
}	O
return	O
0	int
;	O
}	O
static	O
char	O
*	O
upc_e_to_a0	function
(	O
char	O
*	O
text	pointer
)	O
{	O
static	O
char	O
result	array
[	O
16	int
]	O
;	O
strcpy	function
(	O
result	array
,	O
"00000000000"	pointer
)	O
;	O
switch	O
(	O
text	pointer
[	O
5	int
]	O
)	O
{	O
case	O
'0'	O
:	O
case	O
'1'	O
:	O
case	O
'2'	O
:	O
strncpy	function
(	O
result	array
+	O
1	int
,	O
text	pointer
,	O
2	int
)	O
;	O
result	array
[	O
3	int
]	O
=	O
text	pointer
[	O
5	int
]	O
;	O
memcpy	function
(	O
result	array
+	O
8	int
,	O
text	pointer
+	O
2	int
,	O
3	int
)	O
;	O
break	O
;	O
case	O
'3'	O
:	O
memcpy	function
(	O
result	array
+	O
1	int
,	O
text	pointer
,	O
3	int
)	O
;	O
memcpy	function
(	O
result	array
+	O
9	int
,	O
text	pointer
+	O
3	int
,	O
2	int
)	O
;	O
break	O
;	O
case	O
'4'	O
:	O
memcpy	function
(	O
result	array
+	O
1	int
,	O
text	pointer
,	O
4	int
)	O
;	O
memcpy	function
(	O
result	array
+	O
10	int
,	O
text	pointer
+	O
4	int
,	O
1	int
)	O
;	O
break	O
;	O
default	O
:	O
memcpy	function
(	O
result	array
+	O
1	int
,	O
text	pointer
,	O
5	int
)	O
;	O
memcpy	function
(	O
result	array
+	O
10	int
,	O
text	pointer
+	O
5	int
,	O
1	int
)	O
;	O
break	O
;	O
}	O
return	O
result	array
;	O
}	O
static	O
char	O
*	O
upc_e_to_a	function
(	O
char	O
*	O
text	pointer
)	O
{	O
static	O
char	O
result	array
[	O
16	int
]	O
,	O
*	O
spc	pointer
;	O
int	O
len	int
,	O
chk	int
;	O
spc	pointer
=	O
strchr	function
(	O
text	pointer
,	O
' '	O
)	O
;	O
if	O
(	O
spc	pointer
)	O
len	int
=	O
spc	pointer
-	O
text	pointer
;	O
else	O
len	int
=	O
strlen	function
(	O
text	pointer
)	O
;	O
switch	O
(	O
len	int
)	O
{	O
case	O
6	int
:	O
strcpy	function
(	O
result	array
,	O
upc_e_to_a0	function
(	O
text	pointer
)	O
)	O
;	O
return	O
result	array
;	O
case	O
7	int
:	O
if	O
(	O
text	pointer
[	O
0	int
]	O
==	O
'0'	O
||	O
text	pointer
[	O
0	int
]	O
==	O
'1'	O
)	O
{	O
strcpy	function
(	O
result	array
,	O
upc_e_to_a0	function
(	O
text	pointer
+	O
1	int
)	O
)	O
;	O
result	array
[	O
0	int
]	O
=	O
text	pointer
[	O
0	int
]	O
;	O
return	O
result	array
;	O
}	O
strcpy	function
(	O
result	array
,	O
upc_e_to_a0	function
(	O
text	pointer
)	O
)	O
;	O
chk	int
=	O
ean_make_checksum	function
(	O
result	array
,	O
0	int
)	O
;	O
if	O
(	O
chk	int
==	O
(	O
text	pointer
[	O
len	int
-	O
1	int
]	O
-	O
'0'	O
)	O
)	O
return	O
result	array
;	O
return	O
NULL	O
;	O
case	O
8	int
:	O
if	O
(	O
text	pointer
[	O
0	int
]	O
==	O
'0'	O
||	O
text	pointer
[	O
0	int
]	O
==	O
'1'	O
)	O
{	O
strcpy	function
(	O
result	array
,	O
upc_e_to_a0	function
(	O
text	pointer
+	O
1	int
)	O
)	O
;	O
result	array
[	O
0	int
]	O
=	O
text	pointer
[	O
0	int
]	O
;	O
chk	int
=	O
ean_make_checksum	function
(	O
result	array
,	O
0	int
)	O
;	O
if	O
(	O
chk	int
==	O
(	O
text	pointer
[	O
len	int
-	O
1	int
]	O
-	O
'0'	O
)	O
)	O
return	O
result	array
;	O
}	O
default	O
:	O
return	O
NULL	O
;	O
}	O
}	O
static	O
char	O
*	O
upc_a_to_e	function
(	O
char	O
*	O
text	pointer
)	O
{	O
static	O
char	O
result	array
[	O
16	int
]	O
;	O
int	O
len	int
,	O
chksum	int
;	O
len	int
=	O
strlen	function
(	O
text	pointer
)	O
;	O
switch	O
(	O
len	int
)	O
{	O
case	O
12	int
:	O
strcpy	function
(	O
result	array
,	O
text	pointer
)	O
;	O
result	array
[	O
11	int
]	O
=	O
'\0'	O
;	O
chksum	int
=	O
ean_make_checksum	function
(	O
result	array
,	O
0	int
)	O
;	O
if	O
(	O
text	pointer
[	O
11	int
]	O
!=	O
(	O
chksum	int
-	O
'0'	O
)	O
)	O
return	O
NULL	O
;	O
break	O
;	O
case	O
11	int
:	O
chksum	int
=	O
ean_make_checksum	function
(	O
text	pointer
,	O
0	int
)	O
;	O
break	O
;	O
default	O
:	O
return	O
NULL	O
;	O
}	O
strcpy	function
(	O
result	array
,	O
"00000000"	pointer
)	O
;	O
if	O
(	O
text	pointer
[	O
0	int
]	O
!=	O
'0'	O
&&	O
text	pointer
[	O
0	int
]	O
!=	O
'1'	O
)	O
return	O
NULL	O
;	O
result	array
[	O
0	int
]	O
=	O
text	pointer
[	O
0	int
]	O
;	O
if	O
(	O
(	O
text	pointer
[	O
3	int
]	O
==	O
'0'	O
||	O
text	pointer
[	O
3	int
]	O
==	O
'1'	O
||	O
text	pointer
[	O
3	int
]	O
==	O
'2'	O
)	O
&&	O
!	O
strncmp	function
(	O
text	pointer
+	O
4	int
,	O
"0000"	pointer
,	O
4	int
)	O
)	O
{	O
memcpy	function
(	O
&	O
result	array
[	O
1	int
]	O
,	O
text	pointer
+	O
1	int
,	O
2	int
)	O
;	O
memcpy	function
(	O
&	O
result	array
[	O
3	int
]	O
,	O
text	pointer
+	O
8	int
,	O
3	int
)	O
;	O
result	array
[	O
6	int
]	O
=	O
text	pointer
[	O
3	int
]	O
;	O
}	O
else	O
if	O
(	O
!	O
strncmp	function
(	O
text	pointer
+	O
4	int
,	O
"00000"	pointer
,	O
5	int
)	O
)	O
{	O
memcpy	function
(	O
&	O
result	array
[	O
1	int
]	O
,	O
text	pointer
+	O
1	int
,	O
3	int
)	O
;	O
memcpy	function
(	O
&	O
result	array
[	O
4	int
]	O
,	O
text	pointer
+	O
9	int
,	O
2	int
)	O
;	O
result	array
[	O
6	int
]	O
=	O
'3'	O
;	O
}	O
else	O
if	O
(	O
!	O
strncmp	function
(	O
text	pointer
+	O
5	int
,	O
"00000"	pointer
,	O
5	int
)	O
)	O
{	O
memcpy	function
(	O
&	O
result	array
[	O
1	int
]	O
,	O
text	pointer
+	O
1	int
,	O
4	int
)	O
;	O
result	array
[	O
5	int
]	O
=	O
text	pointer
[	O
10	int
]	O
;	O
result	array
[	O
6	int
]	O
=	O
'4'	O
;	O
}	O
else	O
if	O
(	O
(	O
text	pointer
[	O
5	int
]	O
!=	O
'0'	O
)	O
&&	O
!	O
strncmp	function
(	O
text	pointer
+	O
6	int
,	O
"0000"	pointer
,	O
4	int
)	O
&&	O
text	pointer
[	O
10	int
]	O
>=	O
'5'	O
&&	O
text	pointer
[	O
10	int
]	O
<=	O
'9'	O
)	O
{	O
memcpy	function
(	O
&	O
result	array
[	O
1	int
]	O
,	O
text	pointer
+	O
1	int
,	O
5	int
)	O
;	O
result	array
[	O
6	int
]	O
=	O
text	pointer
[	O
10	int
]	O
;	O
}	O
else	O
{	O
return	O
NULL	O
;	O
}	O
result	array
[	O
7	int
]	O
=	O
chksum	int
+	O
'0'	O
;	O
return	O
result	array
;	O
}	O
int	O
Barcode_upc_verify	function
(	O
char	O
*	O
text	pointer
)	O
{	O
int	O
i	int
,	O
len0	int
,	O
len	int
,	O
addon	int
;	O
char	O
tmp	array
[	O
24	int
]	O
,	O
*	O
spc	pointer
;	O
len	int
=	O
strlen	function
(	O
text	pointer
)	O
;	O
spc	pointer
=	O
strchr	function
(	O
text	pointer
,	O
' '	O
)	O
;	O
if	O
(	O
spc	pointer
)	O
{	O
len0	int
=	O
spc	pointer
-	O
text	pointer
;	O
addon	int
=	O
len	int
-	O
len0	int
-	O
1	int
;	O
if	O
(	O
addon	int
!=	O
2	int
&&	O
addon	int
!=	O
5	int
)	O
return	O
-	O
1	int
;	O
for	O
(	O
i	int
=	O
len0	int
+	O
1	int
;	O
i	int
<	O
len	int
;	O
i	int
++	O
)	O
if	O
(	O
!	O
isdigit	function
(	O
text	pointer
[	O
i	int
]	O
)	O
)	O
return	O
-	O
1	int
;	O
}	O
else	O
len0	int
=	O
len	int
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
len0	int
;	O
i	int
++	O
)	O
if	O
(	O
!	O
isdigit	function
(	O
text	pointer
[	O
i	int
]	O
)	O
)	O
return	O
-	O
1	int
;	O
switch	O
(	O
len0	int
)	O
{	O
case	O
6	int
:	O
case	O
7	int
:	O
case	O
8	int
:	O
strncpy	function
(	O
tmp	array
,	O
text	pointer
,	O
len0	int
)	O
;	O
tmp	array
[	O
len0	int
]	O
=	O
'\0'	O
;	O
if	O
(	O
!	O
upc_e_to_a	function
(	O
tmp	array
)	O
)	O
return	O
-	O
1	int
;	O
break	O
;	O
case	O
12	int
:	O
strncpy	function
(	O
tmp	array
,	O
text	pointer
,	O
11	int
)	O
;	O
tmp	array
[	O
11	int
]	O
=	O
'\0'	O
;	O
if	O
(	O
text	pointer
[	O
11	int
]	O
!=	O
(	O
ean_make_checksum	function
(	O
tmp	array
,	O
0	int
)	O
+	O
'0'	O
)	O
)	O
return	O
-	O
1	int
;	O
case	O
11	int
:	O
break	O
;	O
default	O
:	O
return	O
-	O
1	int
;	O
}	O
return	O
0	int
;	O
}	O
int	O
Barcode_isbn_verify	function
(	O
char	O
*	O
text	pointer
)	O
{	O
int	O
i	int
,	O
ndigit	int
=	O
0	int
;	O
for	O
(	O
i	int
=	O
0	int
;	O
text	pointer
[	O
i	int
]	O
;	O
i	int
++	O
)	O
{	O
if	O
(	O
text	pointer
[	O
i	int
]	O
==	O
'-'	O
)	O
continue	O
;	O
if	O
(	O
isdigit	function
(	O
text	pointer
[	O
i	int
]	O
)	O
)	O
{	O
ndigit	int
++	O
;	O
if	O
(	O
ndigit	int
==	O
9	int
)	O
{	O
i	int
++	O
;	O
break	O
;	O
}	O
continue	O
;	O
}	O
return	O
-	O
1	int
;	O
}	O
if	O
(	O
ndigit	int
!=	O
9	int
)	O
return	O
-	O
1	int
;	O
if	O
(	O
text	pointer
[	O
i	int
]	O
==	O
'-'	O
)	O
i	int
++	O
;	O
if	O
(	O
isdigit	function
(	O
text	pointer
[	O
i	int
]	O
)	O
||	O
toupper	function
(	O
text	pointer
[	O
i	int
]	O
)	O
==	O
'X'	O
)	O
i	int
++	O
;	O
if	O
(	O
text	pointer
[	O
i	int
]	O
==	O
'\0'	O
)	O
return	O
0	int
;	O
if	O
(	O
strlen	function
(	O
text	pointer
+	O
i	int
)	O
!=	O
6	int
)	O
return	O
-	O
1	int
;	O
if	O
(	O
text	pointer
[	O
i	int
]	O
!=	O
' '	O
)	O
return	O
-	O
1	int
;	O
i	int
++	O
;	O
while	O
(	O
text	pointer
[	O
i	int
]	O
)	O
{	O
if	O
(	O
!	O
isdigit	function
(	O
text	pointer
[	O
i	int
]	O
)	O
)	O
return	O
-	O
1	int
;	O
i	int
++	O
;	O
}	O
return	O
0	int
;	O
}	O
static	O
int	O
width_of_partial	function
(	O
char	O
*	O
partial	pointer
)	O
{	O
int	O
i	int
=	O
0	int
;	O
while	O
(	O
*	O
partial	pointer
)	O
{	O
if	O
(	O
isdigit	function
(	O
*	O
partial	pointer
)	O
)	O
i	int
+=	O
*	O
partial	pointer
-	O
'0'	O
;	O
else	O
if	O
(	O
islower	function
(	O
*	O
partial	pointer
)	O
)	O
i	int
+=	O
*	O
partial	pointer
-	O
'a'	O
+	O
1	int
;	O
partial	pointer
++	O
;	O
}	O
return	O
i	int
;	O
}	O
int	O
Barcode_ean_encode	function
(	O
struct	O
Barcode_Item	struct
*	O
bc	pointer
)	O
{	O
static	O
char	O
text	pointer
[	O
24	int
]	O
;	O
static	O
char	O
partial	pointer
[	O
256	int
]	O
;	O
static	O
char	O
textinfo	pointer
[	O
256	int
]	O
;	O
char	O
*	O
mirror	pointer
,	O
*	O
ptr1	pointer
,	O
*	O
ptr2	pointer
,	O
*	O
tptr	pointer
=	O
textinfo	pointer
;	O
char	O
*	O
spc	pointer
;	O
enum	O
{	O
UPCA	int
,	O
UPCE	int
,	O
EAN13	int
,	O
EAN8	int
,	O
ISBN	int
}	O
encoding	pointer
=	O
ISBN	int
;	O
int	O
i	int
,	O
xpos	int
,	O
checksum	int
,	O
len	int
,	O
len0	int
,	O
addon	int
;	O
if	O
(	O
!	O
bc	pointer
->	O
ascii	pointer
)	O
{	O
bc	pointer
->	O
error	int
=	O
EINVAL	int
;	O
return	O
-	O
1	int
;	O
}	O
len	int
=	O
strlen	function
(	O
bc	pointer
->	O
ascii	pointer
)	O
;	O
spc	pointer
=	O
strchr	function
(	O
bc	pointer
->	O
ascii	pointer
,	O
' '	O
)	O
;	O
if	O
(	O
spc	pointer
)	O
{	O
len0	int
=	O
spc	pointer
-	O
bc	pointer
->	O
ascii	pointer
;	O
addon	int
=	O
strlen	function
(	O
spc	pointer
+	O
1	int
)	O
;	O
if	O
(	O
addon	int
!=	O
2	int
&&	O
addon	int
!=	O
5	int
)	O
{	O
bc	pointer
->	O
error	int
=	O
EINVAL	int
;	O
return	O
-	O
1	int
;	O
}	O
}	O
else	O
{	O
len0	int
=	O
len	int
;	O
addon	int
=	O
0	int
;	O
}	O
if	O
(	O
!	O
bc	pointer
->	O
encoding	pointer
)	O
{	O
switch	O
(	O
bc	pointer
->	O
flags	int
&	O
BARCODE_ENCODING_MASK	int
)	O
{	O
case	O
BARCODE_EAN	int
:	O
switch	O
(	O
len0	int
)	O
{	O
case	O
7	int
:	O
case	O
8	int
:	O
bc	pointer
->	O
encoding	pointer
=	O
strdup	function
(	O
"EAN-8"	pointer
)	O
;	O
encoding	pointer
=	O
EAN8	int
;	O
break	O
;	O
case	O
12	int
:	O
case	O
13	int
:	O
bc	pointer
->	O
encoding	pointer
=	O
strdup	function
(	O
"EAN-13"	pointer
)	O
;	O
encoding	pointer
=	O
EAN13	int
;	O
break	O
;	O
default	O
:	O
bc	pointer
->	O
error	int
=	O
-	O
EINVAL	int
;	O
return	O
-	O
1	int
;	O
}	O
break	O
;	O
case	O
BARCODE_UPC	int
:	O
switch	O
(	O
len0	int
)	O
{	O
case	O
6	int
:	O
case	O
7	int
:	O
case	O
8	int
:	O
bc	pointer
->	O
encoding	pointer
=	O
strdup	function
(	O
"UPC-E"	pointer
)	O
;	O
encoding	pointer
=	O
UPCE	int
;	O
break	O
;	O
case	O
11	int
:	O
case	O
12	int
:	O
bc	pointer
->	O
encoding	pointer
=	O
strdup	function
(	O
"UPC-A"	pointer
)	O
;	O
encoding	pointer
=	O
UPCA	int
;	O
break	O
;	O
default	O
:	O
bc	pointer
->	O
error	int
=	O
-	O
EINVAL	int
;	O
return	O
-	O
1	int
;	O
}	O
break	O
;	O
default	O
:	O
bc	pointer
->	O
error	int
=	O
-	O
EINVAL	int
;	O
return	O
-	O
1	int
;	O
}	O
}	O
if	O
(	O
bc	pointer
->	O
partial	pointer
)	O
free	function
(	O
bc	pointer
->	O
partial	pointer
)	O
;	O
bc	pointer
->	O
partial	pointer
=	O
NULL	O
;	O
if	O
(	O
bc	pointer
->	O
textinfo	pointer
)	O
free	function
(	O
bc	pointer
->	O
textinfo	pointer
)	O
;	O
bc	pointer
->	O
textinfo	pointer
=	O
NULL	O
;	O
if	O
(	O
encoding	pointer
==	O
UPCA	int
)	O
{	O
text	pointer
[	O
0	int
]	O
=	O
'0'	O
;	O
strcpy	function
(	O
text	pointer
+	O
1	int
,	O
bc	pointer
->	O
ascii	pointer
)	O
;	O
}	O
else	O
if	O
(	O
encoding	pointer
==	O
UPCE	int
)	O
{	O
strcpy	function
(	O
text	pointer
,	O
upc_a_to_e	function
(	O
upc_e_to_a	function
(	O
bc	pointer
->	O
ascii	pointer
)	O
)	O
)	O
;	O
}	O
else	O
{	O
strcpy	function
(	O
text	pointer
,	O
bc	pointer
->	O
ascii	pointer
)	O
;	O
}	O
if	O
(	O
encoding	pointer
==	O
UPCA	int
||	O
encoding	pointer
==	O
EAN13	int
||	O
encoding	pointer
==	O
ISBN	int
)	O
{	O
if	O
(	O
!	O
(	O
encoding	pointer
==	O
UPCA	int
&&	O
len0	int
==	O
12	int
)	O
&&	O
!	O
(	O
encoding	pointer
==	O
EAN13	int
&&	O
len0	int
==	O
13	int
)	O
)	O
{	O
checksum	int
=	O
ean_make_checksum	function
(	O
text	pointer
,	O
0	int
)	O
;	O
text	pointer
[	O
12	int
]	O
=	O
'0'	O
+	O
checksum	int
;	O
text	pointer
[	O
13	int
]	O
=	O
'\0'	O
;	O
}	O
strcpy	function
(	O
partial	pointer
,	O
guard	array
[	O
0	int
]	O
)	O
;	O
if	O
(	O
encoding	pointer
==	O
EAN13	int
||	O
encoding	pointer
==	O
ISBN	int
)	O
{	O
sprintf	function
(	O
tptr	pointer
,	O
"0:12:%c "	pointer
,	O
text	pointer
[	O
0	int
]	O
)	O
;	O
tptr	pointer
+=	O
strlen	function
(	O
tptr	pointer
)	O
;	O
partial	pointer
[	O
0	int
]	O
=	O
'9'	O
;	O
}	O
else	O
if	O
(	O
encoding	pointer
==	O
UPCA	int
)	O
partial	pointer
[	O
0	int
]	O
=	O
'9'	O
;	O
xpos	int
=	O
width_of_partial	function
(	O
partial	pointer
)	O
;	O
mirror	pointer
=	O
ean_mirrortab	array
[	O
text	pointer
[	O
0	int
]	O
-	O
'0'	O
]	O
;	O
for	O
(	O
i	int
=	O
1	int
;	O
i	int
<	O
7	int
;	O
i	int
++	O
)	O
{	O
ptr1	pointer
=	O
partial	pointer
+	O
strlen	function
(	O
partial	pointer
)	O
;	O
ptr2	pointer
=	O
digits	array
[	O
text	pointer
[	O
i	int
]	O
-	O
'0'	O
]	O
;	O
strcpy	function
(	O
ptr1	pointer
,	O
ptr2	pointer
)	O
;	O
if	O
(	O
mirror	pointer
[	O
i	int
-	O
1	int
]	O
==	O
'1'	O
)	O
{	O
ptr1	pointer
[	O
0	int
]	O
=	O
ptr2	pointer
[	O
3	int
]	O
;	O
ptr1	pointer
[	O
1	int
]	O
=	O
ptr2	pointer
[	O
2	int
]	O
;	O
ptr1	pointer
[	O
2	int
]	O
=	O
ptr2	pointer
[	O
1	int
]	O
;	O
ptr1	pointer
[	O
3	int
]	O
=	O
ptr2	pointer
[	O
0	int
]	O
;	O
}	O
if	O
(	O
encoding	pointer
==	O
UPCA	int
&&	O
i	int
==	O
1	int
)	O
{	O
sprintf	function
(	O
tptr	pointer
,	O
"0:10:%c "	pointer
,	O
text	pointer
[	O
i	int
]	O
)	O
;	O
tptr	pointer
+=	O
strlen	function
(	O
tptr	pointer
)	O
;	O
ptr1	pointer
[	O
1	int
]	O
+=	O
'a'	O
-	O
'1'	O
;	O
ptr1	pointer
[	O
3	int
]	O
+=	O
'a'	O
-	O
'1'	O
;	O
}	O
else	O
{	O
sprintf	function
(	O
tptr	pointer
,	O
"%i:12:%c "	pointer
,	O
xpos	int
,	O
text	pointer
[	O
i	int
]	O
)	O
;	O
tptr	pointer
+=	O
strlen	function
(	O
tptr	pointer
)	O
;	O
}	O
xpos	int
+=	O
7	int
;	O
}	O
strcat	function
(	O
partial	pointer
,	O
guard	array
[	O
1	int
]	O
)	O
;	O
xpos	int
+=	O
width_of_partial	function
(	O
guard	array
[	O
1	int
]	O
)	O
;	O
for	O
(	O
i	int
=	O
7	int
;	O
i	int
<	O
13	int
;	O
i	int
++	O
)	O
{	O
ptr1	pointer
=	O
partial	pointer
+	O
strlen	function
(	O
partial	pointer
)	O
;	O
ptr2	pointer
=	O
digits	array
[	O
text	pointer
[	O
i	int
]	O
-	O
'0'	O
]	O
;	O
strcpy	function
(	O
ptr1	pointer
,	O
ptr2	pointer
)	O
;	O
if	O
(	O
encoding	pointer
==	O
UPCA	int
&&	O
i	int
==	O
12	int
)	O
{	O
sprintf	function
(	O
tptr	pointer
,	O
"%i:10:%c "	pointer
,	O
xpos	int
+	O
13	int
,	O
text	pointer
[	O
i	int
]	O
)	O
;	O
tptr	pointer
+=	O
strlen	function
(	O
tptr	pointer
)	O
;	O
ptr1	pointer
[	O
0	int
]	O
+=	O
'a'	O
-	O
'1'	O
;	O
ptr1	pointer
[	O
2	int
]	O
+=	O
'a'	O
-	O
'1'	O
;	O
}	O
else	O
{	O
sprintf	function
(	O
tptr	pointer
,	O
"%i:12:%c "	pointer
,	O
xpos	int
,	O
text	pointer
[	O
i	int
]	O
)	O
;	O
tptr	pointer
+=	O
strlen	function
(	O
tptr	pointer
)	O
;	O
}	O
xpos	int
+=	O
7	int
;	O
}	O
tptr	pointer
[	O
-	O
1	int
]	O
=	O
'\0'	O
;	O
strcat	function
(	O
partial	pointer
,	O
guard	array
[	O
2	int
]	O
)	O
;	O
xpos	int
+=	O
width_of_partial	function
(	O
guard	array
[	O
2	int
]	O
)	O
;	O
}	O
else	O
if	O
(	O
encoding	pointer
==	O
UPCE	int
)	O
{	O
checksum	int
=	O
text	pointer
[	O
7	int
]	O
-	O
'0'	O
;	O
strcpy	function
(	O
partial	pointer
,	O
guardE	array
[	O
0	int
]	O
)	O
;	O
partial	pointer
[	O
0	int
]	O
=	O
'9'	O
;	O
xpos	int
=	O
width_of_partial	function
(	O
partial	pointer
)	O
;	O
sprintf	function
(	O
tptr	pointer
,	O
"0:10:%c "	pointer
,	O
text	pointer
[	O
0	int
]	O
)	O
;	O
tptr	pointer
+=	O
strlen	function
(	O
tptr	pointer
)	O
;	O
if	O
(	O
text	pointer
[	O
0	int
]	O
==	O
'0'	O
)	O
mirror	pointer
=	O
upc_mirrortab	array
[	O
checksum	int
]	O
;	O
else	O
mirror	pointer
=	O
upc_mirrortab1	array
[	O
checksum	int
]	O
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
6	int
;	O
i	int
++	O
)	O
{	O
ptr1	pointer
=	O
partial	pointer
+	O
strlen	function
(	O
partial	pointer
)	O
;	O
ptr2	pointer
=	O
digits	array
[	O
text	pointer
[	O
i	int
+	O
1	int
]	O
-	O
'0'	O
]	O
;	O
strcpy	function
(	O
ptr1	pointer
,	O
ptr2	pointer
)	O
;	O
if	O
(	O
mirror	pointer
[	O
i	int
]	O
!=	O
'1'	O
)	O
{	O
ptr1	pointer
[	O
0	int
]	O
=	O
ptr2	pointer
[	O
3	int
]	O
;	O
ptr1	pointer
[	O
1	int
]	O
=	O
ptr2	pointer
[	O
2	int
]	O
;	O
ptr1	pointer
[	O
2	int
]	O
=	O
ptr2	pointer
[	O
1	int
]	O
;	O
ptr1	pointer
[	O
3	int
]	O
=	O
ptr2	pointer
[	O
0	int
]	O
;	O
}	O
sprintf	function
(	O
tptr	pointer
,	O
"%i:12:%c "	pointer
,	O
xpos	int
,	O
text	pointer
[	O
i	int
+	O
1	int
]	O
)	O
;	O
tptr	pointer
+=	O
strlen	function
(	O
tptr	pointer
)	O
;	O
xpos	int
+=	O
7	int
;	O
}	O
sprintf	function
(	O
tptr	pointer
,	O
"%i:10:%c "	pointer
,	O
xpos	int
+	O
10	int
,	O
text	pointer
[	O
7	int
]	O
)	O
;	O
tptr	pointer
+=	O
strlen	function
(	O
tptr	pointer
)	O
;	O
ptr1	pointer
[	O
0	int
]	O
+=	O
'a'	O
-	O
'1'	O
;	O
ptr1	pointer
[	O
2	int
]	O
+=	O
'a'	O
-	O
'1'	O
;	O
tptr	pointer
[	O
-	O
1	int
]	O
=	O
'\0'	O
;	O
strcat	function
(	O
partial	pointer
,	O
guardE	array
[	O
1	int
]	O
)	O
;	O
}	O
else	O
{	O
if	O
(	O
len0	int
!=	O
8	int
)	O
{	O
checksum	int
=	O
ean_make_checksum	function
(	O
text	pointer
,	O
0	int
)	O
;	O
text	pointer
[	O
7	int
]	O
=	O
'0'	O
+	O
checksum	int
;	O
text	pointer
[	O
8	int
]	O
=	O
'\0'	O
;	O
}	O
strcpy	function
(	O
partial	pointer
,	O
guard	array
[	O
0	int
]	O
)	O
;	O
xpos	int
=	O
width_of_partial	function
(	O
partial	pointer
)	O
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
4	int
;	O
i	int
++	O
)	O
{	O
strcpy	function
(	O
partial	pointer
+	O
strlen	function
(	O
partial	pointer
)	O
,	O
digits	array
[	O
text	pointer
[	O
i	int
]	O
-	O
'0'	O
]	O
)	O
;	O
sprintf	function
(	O
tptr	pointer
,	O
"%i:12:%c "	pointer
,	O
xpos	int
,	O
text	pointer
[	O
i	int
]	O
)	O
;	O
tptr	pointer
+=	O
strlen	function
(	O
tptr	pointer
)	O
;	O
xpos	int
+=	O
7	int
;	O
}	O
strcat	function
(	O
partial	pointer
,	O
guard	array
[	O
1	int
]	O
)	O
;	O
xpos	int
+=	O
width_of_partial	function
(	O
guard	array
[	O
1	int
]	O
)	O
;	O
for	O
(	O
i	int
=	O
4	int
;	O
i	int
<	O
8	int
;	O
i	int
++	O
)	O
{	O
strcpy	function
(	O
partial	pointer
+	O
strlen	function
(	O
partial	pointer
)	O
,	O
digits	array
[	O
text	pointer
[	O
i	int
]	O
-	O
'0'	O
]	O
)	O
;	O
sprintf	function
(	O
tptr	pointer
,	O
"%i:12:%c "	pointer
,	O
xpos	int
,	O
text	pointer
[	O
i	int
]	O
)	O
;	O
tptr	pointer
+=	O
strlen	function
(	O
tptr	pointer
)	O
;	O
xpos	int
+=	O
7	int
;	O
}	O
tptr	pointer
[	O
-	O
1	int
]	O
=	O
'\0'	O
;	O
strcat	function
(	O
partial	pointer
,	O
guard	array
[	O
2	int
]	O
)	O
;	O
}	O
if	O
(	O
(	O
ptr1	pointer
=	O
spc	pointer
)	O
)	O
{	O
ptr1	pointer
++	O
;	O
strcpy	function
(	O
text	pointer
,	O
ptr1	pointer
)	O
;	O
if	O
(	O
strlen	function
(	O
ptr1	pointer
)	O
==	O
5	int
)	O
{	O
checksum	int
=	O
ean_make_checksum	function
(	O
text	pointer
,	O
1	int
)	O
;	O
mirror	pointer
=	O
upc_mirrortab	array
[	O
checksum	int
]	O
+	O
1	int
;	O
}	O
else	O
{	O
checksum	int
=	O
atoi	function
(	O
text	pointer
)	O
%	O
4	int
;	O
mirror	pointer
=	O
upc_mirrortab2	array
[	O
checksum	int
]	O
;	O
}	O
strcat	function
(	O
textinfo	pointer
,	O
" +"	pointer
)	O
;	O
strcat	function
(	O
partial	pointer
,	O
"+"	pointer
)	O
;	O
tptr	pointer
=	O
textinfo	pointer
+	O
strlen	function
(	O
textinfo	pointer
)	O
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
strlen	function
(	O
text	pointer
)	O
;	O
i	int
++	O
)	O
{	O
if	O
(	O
!	O
i	int
)	O
{	O
strcat	function
(	O
partial	pointer
,	O
guardS	array
[	O
0	int
]	O
)	O
;	O
xpos	int
+=	O
width_of_partial	function
(	O
guardS	array
[	O
0	int
]	O
)	O
;	O
}	O
else	O
{	O
strcat	function
(	O
partial	pointer
,	O
guardS	array
[	O
1	int
]	O
)	O
;	O
xpos	int
+=	O
width_of_partial	function
(	O
guardS	array
[	O
1	int
]	O
)	O
;	O
}	O
ptr1	pointer
=	O
partial	pointer
+	O
strlen	function
(	O
partial	pointer
)	O
;	O
ptr2	pointer
=	O
digits	array
[	O
text	pointer
[	O
i	int
]	O
-	O
'0'	O
]	O
;	O
strcpy	function
(	O
ptr1	pointer
,	O
ptr2	pointer
)	O
;	O
if	O
(	O
mirror	pointer
[	O
i	int
]	O
!=	O
'1'	O
)	O
{	O
ptr1	pointer
[	O
0	int
]	O
=	O
ptr2	pointer
[	O
3	int
]	O
;	O
ptr1	pointer
[	O
1	int
]	O
=	O
ptr2	pointer
[	O
2	int
]	O
;	O
ptr1	pointer
[	O
2	int
]	O
=	O
ptr2	pointer
[	O
1	int
]	O
;	O
ptr1	pointer
[	O
3	int
]	O
=	O
ptr2	pointer
[	O
0	int
]	O
;	O
}	O
sprintf	function
(	O
tptr	pointer
,	O
" %i:12:%c"	pointer
,	O
xpos	int
,	O
text	pointer
[	O
i	int
]	O
)	O
;	O
tptr	pointer
+=	O
strlen	function
(	O
tptr	pointer
)	O
;	O
xpos	int
+=	O
7	int
;	O
}	O
}	O
bc	pointer
->	O
partial	pointer
=	O
strdup	function
(	O
partial	pointer
)	O
;	O
if	O
(	O
!	O
bc	pointer
->	O
partial	pointer
)	O
{	O
bc	pointer
->	O
error	int
=	O
errno	O
;	O
return	O
-	O
1	int
;	O
}	O
bc	pointer
->	O
textinfo	pointer
=	O
strdup	function
(	O
textinfo	pointer
)	O
;	O
if	O
(	O
!	O
bc	pointer
->	O
textinfo	pointer
)	O
{	O
bc	pointer
->	O
error	int
=	O
errno	O
;	O
free	function
(	O
bc	pointer
->	O
partial	pointer
)	O
;	O
bc	pointer
->	O
partial	pointer
=	O
NULL	O
;	O
return	O
-	O
1	int
;	O
}	O
if	O
(	O
!	O
bc	pointer
->	O
width	int
)	O
bc	pointer
->	O
width	int
=	O
width_of_partial	function
(	O
partial	pointer
)	O
;	O
return	O
0	int
;	O
}	O
int	O
Barcode_upc_encode	function
(	O
struct	O
Barcode_Item	struct
*	O
bc	pointer
)	O
{	O
return	O
Barcode_ean_encode	function
(	O
bc	pointer
)	O
;	O
}	O
int	O
Barcode_isbn_encode	function
(	O
struct	O
Barcode_Item	struct
*	O
bc	pointer
)	O
{	O
char	O
*	O
text	pointer
=	O
malloc	function
(	O
24	int
)	O
;	O
char	O
*	O
otext	pointer
;	O
int	O
i	int
,	O
j	int
,	O
retval	int
;	O
if	O
(	O
!	O
text	pointer
)	O
{	O
bc	pointer
->	O
error	int
=	O
ENOMEM	int
;	O
return	O
-	O
1	int
;	O
}	O
strcpy	function
(	O
text	pointer
,	O
"978"	pointer
)	O
;	O
j	int
=	O
3	int
;	O
otext	pointer
=	O
bc	pointer
->	O
ascii	pointer
;	O
for	O
(	O
i	int
=	O
0	int
;	O
otext	pointer
[	O
i	int
]	O
;	O
i	int
++	O
)	O
{	O
if	O
(	O
isdigit	function
(	O
otext	pointer
[	O
i	int
]	O
)	O
)	O
text	pointer
[	O
j	int
++	O
]	O
=	O
otext	pointer
[	O
i	int
]	O
;	O
if	O
(	O
j	int
==	O
12	int
)	O
break	O
;	O
}	O
text	pointer
[	O
j	int
]	O
=	O
'\0'	O
;	O
if	O
(	O
strchr	function
(	O
otext	pointer
,	O
' '	O
)	O
)	O
strcat	function
(	O
text	pointer
,	O
strchr	function
(	O
otext	pointer
,	O
' '	O
)	O
)	O
;	O
bc	pointer
->	O
ascii	pointer
=	O
text	pointer
;	O
bc	pointer
->	O
encoding	pointer
=	O
strdup	function
(	O
"ISBN"	pointer
)	O
;	O
retval	int
=	O
Barcode_ean_encode	function
(	O
bc	pointer
)	O
;	O
bc	pointer
->	O
ascii	pointer
=	O
otext	pointer
;	O
free	function
(	O
text	pointer
)	O
;	O
return	O
retval	int
;	O
}	O
