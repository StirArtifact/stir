char	O
*	O
program_name	pointer
;	O
int	O
debugging_enabled	int
=	O
0	int
;	O
long	O
time_warp_leniency	long
=	O
60	int
;	O
long	O
time_warp_suspicious	long
=	O
31536000	int
;	O
int	O
print_file_problems	int
=	O
0	int
;	O
int	O
print_year	int
=	O
0	int
;	O
int	O
print_seconds	int
=	O
0	int
;	O
time_t	long
last_time	long
=	O
0	int
;	O
char	O
*	O
last_event	pointer
=	O
NULL	O
;	O
time_t	long
last_event_time	long
;	O
long	O
num_lines_to_print	long
=	O
-	O
1	int
;	O
int	O
truncate_ftp_entries	int
=	O
1	int
;	O
int	O
print_which_recs	int
=	O
0	int
;	O
int	O
print_name_len	int
=	O
my_min	O
(	O
NAME_LEN	O
,	O
8	int
)	O
;	O
int	O
print_tty_len	int
=	O
my_min	O
(	O
TTY_LEN	O
,	O
12	int
)	O
;	O
int	O
print_host_len	int
=	O
my_min	O
(	O
HOST_LEN	O
,	O
16	int
)	O
;	O
struct	O
hashtab	struct
*	O
names	pointer
=	O
NULL	O
;	O
struct	O
hashtab	struct
*	O
login_table	pointer
=	O
NULL	O
;	O
struct	O
login_data	struct
{	O
time_t	long
time	struct
;	O
short	O
fake_entry	short
;	O
}	O
;	O
void	O
log_everyone_in	function
(	O
time_t	long
)	O
;	O
void	O
update_system_time	function
(	O
time_t	long
)	O
;	O
void	O
log_out	function
(	O
struct	O
utmp	struct
*	O
entry	pointer
,	O
short	O
fake_flag	short
)	O
;	O
void	O
log_in	function
(	O
struct	O
utmp	struct
*	O
)	O
;	O
void	O
print_record	function
(	O
struct	O
utmp	struct
*	O
,	O
time_t	long
logout_time	long
,	O
char	O
*	O
,	O
char	O
*	O
,	O
char	O
*	O
)	O
;	O
void	O
display_date	function
(	O
time_t	long
now	long
)	O
;	O
struct	O
sigaction	struct
sigact	struct
;	O
RETSIGTYPE	void
handler	function
(	O
int	O
)	O
;	O
int	O
main	function
(	O
int	O
argc	int
,	O
char	O
*	O
argv	array
[	O
]	O
)	O
{	O
int	O
c	int
=	O
1	int
;	O
int	O
other_wtmp_file_specified	int
=	O
0	int
;	O
program_name	pointer
=	O
argv	array
[	O
0	int
]	O
;	O
utmp_init	function
(	O
1	int
)	O
;	O
for	O
(	O
;	O
c	int
<	O
argc	int
;	O
c	int
++	O
)	O
{	O
if	O
(	O
argv	array
[	O
c	int
]	O
[	O
0	int
]	O
==	O
'-'	O
&&	O
isdigit	function
(	O
argv	array
[	O
c	int
]	O
[	O
1	int
]	O
)	O
)	O
{	O
int	O
d	int
;	O
num_lines_to_print	long
=	O
strtol	function
(	O
argv	array
[	O
c	int
]	O
+	O
1	int
,	O
(	O
char	O
*	O
*	O
)	O
NULL	O
,	O
10	int
)	O
;	O
if	O
(	O
num_lines_to_print	long
<	O
1	int
)	O
fatal	function
(	O
"number of lines to print must be positive and non-zero"	pointer
)	O
;	O
for	O
(	O
d	int
=	O
c	int
;	O
d	int
;	O
d	int
--	O
)	O
argv	array
[	O
d	int
]	O
=	O
argv	array
[	O
d	int
-	O
1	int
]	O
;	O
argc	int
--	O
;	O
argv	array
++	O
;	O
c	int
--	O
;	O
}	O
}	O
while	O
(	O
1	int
)	O
{	O
int	O
option_index	int
=	O
0	int
;	O
static	O
struct	O
option	struct
long_options	array
[	O
]	O
=	O
{	O
{	O
"complain"	pointer
,	O
no_argument	int
,	O
NULL	O
,	O
1	int
}	O
,	O
{	O
"lines"	pointer
,	O
required_argument	int
,	O
NULL	O
,	O
3	int
}	O
,	O
{	O
"debug"	pointer
,	O
no_argument	int
,	O
NULL	O
,	O
4	int
}	O
,	O
{	O
"tw-leniency"	pointer
,	O
required_argument	int
,	O
NULL	O
,	O
5	int
}	O
,	O
{	O
"version"	pointer
,	O
no_argument	int
,	O
NULL	O
,	O
6	int
}	O
,	O
{	O
"help"	pointer
,	O
no_argument	int
,	O
NULL	O
,	O
7	int
}	O
,	O
{	O
"file"	pointer
,	O
required_argument	int
,	O
NULL	O
,	O
8	int
}	O
,	O
{	O
"no-truncate-ftp-entries"	pointer
,	O
no_argument	int
,	O
NULL	O
,	O
9	int
}	O
,	O
{	O
"all-records"	pointer
,	O
no_argument	int
,	O
NULL	O
,	O
10	int
}	O
,	O
{	O
"print-year"	pointer
,	O
no_argument	int
,	O
NULL	O
,	O
12	int
}	O
,	O
{	O
"more-records"	pointer
,	O
no_argument	int
,	O
NULL	O
,	O
13	int
}	O
,	O
{	O
"tw-suspicious"	pointer
,	O
required_argument	int
,	O
NULL	O
,	O
14	int
}	O
,	O
{	O
"print-seconds"	pointer
,	O
no_argument	int
,	O
NULL	O
,	O
15	int
}	O
,	O
{	O
"wide"	pointer
,	O
no_argument	int
,	O
NULL	O
,	O
16	int
}	O
,	O
{	O
0	int
,	O
0	int
,	O
0	int
,	O
0	int
}	O
}	O
;	O
c	int
=	O
getopt_long	function
(	O
argc	int
,	O
argv	array
,	O
"a"	pointer
"f:n:s"	pointer
"x"	pointer
"wyV"	pointer
,	O
long_options	array
,	O
&	O
option_index	int
)	O
;	O
if	O
(	O
c	int
==	O
EOF	O
)	O
break	O
;	O
switch	O
(	O
c	int
)	O
{	O
case	O
1	int
:	O
print_file_problems	int
=	O
1	int
;	O
break	O
;	O
case	O
'n'	O
:	O
case	O
3	int
:	O
num_lines_to_print	long
=	O
strtol	function
(	O
optarg	pointer
,	O
(	O
char	O
*	O
*	O
)	O
NULL	O
,	O
10	int
)	O
;	O
if	O
(	O
num_lines_to_print	long
<	O
1	int
)	O
fatal	function
(	O
"number of lines to print must be positive and non-zero"	pointer
)	O
;	O
break	O
;	O
case	O
4	int
:	O
debugging_enabled	int
=	O
1	int
;	O
print_file_problems	int
=	O
1	int
;	O
break	O
;	O
case	O
5	int
:	O
time_warp_leniency	long
=	O
strtol	function
(	O
optarg	pointer
,	O
(	O
char	O
*	O
*	O
)	O
NULL	O
,	O
10	int
)	O
;	O
if	O
(	O
time_warp_leniency	long
<	O
0	int
)	O
fatal	function
(	O
"time warp leniency value has to be non-negative"	pointer
)	O
;	O
break	O
;	O
case	O
'V'	O
:	O
case	O
6	int
:	O
printf	function
(	O
"%s: GNU Accounting Utilities (release %s)\n"	pointer
,	O
program_name	pointer
,	O
VERSION_STRING	pointer
)	O
;	O
exit	function
(	O
EXIT_SUCCESS	int
)	O
;	O
case	O
'f'	O
:	O
case	O
8	int
:	O
add_utmp_file	function
(	O
optarg	pointer
)	O
;	O
other_wtmp_file_specified	int
=	O
1	int
;	O
break	O
;	O
case	O
9	int
:	O
truncate_ftp_entries	int
=	O
0	int
;	O
break	O
;	O
case	O
'a'	O
:	O
case	O
10	int
:	O
print_which_recs	int
=	O
2	int
;	O
break	O
;	O
case	O
'y'	O
:	O
case	O
12	int
:	O
print_year	int
=	O
1	int
;	O
break	O
;	O
case	O
'x'	O
:	O
case	O
13	int
:	O
print_which_recs	int
=	O
1	int
;	O
break	O
;	O
case	O
14	int
:	O
time_warp_suspicious	long
=	O
strtol	function
(	O
optarg	pointer
,	O
(	O
char	O
*	O
*	O
)	O
NULL	O
,	O
10	int
)	O
;	O
if	O
(	O
time_warp_suspicious	long
<	O
0	int
)	O
fatal	function
(	O
"time warp suspicious value has to be non-negative"	pointer
)	O
;	O
if	O
(	O
time_warp_suspicious	long
<=	O
time_warp_leniency	long
)	O
fatal	function
(	O
"time warp suspicious value has to greater than the time warp leniency value"	pointer
)	O
;	O
break	O
;	O
case	O
's'	O
:	O
case	O
15	int
:	O
print_seconds	int
=	O
1	int
;	O
break	O
;	O
case	O
'w'	O
:	O
case	O
16	int
:	O
print_name_len	int
=	O
NAME_LEN	O
;	O
print_tty_len	int
=	O
TTY_LEN	O
;	O
print_host_len	int
=	O
HOST_LEN	O
;	O
break	O
;	O
case	O
'h'	O
:	O
case	O
7	int
:	O
default	O
:	O
give_usage	function
(	O
)	O
;	O
exit	function
(	O
EXIT_FAILURE	int
)	O
;	O
}	O
}	O
if	O
(	O
optind	int
<	O
argc	int
)	O
{	O
names	pointer
=	O
hashtab_init	function
(	O
0	int
)	O
;	O
while	O
(	O
optind	int
<	O
argc	int
)	O
{	O
char	O
*	O
string	pointer
;	O
hashtab_create	function
(	O
names	pointer
,	O
argv	array
[	O
optind	int
]	O
,	O
0	int
)	O
;	O
string	pointer
=	O
(	O
char	O
*	O
)	O
xmalloc	function
(	O
(	O
strlen	function
(	O
argv	array
[	O
optind	int
]	O
)	O
+	O
4	int
)	O
*	O
sizeof	O
(	O
char	O
)	O
)	O
;	O
sprintf	function
(	O
string	pointer
,	O
"tty%s"	pointer
,	O
argv	array
[	O
optind	int
]	O
)	O
;	O
hashtab_create	function
(	O
names	pointer
,	O
string	pointer
,	O
0	int
)	O
;	O
free	function
(	O
string	pointer
)	O
;	O
optind	int
++	O
;	O
if	O
(	O
!	O
print_which_recs	int
)	O
print_which_recs	int
=	O
1	int
;	O
}	O
if	O
(	O
debugging_enabled	int
)	O
hashtab_dump_keys	function
(	O
names	pointer
,	O
stddebug	O
)	O
;	O
}	O
if	O
(	O
!	O
other_wtmp_file_specified	int
)	O
add_utmp_file	function
(	O
WTMP_FILE_LOC	pointer
)	O
;	O
login_table	pointer
=	O
hashtab_init	function
(	O
0	int
)	O
;	O
parse_entries	function
(	O
)	O
;	O
(	O
void	O
)	O
fputs	function
(	O
"\nwtmp begins "	pointer
,	O
stdout	pointer
)	O
;	O
display_date	function
(	O
last_time	long
)	O
;	O
(	O
void	O
)	O
fputc	function
(	O
'\n'	O
,	O
stdout	pointer
)	O
;	O
exit	function
(	O
EXIT_SUCCESS	int
)	O
;	O
}	O
void	O
give_usage	function
(	O
void	O
)	O
{	O
(	O
void	O
)	O
printf	function
(	O
"                Usage: %s [-"	pointer
"a"	pointer
"hs"	pointer
"x"	pointer
"yV] [-<lines>] [-n <lines>] [-f <file>] [people] [ttys] ...\n                [--lines <num>] [--file <file>] [--complain] [--debug]\n                [--version] [--tw-leniency <value>] [--tw-suspicious <value>]\n                [--no-truncate-ftp-entries] [--print-year] [--print-seconds]\n                "	pointer
"[--more-records] [--all-records] "	pointer
"[--help]\n"	pointer
,	O
program_name	pointer
)	O
;	O
print_wtmp_file_location	function
(	O
)	O
;	O
}	O
void	O
update_system_time	function
(	O
time_t	long
the_time	long
)	O
{	O
struct	O
hashtab_order	struct
ho	pointer
;	O
struct	O
hashtab_elem	struct
*	O
he	pointer
;	O
for	O
(	O
he	pointer
=	O
hashtab_first	function
(	O
login_table	pointer
,	O
&	O
ho	pointer
)	O
;	O
he	pointer
!=	O
NULL	O
;	O
he	pointer
=	O
hashtab_next	function
(	O
&	O
ho	pointer
)	O
)	O
{	O
struct	O
login_data	struct
*	O
l	pointer
=	O
hashtab_get_value	function
(	O
he	pointer
)	O
;	O
l	pointer
->	O
time	struct
+=	O
the_time	long
;	O
}	O
}	O
void	O
log_everyone_in	function
(	O
time_t	long
the_time	long
)	O
{	O
struct	O
hashtab_order	struct
ho	pointer
;	O
struct	O
hashtab_elem	struct
*	O
he	pointer
;	O
for	O
(	O
he	pointer
=	O
hashtab_first	function
(	O
login_table	pointer
,	O
&	O
ho	pointer
)	O
;	O
he	pointer
!=	O
NULL	O
;	O
he	pointer
=	O
hashtab_next	function
(	O
&	O
ho	pointer
)	O
)	O
{	O
struct	O
login_data	struct
*	O
l	pointer
=	O
hashtab_get_value	function
(	O
he	pointer
)	O
;	O
if	O
(	O
debugging_enabled	int
&&	O
(	O
!	O
l	pointer
->	O
fake_entry	short
)	O
)	O
{	O
struct	O
utmp	struct
this	struct
;	O
char	O
*	O
ttyname	pointer
=	O
hashtab_get_key	function
(	O
he	pointer
)	O
;	O
memset	function
(	O
&	O
this	struct
,	O
0	int
,	O
sizeof	O
(	O
this	struct
)	O
)	O
;	O
strncpy	function
(	O
this	struct
.	O
ut_line	array
,	O
ttyname	pointer
,	O
TTY_LEN	O
)	O
;	O
this	struct
.	O
ut_time	O
=	O
the_time	long
;	O
print_record	function
(	O
&	O
this	struct
,	O
l	pointer
->	O
time	struct
,	O
NULL	O
,	O
NULL	O
,	O
"unpaired"	pointer
)	O
;	O
}	O
hashtab_delete	function
(	O
he	pointer
)	O
;	O
}	O
}	O
void	O
log_out	function
(	O
struct	O
utmp	struct
*	O
entry	pointer
,	O
short	O
fake_flag	short
)	O
{	O
struct	O
hashtab_elem	struct
*	O
he	pointer
;	O
if	O
(	O
entry	pointer
->	O
ut_line	array
[	O
0	int
]	O
==	O
'\0'	O
)	O
{	O
if	O
(	O
print_file_problems	int
)	O
{	O
utmp_print_file_and_line	function
(	O
stddebug	O
)	O
;	O
fprintf	function
(	O
stddebug	O
,	O
": problem: trying to hash rec with ut_line == NULL\n"	pointer
)	O
;	O
}	O
return	O
;	O
}	O
he	pointer
=	O
hashtab_find	function
(	O
login_table	pointer
,	O
entry	pointer
->	O
ut_line	array
,	O
(	O
unsigned	O
int	O
)	O
TTY_LEN	O
)	O
;	O
if	O
(	O
he	pointer
!=	O
NULL	O
)	O
{	O
struct	O
login_data	struct
*	O
l	pointer
=	O
hashtab_get_value	function
(	O
he	pointer
)	O
;	O
if	O
(	O
(	O
!	O
l	pointer
->	O
fake_entry	short
)	O
&&	O
print_file_problems	int
)	O
{	O
char	O
*	O
ttyname	pointer
=	O
hashtab_get_key	function
(	O
he	pointer
)	O
;	O
utmp_print_file_and_line	function
(	O
stddebug	O
)	O
;	O
fprintf	function
(	O
stddebug	O
,	O
": problem: duplicate record for line `%.*s'\n"	pointer
,	O
TTY_LEN	O
,	O
ttyname	pointer
)	O
;	O
}	O
l	pointer
->	O
time	struct
=	O
entry	pointer
->	O
ut_time	O
;	O
l	pointer
->	O
fake_entry	short
=	O
fake_flag	short
;	O
return	O
;	O
}	O
else	O
{	O
struct	O
login_data	struct
l	pointer
;	O
l	pointer
.	O
time	struct
=	O
entry	pointer
->	O
ut_time	O
;	O
l	pointer
.	O
fake_entry	short
=	O
fake_flag	short
;	O
he	pointer
=	O
hashtab_create	function
(	O
login_table	pointer
,	O
entry	pointer
->	O
ut_line	array
,	O
TTY_LEN	O
)	O
;	O
hashtab_set_value	function
(	O
he	pointer
,	O
&	O
l	pointer
,	O
sizeof	O
(	O
l	pointer
)	O
)	O
;	O
}	O
}	O
void	O
log_in	function
(	O
struct	O
utmp	struct
*	O
entry	pointer
)	O
{	O
struct	O
hashtab_elem	struct
*	O
he	pointer
;	O
if	O
(	O
entry	pointer
->	O
ut_line	array
[	O
0	int
]	O
==	O
'\0'	O
)	O
{	O
if	O
(	O
print_file_problems	int
)	O
{	O
utmp_print_file_and_line	function
(	O
stddebug	O
)	O
;	O
fprintf	function
(	O
stddebug	O
,	O
": problem: trying to hash rec with ut_line == NULL\n"	pointer
)	O
;	O
}	O
return	O
;	O
}	O
he	pointer
=	O
hashtab_find	function
(	O
login_table	pointer
,	O
entry	pointer
->	O
ut_line	array
,	O
(	O
unsigned	O
int	O
)	O
TTY_LEN	O
)	O
;	O
if	O
(	O
he	pointer
!=	O
NULL	O
)	O
{	O
struct	O
login_data	struct
*	O
l	pointer
=	O
hashtab_get_value	function
(	O
he	pointer
)	O
;	O
if	O
(	O
l	pointer
->	O
fake_entry	short
&&	O
print_file_problems	int
)	O
{	O
utmp_print_file_and_line	function
(	O
stddebug	O
)	O
;	O
(	O
void	O
)	O
fprintf	function
(	O
stddebug	O
,	O
": problem: missing logout record for `%.*s'\n"	pointer
,	O
TTY_LEN	O
,	O
entry	pointer
->	O
ut_line	array
)	O
;	O
}	O
print_record	function
(	O
entry	pointer
,	O
l	pointer
->	O
time	struct
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
)	O
;	O
hashtab_delete	function
(	O
he	pointer
)	O
;	O
}	O
else	O
{	O
print_record	function
(	O
entry	pointer
,	O
0	int
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
)	O
;	O
}	O
log_out	function
(	O
entry	pointer
,	O
TRUE	int
)	O
;	O
}	O
void	O
print_record	function
(	O
struct	O
utmp	struct
*	O
login	function
,	O
time_t	long
logout_time	long
,	O
char	O
*	O
replacement_name	pointer
,	O
char	O
*	O
replacement_tty	pointer
,	O
char	O
*	O
special_message	pointer
)	O
{	O
char	O
*	O
print_name	pointer
;	O
char	O
*	O
print_tty	pointer
;	O
char	O
sanitized_tty	array
[	O
TTY_LEN	O
]	O
;	O
if	O
(	O
!	O
(	O
(	O
names	pointer
==	O
NULL	O
)	O
||	O
hashtab_find	function
(	O
names	pointer
,	O
login	function
->	O
ut_name	O
,	O
(	O
unsigned	O
int	O
)	O
NAME_LEN	O
)	O
||	O
hashtab_find	function
(	O
names	pointer
,	O
login	function
->	O
ut_line	array
,	O
(	O
unsigned	O
int	O
)	O
TTY_LEN	O
)	O
)	O
)	O
return	O
;	O
if	O
(	O
replacement_tty	pointer
)	O
print_tty	pointer
=	O
replacement_tty	pointer
;	O
else	O
if	O
(	O
truncate_ftp_entries	int
&&	O
(	O
strncmp	function
(	O
login	function
->	O
ut_line	array
,	O
"ftp"	pointer
,	O
3	int
)	O
==	O
0	int
)	O
)	O
print_tty	pointer
=	O
"ftp"	pointer
;	O
else	O
print_tty	pointer
=	O
login	function
->	O
ut_line	array
;	O
print_name	pointer
=	O
(	O
replacement_name	pointer
?	O
replacement_name	pointer
:	O
login	function
->	O
ut_name	O
)	O
;	O
{	O
int	O
i	int
=	O
0	int
;	O
for	O
(	O
;	O
(	O
print_tty	pointer
[	O
i	int
]	O
!=	O
'\0'	O
)	O
&&	O
(	O
i	int
<	O
TTY_LEN	O
)	O
;	O
i	int
++	O
)	O
sanitized_tty	array
[	O
i	int
]	O
=	O
(	O
isprint	function
(	O
print_tty	pointer
[	O
i	int
]	O
)	O
&&	O
isascii	function
(	O
print_tty	pointer
[	O
i	int
]	O
)	O
?	O
print_tty	pointer
[	O
i	int
]	O
:	O
'?'	O
)	O
;	O
if	O
(	O
i	int
<	O
TTY_LEN	O
)	O
sanitized_tty	array
[	O
i	int
]	O
=	O
'\0'	O
;	O
}	O
(	O
void	O
)	O
printf	function
(	O
"%-*.*s %-*.*s "	pointer
,	O
print_name_len	int
,	O
print_name_len	int
,	O
print_name	pointer
,	O
print_tty_len	int
,	O
print_tty_len	int
,	O
sanitized_tty	array
)	O
;	O
(	O
void	O
)	O
printf	function
(	O
"%-*.*s "	pointer
,	O
print_host_len	int
,	O
print_host_len	int
,	O
login	function
->	O
ut_host	array
)	O
;	O
display_date	function
(	O
login	function
->	O
ut_time	O
)	O
;	O
if	O
(	O
special_message	pointer
)	O
(	O
void	O
)	O
printf	function
(	O
"  %s\n"	pointer
,	O
special_message	pointer
)	O
;	O
else	O
{	O
char	O
temp_str	array
[	O
16	int
]	O
;	O
int	O
days	int
,	O
hours	int
,	O
minutes	int
,	O
seconds	int
;	O
int	O
diff	int
,	O
use_last_event	int
=	O
0	int
;	O
if	O
(	O
logout_time	long
==	O
0	int
)	O
{	O
logout_time	long
=	O
last_event_time	long
;	O
use_last_event	int
=	O
1	int
;	O
}	O
diff	int
=	O
(	O
int	O
)	O
logout_time	long
-	O
login	function
->	O
ut_time	O
;	O
days	int
=	O
(	O
int	O
)	O
(	O
diff	int
/	O
86400	int
)	O
;	O
diff	int
-=	O
86400	int
*	O
days	int
;	O
hours	int
=	O
(	O
int	O
)	O
(	O
diff	int
/	O
3600	int
)	O
;	O
diff	int
-=	O
3600	int
*	O
hours	int
;	O
minutes	int
=	O
(	O
int	O
)	O
(	O
diff	int
/	O
60	int
)	O
;	O
diff	int
-=	O
60	int
*	O
minutes	int
;	O
seconds	int
=	O
diff	int
;	O
if	O
(	O
days	int
)	O
{	O
if	O
(	O
print_seconds	int
)	O
(	O
void	O
)	O
snprintf	function
(	O
temp_str	array
,	O
sizeof	O
(	O
temp_str	array
)	O
,	O
"(%d+%02d:%02d:%02d)"	pointer
,	O
days	int
,	O
hours	int
,	O
minutes	int
,	O
seconds	int
)	O
;	O
else	O
(	O
void	O
)	O
snprintf	function
(	O
temp_str	array
,	O
sizeof	O
(	O
temp_str	array
)	O
,	O
"(%d+%02d:%02d)"	pointer
,	O
days	int
,	O
hours	int
,	O
minutes	int
)	O
;	O
}	O
else	O
{	O
if	O
(	O
print_seconds	int
)	O
(	O
void	O
)	O
snprintf	function
(	O
temp_str	array
,	O
sizeof	O
(	O
temp_str	array
)	O
,	O
" (%02d:%02d:%02d)"	pointer
,	O
hours	int
,	O
minutes	int
,	O
seconds	int
)	O
;	O
else	O
(	O
void	O
)	O
snprintf	function
(	O
temp_str	array
,	O
sizeof	O
(	O
temp_str	array
)	O
,	O
" (%02d:%02d)"	pointer
,	O
hours	int
,	O
minutes	int
)	O
;	O
}	O
if	O
(	O
use_last_event	int
)	O
{	O
if	O
(	O
last_event	pointer
==	O
NULL	O
)	O
(	O
void	O
)	O
fputs	function
(	O
"  still logged in\n"	pointer
,	O
stdout	pointer
)	O
;	O
else	O
(	O
void	O
)	O
printf	function
(	O
"- %-5.5s %s\n"	pointer
,	O
last_event	pointer
,	O
temp_str	array
)	O
;	O
}	O
else	O
{	O
struct	O
tm	struct
*	O
tmptr	pointer
;	O
time_t	long
temp_time	long
=	O
logout_time	long
;	O
tmptr	pointer
=	O
localtime	function
(	O
&	O
temp_time	long
)	O
;	O
if	O
(	O
print_seconds	int
)	O
printf	function
(	O
"- %02d:%02d:%02d %s\n"	pointer
,	O
tmptr	pointer
->	O
tm_hour	int
,	O
tmptr	pointer
->	O
tm_min	int
,	O
tmptr	pointer
->	O
tm_sec	int
,	O
temp_str	array
)	O
;	O
else	O
printf	function
(	O
"- %02d:%02d %s\n"	pointer
,	O
tmptr	pointer
->	O
tm_hour	int
,	O
tmptr	pointer
->	O
tm_min	int
,	O
temp_str	array
)	O
;	O
}	O
}	O
if	O
(	O
num_lines_to_print	long
>	O
-	O
1	int
)	O
{	O
num_lines_to_print	long
--	O
;	O
if	O
(	O
num_lines_to_print	long
==	O
0	int
)	O
exit	function
(	O
EXIT_SUCCESS	int
)	O
;	O
}	O
}	O
RETSIGTYPE	void
handler	function
(	O
int	O
sig	int
)	O
{	O
(	O
void	O
)	O
fputs	function
(	O
"\ninterrupted at "	pointer
,	O
stdout	pointer
)	O
;	O
display_date	function
(	O
last_time	long
)	O
;	O
(	O
void	O
)	O
putchar	function
(	O
'\n'	O
)	O
;	O
exit	function
(	O
EXIT_SUCCESS	int
)	O
;	O
}	O
void	O
display_date	function
(	O
time_t	long
now	long
)	O
{	O
char	O
*	O
ct	pointer
=	O
ctime	function
(	O
&	O
now	long
)	O
;	O
printf	function
(	O
"%-10.10s "	pointer
,	O
ct	pointer
)	O
;	O
if	O
(	O
print_year	int
)	O
printf	function
(	O
"%-4.4s "	pointer
,	O
ct	pointer
+	O
20	int
)	O
;	O
if	O
(	O
print_seconds	int
)	O
printf	function
(	O
"%-8.8s "	pointer
,	O
ct	pointer
+	O
11	int
)	O
;	O
else	O
printf	function
(	O
"%-5.5s "	pointer
,	O
ct	pointer
+	O
11	int
)	O
;	O
}	O
