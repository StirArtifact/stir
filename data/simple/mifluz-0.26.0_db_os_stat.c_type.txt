static	O
const	O
char	O
revid	array
[	O
]	O
=	O
"$Id: os_stat.c,v 1.4 2000/06/28 16:47:02 loic Exp $"	pointer
;	O
int	O
CDB___os_exists	function
(	O
path	pointer
,	O
isdirp	pointer
)	O
const	O
char	O
*	O
path	pointer
;	O
int	O
*	O
isdirp	pointer
;	O
{	O
struct	O
stat	struct
sb	struct
;	O
if	O
(	O
CDB___db_jump	struct
.	O
j_exists	pointer
!=	O
NULL	O
)	O
return	O
(	O
CDB___db_jump	struct
.	O
j_exists	pointer
(	O
path	pointer
,	O
isdirp	pointer
)	O
)	O
;	O
if	O
(	O
stat	struct
(	O
path	pointer
,	O
&	O
sb	struct
)	O
!=	O
0	int
)	O
return	O
(	O
CDB___os_get_errno	function
(	O
)	O
)	O
;	O
if	O
(	O
isdirp	pointer
!=	O
NULL	O
)	O
*	O
isdirp	pointer
=	O
S_ISDIR	O
(	O
sb	struct
.	O
st_mode	int
)	O
;	O
return	O
(	O
0	int
)	O
;	O
}	O
int	O
CDB___os_ioinfo	function
(	O
dbenv	pointer
,	O
path	pointer
,	O
fhp	pointer
,	O
mbytesp	pointer
,	O
bytesp	pointer
,	O
iosizep	pointer
)	O
DB_ENV	struct
*	O
dbenv	pointer
;	O
const	O
char	O
*	O
path	pointer
;	O
DB_FH	struct
*	O
fhp	pointer
;	O
u_int32_t	int
*	O
mbytesp	pointer
,	O
*	O
bytesp	pointer
,	O
*	O
iosizep	pointer
;	O
{	O
int	O
ret	int
;	O
struct	O
stat	struct
sb	struct
;	O
if	O
(	O
CDB___db_jump	struct
.	O
j_ioinfo	pointer
!=	O
NULL	O
)	O
return	O
(	O
CDB___db_jump	struct
.	O
j_ioinfo	pointer
(	O
path	pointer
,	O
fhp	pointer
->	O
fd	pointer
,	O
mbytesp	pointer
,	O
bytesp	pointer
,	O
iosizep	pointer
)	O
)	O
;	O
if	O
(	O
fstat	function
(	O
fhp	pointer
->	O
fd	pointer
,	O
&	O
sb	struct
)	O
==	O
-	O
1	int
)	O
{	O
ret	int
=	O
CDB___os_get_errno	function
(	O
)	O
;	O
CDB___db_err	function
(	O
dbenv	pointer
,	O
"fstat: %s"	pointer
,	O
strerror	function
(	O
ret	int
)	O
)	O
;	O
return	O
(	O
ret	int
)	O
;	O
}	O
if	O
(	O
mbytesp	pointer
!=	O
NULL	O
)	O
*	O
mbytesp	pointer
=	O
sb	struct
.	O
st_size	long
/	O
MEGABYTE	int
;	O
if	O
(	O
bytesp	pointer
!=	O
NULL	O
)	O
*	O
bytesp	pointer
=	O
sb	struct
.	O
st_size	long
%	O
MEGABYTE	int
;	O
if	O
(	O
iosizep	pointer
!=	O
NULL	O
)	O
*	O
iosizep	pointer
=	O
DB_DEF_IOSIZE	O
;	O
return	O
(	O
0	int
)	O
;	O
}	O
