void	O
gotox	function
(	O
FILE	struct
*	O
f	pointer
,	O
double	O
*	O
xold	pointer
,	O
double	O
xnew	double
)	O
{	O
double	O
delta	double
=	O
xnew	double
-	O
*	O
xold	pointer
;	O
if	O
(	O
delta	double
)	O
{	O
fprintf	function
(	O
f	pointer
,	O
"%c&a%+.0fH"	pointer
,	O
27	int
,	O
delta	double
*	O
10.0	int
)	O
;	O
}	O
*	O
xold	pointer
=	O
xnew	double
;	O
}	O
void	O
gotoy	function
(	O
FILE	struct
*	O
f	pointer
,	O
double	O
*	O
yold	pointer
,	O
double	O
ynew	double
)	O
{	O
double	O
delta	double
=	O
ynew	double
-	O
*	O
yold	pointer
;	O
if	O
(	O
delta	double
)	O
fprintf	function
(	O
f	pointer
,	O
"%c&a%+.0fV"	pointer
,	O
27	int
,	O
delta	double
*	O
10.0	int
)	O
;	O
*	O
yold	pointer
=	O
ynew	double
;	O
}	O
int	O
Barcode_pcl_print	function
(	O
struct	O
Barcode_Item	struct
*	O
bc	pointer
,	O
FILE	struct
*	O
f	pointer
)	O
{	O
int	O
i	int
,	O
j	int
,	O
barlen	int
;	O
double	O
f1	double
,	O
f2	double
,	O
fsav	double
=	O
0	int
;	O
int	O
mode	int
=	O
'-'	O
;	O
double	O
scalef	double
=	O
1	int
,	O
xpos	double
,	O
xabs	double
,	O
yabs	double
,	O
yr	double
;	O
double	O
textyoffset	double
;	O
char	O
*	O
ptr	pointer
;	O
char	O
c	char
;	O
char	O
font_id	array
[	O
6	int
]	O
;	O
if	O
(	O
!	O
bc	pointer
->	O
partial	pointer
||	O
!	O
bc	pointer
->	O
textinfo	pointer
)	O
{	O
bc	pointer
->	O
error	int
=	O
EINVAL	int
;	O
return	O
-	O
1	int
;	O
}	O
barlen	int
=	O
bc	pointer
->	O
partial	pointer
[	O
0	int
]	O
-	O
'0'	O
;	O
for	O
(	O
ptr	pointer
=	O
bc	pointer
->	O
partial	pointer
+	O
1	int
;	O
*	O
ptr	pointer
;	O
ptr	pointer
++	O
)	O
if	O
(	O
isdigit	function
(	O
*	O
ptr	pointer
)	O
)	O
barlen	int
+=	O
(	O
*	O
ptr	pointer
-	O
'0'	O
)	O
;	O
else	O
if	O
(	O
islower	function
(	O
*	O
ptr	pointer
)	O
)	O
barlen	int
+=	O
(	O
*	O
ptr	pointer
-	O
'a'	O
+	O
1	int
)	O
;	O
if	O
(	O
!	O
bc	pointer
->	O
scalef	double
)	O
{	O
if	O
(	O
!	O
bc	pointer
->	O
width	int
)	O
bc	pointer
->	O
width	int
=	O
barlen	int
;	O
scalef	double
=	O
bc	pointer
->	O
scalef	double
=	O
(	O
double	O
)	O
bc	pointer
->	O
width	int
/	O
(	O
double	O
)	O
barlen	int
;	O
}	O
if	O
(	O
!	O
bc	pointer
->	O
width	int
)	O
bc	pointer
->	O
width	int
=	O
barlen	int
*	O
scalef	double
+	O
1	int
;	O
if	O
(	O
bc	pointer
->	O
width	int
<	O
barlen	int
*	O
scalef	double
)	O
{	O
int	O
wid	int
=	O
barlen	int
*	O
scalef	double
+	O
1	int
;	O
bc	pointer
->	O
xoff	int
-=	O
(	O
wid	int
-	O
bc	pointer
->	O
width	int
)	O
/	O
2	int
;	O
bc	pointer
->	O
width	int
=	O
wid	int
;	O
if	O
(	O
bc	pointer
->	O
xoff	int
<	O
0	int
)	O
{	O
bc	pointer
->	O
width	int
+=	O
-	O
bc	pointer
->	O
xoff	int
;	O
bc	pointer
->	O
xoff	int
=	O
0	int
;	O
}	O
}	O
if	O
(	O
!	O
bc	pointer
->	O
height	int
)	O
bc	pointer
->	O
height	int
=	O
80	int
*	O
scalef	double
;	O
i	int
=	O
5	int
+	O
10	int
*	O
(	O
(	O
bc	pointer
->	O
flags	int
&	O
BARCODE_NO_ASCII	int
)	O
==	O
0	int
)	O
;	O
if	O
(	O
bc	pointer
->	O
height	int
<	O
i	int
*	O
scalef	double
)	O
{	O
double	O
scaleg	double
=	O
(	O
(	O
double	O
)	O
bc	pointer
->	O
height	int
)	O
/	O
i	int
;	O
int	O
wid	int
=	O
bc	pointer
->	O
width	int
*	O
scaleg	double
/	O
scalef	double
;	O
bc	pointer
->	O
xoff	int
+=	O
(	O
bc	pointer
->	O
width	int
-	O
wid	int
)	O
/	O
2	int
;	O
bc	pointer
->	O
width	int
=	O
wid	int
;	O
scalef	double
=	O
scaleg	double
;	O
}	O
textyoffset	double
=	O
(	O
mode	int
!=	O
'-'	O
?	O
(	O
(	O
double	O
)	O
8	int
*	O
scalef	double
)	O
:	O
(	O
(	O
double	O
)	O
bc	pointer
->	O
height	int
)	O
)	O
;	O
xabs	double
=	O
-	O
bc	pointer
->	O
xoff	int
;	O
yabs	double
=	O
-	O
bc	pointer
->	O
yoff	int
;	O
if	O
(	O
!	O
streaming	int
)	O
{	O
fprintf	function
(	O
f	pointer
,	O
"%c&a0H"	pointer
,	O
27	int
)	O
;	O
fprintf	function
(	O
f	pointer
,	O
"%c&a0V"	pointer
,	O
27	int
)	O
;	O
}	O
xpos	double
=	O
bc	pointer
->	O
margin	int
+	O
(	O
bc	pointer
->	O
partial	pointer
[	O
0	int
]	O
-	O
'0'	O
)	O
*	O
scalef	double
;	O
for	O
(	O
ptr	pointer
=	O
bc	pointer
->	O
partial	pointer
+	O
1	int
,	O
i	int
=	O
1	int
;	O
*	O
ptr	pointer
;	O
ptr	pointer
++	O
,	O
i	int
++	O
)	O
{	O
double	O
x0	double
,	O
y0	double
;	O
if	O
(	O
*	O
ptr	pointer
==	O
'+'	O
||	O
*	O
ptr	pointer
==	O
'-'	O
)	O
{	O
mode	int
=	O
*	O
ptr	pointer
;	O
i	int
++	O
;	O
continue	O
;	O
}	O
if	O
(	O
isdigit	function
(	O
*	O
ptr	pointer
)	O
)	O
j	int
=	O
*	O
ptr	pointer
-	O
'0'	O
;	O
else	O
j	int
=	O
*	O
ptr	pointer
-	O
'a'	O
+	O
1	int
;	O
if	O
(	O
i	int
%	O
2	int
)	O
{	O
x0	double
=	O
xpos	double
+	O
SHRINK_AMOUNT	int
/	O
2.0	int
;	O
y0	double
=	O
0	int
;	O
yr	double
=	O
bc	pointer
->	O
height	int
;	O
if	O
(	O
!	O
(	O
bc	pointer
->	O
flags	int
&	O
BARCODE_NO_ASCII	int
)	O
)	O
{	O
if	O
(	O
mode	int
==	O
'-'	O
)	O
{	O
yr	double
-=	O
(	O
isdigit	function
(	O
*	O
ptr	pointer
)	O
?	O
10	int
:	O
5	int
)	O
*	O
scalef	double
;	O
}	O
else	O
{	O
y0	double
+=	O
(	O
isdigit	function
(	O
*	O
ptr	pointer
)	O
?	O
10	int
:	O
0	int
)	O
*	O
scalef	double
;	O
yr	double
-=	O
(	O
isdigit	function
(	O
*	O
ptr	pointer
)	O
?	O
20	int
:	O
10	int
)	O
*	O
scalef	double
;	O
}	O
}	O
gotox	function
(	O
f	pointer
,	O
&	O
xabs	double
,	O
x0	double
)	O
;	O
if	O
(	O
streaming	int
)	O
gotoy	function
(	O
f	pointer
,	O
&	O
yabs	double
,	O
y0	double
-	O
textyoffset	double
)	O
;	O
else	O
gotoy	function
(	O
f	pointer
,	O
&	O
yabs	double
,	O
y0	double
)	O
;	O
fprintf	function
(	O
f	pointer
,	O
"%c*c%.1fH"	pointer
,	O
27	int
,	O
(	O
(	O
j	int
*	O
scalef	double
)	O
-	O
SHRINK_AMOUNT	int
)	O
*	O
10.0	int
)	O
;	O
fprintf	function
(	O
f	pointer
,	O
"%c*c%.1fV"	pointer
,	O
27	int
,	O
yr	double
*	O
10.0	int
)	O
;	O
fprintf	function
(	O
f	pointer
,	O
"%c*c0P"	pointer
,	O
27	int
)	O
;	O
}	O
xpos	double
+=	O
j	int
*	O
scalef	double
;	O
}	O
if	O
(	O
streaming	int
)	O
gotoy	function
(	O
f	pointer
,	O
&	O
yabs	double
,	O
0	int
)	O
;	O
else	O
gotoy	function
(	O
f	pointer
,	O
&	O
yabs	double
,	O
textyoffset	double
)	O
;	O
mode	int
=	O
'-'	O
;	O
if	O
(	O
!	O
(	O
bc	pointer
->	O
flags	int
&	O
BARCODE_NO_ASCII	int
)	O
)	O
{	O
for	O
(	O
ptr	pointer
=	O
bc	pointer
->	O
textinfo	pointer
;	O
ptr	pointer
;	O
ptr	pointer
=	O
strchr	function
(	O
ptr	pointer
,	O
' '	O
)	O
)	O
{	O
while	O
(	O
*	O
ptr	pointer
==	O
' '	O
)	O
ptr	pointer
++	O
;	O
if	O
(	O
!	O
*	O
ptr	pointer
)	O
break	O
;	O
if	O
(	O
*	O
ptr	pointer
==	O
'+'	O
||	O
*	O
ptr	pointer
==	O
'-'	O
)	O
{	O
mode	int
=	O
*	O
ptr	pointer
;	O
continue	O
;	O
}	O
if	O
(	O
sscanf	function
(	O
ptr	pointer
,	O
"%lf:%lf:%c"	pointer
,	O
&	O
f1	double
,	O
&	O
f2	double
,	O
&	O
c	char
)	O
!=	O
3	int
)	O
{	O
fprintf	function
(	O
stderr	pointer
,	O
_	O
(	O
"barcode: impossible data: %s\n"	pointer
)	O
,	O
ptr	pointer
)	O
;	O
continue	O
;	O
}	O
if	O
(	O
fsav	double
!=	O
f2	double
&&	O
!	O
streaming	int
)	O
{	O
if	O
(	O
(	O
bc	pointer
->	O
flags	int
&	O
BARCODE_OUT_PCL_III	int
)	O
==	O
BARCODE_OUT_PCL_III	int
)	O
strcpy	function
(	O
font_id	array
,	O
"4148"	pointer
)	O
;	O
else	O
strcpy	function
(	O
font_id	array
,	O
"16602"	pointer
)	O
;	O
fprintf	function
(	O
f	pointer
,	O
"%c(8U"	pointer
,	O
27	int
)	O
;	O
fprintf	function
(	O
f	pointer
,	O
"%c(s1p%5.2fv0s0b%sT"	pointer
,	O
27	int
,	O
f2	double
*	O
scalef	double
,	O
font_id	array
)	O
;	O
}	O
fsav	double
=	O
f2	double
;	O
gotox	function
(	O
f	pointer
,	O
&	O
xabs	double
,	O
f1	double
*	O
scalef	double
+	O
bc	pointer
->	O
margin	int
)	O
;	O
fprintf	function
(	O
f	pointer
,	O
"%c%c&a180P%c*vo1T%c%c&a0P%c*v1oT"	pointer
,	O
c	char
,	O
27	int
,	O
27	int
,	O
c	char
,	O
27	int
,	O
27	int
)	O
;	O
}	O
}	O
if	O
(	O
streaming	int
)	O
{	O
gotox	function
(	O
f	pointer
,	O
&	O
xabs	double
,	O
xpos	double
+	O
bc	pointer
->	O
margin	int
)	O
;	O
gotoy	function
(	O
f	pointer
,	O
&	O
yabs	double
,	O
-	O
bc	pointer
->	O
yoff	int
)	O
;	O
}	O
return	O
0	int
;	O
}	O
