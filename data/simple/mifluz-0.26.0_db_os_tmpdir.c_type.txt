static	O
const	O
char	O
revid	array
[	O
]	O
=	O
"$Id: os_tmpdir.c,v 1.3 2000/06/28 16:47:02 loic Exp $"	pointer
;	O
int	O
CDB___os_tmpdir	function
(	O
dbenv	pointer
,	O
flags	int
)	O
DB_ENV	struct
*	O
dbenv	pointer
;	O
u_int32_t	int
flags	int
;	O
{	O
static	O
const	O
char	O
*	O
list	array
[	O
]	O
=	O
{	O
"/var/tmp"	pointer
,	O
"/usr/tmp"	pointer
,	O
"/temp"	pointer
,	O
"/tmp"	pointer
,	O
"C:/temp"	pointer
,	O
"C:/tmp"	pointer
,	O
NULL	O
}	O
;	O
const	O
char	O
*	O
const	O
*	O
lp	pointer
,	O
*	O
p	pointer
;	O
if	O
(	O
LF_ISSET	O
(	O
DB_USE_ENVIRON	int
)	O
||	O
(	O
LF_ISSET	O
(	O
DB_USE_ENVIRON_ROOT	int
)	O
&&	O
CDB___os_isroot	function
(	O
)	O
==	O
0	int
)	O
)	O
{	O
if	O
(	O
(	O
p	pointer
=	O
getenv	function
(	O
"TMPDIR"	pointer
)	O
)	O
!=	O
NULL	O
&&	O
p	pointer
[	O
0	int
]	O
==	O
'\0'	O
)	O
{	O
CDB___db_err	function
(	O
dbenv	pointer
,	O
"illegal TMPDIR environment variable"	pointer
)	O
;	O
return	O
(	O
EINVAL	int
)	O
;	O
}	O
if	O
(	O
p	pointer
==	O
NULL	O
&&	O
(	O
p	pointer
=	O
getenv	function
(	O
"TEMP"	pointer
)	O
)	O
!=	O
NULL	O
&&	O
p	pointer
[	O
0	int
]	O
==	O
'\0'	O
)	O
{	O
CDB___db_err	function
(	O
dbenv	pointer
,	O
"illegal TEMP environment variable"	pointer
)	O
;	O
return	O
(	O
EINVAL	int
)	O
;	O
}	O
if	O
(	O
p	pointer
==	O
NULL	O
&&	O
(	O
p	pointer
=	O
getenv	function
(	O
"TMP"	pointer
)	O
)	O
!=	O
NULL	O
&&	O
p	pointer
[	O
0	int
]	O
==	O
'\0'	O
)	O
{	O
CDB___db_err	function
(	O
dbenv	pointer
,	O
"illegal TMP environment variable"	pointer
)	O
;	O
return	O
(	O
EINVAL	int
)	O
;	O
}	O
if	O
(	O
p	pointer
==	O
NULL	O
&&	O
(	O
p	pointer
=	O
getenv	function
(	O
"TempFolder"	pointer
)	O
)	O
!=	O
NULL	O
&&	O
p	pointer
[	O
0	int
]	O
==	O
'\0'	O
)	O
{	O
CDB___db_err	function
(	O
dbenv	pointer
,	O
"illegal TempFolder environment variable"	pointer
)	O
;	O
return	O
(	O
EINVAL	int
)	O
;	O
}	O
if	O
(	O
p	pointer
!=	O
NULL	O
)	O
return	O
(	O
CDB___os_strdup	function
(	O
dbenv	pointer
,	O
p	pointer
,	O
&	O
dbenv	pointer
->	O
db_tmp_dir	pointer
)	O
)	O
;	O
}	O
for	O
(	O
lp	pointer
=	O
list	array
;	O
*	O
lp	pointer
!=	O
NULL	O
;	O
++	O
lp	pointer
)	O
if	O
(	O
CDB___os_exists	function
(	O
*	O
lp	pointer
,	O
NULL	O
)	O
==	O
0	int
)	O
return	O
(	O
CDB___os_strdup	function
(	O
dbenv	pointer
,	O
*	O
lp	pointer
,	O
&	O
dbenv	pointer
->	O
db_tmp_dir	pointer
)	O
)	O
;	O
return	O
(	O
0	int
)	O
;	O
}	O
