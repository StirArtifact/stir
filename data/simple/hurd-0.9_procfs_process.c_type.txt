static	O
char	O
state_char	function
(	O
struct	O
proc_stat	O
*	O
ps	pointer
)	O
{	O
int	O
i	int
;	O
for	O
(	O
i	int
=	O
0	int
;	O
(	O
1	int
<<	O
i	int
)	O
&	O
(	O
PSTAT_STATE_P_STATES	O
|	O
PSTAT_STATE_T_STATES	O
)	O
;	O
i	int
++	O
)	O
if	O
(	O
proc_stat_state	function
(	O
ps	pointer
)	O
&	O
(	O
1	int
<<	O
i	int
)	O
)	O
return	O
proc_stat_state_tags	O
[	O
i	int
]	O
;	O
return	O
'?'	O
;	O
}	O
static	O
const	O
char	O
*	O
state_string	function
(	O
struct	O
proc_stat	O
*	O
ps	pointer
)	O
{	O
static	O
const	O
char	O
*	O
const	O
state_strings	array
[	O
]	O
=	O
{	O
"T (stopped)"	pointer
,	O
"Z (zombie)"	pointer
,	O
"R (running)"	pointer
,	O
"H (halted)"	pointer
,	O
"D (disk sleep)"	pointer
,	O
"S (sleeping)"	pointer
,	O
"I (idle)"	pointer
,	O
NULL	O
}	O
;	O
int	O
i	int
;	O
for	O
(	O
i	int
=	O
0	int
;	O
state_strings	array
[	O
i	int
]	O
;	O
i	int
++	O
)	O
if	O
(	O
proc_stat_state	function
(	O
ps	pointer
)	O
&	O
(	O
1	int
<<	O
i	int
)	O
)	O
return	O
state_strings	array
[	O
i	int
]	O
;	O
return	O
"? (unknown)"	pointer
;	O
}	O
static	O
long	O
long	O
int	O
timeval_jiffies	function
(	O
time_value_t	O
tv	int
)	O
{	O
double	O
secs	double
=	O
tv	int
.	O
seconds	O
*	O
1000000.	int
+	O
tv	int
.	O
microseconds	O
;	O
return	O
secs	double
*	O
opt_clk_tck	O
/	O
1000000.	int
;	O
}	O
static	O
const	O
char	O
*	O
args_filename	function
(	O
const	O
char	O
*	O
name	pointer
)	O
{	O
char	O
*	O
sp	pointer
=	O
strrchr	O
(	O
name	pointer
,	O
'/'	O
)	O
;	O
return	O
sp	pointer
!=	O
NULL	O
&&	O
*	O
(	O
sp	pointer
+	O
1	int
)	O
!=	O
'\0'	O
?	O
sp	pointer
+	O
1	int
:	O
name	pointer
;	O
}	O
static	O
int	O
args_filename_length	function
(	O
const	O
char	O
*	O
name	pointer
)	O
{	O
return	O
strchrnul	function
(	O
name	pointer
,	O
' '	O
)	O
-	O
name	pointer
;	O
}	O
static	O
ssize_t	long
process_file_gc_cmdline	function
(	O
struct	O
proc_stat	O
*	O
ps	pointer
,	O
char	O
*	O
*	O
contents	pointer
)	O
{	O
*	O
contents	pointer
=	O
proc_stat_args	function
(	O
ps	pointer
)	O
;	O
return	O
proc_stat_args_len	function
(	O
ps	pointer
)	O
;	O
}	O
static	O
ssize_t	long
process_file_gc_environ	function
(	O
struct	O
proc_stat	O
*	O
ps	pointer
,	O
char	O
*	O
*	O
contents	pointer
)	O
{	O
*	O
contents	pointer
=	O
proc_stat_env	function
(	O
ps	pointer
)	O
;	O
return	O
proc_stat_env_len	function
(	O
ps	pointer
)	O
;	O
}	O
static	O
ssize_t	long
process_file_gc_maps	function
(	O
struct	O
proc_stat	O
*	O
ps	pointer
,	O
char	O
*	O
*	O
contents	pointer
)	O
{	O
error_t	O
err	O
;	O
FILE	struct
*	O
s	pointer
;	O
size_t	long
contents_len	long
;	O
vm_offset_t	O
addr	O
=	O
0	int
;	O
vm_size_t	O
size	O
;	O
vm_prot_t	O
prot	O
,	O
max_prot	O
;	O
mach_port_t	O
obj	O
;	O
vm_offset_t	O
offs	O
;	O
vm_inherit_t	O
inh	O
;	O
int	O
shared	int
;	O
struct	O
mem_obj	struct
{	O
mach_port_t	O
port	int
;	O
struct	O
mem_obj	struct
*	O
next	pointer
;	O
}	O
;	O
struct	O
mem_obj	struct
*	O
objects	pointer
=	O
NULL	O
;	O
s	pointer
=	O
open_memstream	function
(	O
contents	pointer
,	O
&	O
contents_len	long
)	O
;	O
if	O
(	O
s	pointer
==	O
NULL	O
)	O
{	O
*	O
contents	pointer
=	O
NULL	O
;	O
return	O
0	int
;	O
}	O
while	O
(	O
1	int
)	O
{	O
err	O
=	O
vm_region	function
(	O
ps	pointer
->	O
task	O
,	O
&	O
addr	O
,	O
&	O
size	O
,	O
&	O
prot	O
,	O
&	O
max_prot	O
,	O
&	O
inh	O
,	O
&	O
shared	int
,	O
&	O
obj	O
,	O
&	O
offs	O
)	O
;	O
if	O
(	O
err	O
)	O
break	O
;	O
fprintf	function
(	O
s	pointer
,	O
"%0*lx-%0*lx %c%c%c%c %0*lx %s %d "	pointer
,	O
2	int
*	O
sizeof	O
s	pointer
,	O
addr	O
,	O
2	int
*	O
sizeof	O
s	pointer
,	O
addr	O
+	O
size	O
,	O
prot	O
&	O
VM_PROT_READ	O
?	O
'r'	O
:	O
'-'	O
,	O
prot	O
&	O
VM_PROT_WRITE	O
?	O
'w'	O
:	O
'-'	O
,	O
prot	O
&	O
VM_PROT_EXECUTE	O
?	O
'x'	O
:	O
'-'	O
,	O
shared	int
?	O
's'	O
:	O
'p'	O
,	O
2	int
*	O
sizeof	O
s	pointer
,	O
offs	O
,	O
"00:00"	pointer
,	O
0	int
)	O
;	O
if	O
(	O
MACH_PORT_VALID	function
(	O
obj	O
)	O
)	O
{	O
struct	O
mem_obj	struct
*	O
o	pointer
=	O
malloc	function
(	O
sizeof	O
*	O
o	pointer
)	O
;	O
if	O
(	O
o	pointer
)	O
{	O
o	pointer
->	O
port	int
=	O
obj	O
;	O
o	pointer
->	O
next	pointer
=	O
objects	pointer
;	O
objects	pointer
=	O
o	pointer
;	O
}	O
else	O
mach_port_deallocate	function
(	O
mach_task_self	function
(	O
)	O
,	O
obj	O
)	O
;	O
fprintf	function
(	O
s	pointer
,	O
"[mem_obj=%lu]\n"	pointer
,	O
obj	O
)	O
;	O
}	O
else	O
fprintf	function
(	O
s	pointer
,	O
"\n"	pointer
)	O
;	O
addr	O
+=	O
size	O
;	O
}	O
while	O
(	O
objects	pointer
)	O
{	O
struct	O
mem_obj	struct
*	O
o	pointer
=	O
objects	pointer
;	O
mach_port_deallocate	function
(	O
mach_task_self	function
(	O
)	O
,	O
o	pointer
->	O
port	int
)	O
;	O
objects	pointer
=	O
o	pointer
->	O
next	pointer
;	O
free	function
(	O
o	pointer
)	O
;	O
}	O
if	O
(	O
err	O
!=	O
KERN_NO_SPACE	O
)	O
fprintf	function
(	O
s	pointer
,	O
"%s\n"	pointer
,	O
strerror	O
(	O
err	O
)	O
)	O
;	O
fclose	function
(	O
s	pointer
)	O
;	O
return	O
contents_len	long
;	O
}	O
static	O
ssize_t	long
process_file_gc_stat	function
(	O
struct	O
proc_stat	O
*	O
ps	pointer
,	O
char	O
*	O
*	O
contents	pointer
)	O
{	O
struct	O
procinfo	O
*	O
pi	pointer
=	O
proc_stat_proc_info	function
(	O
ps	pointer
)	O
;	O
task_basic_info_t	O
tbi	O
=	O
proc_stat_task_basic_info	O
(	O
ps	pointer
)	O
;	O
thread_basic_info_t	O
thbi	O
=	O
proc_stat_thread_basic_info	O
(	O
ps	pointer
)	O
;	O
const	O
char	O
*	O
fn	pointer
=	O
args_filename	function
(	O
proc_stat_args	function
(	O
ps	pointer
)	O
)	O
;	O
vm_address_t	O
start_code	O
=	O
1	int
;	O
vm_address_t	O
end_code	O
=	O
1	int
;	O
process_t	O
p	O
;	O
error_t	O
err	O
=	O
proc_pid2proc	O
(	O
ps	pointer
->	O
context	O
->	O
server	O
,	O
ps	pointer
->	O
pid	int
,	O
&	O
p	O
)	O
;	O
if	O
(	O
!	O
err	O
)	O
{	O
boolean_t	O
essential	O
=	O
0	int
;	O
proc_is_important	function
(	O
p	O
,	O
&	O
essential	O
)	O
;	O
if	O
(	O
essential	O
)	O
start_code	O
=	O
end_code	O
=	O
0	int
;	O
else	O
proc_get_code	function
(	O
p	O
,	O
&	O
start_code	O
,	O
&	O
end_code	O
)	O
;	O
mach_port_deallocate	function
(	O
mach_task_self	function
(	O
)	O
,	O
p	O
)	O
;	O
}	O
return	O
asprintf	function
(	O
contents	pointer
,	O
"%d (%.*s) %c "	pointer
"%d %d %d "	pointer
"%d %d "	pointer
"%u "	pointer
"%lu %lu %lu %lu "	pointer
"%lu %lu %ld %ld "	pointer
"%d %d "	pointer
"%d %ld "	pointer
"%llu "	pointer
"%lu %ld %lu "	pointer
"%lu %lu %lu %lu %lu "	pointer
"%lu %lu %lu %lu "	pointer
"%lu "	pointer
"%lu %lu "	pointer
"%d "	pointer
"%d "	pointer
"%u %u "	pointer
"%llu "	pointer
"\n"	pointer
,	O
proc_stat_pid	function
(	O
ps	pointer
)	O
,	O
args_filename_length	function
(	O
fn	pointer
)	O
,	O
fn	pointer
,	O
state_char	function
(	O
ps	pointer
)	O
,	O
pi	pointer
->	O
ppid	O
,	O
pi	pointer
->	O
pgrp	O
,	O
pi	pointer
->	O
session	O
,	O
0	int
,	O
0	int
,	O
0	int
,	O
0L	int
,	O
0L	int
,	O
0L	int
,	O
0L	int
,	O
(	O
long	O
unsigned	O
)	O
timeval_jiffies	function
(	O
thbi	O
->	O
user_time	O
)	O
,	O
(	O
long	O
unsigned	O
)	O
timeval_jiffies	function
(	O
thbi	O
->	O
system_time	O
)	O
,	O
0L	int
,	O
0L	int
,	O
MACH_PRIORITY_TO_NICE	function
(	O
thbi	O
->	O
base_priority	O
)	O
+	O
20	int
,	O
MACH_PRIORITY_TO_NICE	function
(	O
thbi	O
->	O
base_priority	O
)	O
,	O
pi	pointer
->	O
nthreads	O
,	O
0L	int
,	O
timeval_jiffies	function
(	O
thbi	O
->	O
creation_time	O
)	O
,	O
(	O
long	O
unsigned	O
)	O
tbi	O
->	O
virtual_size	O
,	O
(	O
long	O
unsigned	O
)	O
tbi	O
->	O
resident_size	O
/	O
PAGE_SIZE	O
,	O
0L	int
,	O
start_code	O
,	O
end_code	O
,	O
0L	int
,	O
0L	int
,	O
0L	int
,	O
0L	int
,	O
0L	int
,	O
0L	int
,	O
0L	int
,	O
(	O
long	O
unsigned	O
)	O
proc_stat_thread_rpc	function
(	O
ps	pointer
)	O
,	O
0L	int
,	O
0L	int
,	O
0	int
,	O
0	int
,	O
0	int
,	O
0	int
,	O
0LL	int
)	O
;	O
}	O
static	O
ssize_t	long
process_file_gc_statm	function
(	O
struct	O
proc_stat	O
*	O
ps	pointer
,	O
char	O
*	O
*	O
contents	pointer
)	O
{	O
task_basic_info_t	O
tbi	O
=	O
proc_stat_task_basic_info	O
(	O
ps	pointer
)	O
;	O
return	O
asprintf	function
(	O
contents	pointer
,	O
"%lu %lu 0 0 0 0 0\n"	pointer
,	O
tbi	O
->	O
virtual_size	O
/	O
sysconf	function
(	O
_SC_PAGE_SIZE	O
)	O
,	O
tbi	O
->	O
resident_size	O
/	O
sysconf	function
(	O
_SC_PAGE_SIZE	O
)	O
)	O
;	O
}	O
static	O
ssize_t	long
process_file_gc_status	function
(	O
struct	O
proc_stat	O
*	O
ps	pointer
,	O
char	O
*	O
*	O
contents	pointer
)	O
{	O
task_basic_info_t	O
tbi	O
=	O
proc_stat_task_basic_info	O
(	O
ps	pointer
)	O
;	O
const	O
char	O
*	O
fn	pointer
=	O
args_filename	function
(	O
proc_stat_args	function
(	O
ps	pointer
)	O
)	O
;	O
return	O
asprintf	function
(	O
contents	pointer
,	O
"Name:\t%.*s\n"	pointer
"State:\t%s\n"	pointer
"Tgid:\t%u\n"	pointer
"Pid:\t%u\n"	pointer
"PPid:\t%u\n"	pointer
"Uid:\t%u\t%u\t%u\t%u\n"	pointer
"VmSize:\t%8u kB\n"	pointer
"VmPeak:\t%8u kB\n"	pointer
"VmRSS:\t%8u kB\n"	pointer
"VmHWM:\t%8u kB\n"	pointer
"Threads:\t%u\n"	pointer
,	O
args_filename_length	function
(	O
fn	pointer
)	O
,	O
fn	pointer
,	O
state_string	function
(	O
ps	pointer
)	O
,	O
proc_stat_pid	function
(	O
ps	pointer
)	O
,	O
proc_stat_pid	function
(	O
ps	pointer
)	O
,	O
proc_stat_proc_info	function
(	O
ps	pointer
)	O
->	O
ppid	O
,	O
proc_stat_owner_uid	function
(	O
ps	pointer
)	O
,	O
proc_stat_owner_uid	function
(	O
ps	pointer
)	O
,	O
proc_stat_owner_uid	function
(	O
ps	pointer
)	O
,	O
proc_stat_owner_uid	function
(	O
ps	pointer
)	O
,	O
tbi	O
->	O
virtual_size	O
/	O
1024	int
,	O
tbi	O
->	O
virtual_size	O
/	O
1024	int
,	O
tbi	O
->	O
resident_size	O
/	O
1024	int
,	O
tbi	O
->	O
resident_size	O
/	O
1024	int
,	O
proc_stat_num_threads	function
(	O
ps	pointer
)	O
)	O
;	O
}	O
struct	O
process_file_desc	struct
{	O
ps_flags_t	O
needs	int
;	O
ssize_t	long
(	O
*	O
get_contents	pointer
)	O
(	O
struct	O
proc_stat	O
*	O
ps	pointer
,	O
char	O
*	O
*	O
contents	pointer
)	O
;	O
int	O
no_cleanup	int
;	O
mode_t	int
mode	int
;	O
}	O
;	O
struct	O
process_file_node	struct
{	O
const	O
struct	O
process_file_desc	struct
*	O
desc	pointer
;	O
struct	O
proc_stat	O
*	O
ps	pointer
;	O
}	O
;	O
static	O
error_t	O
process_file_get_contents	function
(	O
void	O
*	O
hook	pointer
,	O
char	O
*	O
*	O
contents	pointer
,	O
ssize_t	long
*	O
contents_len	long
)	O
{	O
struct	O
process_file_node	struct
*	O
file	pointer
=	O
hook	pointer
;	O
error_t	O
err	O
;	O
err	O
=	O
proc_stat_set_flags	function
(	O
file	pointer
->	O
ps	pointer
,	O
file	pointer
->	O
desc	pointer
->	O
needs	int
)	O
;	O
if	O
(	O
err	O
)	O
return	O
EIO	O
;	O
if	O
(	O
(	O
proc_stat_flags	function
(	O
file	pointer
->	O
ps	pointer
)	O
&	O
file	pointer
->	O
desc	pointer
->	O
needs	int
)	O
!=	O
file	pointer
->	O
desc	pointer
->	O
needs	int
)	O
return	O
EIO	O
;	O
*	O
contents_len	long
=	O
file	pointer
->	O
desc	pointer
->	O
get_contents	pointer
(	O
file	pointer
->	O
ps	pointer
,	O
contents	pointer
)	O
;	O
return	O
0	int
;	O
}	O
static	O
void	O
process_file_cleanup_contents	function
(	O
void	O
*	O
hook	pointer
,	O
char	O
*	O
contents	pointer
,	O
ssize_t	long
len	long
)	O
{	O
struct	O
process_file_node	struct
*	O
file	pointer
=	O
hook	pointer
;	O
if	O
(	O
!	O
file	pointer
->	O
desc	pointer
->	O
no_cleanup	int
)	O
free	function
(	O
contents	pointer
)	O
;	O
}	O
static	O
struct	O
node	O
*	O
process_file_make_node	function
(	O
void	O
*	O
dir_hook	pointer
,	O
const	O
void	O
*	O
entry_hook	pointer
)	O
{	O
static	O
const	O
struct	O
procfs_node_ops	O
ops	struct
=	O
{	O
.	O
get_contents	pointer
=	O
process_file_get_contents	function
,	O
.	O
cleanup_contents	O
=	O
process_file_cleanup_contents	function
,	O
.	O
cleanup	O
=	O
free	function
,	O
}	O
;	O
struct	O
process_file_node	struct
*	O
f	pointer
;	O
struct	O
node	O
*	O
np	pointer
;	O
f	pointer
=	O
malloc	function
(	O
sizeof	O
*	O
f	pointer
)	O
;	O
if	O
(	O
!	O
f	pointer
)	O
return	O
NULL	O
;	O
f	pointer
->	O
desc	pointer
=	O
entry_hook	pointer
;	O
f	pointer
->	O
ps	pointer
=	O
dir_hook	pointer
;	O
np	pointer
=	O
procfs_make_node	function
(	O
&	O
ops	struct
,	O
f	pointer
)	O
;	O
if	O
(	O
!	O
np	pointer
)	O
return	O
NULL	O
;	O
procfs_node_chown	function
(	O
np	pointer
,	O
proc_stat_owner_uid	function
(	O
f	pointer
->	O
ps	pointer
)	O
)	O
;	O
if	O
(	O
f	pointer
->	O
desc	pointer
->	O
mode	int
)	O
procfs_node_chmod	function
(	O
np	pointer
,	O
f	pointer
->	O
desc	pointer
->	O
mode	int
)	O
;	O
return	O
np	pointer
;	O
}	O
static	O
struct	O
node	O
*	O
process_stat_make_node	function
(	O
void	O
*	O
dir_hook	pointer
,	O
const	O
void	O
*	O
entry_hook	pointer
)	O
{	O
struct	O
node	O
*	O
np	pointer
=	O
process_file_make_node	function
(	O
dir_hook	pointer
,	O
entry_hook	pointer
)	O
;	O
if	O
(	O
np	pointer
)	O
procfs_node_chmod	function
(	O
np	pointer
,	O
opt_stat_mode	O
)	O
;	O
return	O
np	pointer
;	O
}	O
static	O
struct	O
procfs_dir_entry	O
entries	int
[	O
]	O
=	O
{	O
{	O
.	O
name	pointer
=	O
"cmdline"	pointer
,	O
.	O
hook	pointer
=	O
&	O
(	O
struct	O
process_file_desc	struct
)	O
{	O
.	O
get_contents	pointer
=	O
process_file_gc_cmdline	function
,	O
.	O
needs	int
=	O
PSTAT_ARGS	O
,	O
.	O
no_cleanup	int
=	O
1	int
,	O
}	O
,	O
}	O
,	O
{	O
.	O
name	pointer
=	O
"environ"	pointer
,	O
.	O
hook	pointer
=	O
&	O
(	O
struct	O
process_file_desc	struct
)	O
{	O
.	O
get_contents	pointer
=	O
process_file_gc_environ	function
,	O
.	O
needs	int
=	O
PSTAT_ENV	O
,	O
.	O
no_cleanup	int
=	O
1	int
,	O
.	O
mode	int
=	O
0400	int
,	O
}	O
,	O
}	O
,	O
{	O
.	O
name	pointer
=	O
"maps"	pointer
,	O
.	O
hook	pointer
=	O
&	O
(	O
struct	O
process_file_desc	struct
)	O
{	O
.	O
get_contents	pointer
=	O
process_file_gc_maps	function
,	O
.	O
needs	int
=	O
PSTAT_TASK	O
,	O
.	O
mode	int
=	O
0400	int
,	O
}	O
,	O
}	O
,	O
{	O
.	O
name	pointer
=	O
"stat"	pointer
,	O
.	O
hook	pointer
=	O
&	O
(	O
struct	O
process_file_desc	struct
)	O
{	O
.	O
get_contents	pointer
=	O
process_file_gc_stat	function
,	O
.	O
needs	int
=	O
PSTAT_PID	O
|	O
PSTAT_ARGS	O
|	O
PSTAT_STATE	O
|	O
PSTAT_PROC_INFO	O
|	O
PSTAT_TASK	O
|	O
PSTAT_TASK_BASIC	O
|	O
PSTAT_THREAD_BASIC	O
|	O
PSTAT_THREAD_WAIT	O
,	O
}	O
,	O
.	O
ops	struct
=	O
{	O
.	O
make_node	O
=	O
process_stat_make_node	function
,	O
}	O
}	O
,	O
{	O
.	O
name	pointer
=	O
"statm"	pointer
,	O
.	O
hook	pointer
=	O
&	O
(	O
struct	O
process_file_desc	struct
)	O
{	O
.	O
get_contents	pointer
=	O
process_file_gc_statm	function
,	O
.	O
needs	int
=	O
PSTAT_TASK_BASIC	O
,	O
}	O
,	O
}	O
,	O
{	O
.	O
name	pointer
=	O
"status"	pointer
,	O
.	O
hook	pointer
=	O
&	O
(	O
struct	O
process_file_desc	struct
)	O
{	O
.	O
get_contents	pointer
=	O
process_file_gc_status	function
,	O
.	O
needs	int
=	O
PSTAT_PID	O
|	O
PSTAT_ARGS	O
|	O
PSTAT_STATE	O
|	O
PSTAT_PROC_INFO	O
|	O
PSTAT_TASK_BASIC	O
|	O
PSTAT_OWNER_UID	O
|	O
PSTAT_NUM_THREADS	O
,	O
}	O
,	O
}	O
,	O
{	O
}	O
}	O
;	O
error_t	O
process_lookup_pid	function
(	O
struct	O
ps_context	O
*	O
pc	pointer
,	O
pid_t	int
pid	int
,	O
struct	O
node	O
*	O
*	O
np	pointer
)	O
{	O
static	O
const	O
struct	O
procfs_dir_ops	O
dir_ops	struct
=	O
{	O
.	O
entries	int
=	O
entries	int
,	O
.	O
cleanup	O
=	O
(	O
void	O
(	O
*	O
)	O
(	O
void	O
*	O
)	O
)	O
_proc_stat_free	function
,	O
.	O
entry_ops	O
=	O
{	O
.	O
make_node	O
=	O
process_file_make_node	function
,	O
}	O
,	O
}	O
;	O
struct	O
proc_stat	O
*	O
ps	pointer
;	O
int	O
owner	int
;	O
error_t	O
err	O
;	O
err	O
=	O
_proc_stat_create	function
(	O
pid	int
,	O
pc	pointer
,	O
&	O
ps	pointer
)	O
;	O
if	O
(	O
err	O
==	O
ESRCH	O
)	O
return	O
ENOENT	O
;	O
if	O
(	O
err	O
)	O
return	O
EIO	O
;	O
err	O
=	O
proc_stat_set_flags	function
(	O
ps	pointer
,	O
PSTAT_OWNER_UID	O
)	O
;	O
if	O
(	O
err	O
||	O
!	O
(	O
proc_stat_flags	function
(	O
ps	pointer
)	O
&	O
PSTAT_OWNER_UID	O
)	O
)	O
{	O
_proc_stat_free	function
(	O
ps	pointer
)	O
;	O
return	O
EIO	O
;	O
}	O
*	O
np	pointer
=	O
procfs_dir_make_node	function
(	O
&	O
dir_ops	struct
,	O
ps	pointer
)	O
;	O
if	O
(	O
!	O
*	O
np	pointer
)	O
return	O
ENOMEM	O
;	O
owner	int
=	O
proc_stat_owner_uid	function
(	O
ps	pointer
)	O
;	O
procfs_node_chown	function
(	O
*	O
np	pointer
,	O
owner	int
>=	O
0	int
?	O
owner	int
:	O
opt_anon_owner	O
)	O
;	O
return	O
0	int
;	O
}	O
