error_t	O
proc_stat_list_create	function
(	O
struct	O
ps_context	O
*	O
context	pointer
,	O
struct	O
proc_stat_list	O
*	O
*	O
pp	pointer
)	O
{	O
*	O
pp	pointer
=	O
NEW	function
(	O
struct	O
proc_stat_list	O
)	O
;	O
if	O
(	O
*	O
pp	pointer
==	O
NULL	O
)	O
return	O
ENOMEM	O
;	O
(	O
*	O
pp	pointer
)	O
->	O
proc_stats	pointer
=	O
0	int
;	O
(	O
*	O
pp	pointer
)	O
->	O
num_procs	int
=	O
0	int
;	O
(	O
*	O
pp	pointer
)	O
->	O
alloced	O
=	O
0	int
;	O
(	O
*	O
pp	pointer
)	O
->	O
context	pointer
=	O
context	pointer
;	O
return	O
0	int
;	O
}	O
void	O
proc_stat_list_free	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
)	O
{	O
proc_stat_list_remove_threads	function
(	O
pp	pointer
)	O
;	O
FREE	function
(	O
pp	pointer
->	O
proc_stats	pointer
)	O
;	O
FREE	function
(	O
pp	pointer
)	O
;	O
}	O
error_t	O
proc_stat_list_clone	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
struct	O
proc_stat_list	O
*	O
*	O
copy	pointer
)	O
{	O
struct	O
proc_stat_list	O
*	O
new	pointer
=	O
NEW	function
(	O
struct	O
proc_stat_list	O
)	O
;	O
struct	O
proc_stat	O
*	O
*	O
procs	pointer
=	O
NEWVEC	function
(	O
struct	O
proc_stat	O
*	O
,	O
pp	pointer
->	O
num_procs	int
)	O
;	O
if	O
(	O
!	O
new	pointer
||	O
!	O
procs	pointer
)	O
{	O
if	O
(	O
new	pointer
)	O
free	function
(	O
new	pointer
)	O
;	O
if	O
(	O
procs	pointer
)	O
free	function
(	O
procs	pointer
)	O
;	O
return	O
ENOMEM	O
;	O
}	O
bcopy	function
(	O
pp	pointer
->	O
proc_stats	pointer
,	O
procs	pointer
,	O
pp	pointer
->	O
num_procs	int
)	O
;	O
new	pointer
->	O
proc_stats	pointer
=	O
procs	pointer
;	O
new	pointer
->	O
num_procs	int
=	O
pp	pointer
->	O
num_procs	int
;	O
new	pointer
->	O
alloced	O
=	O
pp	pointer
->	O
num_procs	int
;	O
new	pointer
->	O
context	pointer
=	O
pp	pointer
->	O
context	pointer
;	O
*	O
copy	pointer
=	O
new	pointer
;	O
return	O
0	int
;	O
}	O
static	O
error_t	O
proc_stat_list_grow	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
int	O
amount	int
)	O
{	O
amount	int
+=	O
pp	pointer
->	O
num_procs	int
;	O
if	O
(	O
amount	int
>	O
pp	pointer
->	O
alloced	O
)	O
{	O
struct	O
proc_stat	O
*	O
*	O
new_procs	pointer
=	O
GROWVEC	function
(	O
pp	pointer
->	O
proc_stats	pointer
,	O
struct	O
proc_stat	O
*	O
,	O
amount	int
)	O
;	O
if	O
(	O
new_procs	pointer
==	O
NULL	O
)	O
return	O
ENOMEM	O
;	O
pp	pointer
->	O
alloced	O
=	O
amount	int
;	O
pp	pointer
->	O
proc_stats	pointer
=	O
new_procs	pointer
;	O
}	O
return	O
0	int
;	O
}	O
error_t	O
proc_stat_list_add_pids	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
pid_t	O
*	O
pids	pointer
,	O
unsigned	O
num_procs	int
,	O
struct	O
proc_stat	O
*	O
*	O
*	O
proc_stats	pointer
)	O
{	O
error_t	O
err	O
=	O
proc_stat_list_grow	function
(	O
pp	pointer
,	O
num_procs	int
)	O
;	O
if	O
(	O
err	O
)	O
return	O
err	O
;	O
else	O
{	O
int	O
i	int
;	O
struct	O
proc_stat	O
*	O
*	O
end	pointer
=	O
pp	pointer
->	O
proc_stats	pointer
+	O
pp	pointer
->	O
num_procs	int
;	O
if	O
(	O
proc_stats	pointer
)	O
*	O
proc_stats	pointer
=	O
NEWVEC	function
(	O
struct	O
proc_stat	O
*	O
,	O
num_procs	int
)	O
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
num_procs	int
;	O
i	int
++	O
)	O
{	O
int	O
pid	int
=	O
*	O
pids	pointer
++	O
;	O
struct	O
proc_stat	O
*	O
ps	pointer
=	O
proc_stat_list_pid_proc_stat	function
(	O
pp	pointer
,	O
pid	int
)	O
;	O
if	O
(	O
ps	pointer
==	O
NULL	O
)	O
{	O
err	O
=	O
ps_context_find_proc_stat	function
(	O
pp	pointer
->	O
context	pointer
,	O
pid	int
,	O
end	pointer
)	O
;	O
if	O
(	O
err	O
)	O
{	O
if	O
(	O
proc_stats	pointer
)	O
free	function
(	O
*	O
proc_stats	pointer
)	O
;	O
return	O
err	O
;	O
}	O
else	O
ps	pointer
=	O
*	O
end	pointer
++	O
;	O
}	O
if	O
(	O
proc_stats	pointer
)	O
(	O
*	O
proc_stats	pointer
)	O
[	O
i	int
]	O
=	O
ps	pointer
;	O
}	O
pp	pointer
->	O
num_procs	int
=	O
end	pointer
-	O
pp	pointer
->	O
proc_stats	pointer
;	O
return	O
0	int
;	O
}	O
}	O
error_t	O
proc_stat_list_add_pid	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
pid_t	O
pid	int
,	O
struct	O
proc_stat	O
*	O
*	O
ps	pointer
)	O
{	O
struct	O
proc_stat	O
*	O
_ps	pointer
=	O
proc_stat_list_pid_proc_stat	function
(	O
pp	pointer
,	O
pid	int
)	O
;	O
if	O
(	O
_ps	pointer
==	O
NULL	O
)	O
{	O
error_t	O
err	O
;	O
if	O
(	O
pp	pointer
->	O
num_procs	int
==	O
pp	pointer
->	O
alloced	O
)	O
{	O
err	O
=	O
proc_stat_list_grow	function
(	O
pp	pointer
,	O
32	int
)	O
;	O
if	O
(	O
err	O
)	O
return	O
err	O
;	O
}	O
err	O
=	O
ps_context_find_proc_stat	function
(	O
pp	pointer
->	O
context	pointer
,	O
pid	int
,	O
&	O
_ps	pointer
)	O
;	O
if	O
(	O
err	O
)	O
return	O
err	O
;	O
pp	pointer
->	O
proc_stats	pointer
[	O
pp	pointer
->	O
num_procs	int
++	O
]	O
=	O
_ps	pointer
;	O
}	O
if	O
(	O
ps	pointer
)	O
*	O
ps	pointer
=	O
_ps	pointer
;	O
return	O
0	int
;	O
}	O
struct	O
proc_stat	O
*	O
proc_stat_list_pid_proc_stat	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
pid_t	O
pid	int
)	O
{	O
unsigned	O
nprocs	int
=	O
pp	pointer
->	O
num_procs	int
;	O
struct	O
proc_stat	O
*	O
*	O
procs	pointer
=	O
pp	pointer
->	O
proc_stats	pointer
;	O
while	O
(	O
nprocs	int
--	O
>	O
0	int
)	O
if	O
(	O
proc_stat_pid	function
(	O
*	O
procs	pointer
)	O
==	O
pid	int
)	O
return	O
*	O
procs	pointer
;	O
else	O
procs	pointer
++	O
;	O
return	O
NULL	O
;	O
}	O
error_t	O
proc_stat_list_merge	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
struct	O
proc_stat_list	O
*	O
mergee	pointer
)	O
{	O
if	O
(	O
pp	pointer
->	O
context	pointer
!=	O
mergee	pointer
->	O
context	pointer
)	O
return	O
EINVAL	O
;	O
else	O
{	O
error_t	O
err	O
=	O
proc_stat_list_grow	function
(	O
pp	pointer
,	O
mergee	pointer
->	O
num_procs	int
)	O
;	O
if	O
(	O
err	O
)	O
return	O
err	O
;	O
else	O
{	O
int	O
mnprocs	int
=	O
mergee	pointer
->	O
num_procs	int
;	O
struct	O
proc_stat	O
*	O
*	O
mprocs	pointer
=	O
mergee	pointer
->	O
proc_stats	pointer
;	O
int	O
nprocs	int
=	O
pp	pointer
->	O
num_procs	int
;	O
struct	O
proc_stat	O
*	O
*	O
procs	pointer
=	O
pp	pointer
->	O
proc_stats	pointer
;	O
while	O
(	O
mnprocs	int
--	O
>	O
0	int
)	O
if	O
(	O
proc_stat_list_pid_proc_stat	function
(	O
pp	pointer
,	O
proc_stat_pid	function
(	O
mprocs	pointer
[	O
mnprocs	int
]	O
)	O
)	O
==	O
NULL	O
)	O
{	O
procs	pointer
[	O
nprocs	int
++	O
]	O
=	O
mprocs	pointer
[	O
mnprocs	int
]	O
;	O
mprocs	pointer
[	O
mnprocs	int
]	O
=	O
NULL	O
;	O
}	O
proc_stat_list_free	function
(	O
mergee	pointer
)	O
;	O
return	O
0	int
;	O
}	O
}	O
}	O
static	O
error_t	O
proc_stat_list_add_fn_pids	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
kern_return_t	function
(	O
*	O
fetch_fn	pointer
)	O
(	O
process_t	O
proc	int
,	O
pid_t	O
*	O
*	O
pids	pointer
,	O
size_t	long
*	O
num_pids	pointer
)	O
,	O
struct	O
proc_stat	O
*	O
*	O
*	O
proc_stats	pointer
,	O
size_t	long
*	O
num_procs	int
)	O
{	O
error_t	O
err	O
;	O
pid_t	O
pid_array	O
[	O
STATICPIDS	int
]	O
,	O
*	O
pids	pointer
=	O
pid_array	O
;	O
size_t	long
num_pids	pointer
=	O
STATICPIDS	int
;	O
err	O
=	O
(	O
*	O
fetch_fn	pointer
)	O
(	O
ps_context_server	function
(	O
pp	pointer
->	O
context	pointer
)	O
,	O
&	O
pids	pointer
,	O
&	O
num_pids	pointer
)	O
;	O
if	O
(	O
err	O
)	O
return	O
err	O
;	O
err	O
=	O
proc_stat_list_add_pids	function
(	O
pp	pointer
,	O
pids	pointer
,	O
num_pids	pointer
,	O
proc_stats	pointer
)	O
;	O
if	O
(	O
!	O
err	O
&&	O
num_procs	int
)	O
*	O
num_procs	int
=	O
num_pids	pointer
;	O
if	O
(	O
pids	pointer
!=	O
pid_array	O
)	O
VMFREE	function
(	O
pids	pointer
,	O
sizeof	O
(	O
pid_t	O
)	O
*	O
num_pids	pointer
)	O
;	O
return	O
err	O
;	O
}	O
static	O
error_t	O
proc_stat_list_add_id_fn_pids	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
unsigned	O
id	int
,	O
kern_return_t	function
(	O
*	O
fetch_fn	pointer
)	O
(	O
process_t	O
proc	int
,	O
pid_t	O
id	int
,	O
pid_t	O
*	O
*	O
pids	pointer
,	O
size_t	long
*	O
num_pids	pointer
)	O
,	O
struct	O
proc_stat	O
*	O
*	O
*	O
proc_stats	pointer
,	O
size_t	long
*	O
num_procs	int
)	O
{	O
error_t	O
id_fetch_fn	O
(	O
process_t	O
proc	int
,	O
pid_t	O
*	O
*	O
pids	pointer
,	O
size_t	long
*	O
num_pids	pointer
)	O
{	O
return	O
(	O
*	O
fetch_fn	pointer
)	O
(	O
proc	int
,	O
id	int
,	O
pids	pointer
,	O
num_pids	pointer
)	O
;	O
}	O
return	O
proc_stat_list_add_fn_pids	function
(	O
pp	pointer
,	O
id_fetch_fn	O
,	O
proc_stats	pointer
,	O
num_procs	int
)	O
;	O
}	O
error_t	O
proc_stat_list_add_all	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
struct	O
proc_stat	O
*	O
*	O
*	O
proc_stats	pointer
,	O
size_t	long
*	O
num_procs	int
)	O
{	O
return	O
proc_stat_list_add_fn_pids	function
(	O
pp	pointer
,	O
proc_getallpids	O
,	O
proc_stats	pointer
,	O
num_procs	int
)	O
;	O
}	O
error_t	O
proc_stat_list_add_login_coll	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
pid_t	O
login_id	int
,	O
struct	O
proc_stat	O
*	O
*	O
*	O
proc_stats	pointer
,	O
size_t	long
*	O
num_procs	int
)	O
{	O
return	O
proc_stat_list_add_id_fn_pids	function
(	O
pp	pointer
,	O
login_id	int
,	O
proc_getloginpids	O
,	O
proc_stats	pointer
,	O
num_procs	int
)	O
;	O
}	O
error_t	O
proc_stat_list_add_session	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
pid_t	O
session_id	int
,	O
struct	O
proc_stat	O
*	O
*	O
*	O
proc_stats	pointer
,	O
size_t	long
*	O
num_procs	int
)	O
{	O
return	O
proc_stat_list_add_id_fn_pids	function
(	O
pp	pointer
,	O
session_id	int
,	O
proc_getsessionpids	O
,	O
proc_stats	pointer
,	O
num_procs	int
)	O
;	O
}	O
error_t	O
proc_stat_list_add_pgrp	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
pid_t	O
pgrp	int
,	O
struct	O
proc_stat	O
*	O
*	O
*	O
proc_stats	pointer
,	O
size_t	long
*	O
num_procs	int
)	O
{	O
return	O
proc_stat_list_add_id_fn_pids	function
(	O
pp	pointer
,	O
pgrp	int
,	O
proc_getpgrppids	O
,	O
proc_stats	pointer
,	O
num_procs	int
)	O
;	O
}	O
error_t	O
proc_stat_list_set_flags	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
ps_flags_t	O
flags	int
)	O
{	O
unsigned	O
nprocs	int
=	O
pp	pointer
->	O
num_procs	int
;	O
struct	O
proc_stat	O
*	O
*	O
procs	pointer
=	O
pp	pointer
->	O
proc_stats	pointer
;	O
while	O
(	O
nprocs	int
--	O
>	O
0	int
)	O
{	O
struct	O
proc_stat	O
*	O
ps	pointer
=	O
*	O
procs	pointer
++	O
;	O
if	O
(	O
!	O
proc_stat_has	function
(	O
ps	pointer
,	O
flags	int
)	O
)	O
{	O
error_t	O
err	O
=	O
proc_stat_set_flags	O
(	O
ps	pointer
,	O
flags	int
)	O
;	O
if	O
(	O
err	O
)	O
return	O
err	O
;	O
}	O
}	O
return	O
0	int
;	O
}	O
error_t	O
proc_stat_list_filter1	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
int	O
(	O
*	O
predicate	pointer
)	O
(	O
struct	O
proc_stat	O
*	O
ps	pointer
)	O
,	O
ps_flags_t	O
flags	int
,	O
int	O
invert	int
)	O
{	O
unsigned	O
which	int
=	O
0	int
;	O
unsigned	O
num_procs	int
=	O
pp	pointer
->	O
num_procs	int
;	O
struct	O
proc_stat	O
*	O
*	O
procs	pointer
=	O
pp	pointer
->	O
proc_stats	pointer
;	O
struct	O
proc_stat	O
*	O
*	O
kept	pointer
=	O
procs	pointer
;	O
error_t	O
err	O
=	O
proc_stat_list_set_flags	function
(	O
pp	pointer
,	O
flags	int
)	O
;	O
if	O
(	O
err	O
)	O
return	O
err	O
;	O
invert	int
=	O
!	O
!	O
invert	int
;	O
while	O
(	O
which	int
<	O
num_procs	int
)	O
{	O
struct	O
proc_stat	O
*	O
ps	pointer
=	O
procs	pointer
[	O
which	int
++	O
]	O
;	O
if	O
(	O
!	O
proc_stat_has	function
(	O
ps	pointer
,	O
flags	int
)	O
||	O
!	O
!	O
predicate	pointer
(	O
ps	pointer
)	O
!=	O
invert	int
)	O
*	O
kept	pointer
++	O
=	O
ps	pointer
;	O
}	O
pp	pointer
->	O
num_procs	int
=	O
kept	pointer
-	O
procs	pointer
;	O
return	O
0	int
;	O
}	O
error_t	O
proc_stat_list_filter	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
const	O
struct	O
ps_filter	O
*	O
filter	pointer
,	O
int	O
invert	int
)	O
{	O
return	O
proc_stat_list_filter1	function
(	O
pp	pointer
,	O
ps_filter_predicate	function
(	O
filter	pointer
)	O
,	O
ps_filter_needs	function
(	O
filter	pointer
)	O
,	O
invert	int
)	O
;	O
}	O
error_t	O
proc_stat_list_sort1	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
const	O
struct	O
ps_getter	O
*	O
getter	pointer
,	O
int	O
(	O
*	O
cmp_fn	pointer
)	O
(	O
struct	O
proc_stat	O
*	O
ps1	pointer
,	O
struct	O
proc_stat	O
*	O
ps2	pointer
,	O
const	O
struct	O
ps_getter	O
*	O
getter	pointer
)	O
,	O
int	O
reverse	int
)	O
{	O
int	O
needs	int
=	O
ps_getter_needs	function
(	O
getter	pointer
)	O
;	O
struct	O
proc_stat	O
*	O
*	O
procs	pointer
=	O
pp	pointer
->	O
proc_stats	pointer
;	O
error_t	O
err	O
=	O
proc_stat_list_set_flags	function
(	O
pp	pointer
,	O
needs	int
)	O
;	O
int	O
lessp	O
(	O
const	O
void	O
*	O
p1	pointer
,	O
const	O
void	O
*	O
p2	pointer
)	O
{	O
struct	O
proc_stat	O
*	O
ps1	pointer
=	O
*	O
(	O
struct	O
proc_stat	O
*	O
*	O
)	O
p1	pointer
;	O
struct	O
proc_stat	O
*	O
ps2	pointer
=	O
*	O
(	O
struct	O
proc_stat	O
*	O
*	O
)	O
p2	pointer
;	O
int	O
is_th_1	O
=	O
proc_stat_is_thread	O
(	O
ps1	pointer
)	O
;	O
int	O
is_th_2	O
=	O
proc_stat_is_thread	O
(	O
ps2	pointer
)	O
;	O
if	O
(	O
!	O
is_th_1	O
||	O
!	O
is_th_2	O
||	O
proc_stat_thread_origin	O
(	O
ps1	pointer
)	O
!=	O
proc_stat_thread_origin	O
(	O
ps2	pointer
)	O
)	O
{	O
if	O
(	O
is_th_1	O
)	O
ps1	pointer
=	O
proc_stat_thread_origin	O
(	O
ps1	pointer
)	O
;	O
if	O
(	O
is_th_2	O
)	O
ps2	pointer
=	O
proc_stat_thread_origin	O
(	O
ps2	pointer
)	O
;	O
}	O
if	O
(	O
ps1	pointer
==	O
ps2	pointer
||	O
!	O
proc_stat_has	function
(	O
ps1	pointer
,	O
needs	int
)	O
||	O
!	O
proc_stat_has	function
(	O
ps2	pointer
,	O
needs	int
)	O
)	O
return	O
p1	pointer
-	O
p2	pointer
;	O
else	O
if	O
(	O
reverse	int
)	O
return	O
cmp_fn	pointer
(	O
ps2	pointer
,	O
ps1	pointer
,	O
getter	pointer
)	O
;	O
else	O
return	O
cmp_fn	pointer
(	O
ps1	pointer
,	O
ps2	pointer
,	O
getter	pointer
)	O
;	O
}	O
if	O
(	O
err	O
)	O
return	O
err	O
;	O
qsort	function
(	O
(	O
void	O
*	O
)	O
procs	pointer
,	O
(	O
size_t	long
)	O
pp	pointer
->	O
num_procs	int
,	O
sizeof	O
(	O
struct	O
proc_stat	O
*	O
)	O
,	O
lessp	O
)	O
;	O
return	O
0	int
;	O
}	O
error_t	O
proc_stat_list_sort	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
const	O
struct	O
ps_fmt_spec	O
*	O
key	pointer
,	O
int	O
reverse	int
)	O
{	O
int	O
(	O
*	O
cmp_fn	pointer
)	O
(	O
)	O
=	O
ps_fmt_spec_compare_fn	function
(	O
key	pointer
)	O
;	O
if	O
(	O
cmp_fn	pointer
==	O
NULL	O
)	O
return	O
EINVAL	O
;	O
else	O
return	O
proc_stat_list_sort1	function
(	O
pp	pointer
,	O
ps_fmt_spec_getter	function
(	O
key	pointer
)	O
,	O
cmp_fn	pointer
,	O
reverse	int
)	O
;	O
}	O
error_t	O
proc_stat_list_fmt	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
struct	O
ps_fmt	O
*	O
fmt	pointer
,	O
struct	O
ps_stream	O
*	O
stream	pointer
)	O
{	O
unsigned	O
nprocs	int
=	O
pp	pointer
->	O
num_procs	int
;	O
struct	O
proc_stat	O
*	O
*	O
procs	pointer
=	O
pp	pointer
->	O
proc_stats	pointer
;	O
error_t	O
err	O
=	O
proc_stat_list_set_flags	function
(	O
pp	pointer
,	O
ps_fmt_needs	O
(	O
fmt	pointer
)	O
)	O
;	O
while	O
(	O
!	O
err	O
&&	O
nprocs	int
--	O
>	O
0	int
)	O
{	O
err	O
=	O
ps_fmt_write_proc_stat	function
(	O
fmt	pointer
,	O
*	O
procs	pointer
++	O
,	O
stream	pointer
)	O
;	O
if	O
(	O
!	O
err	O
)	O
ps_stream_newline	function
(	O
stream	pointer
)	O
;	O
}	O
return	O
err	O
;	O
}	O
error_t	O
proc_stat_list_find_bogus_flags	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
ps_flags_t	O
*	O
flags	int
)	O
{	O
unsigned	O
nprocs	int
=	O
pp	pointer
->	O
num_procs	int
;	O
struct	O
proc_stat	O
*	O
*	O
procs	pointer
=	O
pp	pointer
->	O
proc_stats	pointer
;	O
error_t	O
err	O
=	O
proc_stat_list_set_flags	function
(	O
pp	pointer
,	O
*	O
flags	int
)	O
;	O
if	O
(	O
err	O
)	O
return	O
err	O
;	O
while	O
(	O
nprocs	int
--	O
>	O
0	int
&&	O
*	O
flags	int
!=	O
0	int
)	O
*	O
flags	int
&=	O
~	O
proc_stat_flags	function
(	O
*	O
procs	pointer
++	O
)	O
;	O
return	O
0	int
;	O
}	O
error_t	O
proc_stat_list_add_threads	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
)	O
{	O
error_t	O
err	O
=	O
proc_stat_list_set_flags	function
(	O
pp	pointer
,	O
PSTAT_NUM_THREADS	O
)	O
;	O
if	O
(	O
err	O
)	O
return	O
err	O
;	O
else	O
{	O
int	O
new_entries	int
=	O
0	int
;	O
int	O
nprocs	int
=	O
pp	pointer
->	O
num_procs	int
;	O
struct	O
proc_stat	O
*	O
*	O
procs	pointer
=	O
pp	pointer
->	O
proc_stats	pointer
;	O
while	O
(	O
nprocs	int
--	O
>	O
0	int
)	O
{	O
struct	O
proc_stat	O
*	O
ps	pointer
=	O
*	O
procs	pointer
++	O
;	O
if	O
(	O
proc_stat_has	function
(	O
ps	pointer
,	O
PSTAT_NUM_THREADS	O
)	O
)	O
new_entries	int
+=	O
proc_stat_num_threads	function
(	O
ps	pointer
)	O
;	O
}	O
err	O
=	O
proc_stat_list_grow	function
(	O
pp	pointer
,	O
new_entries	int
)	O
;	O
if	O
(	O
err	O
)	O
return	O
err	O
;	O
else	O
{	O
struct	O
proc_stat	O
*	O
*	O
end	pointer
=	O
pp	pointer
->	O
proc_stats	pointer
+	O
pp	pointer
->	O
num_procs	int
+	O
new_entries	int
;	O
nprocs	int
=	O
pp	pointer
->	O
num_procs	int
;	O
procs	pointer
=	O
pp	pointer
->	O
proc_stats	pointer
+	O
nprocs	int
;	O
while	O
(	O
nprocs	int
--	O
>	O
0	int
)	O
{	O
struct	O
proc_stat	O
*	O
ps	pointer
=	O
*	O
--	O
procs	pointer
;	O
if	O
(	O
proc_stat_has	function
(	O
ps	pointer
,	O
PSTAT_NUM_THREADS	O
)	O
)	O
{	O
int	O
nthreads	int
=	O
proc_stat_num_threads	function
(	O
ps	pointer
)	O
;	O
while	O
(	O
nthreads	int
--	O
>	O
0	int
)	O
proc_stat_thread_create	function
(	O
ps	pointer
,	O
nthreads	int
,	O
--	O
end	pointer
)	O
;	O
}	O
*	O
--	O
end	pointer
=	O
ps	pointer
;	O
}	O
pp	pointer
->	O
num_procs	int
+=	O
new_entries	int
;	O
}	O
}	O
return	O
0	int
;	O
}	O
error_t	O
proc_stat_list_remove_threads	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
)	O
{	O
int	O
is_thread	O
(	O
struct	O
proc_stat	O
*	O
ps	pointer
)	O
{	O
return	O
proc_stat_is_thread	O
(	O
ps	pointer
)	O
;	O
}	O
return	O
proc_stat_list_filter1	function
(	O
pp	pointer
,	O
is_thread	O
,	O
0	int
,	O
FALSE	O
)	O
;	O
}	O
int	O
proc_stat_list_for_each	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
int	O
(	O
*	O
fn	pointer
)	O
(	O
struct	O
proc_stat	O
*	O
ps	pointer
)	O
)	O
{	O
unsigned	O
nprocs	int
=	O
pp	pointer
->	O
num_procs	int
;	O
struct	O
proc_stat	O
*	O
*	O
procs	pointer
=	O
pp	pointer
->	O
proc_stats	pointer
;	O
while	O
(	O
nprocs	int
--	O
>	O
0	int
)	O
{	O
int	O
val	int
=	O
(	O
*	O
fn	pointer
)	O
(	O
*	O
procs	pointer
++	O
)	O
;	O
if	O
(	O
val	int
)	O
return	O
val	int
;	O
}	O
return	O
0	int
;	O
}	O
int	O
proc_stat_list_spec_nominal	function
(	O
struct	O
proc_stat_list	O
*	O
pp	pointer
,	O
const	O
struct	O
ps_fmt_spec	O
*	O
spec	pointer
)	O
{	O
int	O
(	O
*	O
nominal_fn	pointer
)	O
(	O
struct	O
proc_stat	O
*	O
ps	pointer
,	O
const	O
struct	O
ps_getter	O
*	O
getter	pointer
)	O
=	O
spec	pointer
->	O
nominal_fn	pointer
;	O
if	O
(	O
nominal_fn	pointer
==	O
NULL	O
)	O
return	O
FALSE	O
;	O
else	O
{	O
const	O
struct	O
ps_getter	O
*	O
getter	pointer
=	O
ps_fmt_spec_getter	function
(	O
spec	pointer
)	O
;	O
ps_flags_t	O
needs	int
=	O
ps_getter_needs	function
(	O
getter	pointer
)	O
;	O
int	O
interesting	O
(	O
struct	O
proc_stat	O
*	O
ps	pointer
)	O
{	O
return	O
proc_stat_has	function
(	O
ps	pointer
,	O
needs	int
)	O
&&	O
!	O
(	O
*	O
nominal_fn	pointer
)	O
(	O
ps	pointer
,	O
getter	pointer
)	O
;	O
}	O
proc_stat_list_set_flags	function
(	O
pp	pointer
,	O
needs	int
)	O
;	O
return	O
!	O
proc_stat_list_for_each	function
(	O
pp	pointer
,	O
interesting	O
)	O
;	O
}	O
}	O
