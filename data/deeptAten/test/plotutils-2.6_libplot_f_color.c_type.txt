static	O
int	O
_fig_pseudocolor	function
(	O
int	O
red	int
,	O
int	O
green	int
,	O
int	O
blue	int
,	O
const	O
long	O
int	O
*	O
fig_usercolors	pointer
,	O
int	O
fig_num_usercolors	O
)	O
;	O
int	O
_pl_f_fig_color	int
(	O
R___	O
(	O
Plotter	O
*	O
_plotter	pointer
)	O
int	O
red	int
,	O
int	O
green	int
,	O
int	O
blue	int
)	O
{	O
int	O
fig_fgcolor_red	int
,	O
fig_fgcolor_green	int
,	O
fig_fgcolor_blue	int
;	O
long	O
int	O
fig_fgcolor_rgb	int
;	O
int	O
i	int
;	O
fig_fgcolor_red	O
=	O
(	int
red	O
>>	O
8	int
)	O
&	O
ONEBYTE	pointer
;	O
fig_fgcolor_green	O
=	O
(	int
green	O
>>	O
8	int
)	O
&	O
ONEBYTE	O
;	O
fig_fgcolor_blue	O
=	O
(	int
blue	O
>>	O
8	int
)	O
&	O
ONEBYTE	O
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
FIG_NUM_STD_COLORS	int
;	O
i	int
++	O
)	O
{	O
if	O
(	O
(	int
_pl_f_fig_stdcolors	O
[	O
i	int
]	O
.	O
red	int
==	O
fig_fgcolor_red	int
)	O
&&	O
(	O
_pl_f_fig_stdcolors	O
[	O
i	int
]	O
.	O
green	int
==	O
fig_fgcolor_green	int
)	O
&&	O
(	O
_pl_f_fig_stdcolors	O
[	O
i	int
]	O
.	O
blue	int
==	O
fig_fgcolor_blue	int
)	O
)	O
return	O
i	int
;	O
}	int
fig_fgcolor_rgb	O
=	O
(	function
fig_fgcolor_red	O
<<	O
16	int
)	O
+	O
(	int
fig_fgcolor_green	int
<<	O
8	int
)	O
+	O
(	int
fig_fgcolor_blue	int
)	O
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
_plotter	int
->	O
fig_num_usercolors	int
;	O
i	int
++	O
)	O
{	O
if	O
(	O
_plotter	int
->	O
fig_usercolors	int
[	O
i	int
]	O
==	O
fig_fgcolor_rgb	O
)	O
return	O
FIG_USER_COLOR_MIN	int
+	O
i	int
;	O
}	int
if	O
(	O
_plotter	O
->	O
fig_num_usercolors	pointer
==	O
FIG_MAX_NUM_USER_COLORS	int
-	O
1	int
)	O
{	O
if	O
(	O
_plotter	O
->	O
fig_colormap_warning_issued	int
==	O
false	int
)	O
{	O
_plotter	O
->	O
warning	int
(	O
R___	int
(	O
_plotter	pointer
)	O
"supply of user-defined colors is exhausted"	O
)	O
;	O
_plotter	O
->	O
fig_colormap_warning_issued	int
=	O
true	int
;	O
}	int
return	O
_fig_pseudocolor	O
(	O
fig_fgcolor_red	int
,	O
fig_fgcolor_green	int
,	O
fig_fgcolor_blue	int
,	O
_plotter	int
->	O
fig_usercolors	int
,	O
FIG_MAX_NUM_USER_COLORS	int
-	O
1	int
)	O
;	O
}	O
else	O
{	O
_plotter	O
->	O
fig_usercolors	int
[	O
_plotter	int
->	O
fig_num_usercolors	int
]	O
=	O
fig_fgcolor_rgb	pointer
;	O
_plotter	pointer
->	O
fig_num_usercolors	pointer
++	O
;	O
return	O
FIG_USER_COLOR_MIN	int
+	O
_plotter	int
->	O
fig_num_usercolors	int
-	O
1	int
;	O
}	O
}	O
static	O
int	O
_fig_pseudocolor	function
(	O
int	O
red	int
,	O
int	O
green	int
,	O
int	O
blue	int
,	O
const	O
long	O
int	O
*	O
fig_usercolors	pointer
,	O
int	O
fig_num_usercolors	O
)	O
{	O
unsigned	O
long	int
int	O
difference	O
=	O
INT_MAX	int
;	O
int	O
i	int
;	O
int	O
best	int
=	O
0	int
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
FIG_NUM_STD_COLORS	int
;	O
i	int
++	O
)	O
{	O
unsigned	O
long	O
int	O
newdifference	O
;	O
if	O
(	O
_pl_f_fig_stdcolors	O
[	O
i	int
]	O
.	O
red	int
==	O
0xff	int
&&	O
_pl_f_fig_stdcolors	int
[	O
i	int
]	O
.	O
green	int
==	O
0xff	int
&&	O
_pl_f_fig_stdcolors	int
[	O
i	int
]	O
.	O
blue	int
==	O
0xff	int
)	O
{	O
if	O
(	O
red	O
==	O
0xff	O
&&	O
green	int
==	O
0xff	int
&&	O
blue	int
==	O
0xff	int
)	O
{	O
difference	O
=	O
0	int
;	O
best	int
=	O
i	int
;	O
}	int
continue	O
;	O
}	O
newdifference	O
=	O
(	function
(	O
(	O
_pl_f_fig_stdcolors	O
[	O
i	int
]	O
.	O
red	int
-	O
red	int
)	O
*	O
(	O
_pl_f_fig_stdcolors	O
[	O
i	int
]	O
.	O
red	int
-	O
red	int
)	O
)	O
+	O
(	int
(	int
_pl_f_fig_stdcolors	O
[	O
i	int
]	O
.	O
green	int
-	O
green	int
)	O
*	O
(	O
_pl_f_fig_stdcolors	O
[	O
i	int
]	O
.	O
green	int
-	O
green	int
)	O
)	O
+	O
(	int
(	int
_pl_f_fig_stdcolors	O
[	O
i	int
]	O
.	O
blue	int
-	O
blue	int
)	O
*	O
(	O
_pl_f_fig_stdcolors	O
[	O
i	int
]	O
.	O
blue	int
-	O
blue	int
)	O
)	O
)	O
;	O
if	O
(	O
newdifference	O
<	O
difference	O
)	O
{	O
difference	O
=	O
newdifference	int
;	O
best	O
=	O
i	int
;	O
}	int
}	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
fig_num_usercolors	int
;	O
i	int
++	O
)	O
{	O
unsigned	O
long	O
int	O
newdifference	O
;	O
plColor	O
usercolor	O
;	O
usercolor	O
.	O
red	pointer
=	O
(	O
fig_usercolors	O
[	O
i	int
]	O
>>	O
16	int
)	O
&	O
ONEBYTE	pointer
;	O
usercolor	O
.	O
green	int
=	O
(	O
fig_usercolors	O
[	O
i	int
]	O
>>	O
8	int
)	O
&	O
ONEBYTE	pointer
;	O
usercolor	O
.	O
blue	int
=	O
(	O
fig_usercolors	O
[	O
i	int
]	O
>>	O
0	int
)	O
&	O
ONEBYTE	pointer
;	O
newdifference	O
=	O
(	int
(	O
usercolor	O
.	O
red	int
-	O
red	int
)	O
*	O
(	O
usercolor	O
.	O
red	int
-	O
red	int
)	O
+	O
(	int
usercolor	O
.	O
green	int
-	O
green	int
)	O
*	O
(	O
usercolor	O
.	O
green	int
-	O
green	int
)	O
+	O
(	int
usercolor	O
.	O
blue	int
-	O
blue	int
)	O
*	O
(	O
usercolor	O
.	O
blue	int
-	O
blue	int
)	O
)	O
;	O
if	O
(	O
newdifference	O
<	O
difference	O
)	O
{	O
difference	O
=	O
newdifference	int
;	O
best	O
=	O
i	int
+	O
FIG_USER_COLOR_MIN	int
;	O
}	int
}	O
return	O
best	O
;	O
}	O
void	O
_pl_f_set_pen_color	function
(	O
S___	O
(	O
Plotter	O
*	O
_plotter	pointer
)	O
)	O
{	O
if	O
(	O
(	O
(	O
_plotter	O
->	O
drawstate	pointer
->	O
fgcolor	pointer
)	O
.	O
red	pointer
>	O
0xffff	int
)	O
||	O
(	O
(	O
_plotter	O
->	O
drawstate	pointer
->	O
fgcolor	pointer
)	O
.	O
green	pointer
>	O
0xffff	int
)	O
||	O
(	O
(	O
_plotter	O
->	O
drawstate	pointer
->	O
fgcolor	pointer
)	O
.	O
blue	pointer
>	O
0xffff	int
)	O
)	O
_plotter	O
->	O
drawstate	int
->	O
fig_fgcolor	pointer
=	O
_default_drawstate	int
.	O
fig_fgcolor	int
;	O
else	pointer
_plotter	O
->	O
drawstate	pointer
->	O
fig_fgcolor	pointer
=	O
_pl_f_fig_color	int
(	O
R___	pointer
(	O
_plotter	pointer
)	O
(	O
_plotter	pointer
->	O
drawstate	pointer
->	O
fgcolor	pointer
)	O
.	O
red	pointer
,	O
(	pointer
_plotter	O
->	O
drawstate	pointer
->	O
fgcolor	pointer
)	O
.	O
green	pointer
,	O
(	pointer
_plotter	O
->	O
drawstate	pointer
->	O
fgcolor	pointer
)	O
.	O
blue	pointer
)	O
;	O
return	O
;	O
}	O
void	O
_pl_f_set_fill_color	function
(	O
S___	O
(	O
Plotter	O
*	O
_plotter	pointer
)	O
)	O
{	O
double	O
fill_level	function
;	O
if	O
(	O
_plotter	O
->	O
drawstate	pointer
->	O
fillcolor_base	pointer
.	O
red	int
>	O
0xffff	int
||	O
_plotter	O
->	O
drawstate	pointer
->	O
fillcolor_base	pointer
.	O
green	int
>	O
0xffff	int
||	O
_plotter	O
->	O
drawstate	pointer
->	O
fillcolor_base	pointer
.	O
blue	int
>	O
0xffff	int
)	O
_plotter	O
->	O
drawstate	pointer
->	O
fig_fillcolor	pointer
=	O
_default_drawstate	int
.	O
fig_fillcolor	pointer
;	O
else	pointer
_plotter	O
->	O
drawstate	pointer
->	O
fig_fillcolor	pointer
=	O
_pl_f_fig_color	int
(	O
R___	pointer
(	O
_plotter	pointer
)	O
_plotter	O
->	O
drawstate	pointer
->	O
fillcolor_base	pointer
.	O
red	int
,	O
_plotter	pointer
->	O
drawstate	pointer
->	O
fillcolor_base	pointer
.	O
green	int
,	O
_plotter	pointer
->	O
drawstate	pointer
->	O
fillcolor_base	pointer
.	O
blue	int
)	O
;	O
fill_level	O
=	O
(	int
(	O
double	O
)	O
_plotter	O
->	O
drawstate	pointer
->	O
fill_type	pointer
-	O
1.	int
)	O
/	O
0xFFFE	int
;	O
if	pointer
(	O
fill_level	pointer
>	O
1.	int
)	O
fill_level	O
=	O
(	pointer
(	O
double	O
)	O
_default_drawstate	O
.	O
fill_type	O
-	O
1.	int
)	O
/	O
0xFFFE	int
;	O
else	O
if	O
(	O
fill_level	O
<	O
0.	int
)	O
fill_level	O
=	O
-	int
1.0	O
;	O
if	O
(	O
fill_level	O
==	O
-	O
1.0	int
)	O
_plotter	O
->	O
drawstate	pointer
->	O
fig_fill_level	pointer
=	O
-	int
1	O
;	O
else	O
{	O
switch	O
(	O
_plotter	int
->	O
drawstate	pointer
->	O
fig_fillcolor	pointer
)	O
{	O
case	O
FIG_C_WHITE	O
:	O
_plotter	O
->	O
drawstate	pointer
->	O
fig_fill_level	pointer
=	O
20	int
;	O
break	pointer
;	O
case	O
FIG_C_BLACK	int
:	O
_plotter	O
->	O
drawstate	pointer
->	O
fig_fill_level	pointer
=	O
IROUND	int
(	O
20.0	pointer
-	O
20.0	int
*	O
fill_level	O
)	O
;	O
break	O
;	O
default	O
:	O
_plotter	O
->	O
drawstate	pointer
->	O
fig_fill_level	pointer
=	O
IROUND	int
(	O
20.0	pointer
+	O
20.0	int
*	O
fill_level	O
)	O
;	O
break	O
;	O
}	O
}	O
return	O
;	O
}	O