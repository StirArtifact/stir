int	O
got_signal	O
=	O
0	O
;	O
static	O
void	O
signal_handler	O
(	O
int	O
dummy	int
UNUSEDP	O
)	O
{	O
got_signal	O
=	O
1	O
;	O
}	O
void	O
setup_signal	function
(	O
void	O
)	O
{	O
signal	O
(	O
SIGHUP	int
,	O
signal_handler	O
)	O
;	O
signal	O
(	O
SIGINT	O
,	O
signal_handler	O
)	O
;	O
signal	O
(	O
SIGTERM	int
,	O
signal_handler	O
)	O
;	O
signal	O
(	O
SIGQUIT	int
,	O
signal_handler	O
)	O
;	O
}	O
static	O
void	O
_allow_interrupt	function
(	O
saved_sig_state	O
*	O
ss	pointer
,	O
int	O
sig	int
,	O
int	O
slot	int
)	O
{	O
struct	O
sigaction	struct
new	O
;	O
bzero	O
(	O
&	O
new	pointer
,	O
sizeof	O
(	O
new	O
)	O
)	O
;	O
new	O
.	O
sa_handler	pointer
=	O
signal_handler	O
;	O
new	O
.	O
sa_flags	pointer
&=	O
~	O
SA_RESTART	int
;	O
if	O
(	O
sigaction	O
(	O
sig	int
,	O
&	pointer
new	pointer
,	O
&	O
ss	pointer
->	O
sa	pointer
[	O
slot	int
]	O
)	O
<	O
0	int
)	O
{	O
perror	O
(	O
"sigaction"	pointer
)	O
;	O
exit	O
(	O
1	int
)	O
;	O
}	O
}	O
void	O
allow_interrupts	function
(	O
saved_sig_state	O
*	O
ss	pointer
)	O
{	O
_allow_interrupt	O
(	O
ss	O
,	O
SIGINT	O
,	O
0	O
)	O
;	O
_allow_interrupt	O
(	O
ss	O
,	O
SIGINT	O
,	O
1	int
)	O
;	O
_allow_interrupt	O
(	O
ss	O
,	O
SIGINT	O
,	O
2	int
)	O
;	O
_allow_interrupt	O
(	O
ss	pointer
,	O
SIGINT	O
,	O
3	int
)	O
;	O
}	O
static	O
void	O
_restore_interrupt	function
(	O
saved_sig_state	O
*	O
ss	pointer
,	O
int	O
sig	int
,	O
int	O
slot	int
)	O
{	O
if	O
(	O
sigaction	O
(	O
sig	int
,	O
&	pointer
ss	pointer
->	O
sa	struct
[	O
slot	int
]	O
,	O
NULL	pointer
)	O
<	O
0	int
)	O
{	O
perror	O
(	O
"restore sigaction"	pointer
)	O
;	O
exit	O
(	O
1	int
)	O
;	O
}	O
}	O
void	O
restore_interrupts	function
(	O
saved_sig_state	O
*	O
ss	pointer
)	O
{	O
_restore_interrupt	O
(	O
ss	O
,	O
SIGINT	O
,	O
0	O
)	O
;	O
_restore_interrupt	O
(	O
ss	O
,	O
SIGINT	O
,	O
1	int
)	O
;	O
_restore_interrupt	O
(	O
ss	O
,	O
SIGINT	O
,	O
2	int
)	O
;	O
_restore_interrupt	O
(	O
ss	O
,	O
SIGINT	O
,	O
3	int
)	O
;	O
}	O