typedef	O
int	O
wget_decompressor_decompress_fn	O
(	O
wget_decompressor	O
*	O
dc	pointer
,	O
char	O
*	O
src	pointer
,	O
size_t	O
srclen	long
)	O
;	O
typedef	O
void	O
wget_decompressor_exit_fn	O
(	O
wget_decompressor	O
*	O
dc	pointer
)	O
;	O
struct	O
wget_decompressor_st	struct
{	O
z_stream	O
z_strm	pointer
;	O
wget_decompressor_sink_fn	O
*	O
sink	pointer
;	O
wget_decompressor_error_handler	O
*	O
error_handler	pointer
;	O
wget_decompressor_decompress_fn	O
*	O
decompress	pointer
;	O
wget_decompressor_exit_fn	O
*	O
exit	pointer
;	O
void	O
*	O
context	pointer
;	O
wget_content_encoding	O
encoding	O
;	O
}	O
;	O
static	O
int	O
gzip_init	function
(	O
z_stream	O
*	O
strm	pointer
)	O
{	O
memset	O
(	O
strm	O
,	O
0	int
,	O
sizeof	int
(	O
*	O
strm	pointer
)	O
)	O
;	O
if	O
(	O
inflateInit2	pointer
(	O
strm	pointer
,	O
15	int
+	O
32	int
)	O
!=	O
Z_OK	int
)	O
{	O
error_printf	O
(	O
_	O
(	O
"Failed to init gzip decompression\n"	pointer
)	O
)	O
;	O
return	O
-	int
1	int
;	O
}	O
return	O
0	O
;	O
}	O
static	O
int	O
gzip_decompress	function
(	O
wget_decompressor	O
*	O
dc	pointer
,	O
char	O
*	O
src	pointer
,	O
size_t	O
srclen	O
)	O
{	O
z_stream	O
*	pointer
strm	pointer
;	O
char	O
dst	O
[	O
10240	O
]	O
;	O
int	O
status	int
;	O
if	O
(	O
!	O
srclen	pointer
)	O
{	O
if	O
(	O
dc	int
->	O
sink	pointer
)	O
dc	O
->	O
sink	pointer
(	O
dc	pointer
->	O
context	pointer
,	O
""	pointer
,	O
0	pointer
)	O
;	O
return	O
0	int
;	O
}	O
strm	O
=	O
&	function
dc	pointer
->	O
z_strm	struct
;	O
strm	O
->	O
next_in	int
=	O
(	O
unsigned	O
char	O
*	O
)	O
src	pointer
;	O
strm	O
->	O
avail_in	int
=	O
(	int
unsigned	O
int	O
)	O
srclen	O
;	O
do	O
{	O
strm	O
->	O
next_out	int
=	O
(	pointer
unsigned	O
char	O
*	O
)	O
dst	pointer
;	O
strm	O
->	O
avail_out	int
=	O
sizeof	int
(	O
dst	O
)	O
;	O
status	O
=	O
inflate	function
(	O
strm	O
,	O
Z_SYNC_FLUSH	int
)	O
;	O
if	O
(	O
(	int
status	O
==	O
Z_OK	O
||	O
status	O
==	O
Z_STREAM_END	O
)	O
&&	O
strm	O
->	O
avail_out	int
<	O
sizeof	int
(	O
dst	pointer
)	O
)	O
{	O
if	O
(	O
dc	pointer
->	O
sink	pointer
)	O
dc	O
->	O
sink	pointer
(	O
dc	pointer
->	O
context	pointer
,	O
dst	pointer
,	O
sizeof	int
(	O
dst	O
)	O
-	O
strm	int
->	O
avail_out	int
)	O
;	O
}	O
}	O
while	O
(	O
status	O
==	O
Z_OK	int
&&	O
!	O
strm	O
->	O
avail_out	int
)	O
;	O
if	O
(	O
status	pointer
==	O
Z_OK	O
||	O
status	int
==	O
Z_STREAM_END	O
)	O
return	O
0	int
;	O
error_printf	O
(	O
_	O
(	O
"Failed to uncompress gzip stream (%d)\n"	pointer
)	O
,	O
status	pointer
)	O
;	O
return	O
-	int
1	int
;	O
}	O
static	O
void	O
gzip_exit	function
(	O
wget_decompressor	O
*	O
dc	pointer
)	O
{	O
int	O
status	int
;	O
if	O
(	O
(	O
status	O
=	O
inflateEnd	function
(	O
&	O
dc	struct
->	O
z_strm	pointer
)	O
)	O
!=	O
Z_OK	int
)	O
{	O
error_printf	O
(	O
_	O
(	O
"Failed to close gzip stream (%d)\n"	pointer
)	O
,	O
status	pointer
)	O
;	O
}	O
}	O
static	O
int	O
deflate_init	function
(	O
z_stream	O
*	O
strm	pointer
)	O
{	O
memset	O
(	O
strm	O
,	O
0	int
,	O
sizeof	int
(	O
*	O
strm	pointer
)	O
)	O
;	O
if	O
(	O
inflateInit	O
(	O
strm	pointer
)	O
!=	O
Z_OK	int
)	O
{	O
error_printf	O
(	O
_	O
(	O
"Failed to init deflate decompression\n"	pointer
)	O
)	O
;	O
return	O
-	int
1	int
;	O
}	O
return	O
0	O
;	O
}	O
static	O
int	O
identity	function
(	O
wget_decompressor	O
*	O
dc	pointer
,	O
char	O
*	O
src	pointer
,	O
size_t	O
srclen	O
)	O
{	O
if	O
(	O
dc	O
->	O
sink	pointer
)	O
dc	O
->	O
sink	pointer
(	O
dc	pointer
->	O
context	pointer
,	O
src	pointer
,	O
srclen	int
)	O
;	O
return	O
0	int
;	O
}	O
wget_decompressor	O
*	O
wget_decompress_open	function
(	O
wget_content_encoding	O
encoding	O
,	O
wget_decompressor_sink_fn	O
*	O
sink	pointer
,	O
void	O
*	O
context	pointer
)	O
{	O
int	O
rc	int
=	O
0	int
;	O
wget_decompressor	O
*	O
dc	pointer
=	O
wget_calloc	O
(	O
1	int
,	O
sizeof	O
(	O
wget_decompressor	O
)	O
)	O
;	O
if	O
(	O
!	O
dc	O
)	O
return	O
NULL	O
;	O
if	O
(	O
encoding	O
==	O
wget_content_encoding_gzip	O
)	O
{	O
if	O
(	O
(	pointer
rc	O
=	O
gzip_init	function
(	O
&	O
dc	pointer
->	O
z_strm	pointer
)	O
)	O
==	O
0	int
)	O
{	O
dc	O
->	O
decompress	pointer
=	O
gzip_decompress	O
;	O
dc	pointer
->	O
exit	pointer
=	O
gzip_exit	int
;	O
}	O
}	O
else	O
if	O
(	O
encoding	O
==	O
wget_content_encoding_deflate	O
)	O
{	O
if	O
(	O
(	pointer
rc	O
=	O
deflate_init	function
(	O
&	O
dc	pointer
->	O
z_strm	pointer
)	O
)	O
==	O
0	int
)	O
{	O
dc	O
->	O
decompress	pointer
=	O
gzip_decompress	O
;	O
dc	pointer
->	O
exit	pointer
=	O
gzip_exit	int
;	O
}	O
}	O
else	O
if	O
(	O
encoding	O
==	O
wget_content_encoding_bzip2	O
)	O
{	O
}	O
else	O
if	O
(	O
encoding	O
==	O
wget_content_encoding_lzma	O
)	O
{	O
}	O
else	O
if	O
(	O
encoding	O
==	O
wget_content_encoding_brotli	O
)	O
{	O
}	O
else	O
if	O
(	O
encoding	O
==	O
wget_content_encoding_zstd	O
)	O
{	O
}	O
if	O
(	O
!	O
dc	O
->	O
decompress	pointer
)	O
{	O
debug_printf	O
(	O
"Falling back to Content-Encoding 'identity'\n"	pointer
)	O
;	O
dc	O
->	O
decompress	pointer
=	O
identity	O
;	O
}	pointer
if	O
(	O
rc	O
)	O
{	O
xfree	O
(	O
dc	pointer
)	O
;	O
return	O
NULL	int
;	O
}	O
dc	O
->	O
encoding	pointer
=	O
encoding	pointer
;	O
dc	O
->	O
sink	pointer
=	O
sink	O
;	O
dc	pointer
->	O
context	pointer
=	O
context	O
;	O
return	pointer
dc	int
;	O
}	O
void	O
wget_decompress_close	function
(	O
wget_decompressor	O
*	O
dc	pointer
)	O
{	O
if	O
(	O
dc	O
)	O
{	O
if	O
(	O
dc	pointer
->	O
exit	pointer
)	O
dc	O
->	O
exit	pointer
(	O
dc	int
)	O
;	O
xfree	O
(	O
dc	pointer
)	O
;	O
}	O
}	O
int	O
wget_decompress	function
(	O
wget_decompressor	O
*	O
dc	pointer
,	O
char	O
*	O
src	pointer
,	O
size_t	O
srclen	O
)	O
{	O
if	O
(	O
dc	O
)	O
{	O
int	O
rc	int
=	O
dc	int
->	O
decompress	pointer
(	O
dc	pointer
,	O
src	pointer
,	O
srclen	int
)	O
;	O
if	O
(	O
rc	pointer
&&	O
dc	O
->	O
error_handler	pointer
)	O
dc	O
->	O
error_handler	pointer
(	O
dc	pointer
,	O
rc	pointer
)	O
;	O
}	O
return	O
0	O
;	O
}	O
void	O
wget_decompress_set_error_handler	function
(	O
wget_decompressor	O
*	O
dc	pointer
,	O
wget_decompressor_error_handler	O
*	O
error_handler	pointer
)	O
{	O
if	O
(	O
dc	O
)	O
dc	O
->	O
error_handler	pointer
=	O
error_handler	O
;	O
}	pointer
void	O
*	function
wget_decompress_get_context	function
(	O
wget_decompressor	O
*	O
dc	pointer
)	O
{	O
return	O
dc	int
?	O
dc	int
->	O
context	pointer
:	O
NULL	O
;	O
}	O
static	O
char	O
_encoding_names	function
[	O
wget_content_encoding_max	O
]	O
[	O
9	O
]	O
=	O
{	pointer
[	pointer
wget_content_encoding_identity	int
]	O
=	O
"identity"	O
,	O
[	O
wget_content_encoding_gzip	int
]	O
=	O
"gzip"	O
,	O
[	O
wget_content_encoding_deflate	int
]	O
=	O
"deflate"	O
,	O
[	O
wget_content_encoding_xz	int
]	O
=	O
"xz"	O
,	O
[	O
wget_content_encoding_lzma	int
]	O
=	O
"lzma"	O
,	O
[	O
wget_content_encoding_bzip2	int
]	O
=	O
"bzip2"	O
,	O
[	O
wget_content_encoding_brotli	int
]	O
=	O
"br"	O
,	O
[	O
wget_content_encoding_zstd	int
]	O
=	O
"zstd"	O
,	O
}	O
;	O
wget_content_encoding	O
wget_content_encoding_by_name	O
(	O
const	O
char	O
*	O
name	pointer
)	O
{	O
if	O
(	O
name	O
)	O
{	O
for	O
(	O
wget_content_encoding	int
it	O
=	O
0	int
;	O
it	int
<	O
wget_content_encoding_max	int
;	O
it	int
++	O
)	O
{	O
if	O
(	O
!	int
strcmp	O
(	O
_encoding_names	pointer
[	O
it	int
]	O
,	O
name	pointer
)	O
)	O
return	O
it	int
;	O
}	O
if	O
(	O
!	O
strcmp	O
(	O
"none"	pointer
,	O
name	pointer
)	O
)	O
return	O
wget_content_encoding_identity	int
;	O
}	O
return	O
wget_content_encoding_unknown	O
;	O
}	O
const	O
char	O
*	function
wget_content_encoding_to_name	function
(	O
wget_content_encoding	O
type	O
)	O
{	O
if	O
(	O
type	O
>=	O
0	int
&&	O
type	int
<	O
wget_content_encoding_max	int
)	O
return	O
_encoding_names	O
[	O
type	int
]	O
;	O
return	O
NULL	int
;	O
}	O