void	O
mpz_fib_ui	O
(	O
mpz_ptr	O
fn	O
,	O
unsigned	pointer
long	O
n	O
)	O
{	O
mp_ptr	O
fp	pointer
,	O
xp	pointer
,	O
yp	pointer
;	O
mp_size_t	O
size	long
,	O
xalloc	pointer
;	O
unsigned	O
long	O
n2	O
;	O
mp_limb_t	O
c	long
,	O
c2	int
;	O
TMP_DECL	O
;	O
if	O
(	O
n	long
<=	O
FIB_TABLE_LIMIT	int
)	O
{	O
PTR	O
(	O
fn	pointer
)	O
[	O
0	int
]	O
=	O
FIB_TABLE	O
(	O
n	pointer
)	O
;	O
SIZ	O
(	O
fn	pointer
)	O
=	O
(	int
n	O
!=	O
0	O
)	O
;	O
return	O
;	int
}	O
n2	O
=	O
n	O
/	O
2	O
;	O
xalloc	O
=	O
MPN_FIB2_SIZE	int
(	O
n2	int
)	O
+	O
1	int
;	O
fp	O
=	O
MPZ_REALLOC	O
(	O
fn	pointer
,	O
2	pointer
*	O
xalloc	int
+	O
1	int
)	O
;	O
TMP_MARK	O
;	O
TMP_ALLOC_LIMBS_2	O
(	O
xp	pointer
,	O
xalloc	pointer
,	O
yp	int
,	O
xalloc	int
)	O
;	O
size	O
=	O
mpn_fib2_ui	O
(	O
xp	pointer
,	O
yp	pointer
,	O
n2	pointer
)	O
;	O
TRACE	O
(	O
printf	pointer
(	O
"mpz_fib_ui last step n=%lu size=%ld bit=%lu\n"	pointer
,	O
n	pointer
>>	O
1	int
,	O
size	int
,	O
n	int
&	O
1	int
)	O
;	O
mpn_trace	O
(	O
"xp"	pointer
,	O
xp	pointer
,	O
size	pointer
)	O
;	O
mpn_trace	O
(	O
"yp"	pointer
,	O
yp	pointer
,	O
size	int
)	O
)	O
;	O
if	O
(	O
n	O
&	O
1	int
)	O
{	O
mp_size_t	O
xsize	long
,	O
ysize	O
;	O
c2	O
=	O
mpn_lshift	int
(	O
fp	pointer
,	O
xp	pointer
,	O
size	pointer
,	O
1	pointer
)	O
;	O
c	O
=	O
c2	O
+	O
mpn_add_n	int
(	O
xp	pointer
,	O
fp	pointer
,	O
yp	pointer
,	O
size	long
)	O
;	O
xp	O
[	O
size	int
]	O
=	O
c	pointer
;	O
xsize	O
=	O
size	O
+	O
(	int
c	O
!=	O
0	O
)	O
;	O
c2	O
-=	O
mpn_sub_n	O
(	O
yp	pointer
,	O
fp	pointer
,	O
yp	pointer
,	O
size	long
)	O
;	O
yp	O
[	O
size	int
]	O
=	O
c2	O
;	O
ASSERT	O
(	O
c2	pointer
<=	O
1	int
)	O
;	O
ysize	O
=	O
size	O
+	O
c2	int
;	O
size	O
=	O
xsize	O
+	O
ysize	int
;	O
c	O
=	O
mpn_mul	int
(	O
fp	pointer
,	O
xp	pointer
,	O
xsize	pointer
,	O
yp	pointer
,	O
ysize	int
)	O
;	O
ASSERT	O
(	O
n	O
&	O
2	int
?	O
fp	int
[	O
0	int
]	O
>=	O
2	O
:	O
fp	O
[	O
0	int
]	O
<=	O
GMP_NUMB_MAX	O
-	O
2	int
)	O
;	O
fp	O
[	O
0	int
]	O
+=	O
(	int
n	O
&	O
2	int
?	O
-	int
CNST_LIMB	int
(	O
2	int
)	O
:	O
CNST_LIMB	O
(	O
2	int
)	O
)	O
;	O
}	O
else	O
{	O
mp_size_t	O
xsize	long
,	O
ysize	O
;	O
c	O
=	O
mpn_lshift	int
(	O
yp	pointer
,	O
yp	long
,	O
size	long
,	O
1	long
)	O
;	O
c	O
+=	O
mpn_add_n	int
(	O
yp	pointer
,	O
yp	long
,	O
xp	long
,	O
size	long
)	O
;	O
yp	O
[	O
size	int
]	O
=	O
c	O
;	O
xsize	O
=	O
size	O
;	O
ysize	O
=	O
size	O
+	O
(	int
c	O
!=	O
0	O
)	O
;	O
size	O
+=	O
ysize	O
;	O
c	O
=	O
mpn_mul	int
(	O
fp	pointer
,	O
yp	O
,	O
ysize	long
,	O
xp	pointer
,	O
xsize	pointer
)	O
;	O
}	O
size	O
-=	O
(	O
c	O
==	O
0	O
)	O
;	O
size	O
-=	O
(	O
fp	O
[	O
size	int
-	O
1	int
]	O
==	O
0	O
)	O
;	O
SIZ	O
(	O
fn	pointer
)	O
=	O
size	int
;	O
TRACE	O
(	O
printf	pointer
(	O
"done special, size=%ld\n"	pointer
,	O
size	pointer
)	O
;	O
mpn_trace	O
(	O
"fp "	pointer
,	O
fp	pointer
,	O
size	pointer
)	O
)	O
;	O
TMP_FREE	O
;	O
}	O