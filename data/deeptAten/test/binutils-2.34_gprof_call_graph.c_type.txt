void	O
cg_tally	O
(	O
bfd_vma	O
from_pc	O
,	O
bfd_vma	O
self_pc	O
,	O
unsigned	O
long	O
count	O
)	O
{	O
Sym	O
*	O
parent	O
;	O
Sym	O
*	O
child	O
;	O
parent	O
=	O
sym_lookup	O
(	O
&	pointer
symtab	struct
,	O
from_pc	O
)	O
;	O
child	O
=	O
sym_lookup	O
(	O
&	pointer
symtab	struct
,	O
self_pc	O
)	O
;	O
if	O
(	O
child	O
==	O
NULL	O
||	O
parent	O
==	O
NULL	O
)	O
return	O
;	int
while	O
(	O
child	O
>=	O
symtab	int
.	O
base	int
&&	O
!	O
child	O
->	O
is_func	pointer
)	O
--	O
child	O
;	O
if	O
(	O
child	O
<	O
symtab	int
.	O
base	int
)	O
return	O
;	O
if	O
(	O
sym_id_arc_is_present	O
(	O
&	pointer
syms	pointer
[	O
INCL_ARCS	int
]	O
,	O
parent	pointer
,	O
child	pointer
)	O
||	O
(	O
syms	O
[	O
INCL_ARCS	int
]	O
.	O
len	pointer
==	O
0	O
&&	O
!	int
sym_id_arc_is_present	O
(	O
&	pointer
syms	pointer
[	O
EXCL_ARCS	int
]	O
,	O
parent	pointer
,	O
child	pointer
)	O
)	O
)	O
{	O
child	O
->	O
ncalls	pointer
+=	O
count	int
;	O
DBG	O
(	O
TALLYDEBUG	pointer
,	O
printf	O
(	O
_	pointer
(	O
"[cg_tally] arc from %s to %s traversed %lu times\n"	pointer
)	O
,	O
parent	pointer
->	O
name	pointer
,	O
child	O
->	O
name	pointer
,	O
count	O
)	O
)	O
;	O
arc_add	O
(	O
parent	pointer
,	O
child	pointer
,	O
count	O
)	O
;	O
}	O
}	O
void	O
cg_read_rec	function
(	O
FILE	O
*	O
ifp	pointer
,	O
const	O
char	O
*	O
filename	pointer
)	O
{	O
bfd_vma	O
from_pc	O
,	O
self_pc	O
;	O
unsigned	O
int	O
count	int
;	O
if	O
(	O
gmon_io_read_vma	O
(	O
ifp	pointer
,	O
&	int
from_pc	pointer
)	O
||	O
gmon_io_read_vma	O
(	O
ifp	pointer
,	O
&	int
self_pc	pointer
)	O
||	O
gmon_io_read_32	O
(	O
ifp	pointer
,	O
&	int
count	pointer
)	O
)	O
{	O
fprintf	O
(	O
stderr	pointer
,	O
_	pointer
(	O
"%s: %s: unexpected end of file\n"	pointer
)	O
,	O
whoami	pointer
,	O
filename	pointer
)	O
;	O
done	O
(	O
1	O
)	O
;	O
}	O
DBG	O
(	O
SAMPLEDEBUG	O
,	O
printf	O
(	O
"[cg_read_rec] frompc 0x%lx selfpc 0x%lx count %lu\n"	pointer
,	O
(	pointer
unsigned	O
long	O
)	O
from_pc	O
,	O
(	O
unsigned	O
long	O
)	O
self_pc	O
,	O
(	O
unsigned	O
long	O
)	O
count	O
)	O
)	O
;	O
cg_tally	O
(	O
from_pc	pointer
,	O
self_pc	O
,	O
count	O
)	O
;	O
}	O
void	O
cg_write_arcs	function
(	O
FILE	O
*	O
ofp	pointer
,	O
const	O
char	O
*	O
filename	pointer
)	O
{	O
Arc	O
*	O
arc	pointer
;	O
Sym	O
*	O
sym	O
;	O
for	O
(	O
sym	int
=	O
symtab	int
.	O
base	pointer
;	O
sym	O
<	O
symtab	int
.	O
limit	int
;	O
sym	O
++	O
)	O
{	O
for	O
(	O
arc	int
=	O
sym	pointer
->	O
cg	pointer
.	O
children	pointer
;	O
arc	O
;	O
arc	O
=	O
arc	O
->	O
next_child	pointer
)	O
{	O
if	O
(	O
gmon_io_write_8	O
(	O
ofp	pointer
,	O
GMON_TAG_CG_ARC	pointer
)	O
||	O
gmon_io_write_vma	O
(	O
ofp	pointer
,	O
arc	pointer
->	O
parent	pointer
->	O
addr	pointer
)	O
||	O
gmon_io_write_vma	O
(	O
ofp	pointer
,	O
arc	pointer
->	O
child	pointer
->	O
addr	pointer
)	O
||	O
gmon_io_write_32	O
(	O
ofp	pointer
,	O
arc	pointer
->	O
count	pointer
)	O
)	O
{	O
perror	O
(	O
filename	pointer
)	O
;	O
done	O
(	O
1	O
)	O
;	O
}	O
DBG	O
(	O
SAMPLEDEBUG	O
,	O
printf	O
(	O
"[cg_write_arcs] frompc 0x%lx selfpc 0x%lx count %lu\n"	pointer
,	O
(	pointer
unsigned	O
long	O
)	O
arc	O
->	O
parent	pointer
->	O
addr	pointer
,	O
(	pointer
unsigned	O
long	O
)	O
arc	O
->	O
child	pointer
->	O
addr	pointer
,	O
arc	pointer
->	O
count	pointer
)	O
)	O
;	O
}	O
}	O
}	O