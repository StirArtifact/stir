int	O
gsl_poly_complex_solve	O
(	O
const	O
double	O
*	O
a	pointer
,	O
size_t	O
n	O
,	O
gsl_poly_complex_workspace	O
*	O
w	pointer
,	O
gsl_complex_packed_ptr	O
z	O
)	O
{	O
int	O
status	int
;	O
double	O
*	array
m	pointer
;	O
if	O
(	O
n	O
==	O
0	O
)	O
{	O
GSL_ERROR	O
(	O
"number of terms must be a positive integer"	O
,	O
GSL_EINVAL	O
)	O
;	O
}	O
if	O
(	O
n	O
==	O
1	O
)	O
{	O
GSL_ERROR	O
(	O
"cannot solve for only one term"	O
,	O
GSL_EINVAL	O
)	O
;	O
}	O
if	O
(	O
a	O
[	O
n	int
-	O
1	int
]	O
==	O
0	O
)	O
{	O
GSL_ERROR	O
(	O
"leading term of polynomial must be non-zero"	O
,	O
GSL_EINVAL	O
)	O
;	O
}	O
if	O
(	O
w	O
->	O
nc	pointer
!=	O
n	O
-	O
1	int
)	O
{	O
GSL_ERROR	O
(	O
"size of workspace does not match polynomial"	O
,	O
GSL_EINVAL	O
)	O
;	O
}	O
m	O
=	O
w	O
->	O
matrix	pointer
;	O
set_companion_matrix	O
(	O
a	O
,	O
n	O
-	O
1	int
,	O
m	O
)	O
;	O
balance_companion_matrix	O
(	O
m	O
,	O
n	O
-	O
1	int
)	O
;	O
status	O
=	O
qr_companion	int
(	O
m	O
,	O
n	O
-	O
1	int
,	O
z	O
)	O
;	O
if	O
(	O
status	O
)	O
{	O
GSL_ERROR	O
(	O
"root solving qr method failed to converge"	O
,	O
GSL_EFAILED	O
)	O
;	O
}	O
return	O
GSL_SUCCESS	O
;	O
}	O