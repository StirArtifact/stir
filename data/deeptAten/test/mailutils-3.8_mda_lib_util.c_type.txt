int	O
exit_code	O
;	O
void	O
mda_close_fds	O
(	O
void	O
)	O
{	O
int	O
i	int
;	O
long	O
fdlimit	O
=	O
sysconf	int
(	O
_SC_OPEN_MAX	pointer
)	O
;	O
for	O
(	O
i	int
=	O
3	int
;	O
i	int
<	O
fdlimit	int
;	O
i	int
++	O
)	O
close	O
(	O
i	pointer
)	O
;	O
}	O
int	O
mda_switch_user_id	function
(	O
struct	O
mu_auth_data	struct
*	O
auth	pointer
,	O
int	O
user	int
)	O
{	O
int	O
rc	int
;	O
uid_t	O
uid	int
;	O
if	O
(	O
!	O
auth	int
||	O
auth	O
->	O
change_uid	pointer
==	O
0	O
)	O
return	O
0	int
;	O
if	O
(	O
user	O
)	O
uid	O
=	O
auth	int
->	O
uid	int
;	O
else	O
uid	O
=	O
0	int
;	O
rc	int
=	O
setreuid	int
(	O
0	int
,	O
uid	int
)	O
;	O
if	O
(	O
rc	int
<	O
0	int
)	O
mda_error	O
(	O
"setreuid(0, %d): %s (r=%d, e=%d)"	pointer
,	O
uid	int
,	O
strerror	int
(	O
errno	int
)	O
,	O
getuid	O
(	O
)	O
,	O
geteuid	O
(	O
)	O
)	O
;	O
return	O
rc	int
;	O
}	O
static	O
int	O
temp_errors	function
[	O
]	O
=	O
{	O
EAGAIN	O
,	O
EBUSY	O
,	O
EUSERS	O
,	O
ECONNABORTED	pointer
,	O
ECONNREFUSED	pointer
,	O
ECONNRESET	pointer
,	O
EDEADLK	pointer
,	O
EDEADLOCK	int
,	O
EFBIG	int
,	O
EHOSTDOWN	int
,	O
EHOSTUNREACH	int
,	O
EMFILE	int
,	O
ENETDOWN	int
,	O
ENETUNREACH	int
,	O
ENETRESET	int
,	O
ENFILE	int
,	O
ENOBUFS	int
,	O
ENOMEM	pointer
,	O
ENOSPC	pointer
,	O
EROFS	pointer
,	O
ESTALE	pointer
,	O
ETIMEDOUT	pointer
,	O
EWOULDBLOCK	pointer
,	O
}	pointer
;	O
static	O
void	O
guess_retval	function
(	O
int	O
ec	int
)	O
{	O
int	O
i	int
;	O
if	O
(	O
exit_code	O
==	O
EX_TEMPFAIL	O
)	O
return	O
;	int
if	O
(	O
ec	O
==	O
EDQUOT	int
)	O
{	O
exit_code	O
=	O
EX_QUOTA	int
;	O
return	O
;	int
}	O
for	O
(	O
i	O
=	O
0	int
;	O
i	int
<	O
sizeof	int
(	O
temp_errors	pointer
)	O
/	O
sizeof	int
(	O
temp_errors	pointer
[	O
0	int
]	O
)	O
;	O
i	O
++	O
)	O
if	O
(	O
temp_errors	int
[	O
i	int
]	O
==	O
ec	O
)	O
{	O
exit_code	O
=	O
EX_TEMPFAIL	int
;	O
return	O
;	int
}	O
exit_code	O
=	O
EX_UNAVAILABLE	function
;	O
}	O
void	O
mda_error	function
(	O
const	O
char	O
*	O
fmt	pointer
,	O
...	O
)	O
{	O
va_list	O
ap	pointer
;	O
guess_retval	O
(	O
errno	O
)	O
;	O
va_start	O
(	O
ap	pointer
,	O
fmt	pointer
)	O
;	O
mu_verror	O
(	O
fmt	pointer
,	O
ap	pointer
)	O
;	O
va_end	O
(	O
ap	pointer
)	O
;	O
}	O
static	O
struct	O
mu_cli_capa	struct
mda_cli_capa	O
[	O
]	O
=	O
{	pointer
{	pointer
"forward"	O
,	O
NULL	O
,	O
mda_forward_cfg	O
}	O
,	O
{	O
"deliver"	pointer
,	O
mda_deliver_options	O
,	O
mda_deliver_cfg	O
}	O
,	O
{	O
"quota"	pointer
,	O
NULL	O
,	O
mda_mailquota_cfg	int
}	O
,	O
{	O
"script"	pointer
,	O
mda_script_options	O
,	O
mda_script_cfg	O
}	O
,	O
{	O
NULL	pointer
}	O
}	O
;	O
void	O
mda_cli_capa_init	function
(	O
void	O
)	O
{	O
size_t	O
i	O
;	O
for	O
(	O
i	long
=	O
0	int
;	O
mda_cli_capa	int
[	O
i	int
]	O
.	O
name	pointer
;	O
i	pointer
++	O
)	O
mu_cli_capa_register	O
(	O
&	pointer
mda_cli_capa	pointer
[	O
i	int
]	O
)	O
;	O
}	O