static	O
OM_uint32	int
dup_data	function
(	O
OM_uint32	int
*	O
minor_status	pointer
,	O
gss_buffer_t	pointer
out	pointer
,	O
const	O
char	O
*	O
str	pointer
,	O
int	O
translate	int
)	O
{	O
if	O
(	O
!	O
out	pointer
)	O
return	O
GSS_S_COMPLETE	int
;	O
if	O
(	O
translate	int
)	O
out	pointer
->	O
value	pointer
=	O
strdup	function
(	O
_	O
(	O
str	pointer
)	O
)	O
;	O
else	O
out	pointer
->	O
value	pointer
=	O
strdup	function
(	O
str	pointer
)	O
;	O
if	O
(	O
!	O
out	pointer
->	O
value	pointer
)	O
{	O
if	O
(	O
minor_status	pointer
)	O
*	O
minor_status	pointer
=	O
ENOMEM	int
;	O
return	O
GSS_S_FAILURE	O
;	O
}	O
out	pointer
->	O
length	int
=	O
strlen	function
(	O
str	pointer
)	O
;	O
return	O
GSS_S_COMPLETE	int
;	O
}	O
OM_uint32	int
gss_inquire_saslname_for_mech	function
(	O
OM_uint32	int
*	O
minor_status	pointer
,	O
const	O
gss_OID	pointer
desired_mech	pointer
,	O
gss_buffer_t	pointer
sasl_mech_name	pointer
,	O
gss_buffer_t	pointer
mech_name	pointer
,	O
gss_buffer_t	pointer
mech_description	pointer
)	O
{	O
_gss_mech_api_t	pointer
m	pointer
;	O
if	O
(	O
!	O
desired_mech	pointer
)	O
{	O
if	O
(	O
minor_status	pointer
)	O
*	O
minor_status	pointer
=	O
0	int
;	O
return	O
GSS_S_CALL_INACCESSIBLE_READ	O
;	O
}	O
m	pointer
=	O
_gss_find_mech_no_default	function
(	O
desired_mech	pointer
)	O
;	O
if	O
(	O
!	O
m	pointer
)	O
{	O
if	O
(	O
minor_status	pointer
)	O
*	O
minor_status	pointer
=	O
0	int
;	O
return	O
GSS_S_BAD_MECH	O
;	O
}	O
bindtextdomain	function
(	O
PACKAGE	pointer
PO_SUFFIX	pointer
,	O
LOCALEDIR	O
)	O
;	O
if	O
(	O
dup_data	function
(	O
minor_status	pointer
,	O
sasl_mech_name	pointer
,	O
m	pointer
->	O
sasl_name	pointer
,	O
0	int
)	O
!=	O
GSS_S_COMPLETE	int
)	O
return	O
GSS_S_FAILURE	O
;	O
if	O
(	O
dup_data	function
(	O
minor_status	pointer
,	O
mech_name	pointer
,	O
m	pointer
->	O
mech_name	pointer
,	O
0	int
)	O
!=	O
GSS_S_COMPLETE	int
)	O
{	O
if	O
(	O
sasl_mech_name	pointer
)	O
free	function
(	O
sasl_mech_name	pointer
->	O
value	pointer
)	O
;	O
return	O
GSS_S_FAILURE	O
;	O
}	O
if	O
(	O
dup_data	function
(	O
minor_status	pointer
,	O
mech_description	pointer
,	O
m	pointer
->	O
mech_description	pointer
,	O
1	int
)	O
!=	O
GSS_S_COMPLETE	int
)	O
{	O
if	O
(	O
sasl_mech_name	pointer
)	O
free	function
(	O
sasl_mech_name	pointer
->	O
value	pointer
)	O
;	O
if	O
(	O
mech_name	pointer
)	O
free	function
(	O
mech_name	pointer
->	O
value	pointer
)	O
;	O
return	O
GSS_S_FAILURE	O
;	O
}	O
return	O
GSS_S_COMPLETE	int
;	O
}	O
OM_uint32	int
gss_inquire_mech_for_saslname	function
(	O
OM_uint32	int
*	O
minor_status	pointer
,	O
const	O
gss_buffer_t	pointer
sasl_mech_name	pointer
,	O
gss_OID	pointer
*	O
mech_type	pointer
)	O
{	O
_gss_mech_api_t	pointer
m	pointer
;	O
if	O
(	O
!	O
sasl_mech_name	pointer
)	O
{	O
if	O
(	O
minor_status	pointer
)	O
*	O
minor_status	pointer
=	O
0	int
;	O
return	O
GSS_S_CALL_INACCESSIBLE_READ	O
;	O
}	O
m	pointer
=	O
_gss_find_mech_by_saslname	function
(	O
sasl_mech_name	pointer
)	O
;	O
if	O
(	O
!	O
m	pointer
)	O
{	O
if	O
(	O
minor_status	pointer
)	O
*	O
minor_status	pointer
=	O
0	int
;	O
return	O
GSS_S_BAD_MECH	O
;	O
}	O
if	O
(	O
mech_type	pointer
)	O
*	O
mech_type	pointer
=	O
m	pointer
->	O
mech	pointer
;	O
return	O
GSS_S_COMPLETE	int
;	O
}	O
