static	O
struct	O
_CONFIG	struct
{	O
char	O
*	O
cookie_file	pointer
;	O
wget_cookie_db	struct
*	O
cookie_db	pointer
;	O
char	O
cookies_enabled	char
,	O
keep_session_cookies	char
;	O
}	O
_config	struct
=	O
{	O
.	O
cookies_enabled	char
=	O
0	int
}	O
;	O
static	O
wget_dns_cache	struct
*	O
dns_cache	pointer
;	O
static	O
int	O
_init	int
;	O
static	O
wget_thread_mutex	pointer
_mutex	pointer
;	O
static	O
bool	bool
initialized	bool
;	O
static	O
void	O
__attribute__	O
(	O
(	O
constructor	O
)	O
)	O
_wget_global_init	function
(	O
void	O
)	O
{	O
if	O
(	O
!	O
initialized	bool
)	O
{	O
wget_thread_mutex_init	function
(	O
&	O
_mutex	pointer
)	O
;	O
initialized	bool
=	O
1	int
;	O
}	O
}	O
static	O
void	O
__attribute__	O
(	O
(	O
destructor	pointer
)	O
)	O
_wget_global_exit	function
(	O
void	O
)	O
{	O
if	O
(	O
initialized	bool
)	O
{	O
wget_thread_mutex_destroy	function
(	O
&	O
_mutex	pointer
)	O
;	O
initialized	bool
=	O
0	int
;	O
}	O
}	O
void	O
wget_global_init	function
(	O
int	O
first_key	int
,	O
...	O
)	O
{	O
va_list	array
args	array
;	O
int	O
key	int
,	O
rc	int
,	O
caching	int
;	O
const	O
char	O
*	O
psl_file	pointer
=	O
NULL	O
;	O
wget_logger_func	function
*	O
func	pointer
;	O
_wget_global_init	function
(	O
)	O
;	O
wget_thread_mutex_lock	function
(	O
_mutex	pointer
)	O
;	O
if	O
(	O
_init	int
++	O
)	O
{	O
wget_thread_mutex_unlock	function
(	O
_mutex	pointer
)	O
;	O
return	O
;	O
}	O
wget_console_init	function
(	O
)	O
;	O
wget_random_init	function
(	O
)	O
;	O
wget_http_init	function
(	O
)	O
;	O
va_start	O
(	O
args	array
,	O
first_key	int
)	O
;	O
for	O
(	O
key	int
=	O
first_key	int
;	O
key	int
;	O
key	int
=	O
va_arg	O
(	O
args	array
,	O
int	O
)	O
)	O
{	O
switch	O
(	O
key	int
)	O
{	O
case	O
WGET_DEBUG_STREAM	int
:	O
wget_logger_set_stream	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_DEBUG	int
)	O
,	O
va_arg	O
(	O
args	array
,	O
FILE	struct
*	O
)	O
)	O
;	O
break	O
;	O
case	O
WGET_DEBUG_FUNC	int
:	O
func	pointer
=	O
va_arg	O
(	O
args	array
,	O
wget_logger_func	function
*	O
)	O
;	O
wget_logger_set_func	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_DEBUG	int
)	O
,	O
func	pointer
)	O
;	O
break	O
;	O
case	O
WGET_DEBUG_FILE	int
:	O
wget_logger_set_file	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_DEBUG	int
)	O
,	O
va_arg	O
(	O
args	array
,	O
const	O
char	O
*	O
)	O
)	O
;	O
break	O
;	O
case	O
WGET_ERROR_STREAM	int
:	O
wget_logger_set_stream	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_ERROR	int
)	O
,	O
va_arg	O
(	O
args	array
,	O
FILE	struct
*	O
)	O
)	O
;	O
break	O
;	O
case	O
WGET_ERROR_FUNC	int
:	O
func	pointer
=	O
va_arg	O
(	O
args	array
,	O
wget_logger_func	function
*	O
)	O
;	O
wget_logger_set_func	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_ERROR	int
)	O
,	O
func	pointer
)	O
;	O
break	O
;	O
case	O
WGET_ERROR_FILE	int
:	O
wget_logger_set_file	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_ERROR	int
)	O
,	O
va_arg	O
(	O
args	array
,	O
const	O
char	O
*	O
)	O
)	O
;	O
break	O
;	O
case	O
WGET_INFO_STREAM	int
:	O
wget_logger_set_stream	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_INFO	int
)	O
,	O
va_arg	O
(	O
args	array
,	O
FILE	struct
*	O
)	O
)	O
;	O
break	O
;	O
case	O
WGET_INFO_FUNC	int
:	O
func	pointer
=	O
va_arg	O
(	O
args	array
,	O
wget_logger_func	function
*	O
)	O
;	O
wget_logger_set_func	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_INFO	int
)	O
,	O
func	pointer
)	O
;	O
break	O
;	O
case	O
WGET_INFO_FILE	int
:	O
wget_logger_set_file	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_INFO	int
)	O
,	O
va_arg	O
(	O
args	array
,	O
const	O
char	O
*	O
)	O
)	O
;	O
break	O
;	O
case	O
WGET_DNS_CACHING	int
:	O
caching	int
=	O
va_arg	O
(	O
args	array
,	O
int	O
)	O
;	O
if	O
(	O
caching	int
)	O
{	O
if	O
(	O
(	O
rc	int
=	O
wget_dns_cache_init	function
(	O
&	O
dns_cache	pointer
)	O
)	O
==	O
WGET_E_SUCCESS	int
)	O
wget_dns_set_cache	function
(	O
NULL	O
,	O
dns_cache	pointer
)	O
;	O
else	O
wget_error_printf	function
(	O
_	O
(	O
"Failed to init DNS cache (%d)"	pointer
)	O
,	O
rc	int
)	O
;	O
}	O
break	O
;	O
case	O
WGET_TCP_FASTFORWARD	int
:	O
wget_tcp_set_tcp_fastopen	function
(	O
NULL	O
,	O
va_arg	O
(	O
args	array
,	O
int	O
)	O
)	O
;	O
break	O
;	O
case	O
WGET_COOKIE_SUFFIXES	int
:	O
psl_file	pointer
=	O
va_arg	O
(	O
args	array
,	O
const	O
char	O
*	O
)	O
;	O
_config	struct
.	O
cookies_enabled	char
=	O
1	int
;	O
break	O
;	O
case	O
WGET_COOKIES_ENABLED	int
:	O
_config	struct
.	O
cookies_enabled	char
=	O
!	O
!	O
va_arg	O
(	O
args	array
,	O
int	O
)	O
;	O
break	O
;	O
case	O
WGET_COOKIE_FILE	int
:	O
_config	struct
.	O
cookies_enabled	char
=	O
1	int
;	O
_config	struct
.	O
cookie_file	pointer
=	O
va_arg	O
(	O
args	array
,	O
char	O
*	O
)	O
;	O
break	O
;	O
case	O
WGET_COOKIE_KEEPSESSIONCOOKIES	int
:	O
_config	struct
.	O
keep_session_cookies	char
=	O
!	O
!	O
va_arg	O
(	O
args	array
,	O
int	O
)	O
;	O
break	O
;	O
case	O
WGET_BIND_ADDRESS	int
:	O
wget_tcp_set_bind_address	function
(	O
NULL	O
,	O
va_arg	O
(	O
args	array
,	O
const	O
char	O
*	O
)	O
)	O
;	O
break	O
;	O
case	O
WGET_NET_FAMILY_EXCLUSIVE	int
:	O
wget_tcp_set_family	function
(	O
NULL	O
,	O
va_arg	O
(	O
args	array
,	O
int	O
)	O
)	O
;	O
break	O
;	O
case	O
WGET_NET_FAMILY_PREFERRED	int
:	O
wget_tcp_set_preferred_family	function
(	O
NULL	O
,	O
va_arg	O
(	O
args	array
,	O
int	O
)	O
)	O
;	O
break	O
;	O
default	O
:	O
wget_thread_mutex_unlock	function
(	O
_mutex	pointer
)	O
;	O
wget_error_printf	function
(	O
_	O
(	O
"%s: Unknown option %d"	pointer
)	O
,	O
__func__	O
,	O
key	int
)	O
;	O
va_end	O
(	O
args	array
)	O
;	O
return	O
;	O
}	O
}	O
va_end	O
(	O
args	array
)	O
;	O
if	O
(	O
_config	struct
.	O
cookies_enabled	char
&&	O
_config	struct
.	O
cookie_file	pointer
)	O
{	O
_config	struct
.	O
cookie_db	pointer
=	O
wget_cookie_db_init	function
(	O
NULL	O
)	O
;	O
wget_cookie_set_keep_session_cookies	function
(	O
_config	struct
.	O
cookie_db	pointer
,	O
_config	struct
.	O
keep_session_cookies	char
)	O
;	O
wget_cookie_db_load	function
(	O
_config	struct
.	O
cookie_db	pointer
,	O
_config	struct
.	O
cookie_file	pointer
)	O
;	O
wget_cookie_db_load_psl	function
(	O
_config	struct
.	O
cookie_db	pointer
,	O
psl_file	pointer
)	O
;	O
}	O
rc	int
=	O
wget_net_init	function
(	O
)	O
;	O
wget_thread_mutex_unlock	function
(	O
_mutex	pointer
)	O
;	O
if	O
(	O
rc	int
)	O
wget_error_printf_exit	function
(	O
_	O
(	O
"%s: Failed to init networking (%d)"	pointer
)	O
,	O
__func__	O
,	O
rc	int
)	O
;	O
}	O
void	O
wget_global_deinit	function
(	O
void	O
)	O
{	O
int	O
rc	int
=	O
0	int
;	O
if	O
(	O
_init	int
==	O
1	int
)	O
{	O
if	O
(	O
_config	struct
.	O
cookie_db	pointer
&&	O
_config	struct
.	O
cookies_enabled	char
&&	O
_config	struct
.	O
cookie_file	pointer
)	O
{	O
wget_cookie_db_save	function
(	O
_config	struct
.	O
cookie_db	pointer
,	O
_config	struct
.	O
cookie_file	pointer
)	O
;	O
wget_cookie_db_free	function
(	O
&	O
_config	struct
.	O
cookie_db	pointer
)	O
;	O
}	O
wget_tcp_set_bind_address	function
(	O
NULL	O
,	O
NULL	O
)	O
;	O
wget_dns_cache_free	function
(	O
&	O
dns_cache	pointer
)	O
;	O
rc	int
=	O
wget_net_deinit	function
(	O
)	O
;	O
wget_ssl_deinit	function
(	O
)	O
;	O
wget_http_set_http_proxy	function
(	O
NULL	O
,	O
NULL	O
)	O
;	O
wget_http_set_https_proxy	function
(	O
NULL	O
,	O
NULL	O
)	O
;	O
wget_http_set_no_proxy	function
(	O
NULL	O
,	O
NULL	O
)	O
;	O
}	O
if	O
(	O
_init	int
>	O
0	int
)	O
_init	int
--	O
;	O
_wget_global_exit	function
(	O
)	O
;	O
if	O
(	O
rc	int
)	O
wget_error_printf	function
(	O
_	O
(	O
"%s: Failed to deinit networking (%d)"	pointer
)	O
,	O
__func__	O
,	O
rc	int
)	O
;	O
wget_console_deinit	function
(	O
)	O
;	O
}	O
int	O
wget_global_get_int	function
(	O
int	O
key	int
)	O
{	O
switch	O
(	O
key	int
)	O
{	O
case	O
WGET_COOKIES_ENABLED	int
:	O
return	O
_config	struct
.	O
cookies_enabled	char
;	O
case	O
WGET_COOKIE_KEEPSESSIONCOOKIES	int
:	O
return	O
_config	struct
.	O
keep_session_cookies	char
;	O
case	O
WGET_NET_FAMILY_EXCLUSIVE	int
:	O
return	O
wget_tcp_get_family	function
(	O
NULL	O
)	O
;	O
case	O
WGET_NET_FAMILY_PREFERRED	int
:	O
return	O
wget_tcp_get_preferred_family	function
(	O
NULL	O
)	O
;	O
default	O
:	O
wget_error_printf	function
(	O
_	O
(	O
"%s: Unknown option %d"	pointer
)	O
,	O
__func__	O
,	O
key	int
)	O
;	O
return	O
0	int
;	O
}	O
}	O
const	O
void	O
*	O
wget_global_get_ptr	function
(	O
int	O
key	int
)	O
{	O
switch	O
(	O
key	int
)	O
{	O
case	O
WGET_DEBUG_STREAM	int
:	O
return	O
wget_logger_get_stream	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_DEBUG	int
)	O
)	O
;	O
case	O
WGET_DEBUG_FILE	int
:	O
return	O
wget_logger_get_file	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_DEBUG	int
)	O
)	O
;	O
case	O
WGET_ERROR_STREAM	int
:	O
return	O
wget_logger_get_stream	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_ERROR	int
)	O
)	O
;	O
case	O
WGET_ERROR_FILE	int
:	O
return	O
wget_logger_get_file	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_ERROR	int
)	O
)	O
;	O
case	O
WGET_INFO_STREAM	int
:	O
return	O
wget_logger_get_stream	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_INFO	int
)	O
)	O
;	O
case	O
WGET_INFO_FILE	int
:	O
return	O
wget_logger_get_file	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_INFO	int
)	O
)	O
;	O
case	O
WGET_COOKIE_FILE	int
:	O
return	O
_config	struct
.	O
cookie_file	pointer
;	O
case	O
WGET_COOKIE_DB	int
:	O
return	O
&	O
_config	struct
.	O
cookie_db	pointer
;	O
default	O
:	O
wget_error_printf	function
(	O
_	O
(	O
"%s: Unknown option %d"	pointer
)	O
,	O
__func__	O
,	O
key	int
)	O
;	O
return	O
NULL	O
;	O
}	O
}	O
wget_global_func	function
*	O
wget_global_get_func	function
(	O
int	O
key	int
)	O
{	O
switch	O
(	O
key	int
)	O
{	O
case	O
WGET_DEBUG_FUNC	int
:	O
return	O
wget_logger_get_func	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_DEBUG	int
)	O
)	O
;	O
case	O
WGET_ERROR_FUNC	int
:	O
return	O
wget_logger_get_func	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_ERROR	int
)	O
)	O
;	O
case	O
WGET_INFO_FUNC	int
:	O
return	O
wget_logger_get_func	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_INFO	int
)	O
)	O
;	O
default	O
:	O
wget_error_printf	function
(	O
_	O
(	O
"%s: Unknown option %d"	pointer
)	O
,	O
__func__	O
,	O
key	int
)	O
;	O
return	O
NULL	O
;	O
}	O
}	O
