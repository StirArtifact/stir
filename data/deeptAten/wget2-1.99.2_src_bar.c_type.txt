enum	O
{	O
_BAR_THREAD_SLEEP_DURATION	int
=	O
125	int
}	O
;	O
static	O
wget_bar	struct
*	O
bar	pointer
;	O
static	O
wget_thread	pointer
progress_thread	pointer
;	O
static	O
bool	bool
_terminate_thread	bool
;	O
static	O
void	O
*	O
_bar_update_thread	function
(	O
void	O
*	O
p	pointer
WGET_GCC_UNUSED	O
)	O
{	O
while	O
(	O
!	O
_terminate_thread	bool
)	O
{	O
wget_bar_update	function
(	O
bar	pointer
)	O
;	O
wget_millisleep	function
(	O
_BAR_THREAD_SLEEP_DURATION	int
)	O
;	O
}	O
return	O
NULL	O
;	O
}	O
static	O
void	O
_error_write	function
(	O
const	O
char	O
*	O
buf	pointer
,	O
size_t	long
len	long
)	O
{	O
wget_bar_write_line	function
(	O
bar	pointer
,	O
buf	pointer
,	O
len	long
)	O
;	O
}	O
bool	bool
bar_init	function
(	O
void	O
)	O
{	O
if	O
(	O
wget_thread_support	function
(	O
)	O
)	O
{	O
if	O
(	O
!	O
(	O
bar	pointer
=	O
wget_bar_init	function
(	O
NULL	O
,	O
1	int
)	O
)	O
)	O
goto	O
nobar	O
;	O
wget_bar_set_speed_type	function
(	O
config	struct
.	O
report_speed	enum
)	O
;	O
wget_logger_set_func	function
(	O
wget_get_logger	function
(	O
WGET_LOGGER_ERROR	int
)	O
,	O
_error_write	function
)	O
;	O
_terminate_thread	bool
=	O
0	int
;	O
if	O
(	O
wget_thread_start	function
(	O
&	O
progress_thread	pointer
,	O
_bar_update_thread	function
,	O
NULL	O
,	O
0	int
)	O
)	O
{	O
wget_bar_free	function
(	O
&	O
bar	pointer
)	O
;	O
goto	O
nobar	O
;	O
}	O
return	O
true	int
;	O
}	O
nobar	O
:	O
wget_error_printf	function
(	O
_	O
(	O
"Cannot create progress bar thread. Disabling progress bar.\n"	pointer
)	O
)	O
;	O
config	struct
.	O
progress	char
=	O
0	int
;	O
return	O
false	int
;	O
}	O
void	O
bar_deinit	function
(	O
void	O
)	O
{	O
_terminate_thread	bool
=	O
1	int
;	O
wget_thread_join	function
(	O
&	O
progress_thread	pointer
)	O
;	O
wget_bar_free	function
(	O
&	O
bar	pointer
)	O
;	O
}	O
void	O
bar_print	function
(	O
int	O
slot	int
,	O
const	O
char	O
*	O
s	pointer
)	O
{	O
wget_bar_print	function
(	O
bar	pointer
,	O
slot	int
,	O
s	pointer
)	O
;	O
}	O
void	O
bar_vprintf	function
(	O
int	O
slot	int
,	O
const	O
char	O
*	O
fmt	pointer
,	O
va_list	array
args	array
)	O
{	O
wget_bar_vprintf	function
(	O
bar	pointer
,	O
slot	int
,	O
fmt	pointer
,	O
args	array
)	O
;	O
}	O
void	O
bar_printf	function
(	O
int	O
slot	int
,	O
const	O
char	O
*	O
fmt	pointer
,	O
...	O
)	O
{	O
va_list	array
args	array
;	O
va_start	O
(	O
args	array
,	O
fmt	pointer
)	O
;	O
bar_vprintf	function
(	O
slot	int
,	O
fmt	pointer
,	O
args	array
)	O
;	O
va_end	O
(	O
args	array
)	O
;	O
}	O
void	O
bar_slot_begin	function
(	O
int	O
slot	int
,	O
const	O
char	O
*	O
filename	pointer
,	O
int	O
new_file	int
,	O
ssize_t	long
filesize	long
)	O
{	O
wget_bar_slot_begin	function
(	O
bar	pointer
,	O
slot	int
,	O
filename	pointer
,	O
new_file	int
,	O
filesize	long
)	O
;	O
}	O
void	O
bar_set_downloaded	function
(	O
int	O
slot	int
,	O
size_t	long
nbytes	long
)	O
{	O
wget_bar_slot_downloaded	function
(	O
bar	pointer
,	O
slot	int
,	O
nbytes	long
)	O
;	O
}	O
void	O
bar_slot_deregister	function
(	O
int	O
slot	int
)	O
{	O
wget_bar_slot_deregister	function
(	O
bar	pointer
,	O
slot	int
)	O
;	O
}	O
void	O
bar_update_slots	function
(	O
int	O
nslots	int
)	O
{	O
wget_bar_set_slots	function
(	O
bar	pointer
,	O
nslots	int
)	O
;	O
}	O
