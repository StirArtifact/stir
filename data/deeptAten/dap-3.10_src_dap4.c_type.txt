extern	O
dataobs	struct
dap_obs	array
[	O
]	O
;	O
extern	O
FILE	struct
*	O
dap_lst	pointer
;	O
extern	O
FILE	struct
*	O
dap_err	pointer
;	O
extern	O
char	O
*	O
dap_sttnm	array
[	O
NSTATS	O
]	O
;	O
static	O
double	O
gettwo	function
(	O
double	O
x	array
)	O
{	O
double	O
t	double
;	O
for	O
(	O
t	double
=	O
1.0	int
,	O
x	array
=	O
fabs	function
(	O
x	array
)	O
;	O
t	double
>	O
x	array
;	O
t	double
/=	O
2.0	int
)	O
;	O
while	O
(	O
t	double
<	O
x	array
)	O
t	double
*=	O
2.0	int
;	O
return	O
t	double
;	O
}	O
static	O
int	O
rowred	function
(	O
double	O
*	O
*	O
coeff	pointer
,	O
int	O
rterm	array
[	O
]	O
,	O
int	O
byterm	int
,	O
int	O
ncells	int
,	O
double	O
nobs	array
[	O
]	O
,	O
int	O
row1	int
,	O
int	O
row2	int
,	O
int	O
*	O
nonz	pointer
)	O
{	O
int	O
*	O
misscol	pointer
;	O
int	O
celln	int
;	O
int	O
ncols	int
;	O
int	O
col	int
,	O
subcol	int
;	O
int	O
row	int
,	O
subrow	int
;	O
int	O
maxrow	int
;	O
double	O
colmax	double
;	O
double	O
rowmax	double
;	O
double	O
tmp	double
,	O
tmp1	double
,	O
tmp2	double
;	O
int	O
itmp	int
;	O
double	O
mult1	double
,	O
mult2	double
;	O
int	O
nterms	int
;	O
int	O
*	O
term	pointer
;	O
int	O
t	double
;	O
int	O
elimrow	int
;	O
nterms	int
=	O
0	int
;	O
elimrow	int
=	O
0	int
;	O
misscol	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
term	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
if	O
(	O
byterm	int
)	O
{	O
nterms	int
=	O
0	int
;	O
term	pointer
[	O
nterms	int
++	O
]	O
=	O
0	int
;	O
for	O
(	O
row	int
=	O
row1	int
+	O
1	int
;	O
row	int
<=	O
row2	int
;	O
row	int
++	O
)	O
{	O
for	O
(	O
t	double
=	O
1	int
;	O
t	double
<	O
nterms	int
;	O
t	double
++	O
)	O
{	O
if	O
(	O
rterm	array
[	O
row	int
]	O
==	O
term	pointer
[	O
t	double
]	O
)	O
break	O
;	O
}	O
if	O
(	O
t	double
==	O
nterms	int
)	O
term	pointer
[	O
nterms	int
++	O
]	O
=	O
rterm	array
[	O
row	int
]	O
;	O
}	O
}	O
for	O
(	O
celln	int
=	O
0	int
,	O
ncols	int
=	O
0	int
;	O
celln	int
<	O
ncells	int
;	O
celln	int
++	O
)	O
{	O
if	O
(	O
nobs	array
[	O
celln	int
]	O
==	O
0.0	int
)	O
misscol	pointer
[	O
ncols	int
++	O
]	O
=	O
celln	int
;	O
}	O
for	O
(	O
t	double
=	O
0	int
;	O
(	O
byterm	int
&&	O
t	double
<	O
nterms	int
)	O
||	O
t	double
<	O
1	int
;	O
t	double
++	O
)	O
{	O
for	O
(	O
row	int
=	O
(	O
t	double
?	O
row1	int
+	O
1	int
:	O
0	int
)	O
;	O
row	int
<=	O
(	O
t	double
?	O
row2	int
:	O
row1	int
)	O
;	O
row	int
++	O
)	O
{	O
if	O
(	O
!	O
byterm	int
||	O
row	int
<=	O
row1	int
||	O
rterm	array
[	O
row	int
]	O
==	O
term	pointer
[	O
t	double
]	O
)	O
break	O
;	O
}	O
for	O
(	O
col	int
=	O
0	int
;	O
col	int
<	O
ncols	int
;	O
col	int
++	O
)	O
{	O
while	O
(	O
byterm	int
&&	O
row	int
>	O
row1	int
&&	O
rterm	array
[	O
row	int
]	O
!=	O
term	pointer
[	O
t	double
]	O
&&	O
row	int
<	O
(	O
t	double
?	O
row2	int
:	O
row1	int
)	O
)	O
row	int
++	O
;	O
for	O
(	O
colmax	double
=	O
0.0	int
,	O
maxrow	int
=	O
row	int
,	O
subrow	int
=	O
row	int
;	O
subrow	int
<=	O
(	O
t	double
?	O
row2	int
:	O
row1	int
)	O
;	O
subrow	int
++	O
)	O
{	O
if	O
(	O
byterm	int
&&	O
subrow	int
>	O
row1	int
&&	O
rterm	array
[	O
subrow	int
]	O
!=	O
term	pointer
[	O
t	double
]	O
)	O
continue	O
;	O
if	O
(	O
(	O
tmp	double
=	O
fabs	function
(	O
coeff	pointer
[	O
subrow	int
]	O
[	O
misscol	pointer
[	O
col	int
]	O
]	O
)	O
)	O
>	O
colmax	double
)	O
{	O
colmax	double
=	O
tmp	double
;	O
maxrow	int
=	O
subrow	int
;	O
}	O
}	O
if	O
(	O
colmax	double
>	O
dap_redtol	double
)	O
{	O
if	O
(	O
maxrow	int
!=	O
row	int
)	O
{	O
for	O
(	O
subcol	int
=	O
0	int
;	O
subcol	int
<	O
ncells	int
;	O
subcol	int
++	O
)	O
{	O
tmp	double
=	O
coeff	pointer
[	O
row	int
]	O
[	O
subcol	int
]	O
;	O
coeff	pointer
[	O
row	int
]	O
[	O
subcol	int
]	O
=	O
coeff	pointer
[	O
maxrow	int
]	O
[	O
subcol	int
]	O
;	O
coeff	pointer
[	O
maxrow	int
]	O
[	O
subcol	int
]	O
=	O
tmp	double
;	O
itmp	int
=	O
rterm	array
[	O
row	int
]	O
;	O
rterm	array
[	O
row	int
]	O
=	O
rterm	array
[	O
maxrow	int
]	O
;	O
rterm	array
[	O
maxrow	int
]	O
=	O
itmp	int
;	O
}	O
}	O
for	O
(	O
subrow	int
=	O
row	int
+	O
1	int
;	O
subrow	int
<=	O
row2	int
;	O
subrow	int
++	O
)	O
{	O
if	O
(	O
byterm	int
&&	O
subrow	int
>	O
row1	int
&&	O
rterm	array
[	O
subrow	int
]	O
!=	O
term	pointer
[	O
t	double
]	O
)	O
continue	O
;	O
mult1	double
=	O
coeff	pointer
[	O
subrow	int
]	O
[	O
misscol	pointer
[	O
col	int
]	O
]	O
;	O
mult2	double
=	O
coeff	pointer
[	O
row	int
]	O
[	O
misscol	pointer
[	O
col	int
]	O
]	O
;	O
if	O
(	O
fabs	function
(	O
mult1	double
)	O
>	O
dap_redtol	double
*	O
fabs	function
(	O
mult2	double
)	O
)	O
{	O
for	O
(	O
subcol	int
=	O
0	int
,	O
rowmax	double
=	O
0.0	int
;	O
subcol	int
<	O
ncells	int
;	O
subcol	int
++	O
)	O
{	O
tmp	double
=	O
mult2	double
*	O
coeff	pointer
[	O
subrow	int
]	O
[	O
subcol	int
]	O
;	O
tmp1	double
=	O
mult1	double
*	O
coeff	pointer
[	O
row	int
]	O
[	O
subcol	int
]	O
;	O
coeff	pointer
[	O
subrow	int
]	O
[	O
subcol	int
]	O
=	O
tmp	double
-	O
tmp1	double
;	O
tmp2	double
=	O
fabs	function
(	O
coeff	pointer
[	O
subrow	int
]	O
[	O
subcol	int
]	O
)	O
;	O
if	O
(	O
tmp2	double
<	O
dap_redtol	double
*	O
(	O
fabs	function
(	O
tmp	double
)	O
+	O
fabs	function
(	O
tmp1	double
)	O
)	O
)	O
coeff	pointer
[	O
subrow	int
]	O
[	O
subcol	int
]	O
=	O
0.0	int
;	O
else	O
if	O
(	O
tmp2	double
>	O
rowmax	double
)	O
rowmax	double
=	O
tmp2	double
;	O
}	O
tmp	double
=	O
gettwo	function
(	O
rowmax	double
)	O
;	O
for	O
(	O
subcol	int
=	O
0	int
;	O
subcol	int
<	O
ncells	int
;	O
subcol	int
++	O
)	O
{	O
coeff	pointer
[	O
subrow	int
]	O
[	O
subcol	int
]	O
/=	O
tmp	double
;	O
if	O
(	O
fabs	function
(	O
coeff	pointer
[	O
subrow	int
]	O
[	O
subcol	int
]	O
)	O
<	O
dap_redtol	double
)	O
coeff	pointer
[	O
subrow	int
]	O
[	O
subcol	int
]	O
=	O
0.0	int
;	O
}	O
}	O
}	O
row	int
++	O
;	O
}	O
}	O
if	O
(	O
!	O
t	double
)	O
elimrow	int
=	O
row	int
;	O
}	O
if	O
(	O
byterm	int
)	O
{	O
for	O
(	O
t	double
=	O
0	int
;	O
t	double
<	O
nterms	int
;	O
t	double
++	O
)	O
{	O
for	O
(	O
row	int
=	O
(	O
t	double
?	O
row2	int
:	O
row1	int
)	O
;	O
row	int
>	O
(	O
t	double
?	O
row1	int
+	O
1	int
:	O
0	int
)	O
;	O
--	O
row	int
)	O
{	O
if	O
(	O
row	int
<=	O
row1	int
||	O
rterm	array
[	O
row	int
]	O
==	O
term	pointer
[	O
t	double
]	O
)	O
break	O
;	O
}	O
for	O
(	O
;	O
row	int
>	O
(	O
t	double
?	O
row1	int
+	O
1	int
:	O
0	int
)	O
;	O
--	O
row	int
)	O
{	O
if	O
(	O
row	int
>	O
row1	int
&&	O
rterm	array
[	O
row	int
]	O
!=	O
term	pointer
[	O
t	double
]	O
)	O
continue	O
;	O
for	O
(	O
col	int
=	O
0	int
;	O
col	int
<	O
ncols	int
;	O
col	int
++	O
)	O
{	O
if	O
(	O
fabs	function
(	O
coeff	pointer
[	O
row	int
]	O
[	O
misscol	pointer
[	O
col	int
]	O
]	O
)	O
>	O
dap_redtol	double
)	O
break	O
;	O
}	O
if	O
(	O
col	int
<	O
ncols	int
)	O
{	O
for	O
(	O
subrow	int
=	O
row	int
-	O
1	int
;	O
subrow	int
>=	O
(	O
t	double
?	O
row1	int
+	O
1	int
:	O
0	int
)	O
;	O
--	O
subrow	int
)	O
{	O
if	O
(	O
subrow	int
>	O
row1	int
&&	O
rterm	array
[	O
subrow	int
]	O
!=	O
term	pointer
[	O
t	double
]	O
)	O
continue	O
;	O
mult1	double
=	O
coeff	pointer
[	O
subrow	int
]	O
[	O
misscol	pointer
[	O
col	int
]	O
]	O
;	O
mult2	double
=	O
coeff	pointer
[	O
row	int
]	O
[	O
misscol	pointer
[	O
col	int
]	O
]	O
;	O
if	O
(	O
fabs	function
(	O
mult1	double
)	O
>	O
dap_redtol	double
*	O
fabs	function
(	O
mult2	double
)	O
)	O
{	O
for	O
(	O
col	int
=	O
0	int
,	O
rowmax	double
=	O
0.0	int
;	O
col	int
<	O
ncells	int
;	O
col	int
++	O
)	O
{	O
tmp	double
=	O
mult2	double
*	O
coeff	pointer
[	O
subrow	int
]	O
[	O
col	int
]	O
;	O
tmp1	double
=	O
mult1	double
*	O
coeff	pointer
[	O
row	int
]	O
[	O
col	int
]	O
;	O
coeff	pointer
[	O
subrow	int
]	O
[	O
col	int
]	O
=	O
tmp	double
-	O
tmp1	double
;	O
if	O
(	O
fabs	function
(	O
coeff	pointer
[	O
subrow	int
]	O
[	O
col	int
]	O
)	O
<	O
dap_redtol	double
*	O
(	O
fabs	function
(	O
tmp	double
)	O
+	O
fabs	function
(	O
tmp1	double
)	O
)	O
)	O
coeff	pointer
[	O
subrow	int
]	O
[	O
col	int
]	O
=	O
0.0	int
;	O
else	O
if	O
(	O
fabs	function
(	O
coeff	pointer
[	O
subrow	int
]	O
[	O
col	int
]	O
)	O
>	O
rowmax	double
)	O
rowmax	double
=	O
fabs	function
(	O
coeff	pointer
[	O
subrow	int
]	O
[	O
col	int
]	O
)	O
;	O
}	O
tmp	double
=	O
gettwo	function
(	O
rowmax	double
)	O
;	O
for	O
(	O
col	int
=	O
0	int
;	O
col	int
<	O
ncells	int
;	O
col	int
++	O
)	O
{	O
coeff	pointer
[	O
subrow	int
]	O
[	O
col	int
]	O
/=	O
tmp	double
;	O
if	O
(	O
fabs	function
(	O
coeff	pointer
[	O
subrow	int
]	O
[	O
col	int
]	O
)	O
<	O
dap_redtol	double
)	O
coeff	pointer
[	O
subrow	int
]	O
[	O
col	int
]	O
=	O
0.0	int
;	O
}	O
}	O
}	O
}	O
}	O
}	O
}	O
if	O
(	O
nonz	pointer
)	O
{	O
for	O
(	O
row	int
=	O
0	int
;	O
row	int
<=	O
row2	int
;	O
row	int
++	O
)	O
{	O
nonz	pointer
[	O
row	int
]	O
=	O
0	int
;	O
for	O
(	O
col	int
=	O
0	int
;	O
col	int
<	O
ncells	int
;	O
col	int
++	O
)	O
{	O
if	O
(	O
fabs	function
(	O
coeff	pointer
[	O
row	int
]	O
[	O
col	int
]	O
)	O
>	O
dap_zerotol	double
)	O
{	O
if	O
(	O
nobs	array
[	O
col	int
]	O
>	O
0.0	int
)	O
{	O
nonz	pointer
[	O
row	int
]	O
=	O
1	int
;	O
break	O
;	O
}	O
}	O
}	O
}	O
}	O
dap_free	function
(	O
misscol	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
term	pointer
,	O
""	pointer
)	O
;	O
if	O
(	O
elimrow	int
==	O
ncols	int
)	O
return	O
elimrow	int
;	O
fputs	function
(	O
"error terms insufficient to impute missing cells\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
static	O
double	O
lcm	function
(	O
double	O
x	array
,	O
double	O
y	double
)	O
{	O
int	O
ix	int
,	O
iy	int
;	O
int	O
q	int
,	O
r	double
;	O
int	O
lcmxy	int
;	O
ix	int
=	O
(	O
int	O
)	O
x	array
;	O
iy	int
=	O
(	O
int	O
)	O
y	double
;	O
lcmxy	int
=	O
ix	int
*	O
iy	int
;	O
for	O
(	O
;	O
;	O
)	O
{	O
q	int
=	O
iy	int
/	O
ix	int
;	O
r	double
=	O
iy	int
-	O
q	int
*	O
ix	int
;	O
if	O
(	O
r	double
)	O
{	O
iy	int
=	O
ix	int
;	O
ix	int
=	O
r	double
;	O
}	O
else	O
break	O
;	O
}	O
return	O
(	O
double	O
)	O
(	O
lcmxy	int
/	O
ix	int
)	O
;	O
}	O
static	O
int	O
orthog	function
(	O
double	O
*	O
*	O
coeff	pointer
,	O
int	O
row0	int
,	O
int	O
row1	int
,	O
int	O
row2	int
,	O
int	O
ncells	int
,	O
double	O
*	O
nobs	array
,	O
int	O
*	O
indep	pointer
,	O
int	O
*	O
rterm	array
)	O
{	O
double	O
lcmnobs	double
;	O
int	O
updown	int
;	O
int	O
*	O
term	pointer
;	O
int	O
nterms	int
;	O
int	O
t	double
;	O
int	O
cr	int
;	O
int	O
cc	int
;	O
int	O
crr	int
;	O
double	O
lensq	double
;	O
double	O
dot	double
;	O
double	O
tmp	double
,	O
tmp1	double
;	O
double	O
mult1	double
,	O
mult2	double
;	O
double	O
rowmax	double
;	O
int	O
df	int
;	O
nterms	int
=	O
0	int
;	O
term	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
if	O
(	O
row2	int
>=	O
row0	int
)	O
updown	int
=	O
1	int
;	O
else	O
updown	int
=	O
-	O
1	int
;	O
df	int
=	O
0	int
;	O
if	O
(	O
rterm	array
)	O
{	O
for	O
(	O
cr	int
=	O
row0	int
,	O
nterms	int
=	O
0	int
;	O
cr	int
!=	O
row2	int
+	O
updown	int
;	O
cr	int
+=	O
updown	int
)	O
{	O
for	O
(	O
t	double
=	O
0	int
;	O
t	double
<	O
nterms	int
;	O
t	double
++	O
)	O
{	O
if	O
(	O
rterm	array
[	O
cr	int
]	O
==	O
term	pointer
[	O
t	double
]	O
)	O
break	O
;	O
}	O
if	O
(	O
t	double
==	O
nterms	int
)	O
term	pointer
[	O
nterms	int
++	O
]	O
=	O
rterm	array
[	O
cr	int
]	O
;	O
}	O
}	O
for	O
(	O
cc	int
=	O
0	int
,	O
lcmnobs	double
=	O
1.0	int
;	O
cc	int
<	O
ncells	int
;	O
cc	int
++	O
)	O
{	O
if	O
(	O
nobs	array
[	O
cc	int
]	O
!=	O
0.0	int
)	O
lcmnobs	double
=	O
lcm	function
(	O
lcmnobs	double
,	O
nobs	array
[	O
cc	int
]	O
)	O
;	O
}	O
lcmnobs	double
/=	O
gettwo	function
(	O
lcmnobs	double
)	O
;	O
for	O
(	O
t	double
=	O
0	int
;	O
(	O
rterm	array
&&	O
t	double
<	O
nterms	int
)	O
||	O
t	double
<	O
1	int
;	O
t	double
++	O
)	O
{	O
for	O
(	O
cr	int
=	O
row0	int
;	O
cr	int
!=	O
row1	int
+	O
updown	int
;	O
cr	int
+=	O
updown	int
)	O
{	O
if	O
(	O
rterm	array
&&	O
rterm	array
[	O
cr	int
]	O
!=	O
term	pointer
[	O
t	double
]	O
)	O
continue	O
;	O
for	O
(	O
cc	int
=	O
0	int
;	O
cc	int
<	O
ncells	int
;	O
cc	int
++	O
)	O
{	O
if	O
(	O
fabs	function
(	O
coeff	pointer
[	O
cr	int
]	O
[	O
cc	int
]	O
)	O
>	O
dap_orthtol	double
)	O
break	O
;	O
}	O
if	O
(	O
cc	int
<	O
ncells	int
)	O
break	O
;	O
}	O
for	O
(	O
;	O
cr	int
!=	O
row1	int
+	O
updown	int
;	O
cr	int
+=	O
updown	int
)	O
{	O
if	O
(	O
rterm	array
&&	O
rterm	array
[	O
cr	int
]	O
!=	O
term	pointer
[	O
t	double
]	O
)	O
continue	O
;	O
for	O
(	O
lensq	double
=	O
0.0	int
,	O
cc	int
=	O
0	int
;	O
cc	int
<	O
ncells	int
;	O
cc	int
++	O
)	O
{	O
if	O
(	O
nobs	array
[	O
cc	int
]	O
>	O
0.0	int
)	O
{	O
tmp	double
=	O
coeff	pointer
[	O
cr	int
]	O
[	O
cc	int
]	O
;	O
lensq	double
+=	O
tmp	double
*	O
tmp	double
*	O
(	O
lcmnobs	double
/	O
nobs	array
[	O
cc	int
]	O
)	O
;	O
}	O
}	O
if	O
(	O
lensq	double
>	O
dap_orthtol	double
)	O
{	O
indep	pointer
[	O
cr	int
]	O
=	O
1	int
;	O
df	int
++	O
;	O
for	O
(	O
crr	int
=	O
cr	int
+	O
updown	int
;	O
crr	int
!=	O
row2	int
+	O
updown	int
;	O
crr	int
+=	O
updown	int
)	O
{	O
if	O
(	O
rterm	array
&&	O
rterm	array
[	O
crr	int
]	O
!=	O
term	pointer
[	O
t	double
]	O
)	O
continue	O
;	O
for	O
(	O
dot	double
=	O
0.0	int
,	O
cc	int
=	O
0	int
;	O
cc	int
<	O
ncells	int
;	O
cc	int
++	O
)	O
{	O
if	O
(	O
nobs	array
[	O
cc	int
]	O
>	O
0.0	int
)	O
dot	double
+=	O
coeff	pointer
[	O
cr	int
]	O
[	O
cc	int
]	O
*	O
coeff	pointer
[	O
crr	int
]	O
[	O
cc	int
]	O
*	O
(	O
lcmnobs	double
/	O
nobs	array
[	O
cc	int
]	O
)	O
;	O
}	O
if	O
(	O
fabs	function
(	O
dot	double
)	O
>	O
dap_orthtol	double
*	O
lensq	double
)	O
{	O
mult1	double
=	O
dot	double
;	O
mult2	double
=	O
lensq	double
;	O
for	O
(	O
cc	int
=	O
0	int
,	O
rowmax	double
=	O
0.0	int
;	O
cc	int
<	O
ncells	int
;	O
cc	int
++	O
)	O
{	O
tmp	double
=	O
mult2	double
*	O
coeff	pointer
[	O
crr	int
]	O
[	O
cc	int
]	O
;	O
tmp1	double
=	O
mult1	double
*	O
coeff	pointer
[	O
cr	int
]	O
[	O
cc	int
]	O
;	O
coeff	pointer
[	O
crr	int
]	O
[	O
cc	int
]	O
=	O
tmp	double
-	O
tmp1	double
;	O
if	O
(	O
fabs	function
(	O
coeff	pointer
[	O
crr	int
]	O
[	O
cc	int
]	O
)	O
<	O
dap_orthtol	double
*	O
(	O
fabs	function
(	O
tmp	double
)	O
+	O
fabs	function
(	O
tmp1	double
)	O
)	O
)	O
coeff	pointer
[	O
crr	int
]	O
[	O
cc	int
]	O
=	O
0.0	int
;	O
else	O
if	O
(	O
fabs	function
(	O
coeff	pointer
[	O
crr	int
]	O
[	O
cc	int
]	O
)	O
>	O
rowmax	double
)	O
rowmax	double
=	O
fabs	function
(	O
coeff	pointer
[	O
crr	int
]	O
[	O
cc	int
]	O
)	O
;	O
}	O
tmp	double
=	O
gettwo	function
(	O
rowmax	double
)	O
;	O
for	O
(	O
cc	int
=	O
0	int
;	O
cc	int
<	O
ncells	int
;	O
cc	int
++	O
)	O
{	O
coeff	pointer
[	O
crr	int
]	O
[	O
cc	int
]	O
/=	O
tmp	double
;	O
if	O
(	O
fabs	function
(	O
coeff	pointer
[	O
crr	int
]	O
[	O
cc	int
]	O
)	O
<	O
dap_orthtol	double
)	O
coeff	pointer
[	O
crr	int
]	O
[	O
cc	int
]	O
=	O
0.0	int
;	O
}	O
}	O
}	O
}	O
else	O
{	O
for	O
(	O
cc	int
=	O
0	int
;	O
cc	int
<	O
ncells	int
;	O
cc	int
++	O
)	O
coeff	pointer
[	O
cr	int
]	O
[	O
cc	int
]	O
=	O
0.0	int
;	O
}	O
}	O
while	O
(	O
cr	int
!=	O
row2	int
+	O
updown	int
)	O
{	O
if	O
(	O
!	O
rterm	array
||	O
rterm	array
[	O
cr	int
]	O
==	O
term	pointer
[	O
t	double
]	O
)	O
{	O
for	O
(	O
lensq	double
=	O
0.0	int
,	O
cc	int
=	O
0	int
;	O
cc	int
<	O
ncells	int
;	O
cc	int
++	O
)	O
{	O
if	O
(	O
nobs	array
[	O
cc	int
]	O
>	O
0.0	int
)	O
{	O
tmp	double
=	O
coeff	pointer
[	O
cr	int
]	O
[	O
cc	int
]	O
;	O
lensq	double
+=	O
tmp	double
*	O
tmp	double
*	O
(	O
lcmnobs	double
/	O
nobs	array
[	O
cc	int
]	O
)	O
;	O
}	O
}	O
if	O
(	O
lensq	double
>	O
dap_orthtol	double
)	O
{	O
indep	pointer
[	O
cr	int
]	O
=	O
1	int
;	O
df	int
++	O
;	O
}	O
}	O
cr	int
+=	O
updown	int
;	O
}	O
}	O
dap_free	function
(	O
term	pointer
,	O
""	pointer
)	O
;	O
return	O
df	int
;	O
}	O
static	O
void	O
sumcheck	function
(	O
char	O
caller	array
[	O
]	O
,	O
double	O
*	O
*	O
coeff	pointer
,	O
int	O
ncells	int
,	O
int	O
nerrors	int
,	O
int	O
ncontrasts	int
,	O
int	O
*	O
rterm	array
)	O
{	O
int	O
r	double
,	O
c	int
;	O
double	O
elt	double
;	O
double	O
rowsum	double
;	O
double	O
rowmax	double
;	O
for	O
(	O
r	double
=	O
0	int
;	O
r	double
<	O
nerrors	int
+	O
ncontrasts	int
;	O
r	double
++	O
)	O
{	O
for	O
(	O
c	int
=	O
0	int
,	O
rowsum	double
=	O
0.0	int
,	O
rowmax	double
=	O
0.0	int
;	O
c	int
<	O
ncells	int
;	O
c	int
++	O
)	O
{	O
elt	double
=	O
coeff	pointer
[	O
r	double
]	O
[	O
c	int
]	O
;	O
rowsum	double
+=	O
elt	double
;	O
elt	double
=	O
fabs	function
(	O
elt	double
)	O
;	O
if	O
(	O
elt	double
>	O
rowmax	double
)	O
rowmax	double
=	O
elt	double
;	O
}	O
if	O
(	O
fabs	function
(	O
rowsum	double
)	O
>	O
dap_zerotol	double
*	O
rowmax	double
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(sumcheck:%s) Unable to fit model:\n"	pointer
,	O
caller	array
)	O
;	O
if	O
(	O
r	double
<	O
nerrors	int
)	O
fprintf	function
(	O
dap_err	pointer
,	O
"Error %d sums to %g:\n"	pointer
,	O
r	double
,	O
rowsum	double
)	O
;	O
else	O
fprintf	function
(	O
dap_err	pointer
,	O
"Contrast %d sums to %g:\n"	pointer
,	O
r	double
-	O
nerrors	int
,	O
rowsum	double
)	O
;	O
fprintf	function
(	O
dap_err	pointer
,	O
"%s%d (%x) "	pointer
,	O
(	O
(	O
r	double
<	O
nerrors	int
)	O
?	O
"E"	pointer
:	O
"C"	pointer
)	O
,	O
(	O
(	O
r	double
<	O
nerrors	int
)	O
?	O
r	double
:	O
r	double
-	O
nerrors	int
)	O
,	O
(	O
rterm	array
?	O
rterm	array
[	O
r	double
]	O
:	O
0	int
)	O
)	O
;	O
for	O
(	O
c	int
=	O
0	int
;	O
c	int
<	O
ncells	int
;	O
c	int
++	O
)	O
fprintf	function
(	O
dap_err	pointer
,	O
" %g"	pointer
,	O
coeff	pointer
[	O
r	double
]	O
[	O
c	int
]	O
)	O
;	O
putc	function
(	O
'\n'	O
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
}	O
static	O
int	O
testparse	function
(	O
char	O
*	O
test	pointer
,	O
char	O
*	O
termv	pointer
,	O
int	O
*	O
varv	array
,	O
int	O
nvars	int
)	O
{	O
int	O
nterms	int
;	O
int	O
tv	int
;	O
char	O
*	O
vname	array
;	O
int	O
t	double
;	O
int	O
n	int
;	O
int	O
bit	int
;	O
int	O
term	pointer
;	O
int	O
vv	int
;	O
int	O
v	int
;	O
int	O
firstv	int
;	O
term	pointer
=	O
0	int
;	O
vname	array
=	O
dap_malloc	function
(	O
dap_namelen	int
+	O
1	int
,	O
""	pointer
)	O
;	O
if	O
(	O
!	O
test	pointer
||	O
!	O
test	pointer
[	O
0	int
]	O
)	O
return	O
0	int
;	O
for	O
(	O
nterms	int
=	O
1	int
,	O
tv	int
=	O
1	int
;	O
tv	int
<	O
nvars	int
;	O
tv	int
++	O
)	O
nterms	int
*=	O
2	int
;	O
nterms	int
--	O
;	O
for	O
(	O
tv	int
=	O
1	int
;	O
tv	int
<=	O
nterms	int
;	O
tv	int
++	O
)	O
termv	pointer
[	O
tv	int
]	O
=	O
'e'	O
;	O
for	O
(	O
t	double
=	O
0	int
;	O
test	pointer
[	O
t	double
]	O
==	O
' '	O
;	O
t	double
++	O
)	O
;	O
for	O
(	O
firstv	int
=	O
1	int
;	O
test	pointer
[	O
t	double
]	O
;	O
)	O
{	O
if	O
(	O
firstv	int
)	O
term	pointer
=	O
0	int
;	O
firstv	int
=	O
0	int
;	O
for	O
(	O
n	int
=	O
0	int
;	O
test	pointer
[	O
t	double
]	O
&&	O
test	pointer
[	O
t	double
]	O
!=	O
' '	O
&&	O
test	pointer
[	O
t	double
]	O
!=	O
'*'	O
;	O
)	O
{	O
if	O
(	O
n	int
<	O
dap_namelen	int
)	O
vname	array
[	O
n	int
++	O
]	O
=	O
test	pointer
[	O
t	double
++	O
]	O
;	O
else	O
{	O
vname	array
[	O
n	int
]	O
=	O
'\0'	O
;	O
fprintf	function
(	O
dap_err	pointer
,	O
"(testparse) name too long: %s\n"	pointer
,	O
vname	array
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
vname	array
[	O
n	int
]	O
=	O
'\0'	O
;	O
if	O
(	O
(	O
v	int
=	O
dap_varnum	function
(	O
vname	array
)	O
)	O
<	O
0	int
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(testparse) unknown variable: %s\n"	pointer
,	O
vname	array
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
for	O
(	O
bit	int
=	O
0x1	int
,	O
vv	int
=	O
1	int
;	O
vv	int
<	O
nvars	int
;	O
vv	int
++	O
,	O
bit	int
=	O
(	O
bit	int
<<	O
1	int
)	O
)	O
{	O
if	O
(	O
varv	array
[	O
vv	int
]	O
==	O
v	int
)	O
break	O
;	O
}	O
if	O
(	O
vv	int
==	O
nvars	int
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(testparse) variable in test not in model: %s\n"	pointer
,	O
vname	array
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
term	pointer
|=	O
bit	int
;	O
while	O
(	O
test	pointer
[	O
t	double
]	O
==	O
' '	O
)	O
t	double
++	O
;	O
if	O
(	O
test	pointer
[	O
t	double
]	O
==	O
'*'	O
)	O
{	O
for	O
(	O
t	double
++	O
;	O
test	pointer
[	O
t	double
]	O
==	O
' '	O
;	O
t	double
++	O
)	O
;	O
}	O
else	O
{	O
termv	pointer
[	O
term	pointer
]	O
=	O
'c'	O
;	O
firstv	int
=	O
1	int
;	O
}	O
}	O
dap_free	function
(	O
vname	array
,	O
""	pointer
)	O
;	O
return	O
nterms	int
;	O
}	O
static	O
int	O
levn	function
(	O
char	O
*	O
levstr	pointer
,	O
char	O
*	O
*	O
levval	pointer
,	O
int	O
*	O
nlevels	pointer
)	O
{	O
int	O
l	int
;	O
for	O
(	O
l	int
=	O
0	int
;	O
l	int
<	O
*	O
nlevels	pointer
&&	O
levval	pointer
[	O
l	int
]	O
[	O
0	int
]	O
;	O
l	int
++	O
)	O
{	O
if	O
(	O
!	O
strcmp	function
(	O
levstr	pointer
,	O
levval	pointer
[	O
l	int
]	O
)	O
)	O
return	O
l	int
;	O
}	O
if	O
(	O
l	int
<	O
dap_maxlev	int
-	O
1	int
)	O
{	O
strcpy	function
(	O
levval	pointer
[	O
l	int
]	O
,	O
levstr	pointer
)	O
;	O
if	O
(	O
l	int
<	O
*	O
nlevels	pointer
)	O
return	O
*	O
nlevels	pointer
;	O
else	O
return	O
(	O
*	O
nlevels	pointer
)	O
++	O
;	O
}	O
else	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(levn) too many levels: %s\n"	pointer
,	O
levstr	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
static	O
void	O
putrand	function
(	O
int	O
bits	int
,	O
double	O
coeff	pointer
,	O
int	O
varv	array
[	O
]	O
)	O
{	O
int	O
v	int
;	O
int	O
termn	int
;	O
if	O
(	O
coeff	pointer
!=	O
0.0	int
)	O
fprintf	function
(	O
dap_lst	pointer
,	O
"\n    %g Var("	pointer
,	O
coeff	pointer
)	O
;	O
for	O
(	O
v	int
=	O
1	int
,	O
termn	int
=	O
1	int
;	O
bits	int
;	O
bits	int
=	O
(	O
bits	int
>>	O
1	int
)	O
,	O
v	int
++	O
)	O
{	O
if	O
(	O
bits	int
&	O
0x1	int
)	O
{	O
if	O
(	O
termn	int
>	O
1	int
)	O
putc	function
(	O
'*'	O
,	O
dap_lst	pointer
)	O
;	O
fputs	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_nam	pointer
[	O
varv	array
[	O
v	int
]	O
]	O
,	O
dap_lst	pointer
)	O
;	O
termn	int
++	O
;	O
}	O
}	O
if	O
(	O
coeff	pointer
!=	O
0.0	int
)	O
putc	function
(	O
')'	O
,	O
dap_lst	pointer
)	O
;	O
}	O
static	O
int	O
ems	function
(	O
double	O
*	O
*	O
coeff	pointer
,	O
int	O
*	O
*	O
level	double
,	O
int	O
ncells	int
,	O
int	O
*	O
rterm	array
,	O
int	O
*	O
indep	pointer
,	O
int	O
nrows	int
,	O
double	O
*	O
nobs	array
,	O
int	O
*	O
varv	array
,	O
char	O
*	O
termv	pointer
,	O
int	O
nterm	int
,	O
double	O
*	O
*	O
emscoeff	pointer
)	O
{	O
int	O
r	double
;	O
int	O
t	double
;	O
int	O
u	int
;	O
int	O
c	int
;	O
double	O
*	O
cum	pointer
;	O
double	O
df	int
;	O
int	O
*	O
effrow	pointer
;	O
int	O
neffrows	int
;	O
int	O
*	O
factlev	pointer
;	O
int	O
nfactlevs	int
;	O
int	O
bits	int
;	O
double	O
*	O
emsc	pointer
;	O
double	O
*	O
lensq	double
;	O
int	O
basecell	int
;	O
int	O
nextcell	int
;	O
int	O
*	O
used	pointer
;	O
int	O
s	int
;	O
int	O
same	int
;	O
double	O
tmp	double
;	O
int	O
factor	int
;	O
cum	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
emsc	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
lensq	double
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
effrow	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
factlev	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
used	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
for	O
(	O
r	double
=	O
0	int
;	O
r	double
<	O
nrows	int
;	O
r	double
++	O
)	O
emsc	pointer
[	O
r	double
]	O
=	O
0.0	int
;	O
emscoeff	pointer
++	O
;	O
for	O
(	O
t	double
=	O
1	int
,	O
factor	int
=	O
0	int
;	O
t	double
<=	O
nterm	int
;	O
t	double
++	O
)	O
{	O
if	O
(	O
termv	pointer
[	O
t	double
]	O
==	O
'c'	O
||	O
termv	pointer
[	O
t	double
]	O
==	O
'n'	O
)	O
{	O
if	O
(	O
varv	array
)	O
{	O
fputs	function
(	O
"EMS("	pointer
,	O
dap_lst	pointer
)	O
;	O
putrand	function
(	O
t	double
,	O
0.0	int
,	O
varv	array
)	O
;	O
fputs	function
(	O
") ="	pointer
,	O
dap_lst	pointer
)	O
;	O
}	O
emscoeff	pointer
[	O
factor	int
]	O
[	O
0	int
]	O
=	O
1.0	int
;	O
for	O
(	O
r	double
=	O
0	int
,	O
neffrows	int
=	O
0	int
;	O
r	double
<	O
nrows	int
;	O
r	double
++	O
)	O
{	O
if	O
(	O
indep	pointer
[	O
r	double
]	O
&&	O
rterm	array
[	O
r	double
]	O
==	O
t	double
)	O
effrow	pointer
[	O
neffrows	int
++	O
]	O
=	O
r	double
;	O
}	O
for	O
(	O
u	int
=	O
1	int
;	O
u	int
<=	O
nterm	int
;	O
u	int
++	O
)	O
{	O
for	O
(	O
r	double
=	O
0	int
;	O
r	double
<	O
nrows	int
;	O
r	double
++	O
)	O
{	O
if	O
(	O
indep	pointer
[	O
r	double
]	O
&&	O
rterm	array
[	O
r	double
]	O
==	O
u	int
)	O
break	O
;	O
}	O
if	O
(	O
(	O
u	int
&	O
t	double
)	O
==	O
t	double
&&	O
r	double
<	O
nrows	int
)	O
{	O
for	O
(	O
bits	int
=	O
u	int
,	O
nfactlevs	int
=	O
0	int
,	O
r	double
=	O
1	int
;	O
bits	int
;	O
bits	int
=	O
(	O
bits	int
>>	O
1	int
)	O
,	O
r	double
++	O
)	O
{	O
if	O
(	O
bits	int
&	O
0x1	int
)	O
factlev	pointer
[	O
nfactlevs	int
++	O
]	O
=	O
r	double
;	O
}	O
for	O
(	O
r	double
=	O
0	int
;	O
r	double
<	O
neffrows	int
;	O
r	double
++	O
)	O
{	O
if	O
(	O
indep	pointer
[	O
r	double
]	O
)	O
{	O
lensq	double
[	O
r	double
]	O
=	O
0.0	int
;	O
emsc	pointer
[	O
r	double
]	O
=	O
0.0	int
;	O
}	O
}	O
for	O
(	O
c	int
=	O
0	int
;	O
c	int
<	O
ncells	int
;	O
c	int
++	O
)	O
used	pointer
[	O
c	int
]	O
=	O
0	int
;	O
for	O
(	O
basecell	int
=	O
0	int
,	O
nextcell	int
=	O
0	int
;	O
basecell	int
<	O
ncells	int
;	O
basecell	int
=	O
nextcell	int
)	O
{	O
for	O
(	O
r	double
=	O
0	int
;	O
r	double
<	O
neffrows	int
;	O
r	double
++	O
)	O
cum	pointer
[	O
r	double
]	O
=	O
0.0	int
;	O
for	O
(	O
c	int
=	O
basecell	int
;	O
c	int
<	O
ncells	int
;	O
)	O
{	O
for	O
(	O
r	double
=	O
0	int
;	O
r	double
<	O
neffrows	int
;	O
r	double
++	O
)	O
{	O
if	O
(	O
indep	pointer
[	O
r	double
]	O
)	O
{	O
tmp	double
=	O
coeff	pointer
[	O
effrow	pointer
[	O
r	double
]	O
]	O
[	O
c	int
]	O
;	O
cum	pointer
[	O
r	double
]	O
+=	O
tmp	double
;	O
lensq	double
[	O
r	double
]	O
+=	O
tmp	double
*	O
tmp	double
/	O
nobs	array
[	O
c	int
]	O
;	O
}	O
}	O
used	pointer
[	O
c	int
]	O
=	O
1	int
;	O
for	O
(	O
c	int
++	O
;	O
c	int
<	O
ncells	int
;	O
c	int
++	O
)	O
{	O
for	O
(	O
s	int
=	O
0	int
,	O
same	int
=	O
1	int
;	O
s	int
<	O
nfactlevs	int
;	O
s	int
++	O
)	O
{	O
if	O
(	O
level	double
[	O
factlev	pointer
[	O
s	int
]	O
]	O
[	O
basecell	int
]	O
!=	O
level	double
[	O
factlev	pointer
[	O
s	int
]	O
]	O
[	O
c	int
]	O
)	O
{	O
if	O
(	O
nextcell	int
==	O
basecell	int
&&	O
!	O
used	pointer
[	O
c	int
]	O
)	O
nextcell	int
=	O
c	int
;	O
same	int
=	O
0	int
;	O
break	O
;	O
}	O
}	O
if	O
(	O
same	int
)	O
break	O
;	O
}	O
}	O
for	O
(	O
r	double
=	O
0	int
;	O
r	double
<	O
neffrows	int
;	O
r	double
++	O
)	O
{	O
if	O
(	O
indep	pointer
[	O
r	double
]	O
)	O
{	O
cum	pointer
[	O
r	double
]	O
*=	O
cum	pointer
[	O
r	double
]	O
;	O
emsc	pointer
[	O
r	double
]	O
+=	O
cum	pointer
[	O
r	double
]	O
;	O
}	O
}	O
if	O
(	O
nextcell	int
==	O
basecell	int
)	O
break	O
;	O
}	O
for	O
(	O
r	double
=	O
0	int
;	O
r	double
<	O
neffrows	int
;	O
r	double
++	O
)	O
{	O
if	O
(	O
indep	pointer
[	O
r	double
]	O
)	O
emsc	pointer
[	O
r	double
]	O
/=	O
lensq	double
[	O
r	double
]	O
;	O
}	O
for	O
(	O
r	double
=	O
0	int
,	O
emscoeff	pointer
[	O
factor	int
]	O
[	O
u	int
]	O
=	O
0.0	int
,	O
df	int
=	O
0.0	int
;	O
r	double
<	O
neffrows	int
;	O
r	double
++	O
)	O
{	O
if	O
(	O
indep	pointer
[	O
r	double
]	O
)	O
{	O
emscoeff	pointer
[	O
factor	int
]	O
[	O
u	int
]	O
+=	O
emsc	pointer
[	O
r	double
]	O
;	O
df	int
+=	O
1.0	int
;	O
}	O
}	O
if	O
(	O
df	int
>	O
0.0	int
)	O
{	O
emscoeff	pointer
[	O
factor	int
]	O
[	O
u	int
]	O
/=	O
df	int
;	O
if	O
(	O
varv	array
)	O
putrand	function
(	O
u	int
,	O
emscoeff	pointer
[	O
factor	int
]	O
[	O
u	int
]	O
,	O
varv	array
)	O
;	O
}	O
else	O
emscoeff	pointer
[	O
factor	int
]	O
[	O
u	int
]	O
=	O
0.0	int
;	O
}	O
else	O
emscoeff	pointer
[	O
factor	int
]	O
[	O
u	int
]	O
=	O
0.0	int
;	O
}	O
if	O
(	O
varv	array
)	O
fputs	function
(	O
"\n    1 Var(Error)\n"	pointer
,	O
dap_lst	pointer
)	O
;	O
factor	int
++	O
;	O
}	O
}	O
dap_free	function
(	O
cum	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
effrow	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
factlev	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
emsc	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
lensq	double
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
used	pointer
,	O
""	pointer
)	O
;	O
return	O
factor	int
;	O
}	O
static	O
void	O
putms	function
(	O
int	O
bits	int
,	O
double	O
coeff	pointer
,	O
int	O
*	O
varv	array
)	O
{	O
int	O
v	int
;	O
int	O
termn	int
;	O
if	O
(	O
coeff	pointer
!=	O
0.0	int
)	O
fprintf	function
(	O
dap_lst	pointer
,	O
"\n    %g MS("	pointer
,	O
coeff	pointer
)	O
;	O
if	O
(	O
bits	int
)	O
{	O
for	O
(	O
v	int
=	O
1	int
,	O
termn	int
=	O
1	int
;	O
bits	int
;	O
bits	int
=	O
(	O
bits	int
>>	O
1	int
)	O
,	O
v	int
++	O
)	O
{	O
if	O
(	O
bits	int
&	O
0x1	int
)	O
{	O
if	O
(	O
termn	int
>	O
1	int
)	O
putc	function
(	O
'*'	O
,	O
dap_lst	pointer
)	O
;	O
fputs	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_nam	pointer
[	O
varv	array
[	O
v	int
]	O
]	O
,	O
dap_lst	pointer
)	O
;	O
termn	int
++	O
;	O
}	O
}	O
}	O
else	O
if	O
(	O
coeff	pointer
!=	O
0.0	int
)	O
fputs	function
(	O
"Error"	pointer
,	O
dap_lst	pointer
)	O
;	O
if	O
(	O
coeff	pointer
!=	O
0.0	int
)	O
putc	function
(	O
')'	O
,	O
dap_lst	pointer
)	O
;	O
}	O
static	O
int	O
emssolve	function
(	O
double	O
*	O
*	O
emscoeff	pointer
,	O
int	O
nterms	int
,	O
int	O
nfactors	int
,	O
int	O
*	O
varv	array
,	O
int	O
*	O
termv	pointer
)	O
{	O
int	O
r	double
,	O
c	int
;	O
int	O
maxr	int
;	O
int	O
subr	int
;	O
int	O
subc	int
;	O
double	O
rowmax	double
;	O
double	O
colmax	double
;	O
double	O
maxmax	double
;	O
double	O
tmp	double
;	O
int	O
itmp	int
;	O
double	O
mult	double
;	O
emscoeff	pointer
[	O
0	int
]	O
[	O
0	int
]	O
=	O
1.0	int
;	O
termv	pointer
[	O
0	int
]	O
=	O
0	int
;	O
for	O
(	O
r	double
=	O
1	int
;	O
r	double
<=	O
nterms	int
;	O
r	double
++	O
)	O
{	O
emscoeff	pointer
[	O
0	int
]	O
[	O
r	double
]	O
=	O
0.0	int
;	O
termv	pointer
[	O
r	double
]	O
=	O
r	double
;	O
}	O
for	O
(	O
c	int
=	O
1	int
,	O
r	double
=	O
1	int
;	O
c	int
<=	O
nfactors	int
;	O
c	int
++	O
)	O
{	O
for	O
(	O
colmax	double
=	O
0.0	int
,	O
maxmax	double
=	O
0.0	int
,	O
maxr	int
=	O
r	double
,	O
subr	int
=	O
r	double
;	O
subr	int
<=	O
nterms	int
;	O
subr	int
++	O
)	O
{	O
for	O
(	O
subc	int
=	O
c	int
,	O
rowmax	double
=	O
0.0	int
;	O
subc	int
<=	O
nfactors	int
;	O
subc	int
++	O
)	O
{	O
if	O
(	O
(	O
tmp	double
=	O
fabs	function
(	O
emscoeff	pointer
[	O
subc	int
]	O
[	O
subr	int
]	O
)	O
)	O
>	O
rowmax	double
)	O
rowmax	double
=	O
tmp	double
;	O
}	O
if	O
(	O
(	O
tmp	double
=	O
fabs	function
(	O
emscoeff	pointer
[	O
c	int
]	O
[	O
subr	int
]	O
/	O
rowmax	double
)	O
)	O
>	O
colmax	double
)	O
{	O
maxmax	double
=	O
rowmax	double
;	O
colmax	double
=	O
tmp	double
;	O
maxr	int
=	O
subr	int
;	O
}	O
}	O
if	O
(	O
colmax	double
>	O
dap_redtol	double
*	O
maxmax	double
)	O
{	O
if	O
(	O
maxr	int
!=	O
r	double
)	O
{	O
for	O
(	O
subc	int
=	O
0	int
;	O
subc	int
<=	O
nfactors	int
+	O
1	int
;	O
subc	int
++	O
)	O
{	O
tmp	double
=	O
emscoeff	pointer
[	O
subc	int
]	O
[	O
r	double
]	O
;	O
emscoeff	pointer
[	O
subc	int
]	O
[	O
r	double
]	O
=	O
emscoeff	pointer
[	O
subc	int
]	O
[	O
maxr	int
]	O
;	O
emscoeff	pointer
[	O
subc	int
]	O
[	O
maxr	int
]	O
=	O
tmp	double
;	O
}	O
itmp	int
=	O
termv	pointer
[	O
r	double
]	O
;	O
termv	pointer
[	O
r	double
]	O
=	O
termv	pointer
[	O
maxr	int
]	O
;	O
termv	pointer
[	O
maxr	int
]	O
=	O
itmp	int
;	O
}	O
for	O
(	O
subr	int
=	O
0	int
;	O
subr	int
<=	O
nterms	int
;	O
subr	int
++	O
)	O
{	O
if	O
(	O
subr	int
==	O
r	double
)	O
{	O
mult	double
=	O
emscoeff	pointer
[	O
c	int
]	O
[	O
subr	int
]	O
;	O
for	O
(	O
subc	int
=	O
c	int
;	O
subc	int
<=	O
nfactors	int
+	O
1	int
;	O
subc	int
++	O
)	O
emscoeff	pointer
[	O
subc	int
]	O
[	O
subr	int
]	O
/=	O
mult	double
;	O
}	O
else	O
{	O
mult	double
=	O
emscoeff	pointer
[	O
c	int
]	O
[	O
subr	int
]	O
/	O
emscoeff	pointer
[	O
c	int
]	O
[	O
r	double
]	O
;	O
if	O
(	O
fabs	function
(	O
mult	double
)	O
>	O
dap_redtol	double
*	O
maxmax	double
)	O
{	O
for	O
(	O
subc	int
=	O
c	int
;	O
subc	int
<=	O
nfactors	int
+	O
1	int
;	O
subc	int
++	O
)	O
{	O
tmp	double
=	O
fabs	function
(	O
emscoeff	pointer
[	O
subc	int
]	O
[	O
subr	int
]	O
)	O
;	O
emscoeff	pointer
[	O
subc	int
]	O
[	O
subr	int
]	O
-=	O
mult	double
*	O
emscoeff	pointer
[	O
subc	int
]	O
[	O
r	double
]	O
;	O
if	O
(	O
fabs	function
(	O
emscoeff	pointer
[	O
subc	int
]	O
[	O
subr	int
]	O
)	O
<	O
dap_redtol	double
*	O
tmp	double
)	O
emscoeff	pointer
[	O
subc	int
]	O
[	O
subr	int
]	O
=	O
0.0	int
;	O
}	O
}	O
}	O
}	O
r	double
++	O
;	O
}	O
}	O
return	O
r	double
;	O
}	O
static	O
void	O
ftest1	function
(	O
double	O
*	O
*	O
coeff	pointer
,	O
int	O
*	O
*	O
level	double
,	O
int	O
ncells	int
,	O
int	O
*	O
rterm	array
,	O
int	O
ncontrasts	int
,	O
int	O
nerrors	int
,	O
double	O
*	O
mean	pointer
,	O
double	O
*	O
vari	pointer
,	O
double	O
*	O
nobs	array
,	O
int	O
*	O
varv	array
,	O
char	O
*	O
numv	pointer
,	O
int	O
nnum	int
,	O
char	O
*	O
denv	pointer
,	O
int	O
nden	int
,	O
int	O
typen	int
)	O
{	O
int	O
corow	int
;	O
int	O
cc	int
;	O
int	O
cr	int
;	O
double	O
numer	double
;	O
double	O
sq	double
;	O
double	O
varnce	double
;	O
double	O
tmp	double
;	O
double	O
denom	double
;	O
double	O
modelss	double
;	O
double	O
n	int
;	O
int	O
cdfi	int
;	O
int	O
edfi	int
;	O
double	O
dedfi	double
;	O
int	O
*	O
indep	pointer
;	O
double	O
sse	double
;	O
int	O
dfe	int
;	O
double	O
*	O
emsmem	pointer
;	O
double	O
*	O
*	O
emscoeff	pointer
;	O
int	O
nfactors	int
;	O
int	O
*	O
termv	pointer
;	O
int	O
ndenterm	int
;	O
int	O
t	double
;	O
double	O
ss	double
,	O
ms	double
;	O
double	O
df	int
;	O
double	O
dfdown	double
,	O
dfup	double
;	O
double	O
fdown	double
,	O
fup	double
;	O
dedfi	double
=	O
0.0	int
;	O
emsmem	pointer
=	O
NULL	O
;	O
emscoeff	pointer
=	O
NULL	O
;	O
ndenterm	int
=	O
0	int
;	O
ss	double
=	O
0.0	int
;	O
df	int
=	O
0.0	int
;	O
sumcheck	function
(	O
"ftest1"	pointer
,	O
coeff	pointer
,	O
ncells	int
,	O
nerrors	int
,	O
ncontrasts	int
,	O
rterm	array
)	O
;	O
indep	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
(	O
nerrors	int
+	O
ncontrasts	int
)	O
,	O
""	pointer
)	O
;	O
if	O
(	O
nden	int
)	O
{	O
emsmem	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
2	int
*	O
ncells	int
*	O
ncells	int
,	O
""	pointer
)	O
;	O
emscoeff	pointer
=	O
(	O
double	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
*	O
)	O
*	O
2	int
*	O
ncells	int
,	O
""	pointer
)	O
;	O
for	O
(	O
cr	int
=	O
0	int
;	O
cr	int
<	O
2	int
*	O
ncells	int
;	O
cr	int
++	O
)	O
emscoeff	pointer
[	O
cr	int
]	O
=	O
emsmem	pointer
+	O
cr	int
*	O
ncells	int
;	O
}	O
termv	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
denom	double
=	O
0.0	int
;	O
for	O
(	O
cr	int
=	O
0	int
;	O
cr	int
<	O
nerrors	int
+	O
ncontrasts	int
;	O
cr	int
++	O
)	O
indep	pointer
[	O
cr	int
]	O
=	O
0	int
;	O
nfactors	int
=	O
0	int
;	O
if	O
(	O
nerrors	int
)	O
{	O
if	O
(	O
nden	int
)	O
{	O
edfi	int
=	O
orthog	function
(	O
coeff	pointer
,	O
0	int
,	O
nerrors	int
-	O
1	int
,	O
nerrors	int
-	O
1	int
,	O
ncells	int
,	O
nobs	array
,	O
indep	pointer
,	O
rterm	array
)	O
;	O
nfactors	int
=	O
ems	function
(	O
coeff	pointer
,	O
level	double
,	O
ncells	int
,	O
rterm	array
,	O
indep	pointer
,	O
nerrors	int
+	O
ncontrasts	int
,	O
nobs	array
,	O
varv	array
,	O
denv	pointer
,	O
nden	int
,	O
emscoeff	pointer
)	O
;	O
}	O
else	O
{	O
edfi	int
=	O
nerrors	int
;	O
for	O
(	O
cr	int
=	O
0	int
;	O
cr	int
<	O
nerrors	int
;	O
cr	int
++	O
)	O
{	O
for	O
(	O
cc	int
=	O
0	int
,	O
sq	double
=	O
0.0	int
,	O
varnce	double
=	O
0.0	int
;	O
cc	int
<	O
ncells	int
;	O
cc	int
++	O
)	O
{	O
tmp	double
=	O
coeff	pointer
[	O
cr	int
]	O
[	O
cc	int
]	O
;	O
sq	double
+=	O
tmp	double
*	O
mean	pointer
[	O
cc	int
]	O
;	O
varnce	double
+=	O
tmp	double
*	O
tmp	double
/	O
nobs	array
[	O
cc	int
]	O
;	O
}	O
denom	double
+=	O
sq	double
*	O
sq	double
/	O
varnce	double
;	O
}	O
}	O
}	O
else	O
edfi	int
=	O
0	int
;	O
corow	int
=	O
nerrors	int
+	O
ncontrasts	int
-	O
1	int
;	O
for	O
(	O
cc	int
=	O
0	int
,	O
n	int
=	O
0.0	int
,	O
sse	double
=	O
0.0	int
;	O
cc	int
<	O
ncells	int
;	O
cc	int
++	O
)	O
{	O
if	O
(	O
nobs	array
[	O
cc	int
]	O
>	O
0.0	int
)	O
{	O
sse	double
+=	O
(	O
nobs	array
[	O
cc	int
]	O
-	O
1.0	int
)	O
*	O
vari	pointer
[	O
cc	int
]	O
;	O
n	int
+=	O
nobs	array
[	O
cc	int
]	O
;	O
}	O
}	O
dfe	int
=	O
(	O
(	O
int	O
)	O
n	int
)	O
-	O
ncells	int
;	O
if	O
(	O
nden	int
)	O
{	O
orthog	function
(	O
coeff	pointer
,	O
nerrors	int
,	O
nerrors	int
,	O
corow	int
,	O
ncells	int
,	O
nobs	array
,	O
indep	pointer
,	O
NULL	O
)	O
;	O
cdfi	int
=	O
orthog	function
(	O
coeff	pointer
,	O
nerrors	int
,	O
corow	int
,	O
corow	int
,	O
ncells	int
,	O
nobs	array
,	O
indep	pointer
,	O
rterm	array
)	O
;	O
if	O
(	O
ems	function
(	O
coeff	pointer
,	O
level	double
,	O
ncells	int
,	O
rterm	array
,	O
indep	pointer
,	O
nerrors	int
+	O
ncontrasts	int
,	O
nobs	array
,	O
varv	array
,	O
numv	pointer
,	O
nnum	int
,	O
emscoeff	pointer
+	O
nfactors	int
)	O
!=	O
1	int
)	O
{	O
fputs	function
(	O
"(ftest1) Only one one term allowed in numerator of F-test with denominator\n"	pointer
,	O
dap_lst	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
ndenterm	int
=	O
emssolve	function
(	O
emscoeff	pointer
,	O
nden	int
,	O
nfactors	int
,	O
varv	array
,	O
termv	pointer
)	O
;	O
fputs	function
(	O
"Error for "	pointer
,	O
dap_lst	pointer
)	O
;	O
putms	function
(	O
rterm	array
[	O
nerrors	int
]	O
,	O
0.0	int
,	O
varv	array
)	O
;	O
fputs	function
(	O
" ="	pointer
,	O
dap_lst	pointer
)	O
;	O
for	O
(	O
t	double
=	O
0	int
,	O
denom	double
=	O
0.0	int
,	O
dedfi	double
=	O
0.0	int
;	O
t	double
<	O
ndenterm	int
;	O
t	double
++	O
)	O
{	O
if	O
(	O
termv	pointer
[	O
t	double
]	O
!=	O
rterm	array
[	O
nerrors	int
]	O
&&	O
emscoeff	pointer
[	O
nfactors	int
+	O
1	int
]	O
[	O
t	double
]	O
)	O
{	O
putms	function
(	O
termv	pointer
[	O
t	double
]	O
,	O
emscoeff	pointer
[	O
nfactors	int
+	O
1	int
]	O
[	O
t	double
]	O
,	O
varv	array
)	O
;	O
if	O
(	O
termv	pointer
[	O
t	double
]	O
)	O
{	O
for	O
(	O
cr	int
=	O
0	int
,	O
ss	double
=	O
0.0	int
,	O
df	int
=	O
0.0	int
;	O
cr	int
<	O
nerrors	int
+	O
ncontrasts	int
;	O
cr	int
++	O
)	O
{	O
if	O
(	O
rterm	array
[	O
cr	int
]	O
==	O
termv	pointer
[	O
t	double
]	O
&&	O
indep	pointer
[	O
cr	int
]	O
)	O
{	O
for	O
(	O
cc	int
=	O
0	int
,	O
sq	double
=	O
0.0	int
,	O
varnce	double
=	O
0.0	int
;	O
cc	int
<	O
ncells	int
;	O
cc	int
++	O
)	O
{	O
tmp	double
=	O
coeff	pointer
[	O
cr	int
]	O
[	O
cc	int
]	O
;	O
sq	double
+=	O
tmp	double
*	O
mean	pointer
[	O
cc	int
]	O
;	O
varnce	double
+=	O
tmp	double
*	O
tmp	double
/	O
nobs	array
[	O
cc	int
]	O
;	O
}	O
ss	double
+=	O
sq	double
*	O
sq	double
/	O
varnce	double
;	O
df	int
+=	O
1.0	int
;	O
}	O
}	O
}	O
else	O
{	O
ss	double
=	O
sse	double
;	O
df	int
=	O
(	O
double	O
)	O
dfe	int
;	O
}	O
if	O
(	O
ndenterm	int
>	O
1	int
)	O
{	O
ms	double
=	O
ss	double
/	O
df	int
;	O
tmp	double
=	O
emscoeff	pointer
[	O
nfactors	int
+	O
1	int
]	O
[	O
t	double
]	O
*	O
ms	double
;	O
denom	double
+=	O
tmp	double
;	O
dedfi	double
+=	O
tmp	double
*	O
tmp	double
/	O
df	int
;	O
}	O
}	O
}	O
putc	function
(	O
'\n'	O
,	O
dap_lst	pointer
)	O
;	O
if	O
(	O
ndenterm	int
>	O
1	int
)	O
dedfi	double
=	O
denom	double
*	O
denom	double
/	O
dedfi	double
;	O
else	O
{	O
denom	double
=	O
emscoeff	pointer
[	O
nfactors	int
]	O
[	O
t	double
]	O
*	O
ss	double
;	O
edfi	int
=	O
(	O
int	O
)	O
df	int
;	O
}	O
}	O
else	O
{	O
denom	double
+=	O
sse	double
;	O
cdfi	int
=	O
orthog	function
(	O
coeff	pointer
,	O
0	int
,	O
corow	int
,	O
corow	int
,	O
ncells	int
,	O
nobs	array
,	O
indep	pointer
,	O
NULL	O
)	O
-	O
edfi	int
;	O
edfi	int
+=	O
dfe	int
;	O
}	O
for	O
(	O
cr	int
=	O
nerrors	int
,	O
numer	double
=	O
0.0	int
;	O
cr	int
<=	O
corow	int
;	O
cr	int
++	O
)	O
{	O
if	O
(	O
indep	pointer
[	O
cr	int
]	O
)	O
{	O
for	O
(	O
cc	int
=	O
0	int
,	O
sq	double
=	O
0.0	int
,	O
varnce	double
=	O
0.0	int
;	O
cc	int
<	O
ncells	int
;	O
cc	int
++	O
)	O
{	O
tmp	double
=	O
coeff	pointer
[	O
cr	int
]	O
[	O
cc	int
]	O
;	O
sq	double
+=	O
tmp	double
*	O
mean	pointer
[	O
cc	int
]	O
;	O
varnce	double
+=	O
tmp	double
*	O
tmp	double
/	O
nobs	array
[	O
cc	int
]	O
;	O
}	O
numer	double
+=	O
sq	double
*	O
sq	double
/	O
varnce	double
;	O
}	O
}	O
fprintf	function
(	O
dap_lst	pointer
,	O
"Number of observations = %d\n"	pointer
,	O
(	O
int	O
)	O
n	int
)	O
;	O
fprintf	function
(	O
dap_lst	pointer
,	O
"H0 SS = %g, df = %d, MS = %g\n"	pointer
,	O
numer	double
,	O
cdfi	int
,	O
numer	double
/	O
(	O
(	O
double	O
)	O
cdfi	int
)	O
)	O
;	O
modelss	double
=	O
numer	double
;	O
numer	double
/=	O
(	O
double	O
)	O
cdfi	int
;	O
if	O
(	O
nerrors	int
)	O
fputs	function
(	O
"Residual "	pointer
,	O
dap_lst	pointer
)	O
;	O
else	O
fputs	function
(	O
"Error "	pointer
,	O
dap_lst	pointer
)	O
;	O
if	O
(	O
nden	int
&&	O
ndenterm	int
>	O
1	int
)	O
{	O
fprintf	function
(	O
dap_lst	pointer
,	O
"df = %g, MS = %g\n"	pointer
,	O
dedfi	double
,	O
denom	double
)	O
;	O
numer	double
/=	O
denom	double
;	O
fprintf	function
(	O
dap_lst	pointer
,	O
"F0 = %g\n"	pointer
,	O
numer	double
)	O
;	O
dfdown	double
=	O
floor	function
(	O
dedfi	double
)	O
;	O
dfup	double
=	O
ceil	function
(	O
dedfi	double
)	O
;	O
if	O
(	O
dfup	double
==	O
dfdown	double
)	O
fprintf	function
(	O
dap_lst	pointer
,	O
"Prob[F > F0] = %.5f\n"	pointer
,	O
0.00001	int
*	O
(	O
ceil	function
(	O
100000.0	int
*	O
probf	function
(	O
numer	double
,	O
cdfi	int
,	O
(	O
int	O
)	O
dedfi	double
)	O
)	O
)	O
)	O
;	O
else	O
{	O
fdown	double
=	O
probf	function
(	O
numer	double
,	O
cdfi	int
,	O
(	O
int	O
)	O
dfdown	double
)	O
;	O
fup	double
=	O
probf	function
(	O
numer	double
,	O
cdfi	int
,	O
(	O
int	O
)	O
dfup	double
)	O
;	O
fprintf	function
(	O
dap_lst	pointer
,	O
"Prob[F > F0] = %.5f\n"	pointer
,	O
0.00001	int
*	O
(	O
ceil	function
(	O
100000.0	int
*	O
(	O
fdown	double
+	O
(	O
dedfi	double
-	O
dfdown	double
)	O
/	O
(	O
dfup	double
-	O
dfdown	double
)	O
*	O
(	O
fup	double
-	O
fdown	double
)	O
)	O
)	O
)	O
)	O
;	O
}	O
}	O
else	O
{	O
dedfi	double
=	O
(	O
double	O
)	O
edfi	int
;	O
fprintf	function
(	O
dap_lst	pointer
,	O
"SS = %g, df = %d, MS = %g\n"	pointer
,	O
denom	double
,	O
edfi	int
,	O
denom	double
/	O
dedfi	double
)	O
;	O
if	O
(	O
ncontrasts	int
+	O
nerrors	int
==	O
ncells	int
-	O
1	int
)	O
fprintf	function
(	O
dap_lst	pointer
,	O
"R-sq = %g\n"	pointer
,	O
modelss	double
/	O
(	O
modelss	double
+	O
denom	double
)	O
)	O
;	O
denom	double
/=	O
dedfi	double
;	O
numer	double
/=	O
denom	double
;	O
fprintf	function
(	O
dap_lst	pointer
,	O
"F0 = %g\nProb[F > F0] = %.5f\n"	pointer
,	O
numer	double
,	O
0.00001	int
*	O
(	O
ceil	function
(	O
100000.0	int
*	O
probf	function
(	O
numer	double
,	O
cdfi	int
,	O
edfi	int
)	O
)	O
)	O
)	O
;	O
}	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"MSERROR"	pointer
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
=	O
denom	double
;	O
output	function
(	O
)	O
;	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"ERRORDF"	pointer
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
=	O
dedfi	double
;	O
output	function
(	O
)	O
;	O
if	O
(	O
nden	int
)	O
{	O
dap_free	function
(	O
emsmem	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
emscoeff	pointer
,	O
""	pointer
)	O
;	O
}	O
dap_free	function
(	O
indep	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
termv	pointer
,	O
""	pointer
)	O
;	O
}	O
static	O
void	O
puttest	function
(	O
char	O
*	O
testv	pointer
,	O
int	O
ntest	int
,	O
int	O
*	O
varv	array
,	O
int	O
nvars	int
)	O
{	O
int	O
t	double
;	O
int	O
v	int
;	O
int	O
bits	int
;	O
int	O
first	int
;	O
for	O
(	O
t	double
=	O
1	int
;	O
t	double
<=	O
ntest	int
;	O
t	double
++	O
)	O
{	O
if	O
(	O
testv	pointer
[	O
t	double
]	O
==	O
'c'	O
||	O
testv	pointer
[	O
t	double
]	O
==	O
'n'	O
)	O
{	O
for	O
(	O
bits	int
=	O
t	double
,	O
v	int
=	O
1	int
,	O
first	int
=	O
1	int
;	O
v	int
<	O
nvars	int
;	O
bits	int
=	O
(	O
bits	int
>>	O
1	int
)	O
,	O
v	int
++	O
)	O
{	O
if	O
(	O
bits	int
&	O
0x1	int
)	O
{	O
if	O
(	O
first	int
)	O
{	O
putc	function
(	O
' '	O
,	O
dap_lst	pointer
)	O
;	O
first	int
=	O
0	int
;	O
}	O
else	O
putc	function
(	O
'*'	O
,	O
dap_lst	pointer
)	O
;	O
fprintf	function
(	O
dap_lst	pointer
,	O
"%s"	pointer
,	O
dap_obs	array
[	O
0	int
]	O
.	O
do_nam	pointer
[	O
varv	array
[	O
v	int
]	O
]	O
)	O
;	O
}	O
}	O
}	O
}	O
putc	function
(	O
'\n'	O
,	O
dap_lst	pointer
)	O
;	O
}	O
void	O
ftest	function
(	O
char	O
*	O
fname	array
,	O
char	O
*	O
variables	pointer
,	O
char	O
*	O
numerator	pointer
,	O
char	O
*	O
denominator	pointer
,	O
char	O
*	O
marks	array
)	O
{	O
char	O
*	O
tstname	pointer
;	O
int	O
typen	int
;	O
int	O
termn	int
;	O
int	O
*	O
varv	array
;	O
int	O
nvars	int
;	O
int	O
*	O
markv	array
;	O
int	O
nmark	int
;	O
int	O
*	O
rterm	array
;	O
int	O
nnum	int
;	O
int	O
nden	int
;	O
char	O
*	O
numv	pointer
;	O
char	O
*	O
denv	pointer
;	O
int	O
num	int
;	O
int	O
den	int
;	O
int	O
t	double
;	O
int	O
morecells	int
;	O
int	O
more	int
;	O
int	O
statn	int
;	O
int	O
gotm	int
,	O
gotn	int
,	O
gotv	int
;	O
char	O
*	O
levmem	pointer
;	O
char	O
*	O
*	O
levptr	pointer
;	O
char	O
*	O
*	O
*	O
levval	pointer
;	O
int	O
*	O
nlevels	pointer
;	O
int	O
*	O
levelmem	pointer
;	O
int	O
*	O
*	O
level	double
;	O
int	O
v	int
;	O
int	O
l	int
;	O
double	O
*	O
comem	pointer
;	O
double	O
*	O
*	O
coeff	pointer
;	O
double	O
*	O
mean	pointer
;	O
double	O
*	O
nobs	array
;	O
double	O
*	O
vari	pointer
;	O
int	O
ncells	int
;	O
int	O
ncontrasts	int
;	O
int	O
nerrors	int
;	O
int	O
err	int
;	O
int	O
con	int
;	O
varv	array
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
,	O
""	pointer
)	O
;	O
markv	array
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
dap_maxvar	int
,	O
""	pointer
)	O
;	O
rterm	array
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
(	O
dap_maxcell	int
-	O
1	int
)	O
,	O
""	pointer
)	O
;	O
numv	pointer
=	O
dap_malloc	function
(	O
dap_maxcell	int
,	O
""	pointer
)	O
;	O
denv	pointer
=	O
dap_malloc	function
(	O
dap_maxcell	int
,	O
""	pointer
)	O
;	O
levmem	pointer
=	O
dap_malloc	function
(	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
*	O
dap_maxlev	int
*	O
(	O
dap_strlen	int
+	O
1	int
)	O
,	O
""	pointer
)	O
;	O
levptr	pointer
=	O
(	O
char	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
char	O
*	O
)	O
*	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
*	O
dap_maxlev	int
,	O
""	pointer
)	O
;	O
levval	pointer
=	O
(	O
char	O
*	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
char	O
*	O
*	O
)	O
*	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
,	O
""	pointer
)	O
;	O
for	O
(	O
v	int
=	O
0	int
;	O
v	int
<	O
dap_maxtreat	int
+	O
1	int
;	O
v	int
++	O
)	O
{	O
levval	pointer
[	O
v	int
]	O
=	O
levptr	pointer
+	O
v	int
*	O
dap_maxlev	int
;	O
for	O
(	O
l	int
=	O
0	int
;	O
l	int
<	O
dap_maxlev	int
;	O
l	int
++	O
)	O
levval	pointer
[	O
v	int
]	O
[	O
l	int
]	O
=	O
levmem	pointer
+	O
v	int
*	O
dap_maxlev	int
*	O
(	O
dap_strlen	int
+	O
1	int
)	O
+	O
l	int
*	O
(	O
dap_strlen	int
+	O
1	int
)	O
;	O
}	O
nlevels	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
,	O
""	pointer
)	O
;	O
levelmem	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
*	O
dap_maxcell	int
,	O
""	pointer
)	O
;	O
level	double
=	O
(	O
int	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
*	O
)	O
*	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
,	O
""	pointer
)	O
;	O
for	O
(	O
v	int
=	O
0	int
;	O
v	int
<	O
dap_maxtreat	int
+	O
1	int
;	O
v	int
++	O
)	O
level	double
[	O
v	int
]	O
=	O
levelmem	pointer
+	O
v	int
*	O
dap_maxcell	int
;	O
comem	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
dap_maxcell	int
*	O
dap_maxcell	int
,	O
"dap_maxcell"	pointer
)	O
;	O
coeff	pointer
=	O
(	O
double	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
*	O
)	O
*	O
dap_maxcell	int
,	O
"dap_maxcell"	pointer
)	O
;	O
for	O
(	O
ncells	int
=	O
0	int
;	O
ncells	int
<	O
dap_maxcell	int
;	O
ncells	int
++	O
)	O
coeff	pointer
[	O
ncells	int
]	O
=	O
comem	pointer
+	O
ncells	int
*	O
dap_maxcell	int
;	O
mean	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
dap_maxcell	int
,	O
"dap_maxcell"	pointer
)	O
;	O
nobs	array
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
dap_maxcell	int
,	O
"dap_maxcell"	pointer
)	O
;	O
vari	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
dap_maxcell	int
,	O
"dap_maxcell"	pointer
)	O
;	O
if	O
(	O
!	O
fname	array
)	O
{	O
fputs	function
(	O
"(ftest) No dataset name given.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
tstname	pointer
=	O
dap_malloc	function
(	O
strlen	function
(	O
fname	array
)	O
+	O
5	int
,	O
""	pointer
)	O
;	O
dap_suffix	function
(	O
tstname	pointer
,	O
fname	array
,	O
"<tst"	pointer
)	O
;	O
inset	function
(	O
fname	array
)	O
;	O
if	O
(	O
(	O
typen	int
=	O
dap_varnum	function
(	O
"_type_"	pointer
)	O
)	O
<	O
0	int
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(ftest) no _type_ variable\n"	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
if	O
(	O
(	O
termn	int
=	O
dap_varnum	function
(	O
"_term_"	pointer
)	O
)	O
<	O
0	int
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(ftest) no _term_ variable\n"	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
if	O
(	O
!	O
variables	pointer
||	O
!	O
variables	pointer
[	O
0	int
]	O
)	O
{	O
fputs	function
(	O
"(ftest) No variables given.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
nvars	int
=	O
dap_list	function
(	O
variables	pointer
,	O
varv	array
,	O
dap_maxtreat	int
+	O
1	int
)	O
;	O
if	O
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_len	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
!=	O
DBL	O
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(ftest) response variable %s must be of type double\n"	pointer
,	O
dap_obs	array
[	O
0	int
]	O
.	O
do_nam	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
for	O
(	O
v	int
=	O
1	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
{	O
if	O
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_len	pointer
[	O
varv	array
[	O
v	int
]	O
]	O
<=	O
0	int
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(ftest) classification variable %s must be string\n"	pointer
,	O
dap_obs	array
[	O
0	int
]	O
.	O
do_nam	pointer
[	O
varv	array
[	O
v	int
]	O
]	O
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
outset	function
(	O
tstname	pointer
,	O
""	pointer
)	O
;	O
if	O
(	O
numerator	pointer
&&	O
numerator	pointer
[	O
0	int
]	O
)	O
{	O
nnum	int
=	O
testparse	function
(	O
numerator	pointer
,	O
numv	pointer
,	O
varv	array
,	O
nvars	int
)	O
;	O
num	int
=	O
1	int
;	O
}	O
else	O
{	O
num	int
=	O
0	int
;	O
nnum	int
=	O
0	int
;	O
for	O
(	O
t	double
=	O
1	int
;	O
t	double
<	O
dap_maxcell	int
;	O
t	double
++	O
)	O
numv	pointer
[	O
t	double
]	O
=	O
'e'	O
;	O
}	O
if	O
(	O
denominator	pointer
&&	O
denominator	pointer
[	O
0	int
]	O
)	O
{	O
nden	int
=	O
testparse	function
(	O
denominator	pointer
,	O
denv	pointer
,	O
varv	array
,	O
nvars	int
)	O
;	O
for	O
(	O
t	double
=	O
1	int
;	O
t	double
<=	O
nnum	int
;	O
t	double
++	O
)	O
{	O
if	O
(	O
numv	pointer
[	O
t	double
]	O
==	O
'c'	O
)	O
denv	pointer
[	O
t	double
]	O
=	O
'e'	O
;	O
}	O
for	O
(	O
t	double
=	O
1	int
;	O
t	double
<=	O
nden	int
;	O
t	double
++	O
)	O
{	O
if	O
(	O
denv	pointer
[	O
t	double
]	O
!=	O
'e'	O
)	O
{	O
den	int
=	O
1	int
;	O
break	O
;	O
}	O
}	O
if	O
(	O
t	double
>	O
nden	int
)	O
{	O
den	int
=	O
0	int
;	O
nden	int
=	O
0	int
;	O
while	O
(	O
t	double
<	O
dap_maxcell	int
)	O
denv	pointer
[	O
t	double
++	O
]	O
=	O
'e'	O
;	O
}	O
}	O
else	O
{	O
den	int
=	O
0	int
;	O
nden	int
=	O
0	int
;	O
for	O
(	O
t	double
=	O
1	int
;	O
t	double
<	O
dap_maxcell	int
;	O
t	double
++	O
)	O
denv	pointer
[	O
t	double
]	O
=	O
'e'	O
;	O
}	O
for	O
(	O
v	int
=	O
1	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
{	O
nlevels	pointer
[	O
v	int
]	O
=	O
0	int
;	O
for	O
(	O
l	int
=	O
0	int
;	O
l	int
<	O
dap_maxlev	int
;	O
l	int
++	O
)	O
levval	pointer
[	O
v	int
]	O
[	O
l	int
]	O
[	O
0	int
]	O
=	O
'\0'	O
;	O
}	O
nmark	int
=	O
dap_list	function
(	O
marks	array
,	O
markv	array
,	O
dap_maxvar	int
)	O
;	O
for	O
(	O
ncells	int
=	O
0	int
,	O
ncontrasts	int
=	O
0	int
,	O
nerrors	int
=	O
0	int
,	O
more	int
=	O
step	function
(	O
)	O
,	O
morecells	int
=	O
1	int
;	O
morecells	int
;	O
ncells	int
++	O
)	O
{	O
gotn	int
=	O
0	int
;	O
gotm	int
=	O
0	int
;	O
gotv	int
=	O
0	int
;	O
morecells	int
=	O
more	int
;	O
if	O
(	O
dap_newpart	function
(	O
markv	array
,	O
nmark	int
)	O
)	O
{	O
dap_swap	function
(	O
)	O
;	O
dap_head	function
(	O
markv	array
,	O
nmark	int
)	O
;	O
if	O
(	O
num	int
)	O
fprintf	function
(	O
dap_lst	pointer
,	O
"Testing Ho: %s\n"	pointer
,	O
numerator	pointer
)	O
;	O
else	O
if	O
(	O
nnum	int
>	O
0	int
)	O
{	O
fputs	function
(	O
"Testing Ho:"	pointer
,	O
dap_lst	pointer
)	O
;	O
puttest	function
(	O
numv	pointer
,	O
nnum	int
,	O
varv	array
,	O
nvars	int
)	O
;	O
}	O
if	O
(	O
den	int
)	O
fprintf	function
(	O
dap_lst	pointer
,	O
"Denominator: %s\n"	pointer
,	O
denominator	pointer
)	O
;	O
else	O
if	O
(	O
nden	int
>	O
0	int
)	O
{	O
fputs	function
(	O
"Denominator:"	pointer
,	O
dap_lst	pointer
)	O
;	O
puttest	function
(	O
denv	pointer
,	O
nden	int
,	O
varv	array
,	O
nvars	int
)	O
;	O
}	O
ftest1	function
(	O
coeff	pointer
,	O
level	double
,	O
ncells	int
,	O
rterm	array
,	O
ncontrasts	int
,	O
nerrors	int
,	O
mean	pointer
,	O
vari	pointer
,	O
nobs	array
,	O
varv	array
,	O
numv	pointer
,	O
num	int
*	O
nnum	int
,	O
denv	pointer
,	O
den	int
*	O
nden	int
,	O
typen	int
)	O
;	O
dap_swap	function
(	O
)	O
;	O
for	O
(	O
v	int
=	O
1	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
{	O
nlevels	pointer
[	O
v	int
]	O
=	O
0	int
;	O
for	O
(	O
l	int
=	O
0	int
;	O
l	int
<	O
dap_maxlev	int
;	O
l	int
++	O
)	O
levval	pointer
[	O
v	int
]	O
[	O
l	int
]	O
[	O
0	int
]	O
=	O
'\0'	O
;	O
}	O
ncells	int
=	O
0	int
;	O
ncontrasts	int
=	O
0	int
;	O
nerrors	int
=	O
0	int
;	O
}	O
for	O
(	O
statn	int
=	O
0	int
;	O
more	int
;	O
)	O
{	O
if	O
(	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"N"	pointer
)	O
)	O
{	O
nobs	array
[	O
ncells	int
]	O
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
;	O
gotn	int
=	O
1	int
;	O
output	function
(	O
)	O
;	O
}	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"MEAN"	pointer
)	O
)	O
{	O
mean	pointer
[	O
ncells	int
]	O
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
;	O
gotm	int
=	O
1	int
;	O
output	function
(	O
)	O
;	O
}	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"VAR"	pointer
)	O
)	O
{	O
vari	pointer
[	O
ncells	int
]	O
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
;	O
gotv	int
=	O
1	int
;	O
output	function
(	O
)	O
;	O
}	O
else	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(ftest) Bad cell statistic: %s\n"	pointer
,	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
if	O
(	O
++	O
statn	int
<	O
3	int
)	O
more	int
=	O
step	function
(	O
)	O
;	O
else	O
{	O
if	O
(	O
nobs	array
[	O
ncells	int
]	O
==	O
1.0	int
)	O
vari	pointer
[	O
ncells	int
]	O
=	O
0.0	int
;	O
break	O
;	O
}	O
}	O
if	O
(	O
more	int
)	O
{	O
if	O
(	O
!	O
gotm	int
)	O
{	O
fputs	function
(	O
"(ftest) Missing MEAN.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
if	O
(	O
!	O
gotn	int
)	O
{	O
fputs	function
(	O
"(ftest) Missing N.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
if	O
(	O
!	O
gotv	int
)	O
{	O
fputs	function
(	O
"(ftest) Missing VAR.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
for	O
(	O
v	int
=	O
1	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
level	double
[	O
v	int
]	O
[	O
ncells	int
]	O
=	O
levn	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
varv	array
[	O
v	int
]	O
]	O
,	O
levval	pointer
[	O
v	int
]	O
,	O
&	O
nlevels	pointer
[	O
v	int
]	O
)	O
;	O
}	O
for	O
(	O
dap_mark	function
(	O
)	O
,	O
nerrors	int
=	O
0	int
;	O
more	int
;	O
)	O
{	O
more	int
=	O
step	function
(	O
)	O
;	O
err	int
=	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"ERROR"	pointer
)	O
;	O
con	int
=	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"CONTR"	pointer
)	O
;	O
if	O
(	O
den	int
&&	O
err	int
)	O
dap_mark	function
(	O
)	O
;	O
if	O
(	O
err	int
||	O
(	O
den	int
&&	O
con	int
)	O
)	O
{	O
t	double
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_int	pointer
[	O
termn	int
]	O
;	O
rterm	array
[	O
nerrors	int
]	O
=	O
t	double
;	O
if	O
(	O
!	O
den	int
)	O
{	O
denv	pointer
[	O
t	double
]	O
=	O
'c'	O
;	O
if	O
(	O
nden	int
<	O
t	double
)	O
nden	int
=	O
t	double
;	O
}	O
if	O
(	O
denv	pointer
[	O
t	double
]	O
==	O
'c'	O
||	O
denv	pointer
[	O
t	double
]	O
==	O
'n'	O
)	O
{	O
coeff	pointer
[	O
nerrors	int
]	O
[	O
ncells	int
]	O
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
;	O
nerrors	int
++	O
;	O
output	function
(	O
)	O
;	O
}	O
}	O
else	O
{	O
if	O
(	O
den	int
)	O
{	O
dap_rewind	function
(	O
)	O
;	O
more	int
=	O
step	function
(	O
)	O
;	O
}	O
break	O
;	O
}	O
}	O
for	O
(	O
ncontrasts	int
=	O
0	int
;	O
more	int
;	O
more	int
=	O
step	function
(	O
)	O
)	O
{	O
if	O
(	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"CONTR"	pointer
)	O
)	O
{	O
t	double
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_int	pointer
[	O
termn	int
]	O
;	O
rterm	array
[	O
nerrors	int
+	O
ncontrasts	int
]	O
=	O
t	double
;	O
if	O
(	O
!	O
num	int
)	O
{	O
numv	pointer
[	O
t	double
]	O
=	O
'c'	O
;	O
if	O
(	O
nnum	int
<	O
t	double
)	O
nnum	int
=	O
t	double
;	O
}	O
if	O
(	O
numv	pointer
[	O
t	double
]	O
==	O
'c'	O
||	O
numv	pointer
[	O
t	double
]	O
==	O
'n'	O
)	O
{	O
coeff	pointer
[	O
nerrors	int
+	O
ncontrasts	int
]	O
[	O
ncells	int
]	O
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
;	O
ncontrasts	int
++	O
;	O
}	O
}	O
else	O
break	O
;	O
}	O
while	O
(	O
more	int
)	O
{	O
if	O
(	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"LSMEAN"	pointer
)	O
)	O
{	O
t	double
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_int	pointer
[	O
termn	int
]	O
;	O
if	O
(	O
t	double
<=	O
nnum	int
&&	O
(	O
numv	pointer
[	O
t	double
]	O
==	O
'c'	O
||	O
numv	pointer
[	O
t	double
]	O
==	O
'n'	O
)	O
)	O
output	function
(	O
)	O
;	O
}	O
else	O
break	O
;	O
more	int
=	O
step	function
(	O
)	O
;	O
}	O
}	O
dap_free	function
(	O
comem	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
coeff	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
tstname	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
varv	array
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
markv	array
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
rterm	array
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
numv	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
denv	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
levmem	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
levptr	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
levval	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
nlevels	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
levelmem	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
level	double
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
mean	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
nobs	array
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
vari	pointer
,	O
""	pointer
)	O
;	O
}	O
static	O
void	O
putlev	function
(	O
int	O
*	O
nlevels	pointer
,	O
int	O
*	O
varv	array
,	O
int	O
nvars	int
,	O
char	O
*	O
*	O
*	O
levval	pointer
)	O
{	O
int	O
v	int
;	O
int	O
l	int
;	O
fprintf	function
(	O
dap_lst	pointer
,	O
"Response variable: %s\n\n"	pointer
,	O
dap_obs	array
[	O
0	int
]	O
.	O
do_nam	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
)	O
;	O
fprintf	function
(	O
dap_lst	pointer
,	O
"%-15s Levels\n"	pointer
,	O
"Treatment"	pointer
)	O
;	O
fprintf	function
(	O
dap_lst	pointer
,	O
"%-15s ------\n"	pointer
,	O
"--------"	pointer
)	O
;	O
for	O
(	O
v	int
=	O
1	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
{	O
fprintf	function
(	O
dap_lst	pointer
,	O
"%-15s"	pointer
,	O
dap_obs	array
[	O
0	int
]	O
.	O
do_nam	pointer
[	O
varv	array
[	O
v	int
]	O
]	O
)	O
;	O
for	O
(	O
l	int
=	O
0	int
;	O
l	int
<	O
nlevels	pointer
[	O
v	int
]	O
;	O
l	int
++	O
)	O
fprintf	function
(	O
dap_lst	pointer
,	O
" %s"	pointer
,	O
levval	pointer
[	O
v	int
]	O
[	O
l	int
]	O
)	O
;	O
putc	function
(	O
'\n'	O
,	O
dap_lst	pointer
)	O
;	O
}	O
putc	function
(	O
'\n'	O
,	O
dap_lst	pointer
)	O
;	O
}	O
static	O
void	O
maketerm	function
(	O
int	O
nterm	int
,	O
char	O
*	O
termv	pointer
,	O
int	O
nvars	int
,	O
int	O
*	O
varv	array
,	O
int	O
*	O
nlevels	pointer
,	O
double	O
*	O
*	O
coeff	pointer
,	O
int	O
ncells	int
,	O
double	O
*	O
nobs	array
,	O
int	O
*	O
rterm	array
,	O
int	O
*	O
nrows	int
,	O
int	O
*	O
*	O
clevel	pointer
)	O
{	O
char	O
termtype	array
[	O
4	int
]	O
=	O
"ecc"	pointer
;	O
int	O
tt	int
;	O
int	O
tn	int
;	O
int	O
*	O
nest	pointer
;	O
int	O
reset	int
;	O
int	O
r	double
,	O
c	int
;	O
int	O
row	int
;	O
int	O
*	O
iv	pointer
;	O
int	O
ivn	int
;	O
int	O
ntreat	int
;	O
int	O
*	O
rlevel	pointer
;	O
int	O
bits	int
;	O
double	O
prod	double
;	O
int	O
vn	int
;	O
int	O
nextr	int
;	O
int	O
*	O
change	pointer
;	O
int	O
nbits	int
;	O
row	int
=	O
0	int
;	O
nest	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
iv	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
,	O
"dap_maxtreat"	pointer
)	O
;	O
rlevel	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
,	O
"dap_maxtreat"	pointer
)	O
;	O
change	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
,	O
"dap_maxtreat"	pointer
)	O
;	O
for	O
(	O
tn	int
=	O
1	int
;	O
tn	int
<=	O
nterm	int
;	O
tn	int
++	O
)	O
nest	pointer
[	O
tn	int
]	O
=	O
tn	int
;	O
for	O
(	O
tn	int
=	O
0x1	int
;	O
tn	int
<=	O
nterm	int
;	O
tn	int
=	O
(	O
tn	int
<<	O
1	int
)	O
)	O
{	O
if	O
(	O
termv	pointer
[	O
tn	int
]	O
==	O
'e'	O
)	O
{	O
for	O
(	O
tt	int
=	O
1	int
,	O
bits	int
=	O
0	int
;	O
tt	int
<=	O
nterm	int
;	O
tt	int
++	O
)	O
{	O
if	O
(	O
tt	int
!=	O
tn	int
&&	O
(	O
tt	int
&	O
tn	int
)	O
==	O
tn	int
&&	O
termv	pointer
[	O
tt	int
]	O
==	O
'c'	O
)	O
{	O
if	O
(	O
bits	int
)	O
bits	int
&=	O
tt	int
;	O
else	O
bits	int
=	O
tt	int
;	O
}	O
}	O
if	O
(	O
bits	int
&&	O
bits	int
!=	O
tn	int
)	O
{	O
for	O
(	O
tt	int
=	O
1	int
;	O
tt	int
<=	O
nterm	int
;	O
tt	int
++	O
)	O
{	O
if	O
(	O
(	O
tt	int
&	O
tn	int
)	O
==	O
tn	int
)	O
{	O
if	O
(	O
termv	pointer
[	O
tt	int
]	O
==	O
'e'	O
)	O
{	O
nbits	int
=	O
(	O
tt	int
|	O
bits	int
)	O
;	O
termv	pointer
[	O
tt	int
]	O
=	O
'n'	O
;	O
nest	pointer
[	O
tt	int
]	O
=	O
nbits	int
;	O
}	O
}	O
}	O
}	O
}	O
}	O
for	O
(	O
vn	int
=	O
1	int
,	O
c	int
=	O
0	int
;	O
vn	int
<	O
nvars	int
;	O
vn	int
++	O
)	O
clevel	pointer
[	O
vn	int
]	O
[	O
c	int
]	O
=	O
0	int
;	O
for	O
(	O
c	int
++	O
;	O
c	int
<	O
ncells	int
;	O
c	int
++	O
)	O
{	O
for	O
(	O
vn	int
=	O
1	int
;	O
vn	int
<	O
nvars	int
;	O
vn	int
++	O
)	O
clevel	pointer
[	O
vn	int
]	O
[	O
c	int
]	O
=	O
clevel	pointer
[	O
vn	int
]	O
[	O
c	int
-	O
1	int
]	O
;	O
for	O
(	O
vn	int
=	O
nvars	int
-	O
1	int
;	O
vn	int
>=	O
0	int
;	O
--	O
vn	int
)	O
{	O
if	O
(	O
++	O
clevel	pointer
[	O
vn	int
]	O
[	O
c	int
]	O
==	O
nlevels	pointer
[	O
vn	int
]	O
)	O
clevel	pointer
[	O
vn	int
]	O
[	O
c	int
]	O
=	O
0	int
;	O
else	O
break	O
;	O
}	O
}	O
for	O
(	O
tt	int
=	O
0	int
,	O
r	double
=	O
0	int
;	O
tt	int
<	O
3	int
;	O
tt	int
++	O
)	O
{	O
reset	int
=	O
(	O
tt	int
<	O
2	int
)	O
;	O
for	O
(	O
tn	int
=	O
1	int
,	O
nrows	int
[	O
tt	int
]	O
=	O
0	int
;	O
tn	int
<=	O
nterm	int
;	O
tn	int
++	O
)	O
{	O
if	O
(	O
termv	pointer
[	O
tn	int
]	O
==	O
termtype	array
[	O
tt	int
]	O
||	O
(	O
termv	pointer
[	O
tn	int
]	O
==	O
'n'	O
&&	O
termtype	array
[	O
tt	int
]	O
==	O
'c'	O
)	O
)	O
{	O
bits	int
=	O
tn	int
;	O
for	O
(	O
ntreat	int
=	O
0	int
,	O
vn	int
=	O
1	int
;	O
vn	int
<	O
nvars	int
;	O
vn	int
++	O
,	O
bits	int
=	O
(	O
bits	int
>>	O
1	int
)	O
)	O
{	O
if	O
(	O
bits	int
&	O
0x1	int
)	O
iv	pointer
[	O
ntreat	int
++	O
]	O
=	O
vn	int
;	O
}	O
for	O
(	O
c	int
=	O
0	int
,	O
vn	int
=	O
nvars	int
-	O
1	int
;	O
vn	int
>	O
0	int
;	O
)	O
{	O
for	O
(	O
ivn	int
=	O
0	int
;	O
ivn	int
<	O
ntreat	int
;	O
ivn	int
++	O
)	O
rlevel	pointer
[	O
ivn	int
]	O
=	O
reset	int
;	O
for	O
(	O
row	int
=	O
0	int
,	O
ivn	int
=	O
0	int
;	O
ivn	int
<	O
ntreat	int
;	O
)	O
{	O
if	O
(	O
tt	int
<	O
2	int
)	O
{	O
for	O
(	O
ivn	int
=	O
0	int
,	O
prod	double
=	O
1.0	int
;	O
ivn	int
<	O
ntreat	int
;	O
ivn	int
++	O
)	O
{	O
if	O
(	O
clevel	pointer
[	O
iv	pointer
[	O
ivn	int
]	O
]	O
[	O
c	int
]	O
==	O
0	int
)	O
;	O
else	O
if	O
(	O
clevel	pointer
[	O
iv	pointer
[	O
ivn	int
]	O
]	O
[	O
c	int
]	O
==	O
rlevel	pointer
[	O
ivn	int
]	O
)	O
prod	double
=	O
-	O
prod	double
;	O
else	O
{	O
prod	double
=	O
0.0	int
;	O
break	O
;	O
}	O
}	O
coeff	pointer
[	O
r	double
+	O
row	int
]	O
[	O
c	int
]	O
=	O
prod	double
;	O
row	int
++	O
;	O
}	O
else	O
if	O
(	O
ntreat	int
==	O
1	int
)	O
{	O
if	O
(	O
clevel	pointer
[	O
iv	pointer
[	O
ivn	int
]	O
]	O
[	O
c	int
]	O
==	O
rlevel	pointer
[	O
ivn	int
]	O
)	O
coeff	pointer
[	O
r	double
+	O
row	int
]	O
[	O
c	int
]	O
=	O
1.0	int
;	O
else	O
coeff	pointer
[	O
r	double
+	O
row	int
]	O
[	O
c	int
]	O
=	O
0.0	int
;	O
row	int
++	O
;	O
}	O
for	O
(	O
ivn	int
=	O
0	int
;	O
ivn	int
<	O
ntreat	int
;	O
ivn	int
++	O
)	O
{	O
if	O
(	O
++	O
rlevel	pointer
[	O
ivn	int
]	O
==	O
nlevels	pointer
[	O
iv	pointer
[	O
ivn	int
]	O
]	O
)	O
rlevel	pointer
[	O
ivn	int
]	O
=	O
reset	int
;	O
else	O
break	O
;	O
}	O
}	O
if	O
(	O
++	O
c	int
==	O
ncells	int
)	O
break	O
;	O
}	O
for	O
(	O
nextr	int
=	O
r	double
+	O
row	int
;	O
r	double
<	O
nextr	int
;	O
r	double
++	O
,	O
nrows	int
[	O
tt	int
]	O
++	O
)	O
rterm	array
[	O
r	double
]	O
=	O
nest	pointer
[	O
tn	int
]	O
;	O
}	O
}	O
}	O
dap_free	function
(	O
nest	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
iv	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
rlevel	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
change	pointer
,	O
""	pointer
)	O
;	O
}	O
static	O
int	O
cmpstr	function
(	O
char	O
*	O
*	O
s1	pointer
,	O
char	O
*	O
*	O
s2	pointer
)	O
{	O
return	O
strcmp	function
(	O
*	O
s1	pointer
,	O
*	O
s2	pointer
)	O
;	O
}	O
static	O
void	O
eff1	function
(	O
int	O
incells	int
,	O
char	O
*	O
*	O
*	O
levval	pointer
,	O
int	O
*	O
nlevels	pointer
,	O
int	O
*	O
varv	array
,	O
int	O
nvars	int
,	O
char	O
*	O
termv	pointer
,	O
int	O
nterm	int
,	O
int	O
typen	int
,	O
int	O
termn	int
)	O
{	O
double	O
*	O
comem	pointer
;	O
double	O
*	O
*	O
coeff	pointer
;	O
int	O
v	int
;	O
int	O
ncells	int
;	O
int	O
celli	int
;	O
int	O
*	O
level	double
;	O
int	O
*	O
clevmem	pointer
;	O
int	O
*	O
*	O
clevel	pointer
;	O
int	O
statn	int
;	O
double	O
nobs1	double
;	O
double	O
mean1	double
;	O
double	O
vari1	double
;	O
int	O
gotn	int
,	O
gotm	int
,	O
gotv	int
;	O
double	O
*	O
nobs	array
;	O
double	O
*	O
mean	pointer
;	O
double	O
*	O
vari	pointer
;	O
int	O
celln	int
;	O
int	O
sumlev	int
;	O
int	O
miss	int
;	O
int	O
*	O
rterm	array
;	O
int	O
*	O
indep	pointer
;	O
int	O
*	O
nonz	pointer
;	O
int	O
nrows	int
[	O
3	int
]	O
;	O
int	O
r	double
;	O
int	O
errow	int
;	O
int	O
corow	int
;	O
int	O
cr	int
;	O
double	O
max	double
;	O
double	O
tmp	double
;	O
int	O
(	O
*	O
scmp	pointer
)	O
(	O
)	O
;	O
nobs1	double
=	O
0.0	int
;	O
mean1	double
=	O
0.0	int
;	O
vari1	double
=	O
0.0	int
;	O
scmp	pointer
=	O
&	O
cmpstr	function
;	O
level	double
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
,	O
"dap_maxtreat"	pointer
)	O
;	O
for	O
(	O
v	int
=	O
1	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
qsort	function
(	O
levval	pointer
[	O
v	int
]	O
,	O
nlevels	pointer
[	O
v	int
]	O
,	O
sizeof	O
(	O
char	O
*	O
)	O
,	O
scmp	pointer
)	O
;	O
for	O
(	O
v	int
=	O
1	int
,	O
ncells	int
=	O
1	int
,	O
sumlev	int
=	O
0	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
{	O
ncells	int
*=	O
nlevels	pointer
[	O
v	int
]	O
;	O
sumlev	int
+=	O
nlevels	pointer
[	O
v	int
]	O
;	O
level	double
[	O
v	int
]	O
=	O
0	int
;	O
}	O
clevmem	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
nvars	int
*	O
ncells	int
,	O
""	pointer
)	O
;	O
clevel	pointer
=	O
(	O
int	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
*	O
)	O
*	O
nvars	int
,	O
""	pointer
)	O
;	O
for	O
(	O
v	int
=	O
0	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
clevel	pointer
[	O
v	int
]	O
=	O
clevmem	pointer
+	O
v	int
*	O
ncells	int
;	O
nobs	array
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
mean	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
vari	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
rterm	array
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
(	O
ncells	int
+	O
sumlev	int
-	O
1	int
)	O
,	O
""	pointer
)	O
;	O
indep	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
(	O
ncells	int
+	O
sumlev	int
-	O
1	int
)	O
,	O
""	pointer
)	O
;	O
nonz	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
(	O
ncells	int
+	O
sumlev	int
-	O
1	int
)	O
,	O
""	pointer
)	O
;	O
comem	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
(	O
ncells	int
+	O
sumlev	int
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
coeff	pointer
=	O
(	O
double	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
*	O
)	O
*	O
(	O
ncells	int
+	O
sumlev	int
)	O
,	O
""	pointer
)	O
;	O
for	O
(	O
r	double
=	O
0	int
;	O
r	double
<	O
ncells	int
+	O
sumlev	int
;	O
r	double
++	O
)	O
coeff	pointer
[	O
r	double
]	O
=	O
comem	pointer
+	O
r	double
*	O
ncells	int
;	O
for	O
(	O
celli	int
=	O
0	int
,	O
celln	int
=	O
0	int
;	O
celli	int
<	O
incells	int
;	O
celli	int
++	O
,	O
celln	int
++	O
)	O
{	O
gotn	int
=	O
0	int
;	O
gotm	int
=	O
0	int
;	O
gotv	int
=	O
0	int
;	O
for	O
(	O
statn	int
=	O
0	int
;	O
statn	int
<	O
3	int
;	O
statn	int
++	O
)	O
{	O
step	function
(	O
)	O
;	O
if	O
(	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"N"	pointer
)	O
)	O
{	O
nobs1	double
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
;	O
gotn	int
=	O
1	int
;	O
}	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"MEAN"	pointer
)	O
)	O
{	O
mean1	double
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
;	O
gotm	int
=	O
1	int
;	O
}	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"VAR"	pointer
)	O
)	O
{	O
vari1	double
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
;	O
gotv	int
=	O
1	int
;	O
}	O
else	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(eff1) Bad cell statistic: %s\n"	pointer
,	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
if	O
(	O
!	O
gotn	int
)	O
{	O
fputs	function
(	O
"(eff1) Missing N.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
if	O
(	O
!	O
gotm	int
)	O
{	O
fputs	function
(	O
"(eff1) Missing MEAN.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
if	O
(	O
!	O
gotv	int
)	O
{	O
fputs	function
(	O
"(eff1) Missing VAR.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
do	O
{	O
for	O
(	O
v	int
=	O
1	int
,	O
miss	int
=	O
0	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
{	O
if	O
(	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
varv	array
[	O
v	int
]	O
]	O
,	O
levval	pointer
[	O
v	int
]	O
[	O
level	double
[	O
v	int
]	O
]	O
)	O
)	O
{	O
miss	int
=	O
1	int
;	O
break	O
;	O
}	O
}	O
if	O
(	O
miss	int
)	O
{	O
nobs	array
[	O
celln	int
]	O
=	O
0.0	int
;	O
mean	pointer
[	O
celln	int
]	O
=	O
0.0	int
;	O
vari	pointer
[	O
celln	int
]	O
=	O
0.0	int
;	O
celln	int
++	O
;	O
for	O
(	O
v	int
=	O
nvars	int
-	O
1	int
;	O
v	int
>	O
0	int
;	O
--	O
v	int
)	O
{	O
if	O
(	O
++	O
level	double
[	O
v	int
]	O
==	O
nlevels	pointer
[	O
v	int
]	O
)	O
level	double
[	O
v	int
]	O
=	O
0	int
;	O
else	O
break	O
;	O
}	O
}	O
}	O
while	O
(	O
miss	int
)	O
;	O
nobs	array
[	O
celln	int
]	O
=	O
nobs1	double
;	O
mean	pointer
[	O
celln	int
]	O
=	O
mean1	double
;	O
if	O
(	O
nobs1	double
>	O
1.0	int
)	O
vari	pointer
[	O
celln	int
]	O
=	O
vari1	double
;	O
else	O
vari	pointer
[	O
celln	int
]	O
=	O
0.0	int
;	O
for	O
(	O
v	int
=	O
nvars	int
-	O
1	int
;	O
v	int
>	O
0	int
;	O
--	O
v	int
)	O
{	O
if	O
(	O
++	O
level	double
[	O
v	int
]	O
==	O
nlevels	pointer
[	O
v	int
]	O
)	O
level	double
[	O
v	int
]	O
=	O
0	int
;	O
else	O
break	O
;	O
}	O
}	O
while	O
(	O
celln	int
<	O
ncells	int
)	O
{	O
nobs	array
[	O
celln	int
]	O
=	O
0.0	int
;	O
mean	pointer
[	O
celln	int
]	O
=	O
0.0	int
;	O
vari	pointer
[	O
celln	int
]	O
=	O
0.0	int
;	O
celln	int
++	O
;	O
}	O
maketerm	function
(	O
nterm	int
,	O
termv	pointer
,	O
nvars	int
,	O
varv	array
,	O
nlevels	pointer
,	O
coeff	pointer
,	O
ncells	int
,	O
nobs	array
,	O
rterm	array
,	O
nrows	int
,	O
clevel	pointer
)	O
;	O
for	O
(	O
cr	int
=	O
0	int
;	O
cr	int
<	O
nrows	int
[	O
0	int
]	O
+	O
nrows	int
[	O
1	int
]	O
+	O
nrows	int
[	O
2	int
]	O
;	O
cr	int
++	O
)	O
indep	pointer
[	O
cr	int
]	O
=	O
0	int
;	O
if	O
(	O
nrows	int
[	O
0	int
]	O
)	O
{	O
errow	int
=	O
rowred	function
(	O
coeff	pointer
,	O
rterm	array
,	O
0	int
,	O
ncells	int
,	O
nobs	array
,	O
nrows	int
[	O
0	int
]	O
-	O
1	int
,	O
nrows	int
[	O
0	int
]	O
-	O
1	int
,	O
NULL	O
)	O
;	O
if	O
(	O
errow	int
<	O
nrows	int
[	O
0	int
]	O
)	O
orthog	function
(	O
coeff	pointer
,	O
nrows	int
[	O
0	int
]	O
-	O
1	int
,	O
errow	int
,	O
0	int
,	O
ncells	int
,	O
nobs	array
,	O
indep	pointer
,	O
NULL	O
)	O
;	O
corow	int
=	O
rowred	function
(	O
coeff	pointer
,	O
rterm	array
,	O
0	int
,	O
ncells	int
,	O
nobs	array
,	O
nrows	int
[	O
0	int
]	O
-	O
1	int
,	O
nrows	int
[	O
0	int
]	O
+	O
nrows	int
[	O
1	int
]	O
+	O
nrows	int
[	O
2	int
]	O
-	O
1	int
,	O
nonz	pointer
)	O
;	O
if	O
(	O
corow	int
<	O
nrows	int
[	O
0	int
]	O
)	O
corow	int
=	O
nrows	int
[	O
0	int
]	O
;	O
}	O
else	O
{	O
errow	int
=	O
0	int
;	O
corow	int
=	O
nrows	int
[	O
0	int
]	O
;	O
}	O
for	O
(	O
v	int
=	O
1	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
level	double
[	O
v	int
]	O
=	O
0	int
;	O
for	O
(	O
r	double
=	O
0	int
,	O
max	double
=	O
0.0	int
;	O
r	double
<	O
nrows	int
[	O
0	int
]	O
+	O
nrows	int
[	O
1	int
]	O
+	O
nrows	int
[	O
2	int
]	O
;	O
r	double
++	O
)	O
for	O
(	O
celln	int
=	O
0	int
;	O
celln	int
<	O
ncells	int
;	O
celln	int
++	O
)	O
{	O
if	O
(	O
(	O
tmp	double
=	O
fabs	function
(	O
coeff	pointer
[	O
r	double
]	O
[	O
celln	int
]	O
)	O
)	O
>	O
max	double
)	O
max	double
=	O
tmp	double
;	O
}	O
for	O
(	O
r	double
=	O
0	int
;	O
r	double
<	O
nrows	int
[	O
0	int
]	O
+	O
nrows	int
[	O
1	int
]	O
+	O
nrows	int
[	O
2	int
]	O
;	O
r	double
++	O
)	O
for	O
(	O
celln	int
=	O
0	int
;	O
celln	int
<	O
ncells	int
;	O
celln	int
++	O
)	O
{	O
if	O
(	O
fabs	function
(	O
coeff	pointer
[	O
r	double
]	O
[	O
celln	int
]	O
)	O
<	O
dap_zerotol	double
*	O
max	double
)	O
coeff	pointer
[	O
r	double
]	O
[	O
celln	int
]	O
=	O
0.0	int
;	O
}	O
for	O
(	O
celln	int
=	O
0	int
;	O
celln	int
<	O
ncells	int
;	O
celln	int
++	O
)	O
{	O
if	O
(	O
nobs	array
[	O
celln	int
]	O
)	O
{	O
dap_obs	array
[	O
0	int
]	O
.	O
do_int	pointer
[	O
termn	int
]	O
=	O
0	int
;	O
for	O
(	O
v	int
=	O
1	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
varv	array
[	O
v	int
]	O
]	O
,	O
levval	pointer
[	O
v	int
]	O
[	O
level	double
[	O
v	int
]	O
]	O
)	O
;	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"N"	pointer
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
=	O
nobs	array
[	O
celln	int
]	O
;	O
output	function
(	O
)	O
;	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"MEAN"	pointer
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
=	O
mean	pointer
[	O
celln	int
]	O
;	O
output	function
(	O
)	O
;	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"VAR"	pointer
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
=	O
vari	pointer
[	O
celln	int
]	O
;	O
output	function
(	O
)	O
;	O
for	O
(	O
r	double
=	O
errow	int
;	O
r	double
<	O
nrows	int
[	O
0	int
]	O
;	O
r	double
++	O
)	O
{	O
if	O
(	O
indep	pointer
[	O
r	double
]	O
)	O
{	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
=	O
coeff	pointer
[	O
r	double
]	O
[	O
celln	int
]	O
;	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"ERROR"	pointer
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_int	pointer
[	O
termn	int
]	O
=	O
rterm	array
[	O
r	double
]	O
;	O
output	function
(	O
)	O
;	O
}	O
}	O
for	O
(	O
r	double
=	O
corow	int
;	O
r	double
<	O
nrows	int
[	O
0	int
]	O
+	O
nrows	int
[	O
1	int
]	O
;	O
r	double
++	O
)	O
{	O
if	O
(	O
!	O
nrows	int
[	O
0	int
]	O
||	O
nonz	pointer
[	O
r	double
]	O
)	O
{	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
=	O
coeff	pointer
[	O
r	double
]	O
[	O
celln	int
]	O
;	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"CONTR"	pointer
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_int	pointer
[	O
termn	int
]	O
=	O
rterm	array
[	O
r	double
]	O
;	O
output	function
(	O
)	O
;	O
}	O
}	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"LSMEAN"	pointer
)	O
;	O
while	O
(	O
r	double
<	O
nrows	int
[	O
0	int
]	O
+	O
nrows	int
[	O
1	int
]	O
+	O
nrows	int
[	O
2	int
]	O
)	O
{	O
dap_obs	array
[	O
0	int
]	O
.	O
do_int	pointer
[	O
termn	int
]	O
=	O
rterm	array
[	O
r	double
]	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
=	O
coeff	pointer
[	O
r	double
]	O
[	O
celln	int
]	O
;	O
output	function
(	O
)	O
;	O
r	double
++	O
;	O
}	O
}	O
for	O
(	O
v	int
=	O
nvars	int
-	O
1	int
;	O
v	int
>	O
0	int
;	O
--	O
v	int
)	O
{	O
if	O
(	O
++	O
level	double
[	O
v	int
]	O
==	O
nlevels	pointer
[	O
v	int
]	O
)	O
level	double
[	O
v	int
]	O
=	O
0	int
;	O
else	O
break	O
;	O
}	O
}	O
dap_free	function
(	O
comem	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
coeff	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
level	double
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
clevmem	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
clevel	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
nobs	array
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
mean	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
vari	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
rterm	array
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
indep	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
nonz	pointer
,	O
""	pointer
)	O
;	O
}	O
void	O
effects	function
(	O
char	O
*	O
fname	array
,	O
char	O
*	O
varlist	array
,	O
char	O
*	O
model	pointer
,	O
char	O
*	O
marks	array
)	O
{	O
char	O
*	O
conname	pointer
;	O
char	O
*	O
outlist	pointer
;	O
int	O
*	O
varv	array
;	O
int	O
nvars	int
;	O
int	O
*	O
markv	array
;	O
int	O
nmark	int
;	O
int	O
typen	int
;	O
int	O
termn	int
;	O
char	O
*	O
termv	pointer
;	O
int	O
nterm	int
;	O
char	O
*	O
levmem	pointer
;	O
char	O
*	O
*	O
levptr	pointer
;	O
char	O
*	O
*	O
*	O
levval	pointer
;	O
int	O
*	O
nlevels	pointer
;	O
int	O
incells	int
;	O
int	O
v	int
;	O
int	O
l	int
;	O
int	O
more	int
;	O
conname	pointer
=	O
dap_malloc	function
(	O
strlen	function
(	O
fname	array
)	O
+	O
5	int
,	O
fname	array
)	O
;	O
outlist	pointer
=	O
dap_malloc	function
(	O
strlen	function
(	O
varlist	array
)	O
+	O
strlen	function
(	O
marks	array
)	O
+	O
9	int
,	O
""	pointer
)	O
;	O
varv	array
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
,	O
"dap_maxtreat"	pointer
)	O
;	O
markv	array
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
dap_maxvar	int
,	O
"dap_maxvar"	pointer
)	O
;	O
termv	pointer
=	O
dap_malloc	function
(	O
dap_maxcell	int
,	O
"dap_maxcell"	pointer
)	O
;	O
levmem	pointer
=	O
dap_malloc	function
(	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
*	O
dap_maxlev	int
*	O
(	O
dap_strlen	int
+	O
1	int
)	O
,	O
"dap_maxtreat, dap_maxlev, dap_strlen"	pointer
)	O
;	O
levptr	pointer
=	O
(	O
char	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
char	O
*	O
)	O
*	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
*	O
dap_maxlev	int
,	O
"dap_maxtreat, dap_maxlev"	pointer
)	O
;	O
levval	pointer
=	O
(	O
char	O
*	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
char	O
*	O
*	O
)	O
*	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
,	O
"dap_maxtreat"	pointer
)	O
;	O
for	O
(	O
v	int
=	O
0	int
;	O
v	int
<	O
dap_maxtreat	int
+	O
1	int
;	O
v	int
++	O
)	O
{	O
levval	pointer
[	O
v	int
]	O
=	O
levptr	pointer
+	O
v	int
*	O
dap_maxlev	int
;	O
for	O
(	O
l	int
=	O
0	int
;	O
l	int
<	O
dap_maxlev	int
;	O
l	int
++	O
)	O
levval	pointer
[	O
v	int
]	O
[	O
l	int
]	O
=	O
levmem	pointer
+	O
v	int
*	O
dap_maxlev	int
*	O
(	O
dap_strlen	int
+	O
1	int
)	O
+	O
l	int
*	O
(	O
dap_strlen	int
+	O
1	int
)	O
;	O
}	O
nlevels	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
,	O
"dap_maxtreat"	pointer
)	O
;	O
if	O
(	O
!	O
fname	array
)	O
{	O
fputs	function
(	O
"(effects) No dataset name given.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
dap_suffix	function
(	O
conname	pointer
,	O
fname	array
,	O
".con"	pointer
)	O
;	O
inset	function
(	O
fname	array
)	O
;	O
if	O
(	O
(	O
typen	int
=	O
dap_varnum	function
(	O
"_type_"	pointer
)	O
)	O
<	O
0	int
)	O
{	O
fputs	function
(	O
"(effects) no _type_ variable\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
termn	int
=	O
dap_vd	function
(	O
"_term_ 0"	pointer
,	O
0	int
)	O
;	O
nvars	int
=	O
dap_list	function
(	O
varlist	array
,	O
varv	array
,	O
dap_maxtreat	int
+	O
1	int
)	O
;	O
if	O
(	O
nvars	int
>	O
dap_maxtreat	int
+	O
1	int
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(effects) too many variables in model: %s\n"	pointer
,	O
model	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
if	O
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_len	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
!=	O
DBL	O
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(effects) response variable %s must be of type double\n"	pointer
,	O
dap_obs	array
[	O
0	int
]	O
.	O
do_nam	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
for	O
(	O
v	int
=	O
1	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
{	O
if	O
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_len	pointer
[	O
varv	array
[	O
v	int
]	O
]	O
<=	O
0	int
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(effects) classification variable %s must be string\n"	pointer
,	O
dap_obs	array
[	O
0	int
]	O
.	O
do_nam	pointer
[	O
varv	array
[	O
v	int
]	O
]	O
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
nterm	int
=	O
testparse	function
(	O
model	pointer
,	O
termv	pointer
,	O
varv	array
,	O
nvars	int
)	O
;	O
nmark	int
=	O
dap_list	function
(	O
marks	array
,	O
markv	array
,	O
dap_maxvar	int
)	O
;	O
strcpy	function
(	O
outlist	pointer
,	O
varlist	array
)	O
;	O
strcat	function
(	O
outlist	pointer
,	O
" _term_"	pointer
)	O
;	O
if	O
(	O
nmark	int
)	O
{	O
strcat	function
(	O
outlist	pointer
,	O
" "	pointer
)	O
;	O
strcat	function
(	O
outlist	pointer
,	O
marks	array
)	O
;	O
}	O
outset	function
(	O
conname	pointer
,	O
outlist	pointer
)	O
;	O
for	O
(	O
v	int
=	O
1	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
{	O
nlevels	pointer
[	O
v	int
]	O
=	O
0	int
;	O
for	O
(	O
l	int
=	O
0	int
;	O
l	int
<	O
dap_maxlev	int
;	O
l	int
++	O
)	O
levval	pointer
[	O
v	int
]	O
[	O
l	int
]	O
[	O
0	int
]	O
=	O
'\0'	O
;	O
}	O
dap_mark	function
(	O
)	O
;	O
for	O
(	O
more	int
=	O
1	int
,	O
incells	int
=	O
0	int
;	O
more	int
;	O
incells	int
++	O
)	O
{	O
more	int
=	O
step	function
(	O
)	O
;	O
if	O
(	O
dap_newpart	function
(	O
markv	array
,	O
nmark	int
)	O
)	O
{	O
dap_swap	function
(	O
)	O
;	O
dap_head	function
(	O
markv	array
,	O
nmark	int
)	O
;	O
dap_swap	function
(	O
)	O
;	O
dap_rewind	function
(	O
)	O
;	O
putlev	function
(	O
nlevels	pointer
,	O
varv	array
,	O
nvars	int
,	O
levval	pointer
)	O
;	O
eff1	function
(	O
incells	int
,	O
levval	pointer
,	O
nlevels	pointer
,	O
varv	array
,	O
nvars	int
,	O
termv	pointer
,	O
nterm	int
,	O
typen	int
,	O
termn	int
)	O
;	O
for	O
(	O
v	int
=	O
1	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
{	O
nlevels	pointer
[	O
v	int
]	O
=	O
0	int
;	O
for	O
(	O
l	int
=	O
0	int
;	O
l	int
<	O
dap_maxlev	int
;	O
l	int
++	O
)	O
levval	pointer
[	O
v	int
]	O
[	O
l	int
]	O
[	O
0	int
]	O
=	O
'\0'	O
;	O
}	O
incells	int
=	O
0	int
;	O
dap_mark	function
(	O
)	O
;	O
more	int
=	O
step	function
(	O
)	O
;	O
}	O
if	O
(	O
more	int
)	O
{	O
for	O
(	O
v	int
=	O
1	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
levn	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
varv	array
[	O
v	int
]	O
]	O
,	O
levval	pointer
[	O
v	int
]	O
,	O
&	O
nlevels	pointer
[	O
v	int
]	O
)	O
;	O
if	O
(	O
!	O
step	function
(	O
)	O
||	O
!	O
step	function
(	O
)	O
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(effects) Incomplete cell statistics for: "	pointer
)	O
;	O
for	O
(	O
v	int
=	O
1	int
;	O
v	int
<	O
nvars	int
;	O
v	int
++	O
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"%s (%s) "	pointer
,	O
dap_obs	array
[	O
0	int
]	O
.	O
do_nam	pointer
[	O
varv	array
[	O
v	int
]	O
]	O
,	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
varv	array
[	O
v	int
]	O
]	O
)	O
;	O
}	O
putc	function
(	O
'\n'	O
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
}	O
if	O
(	O
model	pointer
&&	O
model	pointer
[	O
0	int
]	O
)	O
ftest	function
(	O
conname	pointer
,	O
varlist	array
,	O
""	pointer
,	O
""	pointer
,	O
marks	array
)	O
;	O
dap_free	function
(	O
conname	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
outlist	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
varv	array
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
markv	array
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
termv	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
levval	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
nlevels	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
levmem	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
levptr	pointer
,	O
""	pointer
)	O
;	O
}	O
static	O
void	O
lsmeans1	function
(	O
int	O
methn	int
,	O
double	O
alpha	double
,	O
double	O
*	O
*	O
coeff	pointer
,	O
int	O
ncells	int
,	O
double	O
err	int
,	O
double	O
dedfi	double
,	O
int	O
nerrors	int
,	O
int	O
nlsmeans	int
,	O
double	O
*	O
mean	pointer
,	O
double	O
*	O
vari	pointer
,	O
double	O
*	O
nobs	array
,	O
int	O
nlevels	pointer
,	O
char	O
*	O
*	O
levval	pointer
,	O
int	O
respn	int
,	O
int	O
treatn	int
,	O
int	O
resp2n	int
,	O
int	O
treat2n	int
,	O
int	O
typen	int
,	O
int	O
statn	int
,	O
int	O
lsm1	int
,	O
int	O
lsm2	int
)	O
{	O
int	O
l1	int
,	O
l2	int
;	O
int	O
lsrow	int
;	O
double	O
tmp	double
;	O
double	O
n	int
;	O
int	O
cr	int
,	O
cc	int
;	O
int	O
*	O
indep	pointer
;	O
double	O
sumwt	double
;	O
double	O
*	O
lsmean	pointer
;	O
double	O
*	O
effinvn	pointer
;	O
double	O
effin	double
;	O
double	O
*	O
diffmem	pointer
;	O
double	O
*	O
*	O
diff	pointer
;	O
double	O
*	O
probmem	pointer
;	O
double	O
*	O
*	O
prob	pointer
;	O
double	O
pt	double
,	O
pr	double
;	O
int	O
edfi	int
;	O
double	O
dfdown	double
,	O
dfup	double
;	O
double	O
pdown	double
,	O
pup	double
;	O
pt	double
=	O
0.0	int
;	O
dap_swap	function
(	O
)	O
;	O
indep	pointer
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
ncells	int
,	O
""	pointer
)	O
;	O
lsmean	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
nlevels	pointer
,	O
""	pointer
)	O
;	O
effinvn	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
nlevels	pointer
,	O
""	pointer
)	O
;	O
diffmem	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
nlevels	pointer
*	O
nlevels	pointer
,	O
""	pointer
)	O
;	O
probmem	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
nlevels	pointer
*	O
nlevels	pointer
,	O
""	pointer
)	O
;	O
diff	pointer
=	O
(	O
double	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
*	O
)	O
*	O
nlevels	pointer
,	O
""	pointer
)	O
;	O
prob	pointer
=	O
(	O
double	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
*	O
)	O
*	O
nlevels	pointer
,	O
""	pointer
)	O
;	O
for	O
(	O
l1	int
=	O
0	int
;	O
l1	int
<	O
nlevels	pointer
;	O
l1	int
++	O
)	O
{	O
diff	pointer
[	O
l1	int
]	O
=	O
diffmem	pointer
+	O
l1	int
*	O
nlevels	pointer
;	O
prob	pointer
[	O
l1	int
]	O
=	O
probmem	pointer
+	O
l1	int
*	O
nlevels	pointer
;	O
}	O
sumcheck	function
(	O
"lsmeans1"	pointer
,	O
coeff	pointer
,	O
ncells	int
,	O
nerrors	int
,	O
0	int
,	O
NULL	O
)	O
;	O
for	O
(	O
cr	int
=	O
0	int
;	O
cr	int
<	O
nerrors	int
+	O
nlsmeans	int
;	O
cr	int
++	O
)	O
indep	pointer
[	O
cr	int
]	O
=	O
0	int
;	O
lsrow	int
=	O
orthog	function
(	O
coeff	pointer
,	O
0	int
,	O
nerrors	int
+	O
nlevels	pointer
-	O
1	int
,	O
nerrors	int
+	O
nlevels	pointer
-	O
1	int
,	O
ncells	int
,	O
nobs	array
,	O
indep	pointer
,	O
NULL	O
)	O
;	O
if	O
(	O
lsrow	int
-	O
nerrors	int
!=	O
nlevels	pointer
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(lsmeans1) Number of independent LS means %d differs from number of levels %d\n"	pointer
,	O
lsrow	int
-	O
nerrors	int
,	O
nlevels	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
for	O
(	O
cc	int
=	O
0	int
,	O
n	int
=	O
0.0	int
;	O
cc	int
<	O
ncells	int
;	O
cc	int
++	O
)	O
n	int
+=	O
nobs	array
[	O
cc	int
]	O
;	O
for	O
(	O
l1	int
=	O
0	int
,	O
effin	double
=	O
0.0	int
;	O
l1	int
<	O
nlevels	pointer
;	O
l1	int
++	O
)	O
{	O
for	O
(	O
cc	int
=	O
0	int
,	O
lsmean	pointer
[	O
l1	int
]	O
=	O
0.0	int
,	O
effinvn	pointer
[	O
l1	int
]	O
=	O
0.0	int
,	O
sumwt	double
=	O
0.0	int
;	O
cc	int
<	O
ncells	int
;	O
cc	int
++	O
)	O
{	O
tmp	double
=	O
coeff	pointer
[	O
nerrors	int
+	O
l1	int
]	O
[	O
cc	int
]	O
;	O
lsmean	pointer
[	O
l1	int
]	O
+=	O
tmp	double
*	O
mean	pointer
[	O
cc	int
]	O
;	O
sumwt	double
+=	O
tmp	double
;	O
effinvn	pointer
[	O
l1	int
]	O
+=	O
tmp	double
*	O
tmp	double
/	O
nobs	array
[	O
cc	int
]	O
;	O
}	O
lsmean	pointer
[	O
l1	int
]	O
/=	O
sumwt	double
;	O
effinvn	pointer
[	O
l1	int
]	O
/=	O
(	O
sumwt	double
*	O
sumwt	double
)	O
;	O
effin	double
+=	O
effinvn	pointer
[	O
l1	int
]	O
;	O
}	O
effin	double
/=	O
(	O
double	O
)	O
nlevels	pointer
;	O
putc	function
(	O
'\n'	O
,	O
dap_lst	pointer
)	O
;	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"EFFN"	pointer
)	O
;	O
for	O
(	O
l1	int
=	O
0	int
;	O
l1	int
<	O
nlevels	pointer
;	O
l1	int
++	O
)	O
{	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
treatn	int
]	O
,	O
levval	pointer
[	O
l1	int
]	O
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
respn	int
]	O
=	O
1.0	int
/	O
effinvn	pointer
[	O
l1	int
]	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
resp2n	int
]	O
=	O
1.0	int
/	O
effinvn	pointer
[	O
l1	int
]	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
statn	int
]	O
=	O
1.0	int
/	O
effinvn	pointer
[	O
l1	int
]	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
lsm1	int
]	O
=	O
lsmean	pointer
[	O
l1	int
]	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
lsm2	int
]	O
=	O
0.0	int
;	O
output	function
(	O
)	O
;	O
}	O
dfdown	double
=	O
floor	function
(	O
dedfi	double
)	O
;	O
dfup	double
=	O
ceil	function
(	O
dedfi	double
)	O
;	O
edfi	int
=	O
(	O
int	O
)	O
dfdown	double
;	O
if	O
(	O
methn	int
==	O
TUKEY	int
||	O
methn	int
==	O
LSD	int
)	O
{	O
pr	double
=	O
-	O
1.0	int
;	O
for	O
(	O
l1	int
=	O
0	int
;	O
l1	int
<	O
nlevels	pointer
;	O
l1	int
++	O
)	O
{	O
for	O
(	O
l2	int
=	O
0	int
;	O
l2	int
<	O
nlevels	pointer
;	O
l2	int
++	O
)	O
{	O
if	O
(	O
l2	int
==	O
l1	int
)	O
{	O
diff	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
=	O
0.0	int
;	O
prob	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
=	O
1.0	int
;	O
}	O
else	O
if	O
(	O
methn	int
==	O
TUKEY	int
)	O
{	O
diff	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
=	O
(	O
lsmean	pointer
[	O
l1	int
]	O
-	O
lsmean	pointer
[	O
l2	int
]	O
)	O
/	O
sqrt	function
(	O
err	int
*	O
0.5	int
*	O
(	O
effinvn	pointer
[	O
l1	int
]	O
+	O
effinvn	pointer
[	O
l2	int
]	O
)	O
)	O
;	O
diff	pointer
[	O
l2	int
]	O
[	O
l1	int
]	O
=	O
-	O
diff	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
;	O
if	O
(	O
dfdown	double
==	O
dfup	double
)	O
prob	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
=	O
dap_sr	function
(	O
nlevels	pointer
,	O
edfi	int
,	O
fabs	function
(	O
diff	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
)	O
)	O
;	O
else	O
{	O
pdown	double
=	O
dap_sr	function
(	O
nlevels	pointer
,	O
edfi	int
,	O
fabs	function
(	O
diff	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
)	O
)	O
;	O
pup	double
=	O
dap_sr	function
(	O
nlevels	pointer
,	O
(	O
int	O
)	O
dfup	double
,	O
fabs	function
(	O
diff	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
)	O
)	O
;	O
prob	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
=	O
pdown	double
+	O
(	O
dedfi	double
-	O
dfdown	double
)	O
/	O
(	O
dfup	double
-	O
dfdown	double
)	O
*	O
(	O
pup	double
-	O
pdown	double
)	O
;	O
}	O
prob	pointer
[	O
l2	int
]	O
[	O
l1	int
]	O
=	O
prob	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
;	O
}	O
else	O
{	O
diff	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
=	O
(	O
lsmean	pointer
[	O
l1	int
]	O
-	O
lsmean	pointer
[	O
l2	int
]	O
)	O
/	O
sqrt	function
(	O
err	int
*	O
(	O
effinvn	pointer
[	O
l1	int
]	O
+	O
effinvn	pointer
[	O
l2	int
]	O
)	O
)	O
;	O
diff	pointer
[	O
l2	int
]	O
[	O
l1	int
]	O
=	O
-	O
diff	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
;	O
if	O
(	O
dfdown	double
==	O
dfup	double
)	O
prob	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
=	O
2.0	int
*	O
probt	function
(	O
fabs	function
(	O
diff	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
)	O
,	O
edfi	int
)	O
;	O
else	O
{	O
pdown	double
=	O
probt	function
(	O
fabs	function
(	O
diff	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
)	O
,	O
edfi	int
)	O
;	O
pup	double
=	O
probt	function
(	O
fabs	function
(	O
diff	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
)	O
,	O
(	O
int	O
)	O
dfup	double
)	O
;	O
prob	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
=	O
2.0	int
*	O
(	O
pdown	double
+	O
(	O
dedfi	double
-	O
dfdown	double
)	O
/	O
(	O
dfup	double
-	O
dfdown	double
)	O
*	O
(	O
pup	double
-	O
pdown	double
)	O
)	O
;	O
}	O
prob	pointer
[	O
l2	int
]	O
[	O
l1	int
]	O
=	O
prob	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
;	O
}	O
if	O
(	O
pr	double
<	O
0.0	int
||	O
fabs	function
(	O
prob	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
-	O
alpha	double
)	O
<	O
fabs	function
(	O
pr	double
-	O
alpha	double
)	O
)	O
{	O
pt	double
=	O
fabs	function
(	O
diff	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
)	O
;	O
pr	double
=	O
prob	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
;	O
}	O
}	O
}	O
for	O
(	O
l1	int
=	O
0	int
;	O
l1	int
<	O
nlevels	pointer
;	O
l1	int
++	O
)	O
{	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
treatn	int
]	O
,	O
levval	pointer
[	O
l1	int
]	O
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
respn	int
]	O
=	O
lsmean	pointer
[	O
l1	int
]	O
;	O
for	O
(	O
l2	int
=	O
0	int
;	O
l2	int
<	O
nlevels	pointer
;	O
l2	int
++	O
)	O
{	O
if	O
(	O
l2	int
==	O
l1	int
)	O
continue	O
;	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
treat2n	int
]	O
,	O
levval	pointer
[	O
l2	int
]	O
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
resp2n	int
]	O
=	O
lsmean	pointer
[	O
l2	int
]	O
;	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"LSMDIFF"	pointer
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
statn	int
]	O
=	O
lsmean	pointer
[	O
l1	int
]	O
-	O
lsmean	pointer
[	O
l2	int
]	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
lsm1	int
]	O
=	O
lsmean	pointer
[	O
l1	int
]	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
lsm2	int
]	O
=	O
lsmean	pointer
[	O
l2	int
]	O
;	O
output	function
(	O
)	O
;	O
if	O
(	O
methn	int
==	O
TUKEY	int
)	O
{	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
resp2n	int
]	O
=	O
lsmean	pointer
[	O
l2	int
]	O
;	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"MINDIFF"	pointer
)	O
;	O
if	O
(	O
dfdown	double
==	O
dfup	double
)	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
statn	int
]	O
=	O
dap_srpt	function
(	O
nlevels	pointer
,	O
edfi	int
,	O
pt	double
,	O
pr	double
,	O
alpha	double
)	O
*	O
sqrt	function
(	O
err	int
*	O
0.5	int
*	O
(	O
effinvn	pointer
[	O
l1	int
]	O
+	O
effinvn	pointer
[	O
l2	int
]	O
)	O
)	O
;	O
else	O
{	O
pdown	double
=	O
dap_srpt	function
(	O
nlevels	pointer
,	O
edfi	int
,	O
pt	double
,	O
pr	double
,	O
alpha	double
)	O
;	O
pup	double
=	O
dap_srpt	function
(	O
nlevels	pointer
,	O
(	O
int	O
)	O
dfup	double
,	O
pt	double
,	O
pr	double
,	O
alpha	double
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
statn	int
]	O
=	O
(	O
pdown	double
+	O
(	O
dedfi	double
-	O
dfdown	double
)	O
/	O
(	O
dfup	double
-	O
dfdown	double
)	O
*	O
(	O
pup	double
-	O
pdown	double
)	O
)	O
*	O
sqrt	function
(	O
err	int
*	O
0.5	int
*	O
(	O
effinvn	pointer
[	O
l1	int
]	O
+	O
effinvn	pointer
[	O
l2	int
]	O
)	O
)	O
;	O
}	O
output	function
(	O
)	O
;	O
}	O
else	O
{	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
resp2n	int
]	O
=	O
lsmean	pointer
[	O
l2	int
]	O
;	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"MINDIFF"	pointer
)	O
;	O
if	O
(	O
dfdown	double
==	O
dfup	double
)	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
statn	int
]	O
=	O
tpoint	function
(	O
alpha	double
/	O
2.0	int
,	O
edfi	int
)	O
*	O
sqrt	function
(	O
err	int
*	O
(	O
effinvn	pointer
[	O
l1	int
]	O
+	O
effinvn	pointer
[	O
l2	int
]	O
)	O
)	O
;	O
else	O
{	O
pdown	double
=	O
tpoint	function
(	O
alpha	double
/	O
2.0	int
,	O
edfi	int
)	O
;	O
pup	double
=	O
tpoint	function
(	O
alpha	double
/	O
2.0	int
,	O
(	O
int	O
)	O
dfup	double
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
statn	int
]	O
=	O
(	O
pdown	double
+	O
(	O
dedfi	double
-	O
dfdown	double
)	O
/	O
(	O
dfup	double
-	O
dfdown	double
)	O
*	O
(	O
pup	double
-	O
pdown	double
)	O
)	O
*	O
sqrt	function
(	O
err	int
*	O
(	O
effinvn	pointer
[	O
l1	int
]	O
+	O
effinvn	pointer
[	O
l2	int
]	O
)	O
)	O
;	O
}	O
output	function
(	O
)	O
;	O
}	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"PROB"	pointer
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
statn	int
]	O
=	O
prob	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
;	O
output	function
(	O
)	O
;	O
}	O
}	O
}	O
else	O
{	O
pr	double
=	O
-	O
1.0	int
;	O
for	O
(	O
l2	int
=	O
1	int
;	O
l2	int
<	O
nlevels	pointer
;	O
l2	int
++	O
)	O
{	O
diff	pointer
[	O
0	int
]	O
[	O
l2	int
]	O
=	O
(	O
lsmean	pointer
[	O
l2	int
]	O
-	O
lsmean	pointer
[	O
0	int
]	O
)	O
/	O
sqrt	function
(	O
err	int
*	O
effin	double
)	O
;	O
if	O
(	O
dfdown	double
==	O
dfup	double
)	O
prob	pointer
[	O
0	int
]	O
[	O
l2	int
]	O
=	O
dap_md	function
(	O
nlevels	pointer
-	O
1	int
,	O
edfi	int
,	O
fabs	function
(	O
diff	pointer
[	O
0	int
]	O
[	O
l2	int
]	O
)	O
)	O
;	O
else	O
{	O
pdown	double
=	O
dap_md	function
(	O
nlevels	pointer
-	O
1	int
,	O
edfi	int
,	O
fabs	function
(	O
diff	pointer
[	O
0	int
]	O
[	O
l2	int
]	O
)	O
)	O
;	O
pup	double
=	O
dap_md	function
(	O
nlevels	pointer
-	O
1	int
,	O
(	O
int	O
)	O
dfup	double
,	O
fabs	function
(	O
diff	pointer
[	O
0	int
]	O
[	O
l2	int
]	O
)	O
)	O
;	O
prob	pointer
[	O
l1	int
]	O
[	O
l2	int
]	O
=	O
pdown	double
+	O
(	O
dedfi	double
-	O
dfdown	double
)	O
/	O
(	O
dfup	double
-	O
dfdown	double
)	O
*	O
(	O
pup	double
-	O
pdown	double
)	O
;	O
}	O
if	O
(	O
pr	double
<	O
0.0	int
||	O
fabs	function
(	O
prob	pointer
[	O
0	int
]	O
[	O
l2	int
]	O
-	O
alpha	double
)	O
<	O
fabs	function
(	O
pr	double
-	O
alpha	double
)	O
)	O
{	O
pt	double
=	O
fabs	function
(	O
diff	pointer
[	O
0	int
]	O
[	O
l2	int
]	O
)	O
;	O
pr	double
=	O
prob	pointer
[	O
0	int
]	O
[	O
l2	int
]	O
;	O
}	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
treat2n	int
]	O
,	O
levval	pointer
[	O
0	int
]	O
)	O
;	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
treatn	int
]	O
,	O
levval	pointer
[	O
l2	int
]	O
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
respn	int
]	O
=	O
lsmean	pointer
[	O
l2	int
]	O
;	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"LSMDIFF"	pointer
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
statn	int
]	O
=	O
lsmean	pointer
[	O
l2	int
]	O
-	O
lsmean	pointer
[	O
0	int
]	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
lsm1	int
]	O
=	O
lsmean	pointer
[	O
l2	int
]	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
lsm2	int
]	O
=	O
lsmean	pointer
[	O
0	int
]	O
;	O
output	function
(	O
)	O
;	O
strcpy	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"PROB"	pointer
)	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
statn	int
]	O
=	O
prob	pointer
[	O
0	int
]	O
[	O
l2	int
]	O
;	O
output	function
(	O
)	O
;	O
}	O
}	O
switch	O
(	O
methn	int
)	O
{	O
case	O
TUKEY	int
:	O
fputs	function
(	O
"Tukey method\n\n"	pointer
,	O
dap_lst	pointer
)	O
;	O
fprintf	function
(	O
dap_lst	pointer
,	O
"Minimum significant differences are for level %.5f\n"	pointer
,	O
alpha	double
)	O
;	O
break	O
;	O
case	O
LSD	int
:	O
fputs	function
(	O
"LSD  method\n"	pointer
,	O
dap_lst	pointer
)	O
;	O
fprintf	function
(	O
dap_lst	pointer
,	O
"Minimum significant differences are for level %.5f\n"	pointer
,	O
alpha	double
)	O
;	O
break	O
;	O
case	O
DUNNETT	int
:	O
pt	double
=	O
dap_mdpt	function
(	O
nlevels	pointer
,	O
edfi	int
,	O
pt	double
,	O
pr	double
,	O
alpha	double
)	O
*	O
sqrt	function
(	O
err	int
*	O
effin	double
)	O
;	O
fputs	function
(	O
"Dunnett method\n"	pointer
,	O
dap_lst	pointer
)	O
;	O
fprintf	function
(	O
dap_lst	pointer
,	O
"At level %.5f, minimum significant difference = %.6g\n"	pointer
,	O
alpha	double
,	O
pt	double
)	O
;	O
break	O
;	O
}	O
dap_free	function
(	O
indep	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
lsmean	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
effinvn	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
diffmem	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
diff	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
probmem	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
prob	pointer
,	O
""	pointer
)	O
;	O
dap_swap	function
(	O
)	O
;	O
}	O
void	O
lsmeans	function
(	O
char	O
*	O
fname	array
,	O
char	O
*	O
method	pointer
,	O
double	O
alpha	double
,	O
char	O
*	O
varlist	array
,	O
char	O
*	O
treat	pointer
,	O
char	O
*	O
marks	array
,	O
char	O
*	O
format	array
)	O
{	O
int	O
typen	int
;	O
int	O
*	O
varv	array
;	O
int	O
*	O
markv	array
;	O
int	O
nmark	int
;	O
int	O
r	double
;	O
char	O
*	O
lsmname	pointer
;	O
char	O
*	O
lsmsrt	pointer
;	O
char	O
*	O
varstr	pointer
;	O
char	O
*	O
treat2	pointer
;	O
char	O
*	O
args1	pointer
;	O
char	O
*	O
args2	pointer
;	O
int	O
treatn	int
;	O
int	O
treat2n	int
;	O
int	O
resp2n	int
;	O
int	O
statn	int
;	O
int	O
methn	int
;	O
char	O
*	O
levmem	pointer
;	O
char	O
*	O
*	O
levval	pointer
;	O
int	O
l	int
;	O
static	O
int	O
nlevels	pointer
;	O
double	O
*	O
comem	pointer
;	O
double	O
*	O
*	O
coeff	pointer
;	O
int	O
gotm	int
,	O
gotn	int
,	O
gotv	int
;	O
double	O
*	O
mean	pointer
;	O
double	O
*	O
nobs	array
;	O
double	O
*	O
vari	pointer
;	O
int	O
s	int
;	O
int	O
ncells	int
;	O
int	O
nerrors	int
;	O
int	O
nlsmeans	int
;	O
int	O
morecells	int
;	O
int	O
more	int
;	O
int	O
err	int
;	O
int	O
con	int
;	O
double	O
mse	double
;	O
double	O
edf	double
;	O
int	O
lsm1	int
,	O
lsm2	int
;	O
mse	double
=	O
0.0	int
;	O
edf	double
=	O
0.0	int
;	O
if	O
(	O
!	O
fname	array
||	O
!	O
fname	array
[	O
0	int
]	O
)	O
{	O
fputs	function
(	O
"(lsmeans) no dataset name given.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
lsmname	pointer
=	O
dap_malloc	function
(	O
strlen	function
(	O
fname	array
)	O
+	O
5	int
,	O
fname	array
)	O
;	O
dap_suffix	function
(	O
lsmname	pointer
,	O
fname	array
,	O
".lsm"	pointer
)	O
;	O
lsmsrt	pointer
=	O
dap_malloc	function
(	O
strlen	function
(	O
lsmname	pointer
)	O
+	O
5	int
,	O
lsmname	pointer
)	O
;	O
dap_suffix	function
(	O
lsmsrt	pointer
,	O
lsmname	pointer
,	O
".srt"	pointer
)	O
;	O
varv	array
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
(	O
dap_maxtreat	int
+	O
1	int
)	O
,	O
"dap_maxtreat"	pointer
)	O
;	O
markv	array
=	O
(	O
int	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
int	O
)	O
*	O
dap_maxvar	int
,	O
"dap_maxvar"	pointer
)	O
;	O
levmem	pointer
=	O
dap_malloc	function
(	O
dap_maxlev	int
*	O
(	O
dap_strlen	int
+	O
1	int
)	O
,	O
"dap_maxlev, dap_strlen"	pointer
)	O
;	O
levval	pointer
=	O
(	O
char	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
char	O
*	O
)	O
*	O
dap_maxlev	int
,	O
"dap_maxlev"	pointer
)	O
;	O
for	O
(	O
l	int
=	O
0	int
;	O
l	int
<	O
dap_maxlev	int
;	O
l	int
++	O
)	O
levval	pointer
[	O
l	int
]	O
=	O
levmem	pointer
+	O
l	int
*	O
(	O
dap_strlen	int
+	O
1	int
)	O
;	O
comem	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
dap_maxcell	int
*	O
dap_maxcell	int
,	O
"dap_maxcell"	pointer
)	O
;	O
coeff	pointer
=	O
(	O
double	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
*	O
)	O
*	O
dap_maxcell	int
,	O
"dap_maxcell"	pointer
)	O
;	O
for	O
(	O
ncells	int
=	O
0	int
;	O
ncells	int
<	O
dap_maxcell	int
;	O
ncells	int
++	O
)	O
coeff	pointer
[	O
ncells	int
]	O
=	O
comem	pointer
+	O
ncells	int
*	O
dap_maxcell	int
;	O
mean	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
dap_maxcell	int
,	O
"dap_maxcell"	pointer
)	O
;	O
nobs	array
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
dap_maxcell	int
,	O
"dap_maxcell"	pointer
)	O
;	O
vari	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
dap_maxcell	int
,	O
"dap_maxcell"	pointer
)	O
;	O
inset	function
(	O
fname	array
)	O
;	O
if	O
(	O
!	O
varlist	array
||	O
!	O
varlist	array
[	O
0	int
]	O
)	O
{	O
fputs	function
(	O
"(lsmeans) no variable list given.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
dap_list	function
(	O
varlist	array
,	O
varv	array
,	O
dap_maxtreat	int
+	O
1	int
)	O
;	O
if	O
(	O
!	O
treat	pointer
||	O
!	O
treat	pointer
[	O
0	int
]	O
)	O
{	O
fputs	function
(	O
"(lsmeans) no treatments specified.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
if	O
(	O
(	O
treatn	int
=	O
dap_varnum	function
(	O
treat	pointer
)	O
)	O
<	O
0	int
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(lsmeans) Treatment variable unknown: %s\n"	pointer
,	O
treat	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
treat2	pointer
=	O
dap_malloc	function
(	O
strlen	function
(	O
treat	pointer
)	O
+	O
2	int
,	O
treat	pointer
)	O
;	O
strcpy	function
(	O
treat2	pointer
,	O
"_"	pointer
)	O
;	O
strcat	function
(	O
treat2	pointer
,	O
treat	pointer
)	O
;	O
varstr	pointer
=	O
dap_malloc	function
(	O
strlen	function
(	O
treat2	pointer
)	O
+	O
strlen	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_nam	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
)	O
+	O
10	int
,	O
""	pointer
)	O
;	O
sprintf	function
(	O
varstr	pointer
,	O
"%s %d"	pointer
,	O
treat2	pointer
,	O
dap_obs	array
[	O
0	int
]	O
.	O
do_len	pointer
[	O
treatn	int
]	O
)	O
;	O
treat2n	int
=	O
dap_vd	function
(	O
varstr	pointer
,	O
0	int
)	O
;	O
lsm1	int
=	O
dap_vd	function
(	O
"_lsm_ -1"	pointer
,	O
0	int
)	O
;	O
lsm2	int
=	O
dap_vd	function
(	O
"_LSMEAN_ -1"	pointer
,	O
0	int
)	O
;	O
for	O
(	O
r	double
=	O
0	int
,	O
varstr	pointer
[	O
0	int
]	O
=	O
'_'	O
;	O
dap_obs	array
[	O
0	int
]	O
.	O
do_nam	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
[	O
r	double
]	O
;	O
r	double
++	O
)	O
{	O
if	O
(	O
r	double
<	O
dap_namelen	int
-	O
1	int
)	O
varstr	pointer
[	O
r	double
+	O
1	int
]	O
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_nam	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
[	O
r	double
]	O
;	O
}	O
sprintf	function
(	O
varstr	pointer
+	O
r	double
+	O
1	int
,	O
" %d"	pointer
,	O
DBL	O
)	O
;	O
resp2n	int
=	O
dap_vd	function
(	O
varstr	pointer
,	O
0	int
)	O
;	O
sprintf	function
(	O
varstr	pointer
,	O
"_stat_ %d"	pointer
,	O
DBL	O
)	O
;	O
statn	int
=	O
dap_vd	function
(	O
varstr	pointer
,	O
0	int
)	O
;	O
if	O
(	O
(	O
typen	int
=	O
dap_varnum	function
(	O
"_type_"	pointer
)	O
)	O
<	O
0	int
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(lsmeans) no _type_ variable\n"	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
if	O
(	O
dap_varnum	function
(	O
"_term_"	pointer
)	O
<	O
0	int
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(lsmeans) no _term_ variable\n"	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
outset	function
(	O
lsmname	pointer
,	O
""	pointer
)	O
;	O
if	O
(	O
!	O
method	pointer
||	O
!	O
method	pointer
[	O
0	int
]	O
)	O
{	O
fputs	function
(	O
"(lsmeans) no method specified.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
if	O
(	O
!	O
strcmp	function
(	O
method	pointer
,	O
"TUKEY"	pointer
)	O
)	O
methn	int
=	O
TUKEY	int
;	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
method	pointer
,	O
"LSD"	pointer
)	O
)	O
methn	int
=	O
LSD	int
;	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
method	pointer
,	O
"DUNNETT"	pointer
)	O
)	O
methn	int
=	O
DUNNETT	int
;	O
else	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(lsmeans) unknown method: %s\n"	pointer
,	O
method	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
nmark	int
=	O
dap_list	function
(	O
marks	array
,	O
markv	array
,	O
dap_maxvar	int
)	O
;	O
for	O
(	O
l	int
=	O
0	int
;	O
l	int
<	O
dap_maxlev	int
;	O
l	int
++	O
)	O
levval	pointer
[	O
l	int
]	O
[	O
0	int
]	O
=	O
'\0'	O
;	O
for	O
(	O
ncells	int
=	O
0	int
,	O
nlevels	pointer
=	O
0	int
,	O
nlsmeans	int
=	O
0	int
,	O
nerrors	int
=	O
0	int
,	O
more	int
=	O
step	function
(	O
)	O
,	O
morecells	int
=	O
1	int
;	O
morecells	int
;	O
ncells	int
++	O
)	O
{	O
gotn	int
=	O
0	int
;	O
gotm	int
=	O
0	int
;	O
gotv	int
=	O
0	int
;	O
morecells	int
=	O
more	int
;	O
if	O
(	O
dap_newpart	function
(	O
markv	array
,	O
nmark	int
)	O
)	O
{	O
dap_swap	function
(	O
)	O
;	O
dap_head	function
(	O
markv	array
,	O
nmark	int
)	O
;	O
dap_swap	function
(	O
)	O
;	O
fprintf	function
(	O
dap_lst	pointer
,	O
"Least-squares means for: %s\n"	pointer
,	O
treat	pointer
)	O
;	O
lsmeans1	function
(	O
methn	int
,	O
alpha	double
,	O
coeff	pointer
,	O
ncells	int
,	O
mse	double
,	O
edf	double
,	O
nerrors	int
,	O
nlsmeans	int
,	O
mean	pointer
,	O
vari	pointer
,	O
nobs	array
,	O
nlevels	pointer
,	O
levval	pointer
,	O
varv	array
[	O
0	int
]	O
,	O
treatn	int
,	O
resp2n	int
,	O
treat2n	int
,	O
typen	int
,	O
statn	int
,	O
lsm1	int
,	O
lsm2	int
)	O
;	O
ncells	int
=	O
0	int
;	O
nlsmeans	int
=	O
0	int
;	O
nerrors	int
=	O
0	int
;	O
nlevels	pointer
=	O
0	int
;	O
for	O
(	O
l	int
=	O
0	int
;	O
l	int
<	O
dap_maxlev	int
;	O
l	int
++	O
)	O
levval	pointer
[	O
l	int
]	O
[	O
0	int
]	O
=	O
'\0'	O
;	O
}	O
for	O
(	O
s	int
=	O
0	int
;	O
more	int
;	O
)	O
{	O
if	O
(	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"N"	pointer
)	O
)	O
{	O
nobs	array
[	O
ncells	int
]	O
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
;	O
gotn	int
=	O
1	int
;	O
}	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"MEAN"	pointer
)	O
)	O
{	O
mean	pointer
[	O
ncells	int
]	O
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
;	O
gotm	int
=	O
1	int
;	O
}	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"VAR"	pointer
)	O
)	O
{	O
vari	pointer
[	O
ncells	int
]	O
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
;	O
gotv	int
=	O
1	int
;	O
}	O
else	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(lsmeans) Bad cell statistic: %s\n"	pointer
,	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
if	O
(	O
++	O
s	int
<	O
3	int
)	O
more	int
=	O
step	function
(	O
)	O
;	O
else	O
{	O
if	O
(	O
nobs	array
[	O
ncells	int
]	O
==	O
1.0	int
)	O
vari	pointer
[	O
ncells	int
]	O
=	O
0.0	int
;	O
break	O
;	O
}	O
}	O
if	O
(	O
more	int
)	O
{	O
if	O
(	O
!	O
gotm	int
)	O
{	O
fputs	function
(	O
"(lsmeans) Missing MEAN.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
if	O
(	O
!	O
gotn	int
)	O
{	O
fputs	function
(	O
"(lsmeans) Missing N.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
if	O
(	O
!	O
gotv	int
)	O
{	O
fputs	function
(	O
"(lsmeans) Missing VAR.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
levn	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
treatn	int
]	O
,	O
levval	pointer
,	O
&	O
nlevels	pointer
)	O
;	O
}	O
for	O
(	O
nerrors	int
=	O
0	int
;	O
more	int
;	O
)	O
{	O
more	int
=	O
step	function
(	O
)	O
;	O
err	int
=	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"ERROR"	pointer
)	O
;	O
con	int
=	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"CONTR"	pointer
)	O
;	O
if	O
(	O
err	int
||	O
con	int
)	O
{	O
coeff	pointer
[	O
nerrors	int
]	O
[	O
ncells	int
]	O
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
;	O
nerrors	int
++	O
;	O
}	O
else	O
break	O
;	O
}	O
for	O
(	O
nlsmeans	int
=	O
0	int
;	O
more	int
;	O
)	O
{	O
if	O
(	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"LSMEAN"	pointer
)	O
)	O
{	O
coeff	pointer
[	O
nerrors	int
+	O
nlsmeans	int
]	O
[	O
ncells	int
]	O
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
;	O
nlsmeans	int
++	O
;	O
}	O
else	O
break	O
;	O
more	int
=	O
step	function
(	O
)	O
;	O
}	O
if	O
(	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"MSERROR"	pointer
)	O
)	O
{	O
mse	double
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
;	O
if	O
(	O
more	int
&&	O
(	O
more	int
=	O
step	function
(	O
)	O
)	O
&&	O
!	O
strcmp	function
(	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
,	O
"ERRORDF"	pointer
)	O
)	O
{	O
edf	double
=	O
dap_obs	array
[	O
0	int
]	O
.	O
do_dbl	pointer
[	O
varv	array
[	O
0	int
]	O
]	O
;	O
if	O
(	O
more	int
)	O
more	int
=	O
step	function
(	O
)	O
;	O
}	O
else	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(lsmeans1) Expected ERRORDF: %s\n"	pointer
,	O
dap_obs	array
[	O
0	int
]	O
.	O
do_str	pointer
[	O
typen	int
]	O
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
}	O
args1	pointer
=	O
dap_malloc	function
(	O
strlen	function
(	O
marks	array
)	O
+	O
strlen	function
(	O
treat2	pointer
)	O
+	O
strlen	function
(	O
treat	pointer
)	O
+	O
10	int
+	O
15	int
,	O
""	pointer
)	O
;	O
sprintf	function
(	O
args1	pointer
,	O
"%s _type_ _LSMEAN_ %s _lsm_ %s"	pointer
,	O
marks	array
,	O
treat2	pointer
,	O
treat	pointer
)	O
;	O
sort	function
(	O
lsmname	pointer
,	O
args1	pointer
,	O
""	pointer
)	O
;	O
sprintf	function
(	O
args1	pointer
,	O
"_type_ _LSMEAN_ %s"	pointer
,	O
treat2	pointer
)	O
;	O
args2	pointer
=	O
dap_malloc	function
(	O
strlen	function
(	O
treat	pointer
)	O
+	O
8	int
+	O
6	int
,	O
treat	pointer
)	O
;	O
sprintf	function
(	O
args2	pointer
,	O
"_lsm_ %s _stat_"	pointer
,	O
treat	pointer
)	O
;	O
while	O
(	O
*	O
format	array
==	O
' '	O
)	O
format	array
++	O
;	O
if	O
(	O
*	O
format	array
==	O
's'	O
)	O
format	array
++	O
;	O
table	function
(	O
lsmsrt	pointer
,	O
args1	pointer
,	O
args2	pointer
,	O
format	array
,	O
marks	array
)	O
;	O
dap_free	function
(	O
varv	array
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
markv	array
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
lsmname	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
lsmsrt	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
varstr	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
treat2	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
args1	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
args2	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
levmem	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
levval	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
comem	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
coeff	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
mean	pointer
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
nobs	array
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
vari	pointer
,	O
""	pointer
)	O
;	O
}	O
