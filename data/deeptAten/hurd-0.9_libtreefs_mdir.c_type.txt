error_t	function
treefs_mdir_add	function
(	O
struct	O
treefs_node	O
*	O
dir	pointer
,	O
char	O
*	O
name	pointer
,	O
struct	O
treefs_node	O
*	O
child	pointer
,	O
struct	O
treefs_node	O
*	O
*	O
old_child	pointer
)	O
{	O
if	O
(	O
!	O
treefs_node_isdir	function
(	O
dir	pointer
)	O
)	O
return	O
ENOTDIR	O
;	O
else	O
{	O
if	O
(	O
dir	pointer
->	O
children	O
==	O
NULL	O
)	O
{	O
dir	pointer
->	O
children	O
=	O
treefs_make_node_list	function
(	O
)	O
;	O
if	O
(	O
dir	pointer
->	O
children	O
==	O
NULL	O
)	O
return	O
ENOMEM	O
;	O
}	O
return	O
treefs_node_list_add	function
(	O
dir	pointer
->	O
children	O
,	O
name	pointer
,	O
child	pointer
,	O
old_child	pointer
)	O
;	O
}	O
}	O
error_t	function
treefs_mdir_remove	function
(	O
struct	O
treefs_node	O
*	O
dir	pointer
,	O
char	O
*	O
name	pointer
,	O
struct	O
treefs_node	O
*	O
old_child	pointer
)	O
{	O
if	O
(	O
!	O
treefs_node_isdir	function
(	O
dir	pointer
)	O
)	O
return	O
ENOTDIR	O
;	O
else	O
if	O
(	O
dir	pointer
->	O
children	O
==	O
NULL	O
)	O
return	O
ENOENT	O
;	O
else	O
return	O
treefs_node_list_remove	function
(	O
dir	pointer
->	O
children	O
,	O
name	pointer
,	O
old_child	pointer
)	O
;	O
}	O
error_t	function
treefs_mdir_get	function
(	O
struct	O
treefs_node	O
*	O
dir	pointer
,	O
char	O
*	O
name	pointer
,	O
struct	O
treefs_node	O
*	O
*	O
child	pointer
)	O
{	O
if	O
(	O
!	O
treefs_node_isdir	function
(	O
dir	pointer
)	O
)	O
return	O
ENOTDIR	O
;	O
else	O
if	O
(	O
dir	pointer
->	O
children	O
==	O
NULL	O
)	O
return	O
ENOENT	O
;	O
else	O
return	O
treefs_node_list_get	function
(	O
dir	pointer
->	O
children	O
,	O
name	pointer
,	O
child	pointer
)	O
;	O
}	O
error_t	function
treefs_mdir_for_each	function
(	O
struct	O
treefs_node	O
*	O
dir	pointer
,	O
error_t	function
(	O
*	O
fun	pointer
)	O
(	O
char	O
*	O
name	pointer
,	O
struct	O
treefs_node	O
*	O
child	pointer
)	O
)	O
{	O
if	O
(	O
!	O
treefs_node_isdir	function
(	O
dir	pointer
)	O
)	O
return	O
ENOTDIR	O
;	O
else	O
if	O
(	O
dir	pointer
->	O
children	O
==	O
NULL	O
)	O
return	O
0	int
;	O
else	O
return	O
treefs_node_list_for_each	function
(	O
dir	pointer
->	O
children	O
,	O
fun	pointer
)	O
;	O
}	O
