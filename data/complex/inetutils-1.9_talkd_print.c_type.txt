static	O
const	O
char	O
*	O
message_types	array(*(char))
[	O
]	O
=	O
{	O
D	O
(	O
LEAVE_INVITE	O
)	O
,	O
D	O
(	O
LOOK_UP	O
)	O
,	O
D	O
(	O
DELETE	O
)	O
,	O
D	O
(	O
ANNOUNCE	O
)	O
}	O
;	O
static	O
const	O
char	O
*	O
answers	array(*(char))
[	O
]	O
=	O
{	O
D	O
(	O
SUCCESS	O
)	O
,	O
D	O
(	O
NOT_HERE	O
)	O
,	O
D	O
(	O
FAILED	O
)	O
,	O
D	O
(	O
MACHINE_UNKNOWN	O
)	O
,	O
D	O
(	O
PERMISSION_DENIED	O
)	O
,	O
D	O
(	O
UNKNOWN_REQUEST	O
)	O
,	O
D	O
(	O
BADVERSION	O
)	O
,	O
D	O
(	O
BADADDR	O
)	O
,	O
D	O
(	O
BADCTLADDR	O
)	O
}	O
;	O
static	O
const	O
char	O
*	O
_xlat_num	(int,array(*(char)),int)->(*(char))
(	O
int	O
num	int
,	O
const	O
char	O
*	O
array	array(*(char))
[	O
]	O
,	O
int	O
size	int
)	O
{	O
static	O
char	O
buf	array(char)
[	O
64	int
]	O
;	O
if	O
(	O
num	int
>=	O
size	int
)	O
{	O
snprintf	(*(char),long,*(char))->(int)
(	O
buf	array(char)
,	O
sizeof	O
buf	array(char)
,	O
"%d"	*(char)
,	O
num	int
)	O
;	O
return	O
buf	array(char)
;	O
}	O
else	O
return	O
array	array(*(char))
[	O
num	int
]	O
;	O
}	O
int	O
print_request	(*(char),*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))))->(int)
(	O
const	O
char	O
*	O
cp	*(char)
,	O
CTL_MSG	struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))
*	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
)	O
{	O
syslog	(int,*(char))->(void)
(	O
LOG_DEBUG	int
,	O
"%s: %s: id %d, l_user %s, r_user %s, r_tty %s"	*(char)
,	O
cp	*(char)
,	O
_xlat_num	(int,array(*(char)),int)->(*(char))
(	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
type	char
,	O
message_types	array(*(char))
,	O
NITEMS	O
(	O
message_types	array(*(char))
)	O
)	O
,	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
id_num	int
,	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
l_name	array(char)
,	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
r_name	array(char)
,	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
r_tty	array(char)
)	O
;	O
return	O
0	int
;	O
}	O
int	O
print_response	(*(char),*(struct(char,char,char,char,int,struct(short,array(char)))))->(int)
(	O
const	O
char	O
*	O
cp	*(char)
,	O
CTL_RESPONSE	struct(char,char,char,char,int,struct(short,array(char)))
*	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
)	O
{	O
syslog	(int,*(char))->(void)
(	O
LOG_DEBUG	int
,	O
"%s: %s: %s, id %d"	*(char)
,	O
cp	*(char)
,	O
_xlat_num	(int,array(*(char)),int)->(*(char))
(	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
type	char
,	O
message_types	array(*(char))
,	O
NITEMS	O
(	O
message_types	array(*(char))
)	O
)	O
,	O
_xlat_num	(int,array(*(char)),int)->(*(char))
(	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
answer	char
,	O
answers	array(*(char))
,	O
NITEMS	O
(	O
answers	array(*(char))
)	O
)	O
,	O
ntohl	(int)->(int)
(	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
id_num	int
)	O
)	O
;	O
return	O
0	int
;	O
}	O
