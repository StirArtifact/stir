bfd	struct
*	O
stdoutput	O
;	O
void	O
output_file_create	O
(	O
const	O
char	O
*	O
name	*(char)
)	O
{	O
if	O
(	O
name	*(char)
[	O
0	int
]	O
==	O
'-'	O
&&	O
name	*(char)
[	O
1	int
]	O
==	O
'\0'	O
)	O
as_fatal	O
(	O
_	O
(	O
"can't open a bfd on stdout %s"	*(char)
)	O
,	O
name	*(char)
)	O
;	O
else	O
if	O
(	O
!	O
(	O
stdoutput	O
=	O
bfd_openw	(*(char),*(char))->(*(struct))
(	O
name	*(char)
,	O
TARGET_FORMAT	O
)	O
)	O
)	O
{	O
bfd_error_type	enum(int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int)
err	O
=	O
bfd_get_error	()->(enum(int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int))
(	O
)	O
;	O
if	O
(	O
err	O
==	O
bfd_error_invalid_target	int
)	O
as_fatal	O
(	O
_	O
(	O
"selected target format '%s' unknown"	*(char)
)	O
,	O
TARGET_FORMAT	O
)	O
;	O
else	O
as_fatal	O
(	O
_	O
(	O
"can't create %s: %s"	*(char)
)	O
,	O
name	*(char)
,	O
bfd_errmsg	(enum(int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int))->(*(char))
(	O
err	O
)	O
)	O
;	O
}	O
bfd_set_format	O
(	O
stdoutput	O
,	O
bfd_object	int
)	O
;	O
bfd_set_arch_mach	O
(	O
stdoutput	O
,	O
TARGET_ARCH	O
,	O
TARGET_MACH	O
)	O
;	O
if	O
(	O
flag_traditional_format	O
)	O
stdoutput	O
->	O
flags	int
|=	O
BFD_TRADITIONAL_FORMAT	O
;	O
}	O
void	O
output_file_close	O
(	O
const	O
char	O
*	O
filename	*(char)
)	O
{	O
bfd_boolean	int
res	O
;	O
if	O
(	O
stdoutput	O
==	O
NULL	O
)	O
return	O
;	O
if	O
(	O
had_errors	O
(	O
)	O
)	O
res	O
=	O
bfd_cache_close_all	()->(int)
(	O
)	O
;	O
else	O
res	O
=	O
bfd_close	(*(struct))->(int)
(	O
stdoutput	O
)	O
;	O
stdoutput	O
=	O
NULL	O
;	O
if	O
(	O
!	O
res	O
)	O
as_fatal	O
(	O
_	O
(	O
"can't close %s: %s"	*(char)
)	O
,	O
filename	*(char)
,	O
bfd_errmsg	(enum(int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int))->(*(char))
(	O
bfd_get_error	()->(enum(int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int))
(	O
)	O
)	O
)	O
;	O
}	O
