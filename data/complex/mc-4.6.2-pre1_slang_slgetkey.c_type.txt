unsigned	O
int	O
SLang_Input_Buffer_Len	int
=	O
0	int
;	O
unsigned	O
char	O
SLang_Input_Buffer	array(char)
[	O
SL_MAX_INPUT_BUFFER_LEN	int
]	O
;	O
int	O
SLang_Abort_Char	int
=	O
7	int
;	O
int	O
SLang_Ignore_User_Abort	int
=	O
0	int
;	O
unsigned	O
int	O
SLang_getkey	()->(int)
(	O
void	O
)	O
{	O
unsigned	O
int	O
imax	int
;	O
unsigned	O
int	O
ch	int
;	O
if	O
(	O
SLang_Input_Buffer_Len	int
)	O
{	O
ch	int
=	O
(	O
unsigned	O
int	O
)	O
*	O
SLang_Input_Buffer	array(char)
;	O
SLang_Input_Buffer_Len	int
--	O
;	O
imax	int
=	O
SLang_Input_Buffer_Len	int
;	O
SLMEMCPY	O
(	O
(	O
char	O
*	O
)	O
SLang_Input_Buffer	array(char)
,	O
(	O
char	O
*	O
)	O
(	O
SLang_Input_Buffer	array(char)
+	O
1	int
)	O
,	O
imax	int
)	O
;	O
}	O
else	O
if	O
(	O
SLANG_GETKEY_ERROR	int
==	O
(	O
ch	int
=	O
_pSLsys_getkey	()->(int)
(	O
)	O
)	O
)	O
return	O
ch	int
;	O
return	O
(	O
ch	int
)	O
;	O
}	O
int	O
SLang_ungetkey_string	(*(char),int)->(int)
(	O
unsigned	O
char	O
*	O
s	*(char)
,	O
unsigned	O
int	O
n	int
)	O
{	O
register	O
unsigned	O
char	O
*	O
bmax	*(char)
,	O
*	O
b	*(char)
,	O
*	O
b1	*(char)
;	O
if	O
(	O
SLang_Input_Buffer_Len	int
+	O
n	int
+	O
3	int
>	O
SL_MAX_INPUT_BUFFER_LEN	int
)	O
return	O
-	O
1	int
;	O
b	*(char)
=	O
SLang_Input_Buffer	array(char)
;	O
bmax	*(char)
=	O
(	O
b	*(char)
-	O
1	int
)	O
+	O
SLang_Input_Buffer_Len	int
;	O
b1	*(char)
=	O
bmax	*(char)
+	O
n	int
;	O
while	O
(	O
bmax	*(char)
>=	O
b	*(char)
)	O
*	O
b1	*(char)
--	O
=	O
*	O
bmax	*(char)
--	O
;	O
bmax	*(char)
=	O
b	*(char)
+	O
n	int
;	O
while	O
(	O
b	*(char)
<	O
bmax	*(char)
)	O
*	O
b	*(char)
++	O
=	O
*	O
s	*(char)
++	O
;	O
SLang_Input_Buffer_Len	int
+=	O
n	int
;	O
return	O
0	int
;	O
}	O
int	O
SLang_buffer_keystring	(*(char),int)->(int)
(	O
unsigned	O
char	O
*	O
s	*(char)
,	O
unsigned	O
int	O
n	int
)	O
{	O
if	O
(	O
n	int
+	O
SLang_Input_Buffer_Len	int
+	O
3	int
>	O
SL_MAX_INPUT_BUFFER_LEN	int
)	O
return	O
-	O
1	int
;	O
SLMEMCPY	O
(	O
(	O
char	O
*	O
)	O
SLang_Input_Buffer	array(char)
+	O
SLang_Input_Buffer_Len	int
,	O
(	O
char	O
*	O
)	O
s	*(char)
,	O
n	int
)	O
;	O
SLang_Input_Buffer_Len	int
+=	O
n	int
;	O
return	O
0	int
;	O
}	O
int	O
SLang_ungetkey	(char)->(int)
(	O
unsigned	O
char	O
ch	int
)	O
{	O
return	O
SLang_ungetkey_string	(*(char),int)->(int)
(	O
&	O
ch	int
,	O
1	int
)	O
;	O
}	O
int	O
SLang_input_pending	(int)->(int)
(	O
int	O
tsecs	int
)	O
{	O
int	O
n	int
;	O
unsigned	O
char	O
c	int
;	O
if	O
(	O
SLang_Input_Buffer_Len	int
)	O
return	O
(	O
int	O
)	O
SLang_Input_Buffer_Len	int
;	O
n	int
=	O
_pSLsys_input_pending	(int)->(int)
(	O
tsecs	int
)	O
;	O
if	O
(	O
n	int
<=	O
0	int
)	O
return	O
0	int
;	O
c	int
=	O
(	O
unsigned	O
char	O
)	O
SLang_getkey	()->(int)
(	O
)	O
;	O
SLang_ungetkey_string	(*(char),int)->(int)
(	O
&	O
c	int
,	O
1	int
)	O
;	O
return	O
n	int
;	O
}	O
void	O
SLang_flush_input	()->(void)
(	O
void	O
)	O
{	O
int	O
quit	int
=	O
SLKeyBoard_Quit	int
;	O
SLang_Input_Buffer_Len	int
=	O
0	int
;	O
SLKeyBoard_Quit	int
=	O
0	int
;	O
while	O
(	O
_pSLsys_input_pending	(int)->(int)
(	O
0	int
)	O
>	O
0	int
)	O
{	O
(	O
void	O
)	O
_pSLsys_getkey	()->(int)
(	O
)	O
;	O
SLang_Input_Buffer_Len	int
=	O
0	int
;	O
}	O
SLKeyBoard_Quit	int
=	O
quit	int
;	O
}	O
