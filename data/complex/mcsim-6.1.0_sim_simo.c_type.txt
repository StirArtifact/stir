static	O
char	O
vszDefOutFilename	O
[	O
]	O
=	O
"sim.out"	*(char)
;	O
static	O
char	O
vszDefMCOutFilename	O
[	O
]	O
=	O
"simmc.out"	*(char)
;	O
void	O
SaveOutputs	O
(	O
PEXPERIMENT	O
pexp	O
,	O
PDOUBLE	*(double)
pdTout	O
)	O
{	O
static	O
PDOUBLE	*(double)
rgdInterpStates	O
,	O
rgdInterpDeriv	O
;	O
int	O
i	O
,	O
j	O
,	O
index	(*(char),int)->(*(char))
;	O
PMODELINFO	O
pmod	O
=	O
pexp	O
->	O
pmodelinfo	O
;	O
POUTSPEC	*(struct(int,*(struct(*(struct`),*(struct`),int)),*(*(char)),*(long),int,*(struct(*(struct`),*(struct`),int)),*(*(char)),*(long),*(int),*(int),*(*(double)),*(*(double)),int,*(double),*(int),*(*(double))))
pos	O
=	O
&	O
pexp	O
->	O
os	O
;	O
extern	O
IFN	struct(int,int,double,double,double,double,double,double,double,double,long,long,long,long,long,long,int,int,*(double),*(double),*(long),*(long),long,*(int))
vrgInputs	O
[	O
]	O
;	O
if	O
(	O
!	O
(	O
rgdInterpStates	O
)	O
||	O
!	O
(	O
rgdInterpDeriv	O
)	O
)	O
if	O
(	O
!	O
(	O
rgdInterpStates	O
=	O
InitdVector	(long)->(*(double))
(	O
GetNModelVars	()->(int)
(	O
)	O
)	O
)	O
||	O
!	O
(	O
rgdInterpDeriv	O
=	O
InitdVector	(long)->(*(double))
(	O
GetNModelVars	()->(int)
(	O
)	O
)	O
)	O
)	O
ReportError	O
(	O
NULL	O
,	O
RE_OUTOFMEM	O
|	O
RE_FATAL	O
,	O
"SaveOutputs"	*(char)
,	O
NULL	O
)	O
;	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
rgdInterpStates	O
,	O
pmod	O
->	O
pdModelVars	O
,	O
pmod	O
->	O
nModelVars	O
*	O
sizeof	O
(	O
double	O
)	O
)	O
;	O
CalcDeriv	(array(double),array(double),*(double))->(void)
(	O
rgdInterpStates	O
,	O
rgdInterpDeriv	O
,	O
pdTout	O
)	O
;	O
CalcOutputs	(array(double),array(double),*(double))->(void)
(	O
rgdInterpStates	O
,	O
rgdInterpDeriv	O
,	O
pdTout	O
)	O
;	O
for	O
(	O
i	O
=	O
0	int
;	O
i	O
<	O
pos	O
->	O
nOutputs	int
;	O
i	O
++	O
)	O
{	O
if	O
(	O
pos	O
->	O
piCurrentOut	*(int)
[	O
i	O
]	O
<	O
pos	O
->	O
pcOutputTimes	*(int)
[	O
i	O
]	O
&&	O
*	O
pdTout	O
==	O
pos	O
->	O
prgdOutputTimes	*(*(double))
[	O
i	O
]	O
[	O
pos	O
->	O
piCurrentOut	*(int)
[	O
i	O
]	O
]	O
)	O
{	O
double	O
dTmp	O
=	O
0	int
;	O
if	O
(	O
IsModelVar	(long)->(int)
(	O
pos	O
->	O
phvar_out	*(long)
[	O
i	O
]	O
)	O
)	O
dTmp	O
=	O
rgdInterpStates	O
[	O
ModelIndex	(long)->(int)
(	O
pos	O
->	O
phvar_out	*(long)
[	O
i	O
]	O
)	O
]	O
;	O
else	O
{	O
index	(*(char),int)->(*(char))
=	O
HINDEX	O
(	O
pos	O
->	O
phvar_out	*(long)
[	O
i	O
]	O
)	O
;	O
if	O
(	O
IsInput	(long)->(int)
(	O
pos	O
->	O
phvar_out	*(long)
[	O
i	O
]	O
)	O
&&	O
(	O
vrgInputs	O
[	O
index	(*(char),int)->(*(char))
]	O
.	O
iType	int
==	O
IFN_SPIKES	O
)	O
)	O
{	O
j	O
=	O
vrgInputs	O
[	O
index	(*(char),int)->(*(char))
]	O
.	O
iDoseCur	int
;	O
if	O
(	O
(	O
vrgInputs	O
[	O
index	(*(char),int)->(*(char))
]	O
.	O
rgT0s	*(double)
[	O
j	O
]	O
==	O
pexp	O
->	O
dTime	O
)	O
&&	O
(	O
j	O
<	O
vrgInputs	O
[	O
index	(*(char),int)->(*(char))
]	O
.	O
nDoses	int
)	O
)	O
dTmp	O
=	O
vrgInputs	O
[	O
index	(*(char),int)->(*(char))
]	O
.	O
rgMags	*(double)
[	O
j	O
]	O
;	O
else	O
dTmp	O
=	O
0	int
;	O
}	O
else	O
dTmp	O
=	O
GetVarValue	(long)->(double)
(	O
pos	O
->	O
phvar_out	*(long)
[	O
i	O
]	O
)	O
;	O
}	O
if	O
(	O
fabs	(double)->(double)
(	O
dTmp	O
)	O
<	O
SO_EPSILON	O
)	O
dTmp	O
=	O
0.0	int
;	O
pos	O
->	O
prgdOutputVals	*(*(double))
[	O
i	O
]	O
[	O
pos	O
->	O
piCurrentOut	*(int)
[	O
i	O
]	O
++	O
]	O
=	O
dTmp	O
;	O
}	O
}	O
}	O
void	O
NextOutputTime	O
(	O
PEXPERIMENT	O
pexp	O
,	O
PDOUBLE	*(double)
pdTout	O
,	O
PINT	*(int)
piOut	O
)	O
{	O
if	O
(	O
pexp	O
->	O
dTime	O
<	O
pexp	O
->	O
dTfinal	O
)	O
{	O
if	O
(	O
++	O
*	O
piOut	O
<	O
pexp	O
->	O
os	O
.	O
cDistinctTimes	int
)	O
{	O
*	O
pdTout	O
=	O
pexp	O
->	O
os	O
.	O
rgdDistinctTimes	*(double)
[	O
*	O
piOut	O
]	O
;	O
}	O
else	O
{	O
*	O
pdTout	O
=	O
pexp	O
->	O
dTfinal	O
;	O
}	O
}	O
}	O
int	O
WriteOneMod	O
(	O
PVOID	*(void)
pData	*(void)
,	O
PVOID	*(void)
pInfo	*(void)
)	O
{	O
PMCVAR	O
pmcvar	O
=	O
(	O
PMCVAR	O
)	O
pData	*(void)
;	O
PFILE	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
pfile	O
=	O
(	O
PFILE	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
)	O
pInfo	*(void)
;	O
if	O
(	O
!	O
IsInput	(long)->(int)
(	O
pmcvar	O
->	O
hvar	long
)	O
)	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfile	O
,	O
"%g\t"	*(char)
,	O
pmcvar	O
->	O
dVal	double
)	O
;	O
return	O
0	int
;	O
}	O
void	O
WriteMCHeader	O
(	O
PFILE	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
pfileOut	O
,	O
PANALYSIS	O
panal	O
)	O
{	O
long	O
i	O
,	O
j	O
,	O
k	O
;	O
PMONTECARLO	O
pmc	O
=	O
&	O
panal	O
->	O
mc	O
;	O
OUTSPEC	struct(int,*(struct(*(struct(*`,*`)),*(struct(*`,*`)),int)),*(*(char)),*(long),int,*(struct(*(struct(*`,*`)),*(struct(*`,*`)),int)),*(*(char)),*(long),*(int),*(int),*(*(double)),*(*(double)),int,*(double),*(int),*(*(double)))
*	O
pos	O
;	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfileOut	O
,	O
"Iter"	*(char)
)	O
;	O
for	O
(	O
i	O
=	O
0	int
;	O
i	O
<	O
pmc	O
->	O
nParms	O
;	O
i	O
++	O
)	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfileOut	O
,	O
"\t%s"	*(char)
,	O
GetVarName	(long)->(*(char))
(	O
pmc	O
->	O
rgpMCVar	O
[	O
i	O
]	O
->	O
hvar	long
)	O
)	O
;	O
for	O
(	O
i	O
=	O
0	int
;	O
i	O
<	O
panal	O
->	O
expGlobal	O
.	O
iExp	O
;	O
i	O
++	O
)	O
{	O
pos	O
=	O
&	O
panal	O
->	O
rgpExps	O
[	O
i	O
]	O
->	O
os	O
;	O
for	O
(	O
j	O
=	O
0	int
;	O
j	O
<	O
pos	O
->	O
nOutputs	int
;	O
j	O
++	O
)	O
{	O
for	O
(	O
k	O
=	O
0	int
;	O
k	O
<	O
pos	O
->	O
pcOutputTimes	*(int)
[	O
j	O
]	O
;	O
k	O
++	O
)	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfileOut	O
,	O
"\t%s_%ld.%ld"	*(char)
,	O
pos	O
->	O
pszOutputNames	*(*(char))
[	O
j	O
]	O
,	O
i	O
+	O
1	int
,	O
k	O
+	O
1	int
)	O
;	O
}	O
}	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfileOut	O
,	O
"\n"	*(char)
)	O
;	O
fflush	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))))->(int)
(	O
pfileOut	O
)	O
;	O
}	O
void	O
OpenMCFiles	O
(	O
PANALYSIS	O
panal	O
)	O
{	O
PMONTECARLO	O
pmc	O
=	O
&	O
panal	O
->	O
mc	O
;	O
if	O
(	O
panal	O
->	O
bCommandLineSpec	O
)	O
{	O
free	(*(void))->(void)
(	O
pmc	O
->	O
szMCOutfilename	O
)	O
;	O
panal	O
->	O
bAllocatedFileName	O
=	O
FALSE	O
;	O
pmc	O
->	O
szMCOutfilename	O
=	O
panal	O
->	O
szOutfilename	O
;	O
}	O
else	O
if	O
(	O
!	O
(	O
pmc	O
->	O
szMCOutfilename	O
)	O
)	O
pmc	O
->	O
szMCOutfilename	O
=	O
vszDefMCOutFilename	O
;	O
if	O
(	O
panal	O
->	O
size	O
>	O
1	int
)	O
{	O
char	O
*	O
with_rank	O
=	O
malloc	(long)->(*(void))
(	O
sizeof	O
(	O
char	O
)	O
*	O
(	O
6	int
+	O
strlen	(*(char))->(long)
(	O
pmc	O
->	O
szMCOutfilename	O
)	O
)	O
)	O
;	O
sprintf	(*(char),*(char))->(int)
(	O
with_rank	O
,	O
"%04d_%s"	*(char)
,	O
panal	O
->	O
rank	int
,	O
pmc	O
->	O
szMCOutfilename	O
)	O
;	O
pmc	O
->	O
szMCOutfilename	O
=	O
with_rank	O
;	O
}	O
if	O
(	O
!	O
pmc	O
->	O
pfileMCOut	O
&&	O
!	O
(	O
pmc	O
->	O
pfileMCOut	O
=	O
fopen	(*(char),*(char))->(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))))
(	O
pmc	O
->	O
szMCOutfilename	O
,	O
"w"	*(char)
)	O
)	O
)	O
{	O
ReportError	O
(	O
NULL	O
,	O
RE_FATAL	O
|	O
RE_CANNOTOPEN	O
,	O
pmc	O
->	O
szMCOutfilename	O
,	O
"OpenMCFiles()"	*(char)
)	O
;	O
}	O
WriteMCHeader	O
(	O
pmc	O
->	O
pfileMCOut	O
,	O
panal	O
)	O
;	O
}	O
void	O
CloseMCFiles	O
(	O
PANALYSIS	O
panal	O
)	O
{	O
fclose	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))))->(int)
(	O
panal	O
->	O
mc	O
.	O
pfileMCOut	O
)	O
;	O
printf	(*(char))->(int)
(	O
"\nWrote results to \"%s\"\n"	*(char)
,	O
panal	O
->	O
mc	O
.	O
szMCOutfilename	O
)	O
;	O
}	O
void	O
WriteMCOutput	O
(	O
PANALYSIS	O
panal	O
,	O
PMCPREDOUT	O
pmcpredout	O
)	O
{	O
PFILE	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
pfileMC	O
;	O
PMONTECARLO	O
pmc	O
=	O
&	O
panal	O
->	O
mc	O
;	O
pfileMC	O
=	O
pmc	O
->	O
pfileMCOut	O
;	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfileMC	O
,	O
"%ld\t"	*(char)
,	O
panal	O
->	O
mc	O
.	O
lRun	O
)	O
;	O
WriteArray	O
(	O
pfileMC	O
,	O
panal	O
->	O
mc	O
.	O
nParms	O
,	O
panal	O
->	O
mc	O
.	O
rgdParms	O
)	O
;	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfileMC	O
,	O
"\t"	*(char)
)	O
;	O
WriteArray	O
(	O
pfileMC	O
,	O
pmcpredout	O
->	O
nbrdy	O
,	O
pmcpredout	O
->	O
pred	O
)	O
;	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfileMC	O
,	O
"\n"	*(char)
)	O
;	O
fflush	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))))->(int)
(	O
pfileMC	O
)	O
;	O
}	O
void	O
WriteNormalOutput	O
(	O
PANALYSIS	O
panal	O
,	O
PEXPERIMENT	O
pexp	O
)	O
{	O
long	O
i	O
,	O
j	O
;	O
PFILE	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
pfile	O
;	O
POUTSPEC	*(struct(int,*(struct(*(struct`),*(struct`),int)),*(*(char)),*(long),int,*(struct(*(struct`),*(struct`),int)),*(*(char)),*(long),*(int),*(int),*(*(double)),*(*(double)),int,*(double),*(int),*(*(double))))
pos	O
;	O
if	O
(	O
!	O
panal	O
)	O
return	O
;	O
pos	O
=	O
&	O
pexp	O
->	O
os	O
;	O
if	O
(	O
!	O
panal	O
->	O
szOutfilename	O
)	O
panal	O
->	O
szOutfilename	O
=	O
vszDefOutFilename	O
;	O
if	O
(	O
panal	O
->	O
size	O
>	O
1	int
)	O
{	O
char	O
*	O
with_rank	O
=	O
malloc	(long)->(*(void))
(	O
sizeof	O
(	O
char	O
)	O
*	O
(	O
5	int
+	O
strlen	(*(char))->(long)
(	O
panal	O
->	O
szOutfilename	O
)	O
)	O
)	O
;	O
sprintf	(*(char),*(char))->(int)
(	O
with_rank	O
,	O
"%4d%s"	*(char)
,	O
panal	O
->	O
rank	int
,	O
panal	O
->	O
szOutfilename	O
)	O
;	O
panal	O
->	O
szOutfilename	O
=	O
with_rank	O
;	O
}	O
if	O
(	O
!	O
(	O
panal	O
->	O
pfileOut	O
)	O
)	O
if	O
(	O
!	O
(	O
panal	O
->	O
pfileOut	O
=	O
fopen	(*(char),*(char))->(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))))
(	O
panal	O
->	O
szOutfilename	O
,	O
"w"	*(char)
)	O
)	O
)	O
ReportError	O
(	O
NULL	O
,	O
RE_CANNOTOPEN	O
|	O
RE_FATAL	O
,	O
panal	O
->	O
szOutfilename	O
,	O
NULL	O
)	O
;	O
pfile	O
=	O
panal	O
->	O
pfileOut	O
;	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfile	O
,	O
"Results of Simulation %d\n\n"	*(char)
,	O
pexp	O
->	O
iExp	O
)	O
;	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfile	O
,	O
"Time"	*(char)
)	O
;	O
for	O
(	O
i	O
=	O
0	int
;	O
i	O
<	O
pos	O
->	O
nOutputs	int
;	O
i	O
++	O
)	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfile	O
,	O
"\t%s"	*(char)
,	O
pos	O
->	O
pszOutputNames	*(*(char))
[	O
i	O
]	O
)	O
;	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfile	O
,	O
"\n"	*(char)
)	O
;	O
for	O
(	O
j	O
=	O
0	int
;	O
j	O
<	O
pos	O
->	O
nOutputs	int
;	O
j	O
++	O
)	O
pos	O
->	O
piCurrentOut	*(int)
[	O
j	O
]	O
=	O
0	int
;	O
for	O
(	O
i	O
=	O
0	int
;	O
i	O
<	O
pos	O
->	O
cDistinctTimes	int
;	O
i	O
++	O
)	O
{	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfile	O
,	O
"%g"	*(char)
,	O
pos	O
->	O
rgdDistinctTimes	*(double)
[	O
i	O
]	O
)	O
;	O
for	O
(	O
j	O
=	O
0	int
;	O
j	O
<	O
pos	O
->	O
nOutputs	int
;	O
j	O
++	O
)	O
{	O
if	O
(	O
pos	O
->	O
piCurrentOut	*(int)
[	O
j	O
]	O
<	O
pos	O
->	O
pcOutputTimes	*(int)
[	O
j	O
]	O
&&	O
pos	O
->	O
rgdDistinctTimes	*(double)
[	O
i	O
]	O
==	O
pos	O
->	O
prgdOutputTimes	*(*(double))
[	O
j	O
]	O
[	O
pos	O
->	O
piCurrentOut	*(int)
[	O
j	O
]	O
]	O
)	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfile	O
,	O
"\t%g"	*(char)
,	O
pos	O
->	O
prgdOutputVals	*(*(double))
[	O
j	O
]	O
[	O
pos	O
->	O
piCurrentOut	*(int)
[	O
j	O
]	O
++	O
]	O
)	O
;	O
else	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfile	O
,	O
"\t"	*(char)
)	O
;	O
}	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfile	O
,	O
"\n"	*(char)
)	O
;	O
}	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
pfile	O
,	O
"\n\n"	*(char)
)	O
;	O
}	O
