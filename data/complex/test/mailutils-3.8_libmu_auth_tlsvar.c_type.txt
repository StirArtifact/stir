int	O
mu_tls_enable	int
=	O
0	int
;	O
int	O
mu_tls_cert_file_checks	int
=	O
MU_TLS_CERT_FILE_CHECKS	O
;	O
int	O
mu_tls_key_file_checks	int
=	O
MU_TLS_KEY_FILE_CHECKS	O
;	O
int	O
mu_tls_ca_file_checks	int
=	O
MU_TLS_CA_FILE_CHECKS	O
;	O
static	O
int	O
check_err	(int)->(int)
(	O
int	O
rc	int
)	O
{	O
switch	O
(	O
rc	int
)	O
{	O
case	O
MU_ERR_PERM_OWNER_MISMATCH	O
:	O
case	O
MU_ERR_PERM_GROUP_WRITABLE	O
:	O
case	O
MU_ERR_PERM_WORLD_WRITABLE	O
:	O
case	O
MU_ERR_PERM_GROUP_READABLE	O
:	O
case	O
MU_ERR_PERM_WORLD_READABLE	O
:	O
case	O
MU_ERR_PERM_LINKED_WRDIR	O
:	O
case	O
MU_ERR_PERM_DIR_IWGRP	O
:	O
case	O
MU_ERR_PERM_DIR_IWOTH	O
:	O
return	O
MU_TLS_CONFIG_UNSAFE	int
;	O
default	O
:	O
return	O
MU_TLS_CONFIG_FAIL	int
;	O
}	O
}	O
int	O
mu_tls_config_check	(*(struct(*(char),*(char),*(char),*(char))),int)->(int)
(	O
struct	O
mu_tls_config	struct(*(char),*(char),*(char),*(char))
const	O
*	O
conf	*(struct(*(char),*(char),*(char),*(char)))
,	O
int	O
verbose	int
)	O
{	O
int	O
rc	int
;	O
int	O
res	*(int)
=	O
MU_TLS_CONFIG_NULL	int
;	O
if	O
(	O
conf	*(struct(*(char),*(char),*(char),*(char)))
->	O
cert_file	*(char)
)	O
{	O
rc	int
=	O
mu_file_safety_check	(*(char),int,int,*(struct))->(int)
(	O
conf	*(struct(*(char),*(char),*(char),*(char)))
->	O
cert_file	*(char)
,	O
mu_tls_cert_file_checks	int
,	O
-	O
1	int
,	O
NULL	O
)	O
;	O
if	O
(	O
rc	int
)	O
{	O
if	O
(	O
verbose	int
)	O
mu_error	(*(char))->(int)
(	O
"%s: %s"	*(char)
,	O
conf	*(struct(*(char),*(char),*(char),*(char)))
->	O
cert_file	*(char)
,	O
mu_strerror	(int)->(*(char))
(	O
rc	int
)	O
)	O
;	O
return	O
check_err	(int)->(int)
(	O
rc	int
)	O
;	O
}	O
res	*(int)
=	O
MU_TLS_CONFIG_OK	int
;	O
}	O
if	O
(	O
conf	*(struct(*(char),*(char),*(char),*(char)))
->	O
key_file	*(char)
)	O
{	O
rc	int
=	O
mu_file_safety_check	(*(char),int,int,*(struct))->(int)
(	O
conf	*(struct(*(char),*(char),*(char),*(char)))
->	O
key_file	*(char)
,	O
mu_tls_key_file_checks	int
,	O
-	O
1	int
,	O
NULL	O
)	O
;	O
if	O
(	O
rc	int
)	O
{	O
if	O
(	O
verbose	int
)	O
mu_error	(*(char))->(int)
(	O
"%s: %s"	*(char)
,	O
conf	*(struct(*(char),*(char),*(char),*(char)))
->	O
key_file	*(char)
,	O
mu_strerror	(int)->(*(char))
(	O
rc	int
)	O
)	O
;	O
return	O
check_err	(int)->(int)
(	O
rc	int
)	O
;	O
}	O
res	*(int)
=	O
MU_TLS_CONFIG_OK	int
;	O
}	O
if	O
(	O
conf	*(struct(*(char),*(char),*(char),*(char)))
->	O
ca_file	*(char)
)	O
{	O
rc	int
=	O
mu_file_safety_check	(*(char),int,int,*(struct))->(int)
(	O
conf	*(struct(*(char),*(char),*(char),*(char)))
->	O
ca_file	*(char)
,	O
mu_tls_ca_file_checks	int
,	O
-	O
1	int
,	O
NULL	O
)	O
;	O
if	O
(	O
rc	int
)	O
{	O
if	O
(	O
verbose	int
)	O
mu_error	(*(char))->(int)
(	O
"%s: %s"	*(char)
,	O
conf	*(struct(*(char),*(char),*(char),*(char)))
->	O
ca_file	*(char)
,	O
mu_strerror	(int)->(*(char))
(	O
rc	int
)	O
)	O
;	O
return	O
check_err	(int)->(int)
(	O
rc	int
)	O
;	O
}	O
res	*(int)
=	O
MU_TLS_CONFIG_OK	int
;	O
}	O
if	O
(	O
conf	*(struct(*(char),*(char),*(char),*(char)))
->	O
priorities	*(char)
)	O
res	*(int)
=	O
MU_TLS_CONFIG_OK	int
;	O
return	O
res	*(int)
;	O
}	O
