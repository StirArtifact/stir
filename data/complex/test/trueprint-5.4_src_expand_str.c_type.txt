static	O
char	O
*	O
expand_character	(char,enum(int,int,int))->(*(char))
(	O
char	O
,	O
boolean	enum(int,int,int)
)	O
;	O
static	O
void	O
add_string	(*(*(char)),*(char),*(long))->(void)
(	O
char	O
*	O
*	O
,	O
char	O
*	O
,	O
size_t	long
*	O
)	O
;	O
static	O
void	O
add_character	(*(*(char)),char,*(long))->(void)
(	O
char	O
*	O
*	O
,	O
char	O
,	O
size_t	long
*	O
)	O
;	O
char	O
*	O
expand_string	(*(char),enum(int,int,int))->(*(char))
(	O
char	O
*	O
original_string	*(char)
,	O
boolean	enum(int,int,int)
index_page	enum(int,int,int)
)	O
{	O
static	O
char	O
*	O
output_buffer	*(char)
=	O
NULL	O
;	O
static	O
size_t	long
buffer_size	long
=	O
100	int
;	O
char	O
*	O
current_char	long
;	O
if	O
(	O
original_string	*(char)
)	O
dm	(char,int,*(char))->(void)
(	O
'h'	O
,	O
5	int
,	O
"expand_string.c:expand_string() Expanding string %s\n"	*(char)
,	O
original_string	*(char)
)	O
;	O
else	O
dm	(char,int,*(char))->(void)
(	O
'h'	O
,	O
5	int
,	O
"expand_string.c:expand_string() Expanding null string\n"	*(char)
)	O
;	O
if	O
(	O
output_buffer	*(char)
==	O
NULL	O
)	O
output_buffer	*(char)
=	O
xmalloc	(long)->(*(void))
(	O
100	int
)	O
;	O
*	O
output_buffer	*(char)
=	O
'\0'	O
;	O
if	O
(	O
original_string	*(char)
)	O
{	O
for	O
(	O
current_char	long
=	O
original_string	*(char)
;	O
*	O
current_char	long
;	O
current_char	long
++	O
)	O
{	O
if	O
(	O
*	O
current_char	long
!=	O
'%'	O
)	O
{	O
add_character	(*(*(char)),char,*(long))->(void)
(	O
&	O
output_buffer	*(char)
,	O
*	O
current_char	long
,	O
&	O
buffer_size	long
)	O
;	O
continue	O
;	O
}	O
add_string	(*(*(char)),*(char),*(long))->(void)
(	O
&	O
output_buffer	*(char)
,	O
expand_character	(char,enum(int,int,int))->(*(char))
(	O
*	O
++	O
current_char	long
,	O
index_page	enum(int,int,int)
)	O
,	O
&	O
buffer_size	long
)	O
;	O
}	O
}	O
else	O
{	O
*	O
output_buffer	*(char)
=	O
'\0'	O
;	O
}	O
dm	(char,int,*(char))->(void)
(	O
'h'	O
,	O
5	int
,	O
"expand_string.c:expand_string Returning string %s\n"	*(char)
,	O
output_buffer	*(char)
)	O
;	O
return	O
output_buffer	*(char)
;	O
}	O
char	O
*	O
expand_character	(char,enum(int,int,int))->(*(char))
(	O
char	O
character	char
,	O
boolean	enum(int,int,int)
index_page	enum(int,int,int)
)	O
{	O
static	O
char	O
*	O
output_buffer	*(char)
=	O
NULL	O
;	O
static	O
struct	O
tm	struct(int,int,int,int,int,int,int,int,int,long,*(char))
*	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
=	O
NULL	O
;	O
static	O
char	O
*	O
daynames	array(*(char))
[	O
]	O
=	O
{	O
"Sun"	*(char)
,	O
"Mon"	*(char)
,	O
"Tue"	*(char)
,	O
"Wed"	*(char)
,	O
"Thu"	*(char)
,	O
"Fri"	*(char)
,	O
"Sat"	*(char)
}	O
;	O
static	O
char	O
*	O
monnames	array(*(char))
[	O
]	O
=	O
{	O
"Jan"	*(char)
,	O
"Feb"	*(char)
,	O
"Mar"	*(char)
,	O
"Apr"	*(char)
,	O
"May"	*(char)
,	O
"Jun"	*(char)
,	O
"Jul"	*(char)
,	O
"Aug"	*(char)
,	O
"Sep"	*(char)
,	O
"Oct"	*(char)
,	O
"Nov"	*(char)
,	O
"Dec"	*(char)
}	O
;	O
struct	O
tm	struct(int,int,int,int,int,int,int,int,int,long,*(char))
*	O
ft	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
;	O
if	O
(	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
==	O
NULL	O
)	O
{	O
time_t	long
now	long
;	O
if	O
(	O
!	O
use_environment	enum(int,int,int)
)	O
{	O
now	long
=	O
387774000	int
;	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
=	O
gmtime	(*(long))->(*(struct(int,int,int,int,int,int,int,int,int,long,*(char))))
(	O
&	O
now	long
)	O
;	O
}	O
else	O
{	O
now	long
=	O
time	(*(long))->(long)
(	O
(	O
time_t	long
*	O
)	O
NULL	O
)	O
;	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
=	O
localtime	(*(long))->(*(struct(int,int,int,int,int,int,int,int,int,long,*(char))))
(	O
&	O
now	long
)	O
;	O
}	O
}	O
if	O
(	O
output_buffer	*(char)
==	O
NULL	O
)	O
output_buffer	*(char)
=	O
xmalloc	(long)->(*(void))
(	O
100	int
)	O
;	O
*	O
output_buffer	*(char)
=	O
'\0'	O
;	O
switch	O
(	O
character	char
)	O
{	O
case	O
'%'	O
:	O
return	O
"%"	*(char)
;	O
case	O
'm'	O
:	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%02d"	*(char)
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_mon	int
+	O
1	int
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'd'	O
:	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%02d"	*(char)
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_mday	int
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'y'	O
:	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%4d"	*(char)
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_year	int
+	O
1900	int
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'D'	O
:	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%02d/%02d/%02d"	*(char)
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_mon	int
+	O
1	int
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_mday	int
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_year	int
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'L'	O
:	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%s %s %02d %02d:%02d:%02d %4d"	*(char)
,	O
daynames	array(*(char))
[	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_wday	int
]	O
,	O
monnames	array(*(char))
[	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_mon	int
]	O
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_mday	int
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_hour	int
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_min	int
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_sec	int
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_year	int
+	O
1900	int
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'H'	O
:	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%02d"	*(char)
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_hour	int
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'M'	O
:	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%02d"	*(char)
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_min	int
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'S'	O
:	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%02d"	*(char)
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_sec	int
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'T'	O
:	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%02d:%02d:%02d"	*(char)
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_hour	int
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_min	int
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_sec	int
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'j'	O
:	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%3d"	*(char)
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_yday	int
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'w'	O
:	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%d"	*(char)
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_wday	int
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'a'	O
:	O
return	O
daynames	array(*(char))
[	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_wday	int
]	O
;	O
case	O
'h'	O
:	O
return	O
monnames	array(*(char))
[	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_mon	int
]	O
;	O
case	O
'r'	O
:	O
if	O
(	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_hour	int
>	O
12	int
)	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%02d:%02dpm"	*(char)
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_hour	int
-	O
12	int
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_min	int
)	O
;	O
else	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%02d:%02dam"	*(char)
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_hour	int
,	O
t	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_min	int
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'p'	O
:	O
if	O
(	O
index_page	enum(int,int,int)
)	O
return	O
""	*(char)
;	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%ld"	*(char)
,	O
file_page_number	long
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'P'	O
:	O
if	O
(	O
index_page	enum(int,int,int)
)	O
return	O
""	*(char)
;	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%ld"	*(char)
,	O
page_number	long
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'f'	O
:	O
if	O
(	O
index_page	enum(int,int,int)
)	O
return	O
""	*(char)
;	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%ld"	*(char)
,	O
get_file_last_page	(int)->(long)
(	O
file_number	int
)	O
-	O
get_file_first_page	(int)->(long)
(	O
file_number	int
)	O
+	O
1	int
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'c'	O
:	O
if	O
(	O
index_page	enum(int,int,int)
)	O
return	O
""	*(char)
;	O
ft	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
=	O
get_file_modified_time	(int)->(*(struct(int,int,int,int,int,int,int,int,int,long,*(char))))
(	O
file_number	int
)	O
;	O
if	O
(	O
ft	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
==	O
NULL	O
)	O
return	O
""	*(char)
;	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%02d/%02d/%02d"	*(char)
,	O
ft	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_mon	int
+	O
1	int
,	O
ft	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_mday	int
,	O
ft	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_year	int
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'C'	O
:	O
if	O
(	O
index_page	enum(int,int,int)
)	O
return	O
""	*(char)
;	O
ft	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
=	O
get_file_modified_time	(int)->(*(struct(int,int,int,int,int,int,int,int,int,long,*(char))))
(	O
file_number	int
)	O
;	O
if	O
(	O
ft	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
==	O
NULL	O
)	O
return	O
""	*(char)
;	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%s %s %02d %02d:%02d:%02d %4d"	*(char)
,	O
daynames	array(*(char))
[	O
ft	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_wday	int
]	O
,	O
monnames	array(*(char))
[	O
ft	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_mon	int
]	O
,	O
ft	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_mday	int
,	O
ft	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_hour	int
,	O
ft	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_min	int
,	O
ft	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_sec	int
,	O
ft	*(struct(int,int,int,int,int,int,int,int,int,long,*(char)))
->	O
tm_year	int
+	O
1900	int
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'F'	O
:	O
if	O
(	O
index_page	enum(int,int,int)
)	O
return	O
""	*(char)
;	O
sprintf	(*(char),*(char))->(int)
(	O
output_buffer	*(char)
,	O
"%ld"	*(char)
,	O
total_pages	long
)	O
;	O
return	O
output_buffer	*(char)
;	O
case	O
'n'	O
:	O
if	O
(	O
index_page	enum(int,int,int)
)	O
return	O
""	*(char)
;	O
return	O
file_name	(int)->(*(char))
(	O
file_number	int
)	O
;	O
case	O
'N'	O
:	O
if	O
(	O
index_page	enum(int,int,int)
)	O
return	O
""	*(char)
;	O
return	O
get_function_name	(long)->(*(char))
(	O
page_number	long
)	O
;	O
case	O
'l'	O
:	O
if	O
(	O
!	O
use_environment	enum(int,int,int)
)	O
return	O
"testuser"	*(char)
;	O
{	O
char	O
*	O
u	*(char)
=	O
getenv	(*(char))->(*(char))
(	O
"USER"	*(char)
)	O
;	O
if	O
(	O
u	*(char)
==	O
0	int
)	O
return	O
""	*(char)
;	O
else	O
return	O
u	*(char)
;	O
}	O
default	O
:	O
return	O
"?"	*(char)
;	O
}	O
}	O
static	O
void	O
add_string	(*(*(char)),*(char),*(long))->(void)
(	O
char	O
*	O
*	O
buffer_ptr	*(*(char))
,	O
char	O
*	O
string	*(char)
,	O
size_t	long
*	O
bufflen_ptr	*(long)
)	O
{	O
size_t	long
required_length	long
;	O
required_length	long
=	O
strlen	(*(char))->(long)
(	O
*	O
buffer_ptr	*(*(char))
)	O
+	O
strlen	(*(char))->(long)
(	O
string	*(char)
)	O
+	O
1	int
;	O
if	O
(	O
required_length	long
>	O
*	O
bufflen_ptr	*(long)
)	O
{	O
*	O
buffer_ptr	*(*(char))
=	O
xrealloc	(*(void),long)->(*(void))
(	O
*	O
buffer_ptr	*(*(char))
,	O
required_length	long
)	O
;	O
*	O
bufflen_ptr	*(long)
=	O
required_length	long
;	O
}	O
strcat	(*(char),*(char))->(*(char))
(	O
*	O
buffer_ptr	*(*(char))
,	O
string	*(char)
)	O
;	O
return	O
;	O
}	O
static	O
void	O
add_character	(*(*(char)),char,*(long))->(void)
(	O
char	O
*	O
*	O
buffer_ptr	*(*(char))
,	O
char	O
character	char
,	O
size_t	long
*	O
bufflen_ptr	*(long)
)	O
{	O
size_t	long
required_length	long
;	O
required_length	long
=	O
strlen	(*(char))->(long)
(	O
*	O
buffer_ptr	*(*(char))
)	O
+	O
2	int
;	O
if	O
(	O
required_length	long
>	O
*	O
bufflen_ptr	*(long)
)	O
{	O
*	O
buffer_ptr	*(*(char))
=	O
xrealloc	(*(void),long)->(*(void))
(	O
*	O
buffer_ptr	*(*(char))
,	O
required_length	long
)	O
;	O
*	O
bufflen_ptr	*(long)
=	O
required_length	long
;	O
}	O
(	O
*	O
buffer_ptr	*(*(char))
)	O
[	O
required_length	long
-	O
1	int
]	O
=	O
'\0'	O
;	O
(	O
*	O
buffer_ptr	*(*(char))
)	O
[	O
required_length	long
-	O
2	int
]	O
=	O
character	char
;	O
return	O
;	O
}	O
