const	O
char	O
proti_rcsid	array(char)
[	O
]	O
=	O
"$Id: proti.c,v 1.36 2002/03/05 19:10:41 ian Rel $"	*(char)
;	O
static	O
int	O
iIrequest_packsize	int
=	O
IREQUEST_PACKSIZE	O
;	O
static	O
int	O
iIrequest_winsize	int
=	O
IREQUEST_WINSIZE	O
;	O
static	O
int	O
iIremote_packsize	int
;	O
static	O
int	O
iIalc_packsize	int
;	O
static	O
int	O
iIforced_remote_packsize	int
=	O
0	int
;	O
static	O
int	O
iIremote_winsize	int
;	O
int	O
cIsync_timeout	int
=	O
CSYNC_TIMEOUT	O
;	O
static	O
int	O
cIsync_retries	int
=	O
CSYNC_RETRIES	O
;	O
static	O
int	O
cItimeout	int
=	O
CTIMEOUT	O
;	O
static	O
int	O
cIwindow_timeout	int
=	O
CTIMEOUT	O
;	O
static	O
int	O
cIretries	int
=	O
CRETRIES	O
;	O
static	O
int	O
cIerrors	int
=	O
CERRORS	O
;	O
static	O
int	O
cIerror_decay	int
=	O
CERROR_DECAY	O
;	O
static	O
int	O
cIack_frequency	int
=	O
0	int
;	O
const	O
char	O
*	O
zJavoid_parameter	*(char)
=	O
ZAVOID	*(char)
;	O
static	O
boolean	int
(	O
*	O
pfIsend	*((*(struct(*(struct`),*(void),*(struct`))),*(char),long,int)->(int))
)	O
P	O
(	O
(	O
struct	O
sconnection	struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct(int,*(struct`))),int,*(char),*(void),union(struct(int),struct(*(char),*(char),long,long,long,int,int,*(*`),*(struct`)),struct(*(char),long,int,int),struct(*(char),int,*(*`)),struct(*(char),int,*(*`),*(*`),*(char)),struct(*(*`))))))
*	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
,	O
const	O
char	O
*	O
zsend	*(char)
,	O
size_t	long
csend	long
,	O
boolean	int
fdoread	int
)	O
)	O
;	O
static	O
boolean	int
(	O
*	O
pfIreceive	*((*(struct(*(struct`),*(void),*(struct`))),long,*(long),int,int)->(int))
)	O
P	O
(	O
(	O
struct	O
sconnection	struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct(int,*(struct`))),int,*(char),*(void),union(struct(int),struct(*(char),*(char),long,long,long,int,int,*(*`),*(struct`)),struct(*(char),long,int,int),struct(*(char),int,*(*`)),struct(*(char),int,*(*`),*(*`),*(char)),struct(*(*`))))))
*	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
,	O
size_t	long
cneed	long
,	O
size_t	long
*	O
pcrec	*(long)
,	O
int	O
ctimeout	int
,	O
boolean	int
freport	int
)	O
)	O
;	O
static	O
int	O
iIsendseq	int
;	O
static	O
int	O
iIrecseq	int
;	O
static	O
int	O
iIlocal_ack	int
;	O
static	O
int	O
iIremote_ack	int
;	O
static	O
long	O
iIsendpos	long
;	O
static	O
long	O
iIrecpos	long
;	O
static	O
boolean	int
fIclosing	int
;	O
static	O
char	O
*	O
azIsendbuffers	array(*(char))
[	O
IMAXSEQ	int
]	O
;	O
static	O
char	O
*	O
azIrecbuffers	array(*(char))
[	O
IMAXSEQ	int
]	O
;	O
static	O
boolean	int
afInaked	array(int)
[	O
IMAXSEQ	int
]	O
;	O
static	O
int	O
cIsyncs	int
;	O
static	O
long	O
cIsent_packets	long
;	O
static	O
long	O
cIreceived_packets	long
;	O
static	O
long	O
cIresent_packets	long
;	O
static	O
long	O
cIbad_hdr	long
;	O
static	O
long	O
cIbad_order	long
;	O
static	O
long	O
cIbad_cksum	long
;	O
static	O
long	O
cIremote_rejects	long
;	O
struct	O
uuconf_cmdtab	struct(*(char),int,*(void),*((*(void),int,*(*(char)),*(void),*(void))->(int)))
asIproto_params	array(struct(*(char),int,*(void),*((*(void),int,*(*(char)),*(void),*(void))->(int))))
[	O
]	O
=	O
{	O
{	O
"packet-size"	*(char)
,	O
UUCONF_CMDTABTYPE_INT	O
,	O
(	O
pointer	*(void)
)	O
&	O
iIrequest_packsize	int
,	O
NULL	O
}	O
,	O
{	O
"window"	*(char)
,	O
UUCONF_CMDTABTYPE_INT	O
,	O
(	O
pointer	*(void)
)	O
&	O
iIrequest_winsize	int
,	O
NULL	O
}	O
,	O
{	O
"remote-packet-size"	*(char)
,	O
UUCONF_CMDTABTYPE_INT	O
,	O
(	O
pointer	*(void)
)	O
&	O
iIforced_remote_packsize	int
,	O
NULL	O
}	O
,	O
{	O
"sync-timeout"	*(char)
,	O
UUCONF_CMDTABTYPE_INT	O
,	O
(	O
pointer	*(void)
)	O
&	O
cIsync_timeout	int
,	O
NULL	O
}	O
,	O
{	O
"sync-retries"	*(char)
,	O
UUCONF_CMDTABTYPE_INT	O
,	O
(	O
pointer	*(void)
)	O
&	O
cIsync_retries	int
,	O
NULL	O
}	O
,	O
{	O
"timeout"	*(char)
,	O
UUCONF_CMDTABTYPE_INT	O
,	O
(	O
pointer	*(void)
)	O
&	O
cItimeout	int
,	O
NULL	O
}	O
,	O
{	O
"retries"	*(char)
,	O
UUCONF_CMDTABTYPE_INT	O
,	O
(	O
pointer	*(void)
)	O
&	O
cIretries	int
,	O
NULL	O
}	O
,	O
{	O
"errors"	*(char)
,	O
UUCONF_CMDTABTYPE_INT	O
,	O
(	O
pointer	*(void)
)	O
&	O
cIerrors	int
,	O
NULL	O
}	O
,	O
{	O
"error-decay"	*(char)
,	O
UUCONF_CMDTABTYPE_INT	O
,	O
(	O
pointer	*(void)
)	O
&	O
cIerror_decay	int
,	O
NULL	O
}	O
,	O
{	O
"ack-frequency"	*(char)
,	O
UUCONF_CMDTABTYPE_INT	O
,	O
(	O
pointer	*(void)
)	O
&	O
cIack_frequency	int
,	O
NULL	O
}	O
,	O
{	O
"avoid"	*(char)
,	O
UUCONF_CMDTABTYPE_STRING	O
,	O
(	O
pointer	*(void)
)	O
&	O
zJavoid_parameter	*(char)
,	O
NULL	O
}	O
,	O
{	O
NULL	O
,	O
0	int
,	O
NULL	O
,	O
NULL	O
}	O
}	O
;	O
static	O
boolean	int
finak	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),int)->(int)
P	O
(	O
(	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
int	O
iseq	int
)	O
)	O
;	O
static	O
boolean	int
firesend	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)))->(int)
P	O
(	O
(	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
)	O
)	O
;	O
static	O
boolean	int
fiwindow_wait	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)))->(int)
P	O
(	O
(	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
)	O
)	O
;	O
static	O
boolean	int
fiwait_for_packet	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),int,int,int,*(int))->(int)
P	O
(	O
(	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
int	O
ctimeout	int
,	O
int	O
cretries	int
,	O
boolean	int
fone	int
,	O
boolean	int
*	O
ftimedout	*(int)
)	O
)	O
;	O
static	O
boolean	int
ficheck_errors	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)))->(int)
P	O
(	O
(	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
)	O
)	O
;	O
static	O
boolean	int
fiprocess_data	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(int),*(int),*(long))->(int)
P	O
(	O
(	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
boolean	int
*	O
pfexit	*(int)
,	O
boolean	int
*	O
pffound	*(int)
,	O
size_t	long
*	O
pcneed	*(long)
)	O
)	O
;	O
static	O
boolean	int
fiprocess_packet	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(char),*(char),int,*(char),int,*(int))->(int)
P	O
(	O
(	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
const	O
char	O
*	O
zhdr	*(char)
,	O
const	O
char	O
*	O
zfirst	*(char)
,	O
int	O
cfirst	long
,	O
const	O
char	O
*	O
zsecond	*(char)
,	O
int	O
csecond	long
,	O
boolean	int
*	O
pfexit	*(int)
)	O
)	O
;	O
boolean	int
fistart	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(*(char)))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
pzlog	*(*(char))
)	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
;	O
char	O
*	O
*	O
pzlog	*(*(char))
;	O
{	O
return	O
fijstart	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(*(char)),int,*((*(struct(*`,*`,*`)),*(char),long,int)->(int)),*((*(struct(*`,*`,*`)),long,*(long),int,int)->(int)))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
pzlog	*(*(char))
,	O
IMAXPACKSIZE	O
,	O
fsend_data	(*(struct(*(struct(*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`)),*(void),*(struct(*`,enum(int,int,int,int,int,int,int),*`,*`,int,*`,*`,union`)))),*(char),long,int)->(int)
,	O
freceive_data	(*(struct(*(struct(*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`)),*(void),*(struct(*`,enum(int,int,int,int,int,int,int),*`,*`,int,*`,*`,union`)))),long,*(long),int,int)->(int)
)	O
;	O
}	O
boolean	int
fijstart	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(*(char)),int,*((*(struct(*`,*`,*`)),*(char),long,int)->(int)),*((*(struct(*`,*`,*`)),long,*(long),int,int)->(int)))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
pzlog	*(*(char))
,	O
imaxpacksize	int
,	O
pfsend	*((*(struct(*(struct`),*(void),*(struct`))),*(char),long,int)->(int))
,	O
pfreceive	*((*(struct(*(struct`),*(void),*(struct`))),long,*(long),int,int)->(int))
)	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
;	O
char	O
*	O
*	O
pzlog	*(*(char))
;	O
int	O
imaxpacksize	int
;	O
boolean	int
(	O
*	O
pfsend	*((*(struct(*(struct`),*(void),*(struct`))),*(char),long,int)->(int))
)	O
P	O
(	O
(	O
struct	O
sconnection	struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct(int,*(struct`))),int,*(char),*(void),union(struct(int),struct(*(char),*(char),long,long,long,int,int,*(*`),*(struct`)),struct(*(char),long,int,int),struct(*(char),int,*(*`)),struct(*(char),int,*(*`),*(*`),*(char)),struct(*(*`))))))
*	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
,	O
const	O
char	O
*	O
zsend	*(char)
,	O
size_t	long
csend	long
,	O
boolean	int
fdoread	int
)	O
)	O
;	O
boolean	int
(	O
*	O
pfreceive	*((*(struct(*(struct`),*(void),*(struct`))),long,*(long),int,int)->(int))
)	O
P	O
(	O
(	O
struct	O
sconnection	struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct(int,*(struct`))),int,*(char),*(void),union(struct(int),struct(*(char),*(char),long,long,long,int,int,*(*`),*(struct`)),struct(*(char),long,int,int),struct(*(char),int,*(*`)),struct(*(char),int,*(*`),*(*`),*(char)),struct(*(*`))))))
*	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
,	O
size_t	long
cneed	long
,	O
size_t	long
*	O
pcrec	*(long)
,	O
int	O
ctimeout	int
,	O
boolean	int
freport	int
)	O
)	O
;	O
{	O
char	O
ab	array(char)
[	O
CHDRLEN	O
+	O
4	int
+	O
CCKSUMLEN	O
]	O
;	O
unsigned	O
long	O
icksum	long
;	O
int	O
ctries	int
;	O
int	O
csyncs	int
;	O
long	O
ibaud	long
;	O
*	O
pzlog	*(*(char))
=	O
NULL	O
;	O
pfIsend	*((*(struct(*(struct`),*(void),*(struct`))),*(char),long,int)->(int))
=	O
pfsend	*((*(struct(*(struct`),*(void),*(struct`))),*(char),long,int)->(int))
;	O
pfIreceive	*((*(struct(*(struct`),*(void),*(struct`))),long,*(long),int,int)->(int))
=	O
pfreceive	*((*(struct(*(struct`),*(void),*(struct`))),long,*(long),int,int)->(int))
;	O
if	O
(	O
iIforced_remote_packsize	int
<=	O
0	int
||	O
iIforced_remote_packsize	int
>	O
imaxpacksize	int
)	O
iIforced_remote_packsize	int
=	O
0	int
;	O
else	O
iIremote_packsize	int
=	O
iIforced_remote_packsize	int
;	O
iIalc_packsize	int
=	O
0	int
;	O
iIsendseq	int
=	O
1	int
;	O
iIrecseq	int
=	O
0	int
;	O
iIlocal_ack	int
=	O
0	int
;	O
iIremote_ack	int
=	O
0	int
;	O
iIsendpos	long
=	O
0	int
;	O
iIrecpos	long
=	O
0	int
;	O
fIclosing	int
=	O
FALSE	O
;	O
cIsent_packets	long
=	O
0	int
;	O
cIreceived_packets	long
=	O
0	int
;	O
cIresent_packets	long
=	O
0	int
;	O
cIbad_hdr	long
=	O
0	int
;	O
cIbad_order	long
=	O
0	int
;	O
cIbad_cksum	long
=	O
0	int
;	O
cIremote_rejects	long
=	O
0	int
;	O
if	O
(	O
iIrequest_packsize	int
<	O
0	int
||	O
iIrequest_packsize	int
>	O
imaxpacksize	int
)	O
{	O
ulog	(enum(int,int,int,int,int,int,int),*(char))->(void)
(	O
LOG_ERROR	int
,	O
"Illegal protocol '%c' packet size; using %d"	*(char)
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qproto	*(struct)
->	O
bname	char
,	O
imaxpacksize	int
)	O
;	O
iIrequest_packsize	int
=	O
imaxpacksize	int
;	O
}	O
if	O
(	O
iIrequest_winsize	int
<	O
0	int
||	O
iIrequest_winsize	int
>	O
IMAXSEQ	int
/	O
2	int
)	O
{	O
ulog	(enum(int,int,int,int,int,int,int),*(char))->(void)
(	O
LOG_ERROR	int
,	O
"Illegal protocol '%c' window size; using %d"	*(char)
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qproto	*(struct)
->	O
bname	char
,	O
IREQUEST_WINSIZE	O
)	O
;	O
iIrequest_winsize	int
=	O
IREQUEST_WINSIZE	O
;	O
}	O
if	O
(	O
cIack_frequency	int
<=	O
0	int
||	O
cIack_frequency	int
>=	O
iIrequest_winsize	int
)	O
cIack_frequency	int
=	O
iIrequest_winsize	int
/	O
2	int
;	O
ab	array(char)
[	O
IHDR_INTRO	O
]	O
=	O
IINTRO	O
;	O
ab	array(char)
[	O
IHDR_LOCAL	O
]	O
=	O
ab	array(char)
[	O
IHDR_REMOTE	O
]	O
=	O
IHDRWIN_SET	O
(	O
0	int
,	O
0	int
)	O
;	O
ab	array(char)
[	O
IHDR_CONTENTS1	O
]	O
=	O
IHDRCON_SET1	O
(	O
SYNC	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
4	int
)	O
;	O
ab	array(char)
[	O
IHDR_CONTENTS2	O
]	O
=	O
IHDRCON_SET2	O
(	O
SYNC	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
4	int
)	O
;	O
ab	array(char)
[	O
IHDR_CHECK	O
]	O
=	O
IHDRCHECK_VAL	O
(	O
ab	array(char)
)	O
;	O
ab	array(char)
[	O
CHDRLEN	O
+	O
0	int
]	O
=	O
(	O
iIrequest_packsize	int
>>	O
8	int
)	O
&	O
0xff	int
;	O
ab	array(char)
[	O
CHDRLEN	O
+	O
1	int
]	O
=	O
iIrequest_packsize	int
&	O
0xff	int
;	O
ab	array(char)
[	O
CHDRLEN	O
+	O
2	int
]	O
=	O
iIrequest_winsize	int
;	O
ab	array(char)
[	O
CHDRLEN	O
+	O
3	int
]	O
=	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
cchans	int
;	O
icksum	long
=	O
icrc	(*(char),long,long)->(long)
(	O
ab	array(char)
+	O
CHDRLEN	O
,	O
4	int
,	O
ICRCINIT	O
)	O
;	O
UCKSUM_SET	O
(	O
ab	array(char)
+	O
CHDRLEN	O
+	O
4	int
,	O
icksum	long
)	O
;	O
csyncs	int
=	O
cIsyncs	int
;	O
ctries	int
=	O
0	int
;	O
while	O
(	O
TRUE	O
)	O
{	O
boolean	int
ftimedout	*(int)
;	O
DEBUG_MESSAGE3	O
(	O
DEBUG_PROTO	O
,	O
"fistart: Sending SYNC packsize %d winsize %d channels %d"	*(char)
,	O
iIrequest_packsize	int
,	O
iIrequest_winsize	int
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
cchans	int
)	O
;	O
if	O
(	O
!	O
(	O
*	O
pfIsend	*((*(struct(*(struct`),*(void),*(struct`))),*(char),long,int)->(int))
)	O
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
,	O
ab	array(char)
,	O
CHDRLEN	O
+	O
4	int
+	O
CCKSUMLEN	O
,	O
TRUE	O
)	O
)	O
return	O
FALSE	O
;	O
if	O
(	O
fiwait_for_packet	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),int,int,int,*(int))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
cIsync_timeout	int
,	O
0	int
,	O
FALSE	O
,	O
&	O
ftimedout	*(int)
)	O
)	O
{	O
if	O
(	O
csyncs	int
!=	O
cIsyncs	int
)	O
break	O
;	O
}	O
else	O
{	O
if	O
(	O
!	O
ftimedout	*(int)
)	O
return	O
FALSE	O
;	O
++	O
ctries	int
;	O
if	O
(	O
ctries	int
>	O
cIsync_retries	int
)	O
{	O
ulog	(enum(int,int,int,int,int,int,int),*(char))->(void)
(	O
LOG_ERROR	int
,	O
"Protocol startup failed"	*(char)
)	O
;	O
return	O
FALSE	O
;	O
}	O
}	O
}	O
ibaud	long
=	O
iconn_baud	(*(struct(*(struct(*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`)),*(void),*(struct(*`,enum(int,int,int,int,int,int,int),*`,*`,int,*`,*`,union`)))))->(long)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
)	O
;	O
if	O
(	O
ibaud	long
==	O
0	int
)	O
cIwindow_timeout	int
=	O
cItimeout	int
;	O
else	O
{	O
cIwindow_timeout	int
=	O
(	O
(	O
5	int
*	O
iIremote_packsize	int
*	O
iIremote_winsize	int
)	O
/	O
ibaud	long
+	O
cItimeout	int
)	O
;	O
}	O
if	O
(	O
!	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
)	O
{	O
++	O
cItimeout	int
;	O
++	O
cIwindow_timeout	int
;	O
}	O
if	O
(	O
iIremote_packsize	int
>	O
imaxpacksize	int
)	O
iIremote_packsize	int
=	O
imaxpacksize	int
;	O
do	O
{	O
int	O
iseq	int
;	O
for	O
(	O
iseq	int
=	O
0	int
;	O
iseq	int
<	O
IMAXSEQ	int
;	O
iseq	int
++	O
)	O
{	O
azIrecbuffers	array(*(char))
[	O
iseq	int
]	O
=	O
NULL	O
;	O
afInaked	array(int)
[	O
iseq	int
]	O
=	O
FALSE	O
;	O
azIsendbuffers	array(*(char))
[	O
iseq	int
]	O
=	O
(	O
char	O
*	O
)	O
malloc	(long)->(*(void))
(	O
iIremote_packsize	int
+	O
CHDRSKIPLEN	O
+	O
CCKSUMLEN	O
)	O
;	O
if	O
(	O
azIsendbuffers	array(*(char))
[	O
iseq	int
]	O
==	O
NULL	O
)	O
{	O
int	O
ifree	int
;	O
for	O
(	O
ifree	int
=	O
0	int
;	O
ifree	int
<	O
iseq	int
;	O
ifree	int
++	O
)	O
free	(*(void))->(void)
(	O
(	O
pointer	*(void)
)	O
azIsendbuffers	array(*(char))
[	O
ifree	int
]	O
)	O
;	O
break	O
;	O
}	O
}	O
if	O
(	O
iseq	int
>=	O
IMAXSEQ	int
)	O
{	O
*	O
pzlog	*(*(char))
=	O
zbufalc	(long)->(*(char))
(	O
sizeof	O
"protocol '' sending packet/window / receiving /"	*(char)
+	O
64	int
)	O
;	O
sprintf	(*(char),*(char))->(int)
(	O
*	O
pzlog	*(*(char))
,	O
"protocol '%c' sending packet/window %d/%d receiving %d/%d"	*(char)
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qproto	*(struct)
->	O
bname	char
,	O
(	O
int	O
)	O
iIremote_packsize	int
,	O
(	O
int	O
)	O
iIremote_winsize	int
,	O
(	O
int	O
)	O
iIrequest_packsize	int
,	O
(	O
int	O
)	O
iIrequest_winsize	int
)	O
;	O
iIalc_packsize	int
=	O
iIremote_packsize	int
;	O
return	O
TRUE	O
;	O
}	O
iIremote_packsize	int
>>=	O
1	int
;	O
}	O
while	O
(	O
iIremote_packsize	int
>	O
200	int
)	O
;	O
ulog	(enum(int,int,int,int,int,int,int),*(char))->(void)
(	O
LOG_ERROR	int
,	O
"'%c' protocol startup failed; insufficient memory for packets"	*(char)
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qproto	*(struct)
->	O
bname	char
)	O
;	O
return	O
FALSE	O
;	O
}	O
boolean	int
fishutdown	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
)	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
;	O
{	O
char	O
*	O
z	*(char)
;	O
size_t	long
clen	long
;	O
fIclosing	int
=	O
TRUE	O
;	O
z	*(char)
=	O
zigetspace	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(long))->(*(char))
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
&	O
clen	long
)	O
-	O
CHDRLEN	O
;	O
z	*(char)
[	O
IHDR_INTRO	O
]	O
=	O
IINTRO	O
;	O
z	*(char)
[	O
IHDR_LOCAL	O
]	O
=	O
IHDRWIN_SET	O
(	O
iIsendseq	int
,	O
0	int
)	O
;	O
z	*(char)
[	O
IHDR_REMOTE	O
]	O
=	O
IHDRWIN_SET	O
(	O
iIrecseq	int
,	O
0	int
)	O
;	O
iIlocal_ack	int
=	O
iIrecseq	int
;	O
z	*(char)
[	O
IHDR_CONTENTS1	O
]	O
=	O
IHDRCON_SET1	O
(	O
CLOSE	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
0	int
)	O
;	O
z	*(char)
[	O
IHDR_CONTENTS2	O
]	O
=	O
IHDRCON_SET2	O
(	O
CLOSE	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
0	int
)	O
;	O
z	*(char)
[	O
IHDR_CHECK	O
]	O
=	O
IHDRCHECK_VAL	O
(	O
z	*(char)
)	O
;	O
DEBUG_MESSAGE0	O
(	O
DEBUG_PROTO	O
,	O
"fishutdown: Sending CLOSE"	*(char)
)	O
;	O
if	O
(	O
!	O
(	O
*	O
pfIsend	*((*(struct(*(struct`),*(void),*(struct`))),*(char),long,int)->(int))
)	O
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
,	O
z	*(char)
,	O
CHDRLEN	O
,	O
FALSE	O
)	O
)	O
return	O
FALSE	O
;	O
ulog	(enum(int,int,int,int,int,int,int),*(char))->(void)
(	O
LOG_NORMAL	int
,	O
"Protocol '%c' packets: sent %ld, resent %ld, received %ld"	*(char)
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qproto	*(struct)
->	O
bname	char
,	O
cIsent_packets	long
,	O
cIresent_packets	long
,	O
cIreceived_packets	long
)	O
;	O
if	O
(	O
cIbad_hdr	long
!=	O
0	int
||	O
cIbad_cksum	long
!=	O
0	int
||	O
cIbad_order	long
!=	O
0	int
||	O
cIremote_rejects	long
!=	O
0	int
)	O
ulog	(enum(int,int,int,int,int,int,int),*(char))->(void)
(	O
LOG_NORMAL	int
,	O
"Errors: header %ld, checksum %ld, order %ld, remote rejects %ld"	*(char)
,	O
cIbad_hdr	long
,	O
cIbad_cksum	long
,	O
cIbad_order	long
,	O
cIremote_rejects	long
)	O
;	O
iIrequest_packsize	int
=	O
IREQUEST_PACKSIZE	O
;	O
iIrequest_winsize	int
=	O
IREQUEST_WINSIZE	O
;	O
iIforced_remote_packsize	int
=	O
0	int
;	O
cIsync_timeout	int
=	O
CSYNC_TIMEOUT	O
;	O
cIsync_retries	int
=	O
CSYNC_RETRIES	O
;	O
cItimeout	int
=	O
CTIMEOUT	O
;	O
cIwindow_timeout	int
=	O
CTIMEOUT	O
;	O
cIretries	int
=	O
CRETRIES	O
;	O
cIerrors	int
=	O
CERRORS	O
;	O
cIerror_decay	int
=	O
CERROR_DECAY	O
;	O
cIack_frequency	int
=	O
0	int
;	O
zJavoid_parameter	*(char)
=	O
ZAVOID	*(char)
;	O
return	O
TRUE	O
;	O
}	O
boolean	int
fisendcmd	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(char),int,int)->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
z	*(char)
,	O
ilocal	int
,	O
iremote	int
)	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
;	O
const	O
char	O
*	O
z	*(char)
;	O
int	O
ilocal	int
;	O
int	O
iremote	int
;	O
{	O
size_t	long
clen	long
;	O
DEBUG_MESSAGE1	O
(	O
DEBUG_UUCP_PROTO	O
,	O
"fisendcmd: Sending command \"%s\""	*(char)
,	O
z	*(char)
)	O
;	O
clen	long
=	O
strlen	(*(char))->(long)
(	O
z	*(char)
)	O
;	O
while	O
(	O
TRUE	O
)	O
{	O
char	O
*	O
zpacket	*(char)
;	O
size_t	long
csize	long
;	O
zpacket	*(char)
=	O
zigetspace	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(long))->(*(char))
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
&	O
csize	long
)	O
;	O
if	O
(	O
clen	long
<	O
csize	long
)	O
{	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
zpacket	*(char)
,	O
z	*(char)
,	O
clen	long
+	O
1	int
)	O
;	O
return	O
fisenddata	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(char),long,int,int,long)->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
zpacket	*(char)
,	O
clen	long
+	O
1	int
,	O
ilocal	int
,	O
iremote	int
,	O
(	O
long	O
)	O
-	O
1	int
)	O
;	O
}	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
zpacket	*(char)
,	O
z	*(char)
,	O
csize	long
)	O
;	O
z	*(char)
+=	O
csize	long
;	O
clen	long
-=	O
csize	long
;	O
if	O
(	O
!	O
fisenddata	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(char),long,int,int,long)->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
zpacket	*(char)
,	O
csize	long
,	O
ilocal	int
,	O
iremote	int
,	O
(	O
long	O
)	O
-	O
1	int
)	O
)	O
return	O
FALSE	O
;	O
}	O
}	O
static	O
boolean	int
finak	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),int)->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
iseq	int
)	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
;	O
int	O
iseq	int
;	O
{	O
char	O
abnak	array(char)
[	O
CHDRLEN	O
]	O
;	O
abnak	array(char)
[	O
IHDR_INTRO	O
]	O
=	O
IINTRO	O
;	O
abnak	array(char)
[	O
IHDR_LOCAL	O
]	O
=	O
IHDRWIN_SET	O
(	O
iseq	int
,	O
0	int
)	O
;	O
abnak	array(char)
[	O
IHDR_REMOTE	O
]	O
=	O
IHDRWIN_SET	O
(	O
iIrecseq	int
,	O
0	int
)	O
;	O
iIlocal_ack	int
=	O
iIrecseq	int
;	O
abnak	array(char)
[	O
IHDR_CONTENTS1	O
]	O
=	O
IHDRCON_SET1	O
(	O
NAK	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
0	int
)	O
;	O
abnak	array(char)
[	O
IHDR_CONTENTS2	O
]	O
=	O
IHDRCON_SET2	O
(	O
NAK	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
0	int
)	O
;	O
abnak	array(char)
[	O
IHDR_CHECK	O
]	O
=	O
IHDRCHECK_VAL	O
(	O
abnak	array(char)
)	O
;	O
afInaked	array(int)
[	O
iseq	int
]	O
=	O
TRUE	O
;	O
DEBUG_MESSAGE1	O
(	O
DEBUG_PROTO	O
|	O
DEBUG_ABNORMAL	O
,	O
"finak: Sending NAK %d"	*(char)
,	O
iseq	int
)	O
;	O
return	O
(	O
*	O
pfIsend	*((*(struct(*(struct`),*(void),*(struct`))),*(char),long,int)->(int))
)	O
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
,	O
abnak	array(char)
,	O
CHDRLEN	O
,	O
TRUE	O
)	O
;	O
}	O
static	O
boolean	int
firesend	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
)	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
;	O
{	O
int	O
iseq	int
;	O
char	O
*	O
zhdr	*(char)
;	O
size_t	long
clen	long
;	O
iseq	int
=	O
INEXTSEQ	O
(	O
iIremote_ack	int
)	O
;	O
if	O
(	O
iseq	int
==	O
iIsendseq	int
)	O
{	O
return	O
TRUE	O
;	O
}	O
DEBUG_MESSAGE1	O
(	O
DEBUG_PROTO	O
|	O
DEBUG_ABNORMAL	O
,	O
"firesend: Resending packet %d"	*(char)
,	O
iseq	int
)	O
;	O
zhdr	*(char)
=	O
azIsendbuffers	array(*(char))
[	O
iseq	int
]	O
+	O
CHDROFFSET	O
;	O
if	O
(	O
IHDRWIN_GETSEQ	O
(	O
zhdr	*(char)
[	O
IHDR_REMOTE	O
]	O
)	O
!=	O
iIrecseq	int
)	O
{	O
int	O
iremote	int
;	O
iremote	int
=	O
IHDRWIN_GETCHAN	O
(	O
zhdr	*(char)
[	O
IHDR_REMOTE	O
]	O
)	O
;	O
zhdr	*(char)
[	O
IHDR_REMOTE	O
]	O
=	O
IHDRWIN_SET	O
(	O
iIrecseq	int
,	O
iremote	int
)	O
;	O
zhdr	*(char)
[	O
IHDR_CHECK	O
]	O
=	O
IHDRCHECK_VAL	O
(	O
zhdr	*(char)
)	O
;	O
iIlocal_ack	int
=	O
iIrecseq	int
;	O
}	O
++	O
cIresent_packets	long
;	O
clen	long
=	O
CHDRCON_GETBYTES	O
(	O
zhdr	*(char)
[	O
IHDR_CONTENTS1	O
]	O
,	O
zhdr	*(char)
[	O
IHDR_CONTENTS2	O
]	O
)	O
;	O
return	O
(	O
*	O
pfIsend	*((*(struct(*(struct`),*(void),*(struct`))),*(char),long,int)->(int))
)	O
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
,	O
zhdr	*(char)
,	O
CHDRLEN	O
+	O
clen	long
+	O
(	O
clen	long
>	O
0	int
?	O
CCKSUMLEN	O
:	O
0	int
)	O
,	O
TRUE	O
)	O
;	O
}	O
static	O
boolean	int
fiwindow_wait	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
)	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
;	O
{	O
while	O
(	O
CSEQDIFF	O
(	O
iIsendseq	int
,	O
iIremote_ack	int
)	O
>	O
iIremote_winsize	int
)	O
{	O
DEBUG_MESSAGE0	O
(	O
DEBUG_PROTO	O
,	O
"fiwindow_wait: Waiting for ACK"	*(char)
)	O
;	O
if	O
(	O
!	O
fiwait_for_packet	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),int,int,int,*(int))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
cIwindow_timeout	int
,	O
cIretries	int
,	O
TRUE	O
,	O
(	O
boolean	int
*	O
)	O
NULL	O
)	O
)	O
return	O
FALSE	O
;	O
}	O
return	O
TRUE	O
;	O
}	O
char	O
*	O
zigetspace	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(long))->(*(char))
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
pclen	*(long)
)	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
ATTRIBUTE_UNUSED	O
;	O
size_t	long
*	O
pclen	*(long)
;	O
{	O
*	O
pclen	*(long)
=	O
iIremote_packsize	int
;	O
return	O
azIsendbuffers	array(*(char))
[	O
iIsendseq	int
]	O
+	O
CHDRSKIPLEN	O
;	O
}	O
boolean	int
fisenddata	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(char),long,int,int,long)->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
zdata	*(char)
,	O
cdata	long
,	O
ilocal	int
,	O
iremote	int
,	O
ipos	long
)	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
;	O
char	O
*	O
zdata	*(char)
;	O
size_t	long
cdata	long
;	O
int	O
ilocal	int
;	O
int	O
iremote	int
;	O
long	O
ipos	long
;	O
{	O
char	O
*	O
zhdr	*(char)
;	O
unsigned	O
long	O
icksum	long
;	O
boolean	int
fret	int
;	O
if	O
(	O
ilocal	int
<	O
0	int
||	O
ilocal	int
>=	O
IMAXICHAN	O
||	O
iremote	int
<	O
0	int
||	O
iremote	int
>=	O
IMAXICHAN	O
)	O
ulog	(enum(int,int,int,int,int,int,int),*(char))->(void)
(	O
LOG_FATAL	int
,	O
"fisenddata: ilocal %d iremote %d"	*(char)
,	O
ilocal	int
,	O
iremote	int
)	O
;	O
if	O
(	O
ipos	long
!=	O
iIsendpos	long
&&	O
ipos	long
!=	O
(	O
long	O
)	O
-	O
1	int
)	O
{	O
int	O
inext	int
;	O
char	O
*	O
zspos	*(char)
;	O
inext	int
=	O
INEXTSEQ	O
(	O
iIsendseq	int
)	O
;	O
zspos	*(char)
=	O
azIsendbuffers	array(*(char))
[	O
inext	int
]	O
;	O
azIsendbuffers	array(*(char))
[	O
inext	int
]	O
=	O
zdata	*(char)
-	O
CHDRSKIPLEN	O
;	O
azIsendbuffers	array(*(char))
[	O
iIsendseq	int
]	O
=	O
zspos	*(char)
;	O
zspos	*(char)
+=	O
CHDROFFSET	O
;	O
zspos	*(char)
[	O
IHDR_INTRO	O
]	O
=	O
IINTRO	O
;	O
zspos	*(char)
[	O
IHDR_LOCAL	O
]	O
=	O
IHDRWIN_SET	O
(	O
iIsendseq	int
,	O
0	int
)	O
;	O
zspos	*(char)
[	O
IHDR_REMOTE	O
]	O
=	O
IHDRWIN_SET	O
(	O
iIrecseq	int
,	O
0	int
)	O
;	O
iIlocal_ack	int
=	O
iIrecseq	int
;	O
zspos	*(char)
[	O
IHDR_CONTENTS1	O
]	O
=	O
IHDRCON_SET1	O
(	O
SPOS	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
CCKSUMLEN	O
)	O
;	O
zspos	*(char)
[	O
IHDR_CONTENTS2	O
]	O
=	O
IHDRCON_SET2	O
(	O
SPOS	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
CCKSUMLEN	O
)	O
;	O
zspos	*(char)
[	O
IHDR_CHECK	O
]	O
=	O
IHDRCHECK_VAL	O
(	O
zspos	*(char)
)	O
;	O
UCKSUM_SET	O
(	O
zspos	*(char)
+	O
CHDRLEN	O
,	O
(	O
unsigned	O
long	O
)	O
ipos	long
)	O
;	O
icksum	long
=	O
icrc	(*(char),long,long)->(long)
(	O
zspos	*(char)
+	O
CHDRLEN	O
,	O
CCKSUMLEN	O
,	O
ICRCINIT	O
)	O
;	O
UCKSUM_SET	O
(	O
zspos	*(char)
+	O
CHDRLEN	O
+	O
CCKSUMLEN	O
,	O
icksum	long
)	O
;	O
if	O
(	O
iIremote_winsize	int
>	O
0	int
&&	O
CSEQDIFF	O
(	O
iIsendseq	int
,	O
iIremote_ack	int
)	O
>	O
iIremote_winsize	int
)	O
{	O
if	O
(	O
!	O
fiwindow_wait	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
)	O
)	O
return	O
FALSE	O
;	O
}	O
DEBUG_MESSAGE1	O
(	O
DEBUG_PROTO	O
,	O
"fisenddata: Sending SPOS %ld"	*(char)
,	O
ipos	long
)	O
;	O
if	O
(	O
!	O
(	O
*	O
pfIsend	*((*(struct(*(struct`),*(void),*(struct`))),*(char),long,int)->(int))
)	O
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
,	O
zspos	*(char)
,	O
CHDRLEN	O
+	O
CCKSUMLEN	O
+	O
CCKSUMLEN	O
,	O
TRUE	O
)	O
)	O
return	O
FALSE	O
;	O
iIsendseq	int
=	O
INEXTSEQ	O
(	O
iIsendseq	int
)	O
;	O
iIsendpos	long
=	O
ipos	long
;	O
}	O
zhdr	*(char)
=	O
zdata	*(char)
-	O
CHDRLEN	O
;	O
zhdr	*(char)
[	O
IHDR_INTRO	O
]	O
=	O
IINTRO	O
;	O
zhdr	*(char)
[	O
IHDR_LOCAL	O
]	O
=	O
IHDRWIN_SET	O
(	O
iIsendseq	int
,	O
ilocal	int
)	O
;	O
zhdr	*(char)
[	O
IHDR_CONTENTS1	O
]	O
=	O
IHDRCON_SET1	O
(	O
DATA	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
cdata	long
)	O
;	O
zhdr	*(char)
[	O
IHDR_CONTENTS2	O
]	O
=	O
IHDRCON_SET2	O
(	O
DATA	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
cdata	long
)	O
;	O
if	O
(	O
cdata	long
>	O
0	int
)	O
{	O
icksum	long
=	O
icrc	(*(char),long,long)->(long)
(	O
zdata	*(char)
,	O
cdata	long
,	O
ICRCINIT	O
)	O
;	O
UCKSUM_SET	O
(	O
zdata	*(char)
+	O
cdata	long
,	O
icksum	long
)	O
;	O
}	O
if	O
(	O
iIremote_winsize	int
>	O
0	int
&&	O
CSEQDIFF	O
(	O
iIsendseq	int
,	O
iIremote_ack	int
)	O
>	O
iIremote_winsize	int
)	O
{	O
if	O
(	O
!	O
fiwindow_wait	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
)	O
)	O
return	O
FALSE	O
;	O
}	O
zhdr	*(char)
[	O
IHDR_REMOTE	O
]	O
=	O
IHDRWIN_SET	O
(	O
iIrecseq	int
,	O
iremote	int
)	O
;	O
iIlocal_ack	int
=	O
iIrecseq	int
;	O
zhdr	*(char)
[	O
IHDR_CHECK	O
]	O
=	O
IHDRCHECK_VAL	O
(	O
zhdr	*(char)
)	O
;	O
DEBUG_MESSAGE4	O
(	O
DEBUG_PROTO	O
,	O
"fisenddata: Sending packet %d size %d local %d remote %d"	*(char)
,	O
iIsendseq	int
,	O
(	O
int	O
)	O
cdata	long
,	O
ilocal	int
,	O
iremote	int
)	O
;	O
iIsendseq	int
=	O
INEXTSEQ	O
(	O
iIsendseq	int
)	O
;	O
++	O
cIsent_packets	long
;	O
fret	int
=	O
(	O
*	O
pfIsend	*((*(struct(*(struct`),*(void),*(struct`))),*(char),long,int)->(int))
)	O
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
,	O
zhdr	*(char)
,	O
cdata	long
+	O
CHDRLEN	O
+	O
(	O
cdata	long
>	O
0	int
?	O
CCKSUMLEN	O
:	O
0	int
)	O
,	O
TRUE	O
)	O
;	O
iIsendpos	long
+=	O
cdata	long
;	O
if	O
(	O
fret	int
&&	O
iPrecstart	int
!=	O
iPrecend	int
)	O
{	O
boolean	int
fexit	int
;	O
fret	int
=	O
fiprocess_data	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(int),*(int),*(long))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
&	O
fexit	int
,	O
(	O
boolean	int
*	O
)	O
NULL	O
,	O
(	O
size_t	long
*	O
)	O
NULL	O
)	O
;	O
}	O
return	O
fret	int
;	O
}	O
boolean	int
fiwait	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
)	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
;	O
{	O
return	O
fiwait_for_packet	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),int,int,int,*(int))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
cItimeout	int
,	O
cIretries	int
,	O
FALSE	O
,	O
(	O
boolean	int
*	O
)	O
NULL	O
)	O
;	O
}	O
static	O
boolean	int
fiwait_for_packet	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),int,int,int,*(int))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
ctimeout	int
,	O
cretries	int
,	O
fone	int
,	O
pftimedout	*(int)
)	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
;	O
int	O
ctimeout	int
;	O
int	O
cretries	int
;	O
boolean	int
fone	int
;	O
boolean	int
*	O
pftimedout	*(int)
;	O
{	O
int	O
cshort	int
;	O
int	O
ctimeouts	int
;	O
if	O
(	O
pftimedout	*(int)
!=	O
NULL	O
)	O
*	O
pftimedout	*(int)
=	O
FALSE	O
;	O
cshort	int
=	O
0	int
;	O
ctimeouts	int
=	O
0	int
;	O
while	O
(	O
TRUE	O
)	O
{	O
boolean	int
fexit	int
,	O
ffound	int
;	O
size_t	long
cneed	long
;	O
size_t	long
crec	long
;	O
if	O
(	O
!	O
fiprocess_data	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(int),*(int),*(long))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
&	O
fexit	int
,	O
&	O
ffound	int
,	O
&	O
cneed	long
)	O
)	O
return	O
FALSE	O
;	O
if	O
(	O
fexit	int
||	O
(	O
fone	int
&&	O
ffound	int
)	O
)	O
return	O
TRUE	O
;	O
if	O
(	O
cneed	long
==	O
0	int
)	O
continue	O
;	O
DEBUG_MESSAGE1	O
(	O
DEBUG_PROTO	O
,	O
"fiwait_for_packet: Need %d bytes"	*(char)
,	O
(	O
int	O
)	O
cneed	long
)	O
;	O
if	O
(	O
!	O
(	O
*	O
pfIreceive	*((*(struct(*(struct`),*(void),*(struct`))),long,*(long),int,int)->(int))
)	O
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
,	O
cneed	long
,	O
&	O
crec	long
,	O
ctimeout	int
,	O
TRUE	O
)	O
)	O
return	O
FALSE	O
;	O
if	O
(	O
crec	long
!=	O
0	int
)	O
{	O
if	O
(	O
crec	long
>=	O
cneed	long
)	O
cshort	int
=	O
0	int
;	O
else	O
{	O
++	O
cshort	int
;	O
if	O
(	O
cshort	int
>	O
1	int
)	O
{	O
iPrecstart	int
=	O
(	O
iPrecstart	int
+	O
1	int
)	O
%	O
CRECBUFLEN	O
;	O
cshort	int
=	O
0	int
;	O
}	O
}	O
}	O
else	O
{	O
int	O
i	int
;	O
++	O
ctimeouts	int
;	O
if	O
(	O
ctimeouts	int
>	O
cretries	int
)	O
{	O
if	O
(	O
cretries	int
>	O
0	int
)	O
ulog	(enum(int,int,int,int,int,int,int),*(char))->(void)
(	O
LOG_ERROR	int
,	O
"Timed out waiting for packet"	*(char)
)	O
;	O
if	O
(	O
pftimedout	*(int)
!=	O
NULL	O
)	O
*	O
pftimedout	*(int)
=	O
TRUE	O
;	O
return	O
FALSE	O
;	O
}	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
IMAXSEQ	int
;	O
i	int
++	O
)	O
afInaked	array(int)
[	O
i	int
]	O
=	O
FALSE	O
;	O
if	O
(	O
!	O
finak	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),int)->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
INEXTSEQ	O
(	O
iIrecseq	int
)	O
)	O
||	O
!	O
firesend	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
)	O
)	O
return	O
FALSE	O
;	O
}	O
}	O
}	O
static	O
boolean	int
ficheck_errors	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
)	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
;	O
{	O
if	O
(	O
cIerrors	int
<	O
0	int
)	O
return	O
TRUE	O
;	O
if	O
(	O
(	O
(	O
cIbad_order	long
+	O
cIbad_hdr	long
+	O
cIbad_cksum	long
+	O
cIremote_rejects	long
)	O
-	O
(	O
cIreceived_packets	long
/	O
cIerror_decay	int
)	O
)	O
>	O
cIerrors	int
)	O
{	O
if	O
(	O
iIrequest_packsize	int
>	O
400	int
)	O
{	O
char	O
absync	array(char)
[	O
CHDRLEN	O
+	O
3	int
+	O
CCKSUMLEN	O
]	O
;	O
unsigned	O
long	O
icksum	long
;	O
iIrequest_packsize	int
/=	O
2	int
;	O
absync	array(char)
[	O
IHDR_INTRO	O
]	O
=	O
IINTRO	O
;	O
absync	array(char)
[	O
IHDR_LOCAL	O
]	O
=	O
IHDRWIN_SET	O
(	O
0	int
,	O
0	int
)	O
;	O
absync	array(char)
[	O
IHDR_REMOTE	O
]	O
=	O
IHDRWIN_SET	O
(	O
iIrecseq	int
,	O
0	int
)	O
;	O
iIlocal_ack	int
=	O
iIrecseq	int
;	O
absync	array(char)
[	O
IHDR_CONTENTS1	O
]	O
=	O
IHDRCON_SET1	O
(	O
SYNC	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
3	int
)	O
;	O
absync	array(char)
[	O
IHDR_CONTENTS2	O
]	O
=	O
IHDRCON_SET2	O
(	O
SYNC	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
3	int
)	O
;	O
absync	array(char)
[	O
IHDR_CHECK	O
]	O
=	O
IHDRCHECK_VAL	O
(	O
absync	array(char)
)	O
;	O
absync	array(char)
[	O
CHDRLEN	O
+	O
0	int
]	O
=	O
(	O
iIrequest_packsize	int
>>	O
8	int
)	O
&	O
0xff	int
;	O
absync	array(char)
[	O
CHDRLEN	O
+	O
1	int
]	O
=	O
iIrequest_packsize	int
&	O
0xff	int
;	O
absync	array(char)
[	O
CHDRLEN	O
+	O
2	int
]	O
=	O
iIrequest_winsize	int
;	O
icksum	long
=	O
icrc	(*(char),long,long)->(long)
(	O
absync	array(char)
+	O
CHDRLEN	O
,	O
3	int
,	O
ICRCINIT	O
)	O
;	O
UCKSUM_SET	O
(	O
absync	array(char)
+	O
CHDRLEN	O
+	O
3	int
,	O
icksum	long
)	O
;	O
cIerrors	int
*=	O
2	int
;	O
DEBUG_MESSAGE2	O
(	O
DEBUG_PROTO	O
|	O
DEBUG_ABNORMAL	O
,	O
"ficheck_errors: Sending SYNC packsize %d winsize %d"	*(char)
,	O
iIrequest_packsize	int
,	O
iIrequest_winsize	int
)	O
;	O
return	O
(	O
*	O
pfIsend	*((*(struct(*(struct`),*(void),*(struct`))),*(char),long,int)->(int))
)	O
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
,	O
absync	array(char)
,	O
CHDRLEN	O
+	O
3	int
+	O
CCKSUMLEN	O
,	O
TRUE	O
)	O
;	O
}	O
ulog	(enum(int,int,int,int,int,int,int),*(char))->(void)
(	O
LOG_ERROR	int
,	O
"Too many '%c' protocol errors"	*(char)
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qproto	*(struct)
->	O
bname	char
)	O
;	O
return	O
FALSE	O
;	O
}	O
return	O
TRUE	O
;	O
}	O
static	O
boolean	int
fiprocess_data	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(int),*(int),*(long))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
pfexit	*(int)
,	O
pffound	*(int)
,	O
pcneed	*(long)
)	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
;	O
boolean	int
*	O
pfexit	*(int)
;	O
boolean	int
*	O
pffound	*(int)
;	O
size_t	long
*	O
pcneed	*(long)
;	O
{	O
boolean	int
fbadhdr	int
;	O
if	O
(	O
pfexit	*(int)
!=	O
NULL	O
)	O
*	O
pfexit	*(int)
=	O
FALSE	O
;	O
if	O
(	O
pffound	*(int)
!=	O
NULL	O
)	O
*	O
pffound	*(int)
=	O
FALSE	O
;	O
fbadhdr	int
=	O
FALSE	O
;	O
while	O
(	O
iPrecstart	int
!=	O
iPrecend	int
)	O
{	O
char	O
ab	array(char)
[	O
CHDRLEN	O
]	O
;	O
int	O
cfirst	long
,	O
csecond	long
;	O
char	O
*	O
zfirst	*(char)
,	O
*	O
zsecond	*(char)
;	O
int	O
i	int
;	O
int	O
iget	int
;	O
int	O
ttype	enum(int,int,int,int,int,int,int,int,int)
;	O
int	O
iseq	int
;	O
int	O
csize	long
;	O
int	O
iack	int
;	O
if	O
(	O
fIclosing	int
)	O
{	O
if	O
(	O
pfexit	*(int)
!=	O
NULL	O
)	O
*	O
pfexit	*(int)
=	O
TRUE	O
;	O
if	O
(	O
pcneed	*(long)
!=	O
NULL	O
)	O
*	O
pcneed	*(long)
=	O
0	int
;	O
return	O
TRUE	O
;	O
}	O
if	O
(	O
abPrecbuf	array(char)
[	O
iPrecstart	int
]	O
!=	O
IINTRO	O
)	O
{	O
char	O
*	O
zintro	*(char)
;	O
int	O
cintro	int
;	O
cintro	int
=	O
iPrecend	int
-	O
iPrecstart	int
;	O
if	O
(	O
cintro	int
<	O
0	int
)	O
cintro	int
=	O
CRECBUFLEN	O
-	O
iPrecstart	int
;	O
zintro	*(char)
=	O
memchr	(*(void),int,long)->(*(void))
(	O
abPrecbuf	array(char)
+	O
iPrecstart	int
,	O
IINTRO	O
,	O
(	O
size_t	long
)	O
cintro	int
)	O
;	O
if	O
(	O
zintro	*(char)
==	O
NULL	O
)	O
{	O
iPrecstart	int
=	O
(	O
iPrecstart	int
+	O
cintro	int
)	O
%	O
CRECBUFLEN	O
;	O
continue	O
;	O
}	O
iPrecstart	int
+=	O
zintro	*(char)
-	O
(	O
abPrecbuf	array(char)
+	O
iPrecstart	int
)	O
;	O
}	O
for	O
(	O
i	int
=	O
0	int
,	O
iget	int
=	O
iPrecstart	int
;	O
i	int
<	O
CHDRLEN	O
&&	O
iget	int
!=	O
iPrecend	int
;	O
i	int
++	O
,	O
iget	int
=	O
(	O
iget	int
+	O
1	int
)	O
%	O
CRECBUFLEN	O
)	O
ab	array(char)
[	O
i	int
]	O
=	O
abPrecbuf	array(char)
[	O
iget	int
]	O
;	O
if	O
(	O
i	int
<	O
CHDRLEN	O
)	O
{	O
if	O
(	O
pcneed	*(long)
!=	O
NULL	O
)	O
*	O
pcneed	*(long)
=	O
CHDRLEN	O
-	O
i	int
;	O
return	O
TRUE	O
;	O
}	O
if	O
(	O
(	O
ab	array(char)
[	O
IHDR_CHECK	O
]	O
&	O
0xff	int
)	O
!=	O
IHDRCHECK_VAL	O
(	O
ab	array(char)
)	O
||	O
(	O
FHDRCON_GETCALLER	O
(	O
ab	array(char)
[	O
IHDR_CONTENTS1	O
]	O
,	O
ab	array(char)
[	O
IHDR_CONTENTS2	O
]	O
)	O
?	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
:	O
!	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
)	O
)	O
{	O
if	O
(	O
!	O
fbadhdr	int
)	O
{	O
DEBUG_MESSAGE0	O
(	O
DEBUG_PROTO	O
|	O
DEBUG_ABNORMAL	O
,	O
"fiprocess_data: Bad header"	*(char)
)	O
;	O
++	O
cIbad_hdr	long
;	O
if	O
(	O
!	O
ficheck_errors	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
)	O
)	O
return	O
FALSE	O
;	O
fbadhdr	int
=	O
TRUE	O
;	O
}	O
iPrecstart	int
=	O
(	O
iPrecstart	int
+	O
1	int
)	O
%	O
CRECBUFLEN	O
;	O
continue	O
;	O
}	O
zfirst	*(char)
=	O
zsecond	*(char)
=	O
NULL	O
;	O
cfirst	long
=	O
csecond	long
=	O
0	int
;	O
ttype	enum(int,int,int,int,int,int,int,int,int)
=	O
THDRCON_GETTYPE	O
(	O
ab	array(char)
[	O
IHDR_CONTENTS1	O
]	O
,	O
ab	array(char)
[	O
IHDR_CONTENTS2	O
]	O
)	O
;	O
if	O
(	O
ttype	enum(int,int,int,int,int,int,int,int,int)
==	O
DATA	O
||	O
ttype	enum(int,int,int,int,int,int,int,int,int)
==	O
SPOS	O
||	O
ttype	enum(int,int,int,int,int,int,int,int,int)
==	O
CLOSE	O
)	O
iseq	int
=	O
IHDRWIN_GETSEQ	O
(	O
ab	array(char)
[	O
IHDR_LOCAL	O
]	O
)	O
;	O
else	O
iseq	int
=	O
-	O
1	int
;	O
csize	long
=	O
CHDRCON_GETBYTES	O
(	O
ab	array(char)
[	O
IHDR_CONTENTS1	O
]	O
,	O
ab	array(char)
[	O
IHDR_CONTENTS2	O
]	O
)	O
;	O
if	O
(	O
iseq	int
!=	O
-	O
1	int
)	O
{	O
if	O
(	O
iIrequest_winsize	int
>	O
0	int
&&	O
CSEQDIFF	O
(	O
iseq	int
,	O
iIlocal_ack	int
)	O
>	O
iIrequest_winsize	int
)	O
{	O
DEBUG_MESSAGE2	O
(	O
DEBUG_PROTO	O
|	O
DEBUG_ABNORMAL	O
,	O
"fiprocess_data: Out of order packet %d (ack %d)"	*(char)
,	O
iseq	int
,	O
iIlocal_ack	int
)	O
;	O
++	O
cIbad_order	long
;	O
if	O
(	O
!	O
ficheck_errors	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
)	O
)	O
return	O
FALSE	O
;	O
iPrecstart	int
=	O
(	O
iPrecstart	int
+	O
1	int
)	O
%	O
CRECBUFLEN	O
;	O
continue	O
;	O
}	O
}	O
if	O
(	O
csize	long
>	O
0	int
)	O
{	O
int	O
cinbuf	int
;	O
char	O
abcksum	array(char)
[	O
CCKSUMLEN	O
]	O
;	O
unsigned	O
long	O
ickdata	long
;	O
cinbuf	int
=	O
iPrecend	int
-	O
iPrecstart	int
;	O
if	O
(	O
cinbuf	int
<	O
0	int
)	O
cinbuf	int
+=	O
CRECBUFLEN	O
;	O
if	O
(	O
cinbuf	int
<	O
CHDRLEN	O
+	O
csize	long
+	O
CCKSUMLEN	O
)	O
{	O
if	O
(	O
pcneed	*(long)
!=	O
NULL	O
)	O
*	O
pcneed	*(long)
=	O
CHDRLEN	O
+	O
csize	long
+	O
CCKSUMLEN	O
-	O
cinbuf	int
;	O
return	O
TRUE	O
;	O
}	O
if	O
(	O
iPrecend	int
>	O
iPrecstart	int
)	O
{	O
cfirst	long
=	O
csize	long
;	O
zfirst	*(char)
=	O
abPrecbuf	array(char)
+	O
iPrecstart	int
+	O
CHDRLEN	O
;	O
}	O
else	O
{	O
cfirst	long
=	O
CRECBUFLEN	O
-	O
(	O
iPrecstart	int
+	O
CHDRLEN	O
)	O
;	O
if	O
(	O
cfirst	long
<=	O
0	int
)	O
{	O
zfirst	*(char)
=	O
abPrecbuf	array(char)
-	O
cfirst	long
;	O
cfirst	long
=	O
csize	long
;	O
}	O
else	O
{	O
if	O
(	O
cfirst	long
>=	O
csize	long
)	O
cfirst	long
=	O
csize	long
;	O
else	O
{	O
zsecond	*(char)
=	O
abPrecbuf	array(char)
;	O
csecond	long
=	O
csize	long
-	O
cfirst	long
;	O
}	O
zfirst	*(char)
=	O
abPrecbuf	array(char)
+	O
iPrecstart	int
+	O
CHDRLEN	O
;	O
}	O
}	O
for	O
(	O
i	int
=	O
0	int
,	O
iget	int
=	O
(	O
iPrecstart	int
+	O
CHDRLEN	O
+	O
csize	long
)	O
%	O
CRECBUFLEN	O
;	O
i	int
<	O
CCKSUMLEN	O
;	O
i	int
++	O
,	O
iget	int
=	O
(	O
iget	int
+	O
1	int
)	O
%	O
CRECBUFLEN	O
)	O
abcksum	array(char)
[	O
i	int
]	O
=	O
abPrecbuf	array(char)
[	O
iget	int
]	O
;	O
ickdata	long
=	O
icrc	(*(char),long,long)->(long)
(	O
zfirst	*(char)
,	O
(	O
size_t	long
)	O
cfirst	long
,	O
ICRCINIT	O
)	O
;	O
if	O
(	O
csecond	long
>	O
0	int
)	O
ickdata	long
=	O
icrc	(*(char),long,long)->(long)
(	O
zsecond	*(char)
,	O
(	O
size_t	long
)	O
csecond	long
,	O
ickdata	long
)	O
;	O
if	O
(	O
ICKSUM_GET	O
(	O
abcksum	array(char)
)	O
!=	O
ickdata	long
)	O
{	O
DEBUG_MESSAGE2	O
(	O
DEBUG_PROTO	O
|	O
DEBUG_ABNORMAL	O
,	O
"fiprocess_data: Bad checksum; data %lu, frame %lu"	*(char)
,	O
ickdata	long
,	O
ICKSUM_GET	O
(	O
abcksum	array(char)
)	O
)	O
;	O
++	O
cIbad_cksum	long
;	O
if	O
(	O
!	O
ficheck_errors	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
)	O
)	O
return	O
FALSE	O
;	O
if	O
(	O
iseq	int
!=	O
-	O
1	int
&&	O
iseq	int
!=	O
iIrecseq	int
&&	O
(	O
iIrequest_winsize	int
<=	O
0	int
||	O
CSEQDIFF	O
(	O
iseq	int
,	O
iIrecseq	int
)	O
<=	O
iIrequest_winsize	int
)	O
&&	O
azIrecbuffers	array(*(char))
[	O
iseq	int
]	O
==	O
NULL	O
)	O
{	O
if	O
(	O
!	O
finak	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),int)->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
iseq	int
)	O
)	O
return	O
FALSE	O
;	O
}	O
iPrecstart	int
=	O
(	O
iPrecstart	int
+	O
1	int
)	O
%	O
CRECBUFLEN	O
;	O
continue	O
;	O
}	O
}	O
if	O
(	O
csize	long
==	O
0	int
)	O
iPrecstart	int
=	O
(	O
iPrecstart	int
+	O
CHDRLEN	O
)	O
%	O
CRECBUFLEN	O
;	O
else	O
{	O
iPrecstart	int
=	O
(	O
(	O
iPrecstart	int
+	O
CHDRLEN	O
+	O
csize	long
+	O
CCKSUMLEN	O
)	O
%	O
CRECBUFLEN	O
)	O
;	O
++	O
cIreceived_packets	long
;	O
}	O
iack	int
=	O
IHDRWIN_GETSEQ	O
(	O
ab	array(char)
[	O
IHDR_REMOTE	O
]	O
)	O
;	O
if	O
(	O
iIremote_winsize	int
>	O
0	int
&&	O
iack	int
!=	O
iIsendseq	int
&&	O
CSEQDIFF	O
(	O
iack	int
,	O
iIremote_ack	int
)	O
<=	O
iIremote_winsize	int
&&	O
CSEQDIFF	O
(	O
iIsendseq	int
,	O
iack	int
)	O
<=	O
iIremote_winsize	int
)	O
{	O
if	O
(	O
iack	int
<	O
iIremote_ack	int
)	O
uwindow_acked	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),int)->(void)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
FALSE	O
)	O
;	O
iIremote_ack	int
=	O
iack	int
;	O
}	O
if	O
(	O
iseq	int
!=	O
-	O
1	int
)	O
{	O
if	O
(	O
afInaked	array(int)
[	O
iseq	int
]	O
&&	O
azIrecbuffers	array(*(char))
[	O
IPREVSEQ	O
(	O
iseq	int
)	O
]	O
==	O
NULL	O
)	O
{	O
for	O
(	O
i	int
=	O
INEXTSEQ	O
(	O
iIrecseq	int
)	O
;	O
i	int
!=	O
iseq	int
;	O
i	int
=	O
INEXTSEQ	O
(	O
i	int
)	O
)	O
afInaked	array(int)
[	O
i	int
]	O
=	O
FALSE	O
;	O
afInaked	array(int)
[	O
iseq	int
]	O
=	O
FALSE	O
;	O
}	O
if	O
(	O
iseq	int
!=	O
INEXTSEQ	O
(	O
iIrecseq	int
)	O
)	O
{	O
if	O
(	O
iseq	int
==	O
iIrecseq	int
||	O
(	O
iIrequest_winsize	int
>	O
0	int
&&	O
CSEQDIFF	O
(	O
iseq	int
,	O
iIrecseq	int
)	O
>	O
iIrequest_winsize	int
)	O
)	O
{	O
DEBUG_MESSAGE2	O
(	O
DEBUG_PROTO	O
|	O
DEBUG_ABNORMAL	O
,	O
"fiprocess_data: Ignoring out of order packet %d (recseq %d)"	*(char)
,	O
iseq	int
,	O
iIrecseq	int
)	O
;	O
continue	O
;	O
}	O
else	O
{	O
DEBUG_MESSAGE2	O
(	O
DEBUG_PROTO	O
|	O
DEBUG_ABNORMAL	O
,	O
"fiprocess_data: Saving unexpected packet %d (recseq %d)"	*(char)
,	O
iseq	int
,	O
iIrecseq	int
)	O
;	O
if	O
(	O
azIrecbuffers	array(*(char))
[	O
iseq	int
]	O
==	O
NULL	O
)	O
{	O
azIrecbuffers	array(*(char))
[	O
iseq	int
]	O
=	O
zbufalc	(long)->(*(char))
(	O
(	O
size_t	long
)	O
(	O
CHDRLEN	O
+	O
csize	long
)	O
)	O
;	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
azIrecbuffers	array(*(char))
[	O
iseq	int
]	O
,	O
ab	array(char)
,	O
CHDRLEN	O
)	O
;	O
if	O
(	O
csize	long
>	O
0	int
)	O
{	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
azIrecbuffers	array(*(char))
[	O
iseq	int
]	O
+	O
CHDRLEN	O
,	O
zfirst	*(char)
,	O
(	O
size_t	long
)	O
cfirst	long
)	O
;	O
if	O
(	O
csecond	long
>	O
0	int
)	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
azIrecbuffers	array(*(char))
[	O
iseq	int
]	O
+	O
CHDRLEN	O
+	O
cfirst	long
,	O
zsecond	*(char)
,	O
(	O
size_t	long
)	O
csecond	long
)	O
;	O
}	O
}	O
}	O
for	O
(	O
i	int
=	O
INEXTSEQ	O
(	O
iIrecseq	int
)	O
;	O
i	int
!=	O
iseq	int
;	O
i	int
=	O
INEXTSEQ	O
(	O
i	int
)	O
)	O
{	O
if	O
(	O
!	O
afInaked	array(int)
[	O
i	int
]	O
&&	O
azIrecbuffers	array(*(char))
[	O
i	int
]	O
==	O
NULL	O
)	O
{	O
if	O
(	O
!	O
finak	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),int)->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
i	int
)	O
)	O
return	O
FALSE	O
;	O
}	O
}	O
continue	O
;	O
}	O
iIrecseq	int
=	O
iseq	int
;	O
}	O
if	O
(	O
pffound	*(int)
!=	O
NULL	O
)	O
*	O
pffound	*(int)
=	O
TRUE	O
;	O
if	O
(	O
!	O
fiprocess_packet	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(char),*(char),int,*(char),int,*(int))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
ab	array(char)
,	O
zfirst	*(char)
,	O
cfirst	long
,	O
zsecond	*(char)
,	O
csecond	long
,	O
pfexit	*(int)
)	O
)	O
return	O
FALSE	O
;	O
if	O
(	O
iseq	int
!=	O
-	O
1	int
)	O
{	O
int	O
inext	int
;	O
inext	int
=	O
INEXTSEQ	O
(	O
iIrecseq	int
)	O
;	O
while	O
(	O
azIrecbuffers	array(*(char))
[	O
inext	int
]	O
!=	O
NULL	O
)	O
{	O
char	O
*	O
z	*(char)
;	O
int	O
c	long
;	O
z	*(char)
=	O
azIrecbuffers	array(*(char))
[	O
inext	int
]	O
;	O
c	long
=	O
CHDRCON_GETBYTES	O
(	O
z	*(char)
[	O
IHDR_CONTENTS1	O
]	O
,	O
z	*(char)
[	O
IHDR_CONTENTS2	O
]	O
)	O
;	O
iIrecseq	int
=	O
inext	int
;	O
if	O
(	O
!	O
fiprocess_packet	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(char),*(char),int,*(char),int,*(int))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
z	*(char)
,	O
z	*(char)
+	O
CHDRLEN	O
,	O
c	long
,	O
(	O
char	O
*	O
)	O
NULL	O
,	O
0	int
,	O
pfexit	*(int)
)	O
)	O
return	O
FALSE	O
;	O
ubuffree	(*(char))->(void)
(	O
azIrecbuffers	array(*(char))
[	O
inext	int
]	O
)	O
;	O
azIrecbuffers	array(*(char))
[	O
inext	int
]	O
=	O
NULL	O
;	O
inext	int
=	O
INEXTSEQ	O
(	O
inext	int
)	O
;	O
}	O
}	O
if	O
(	O
iIrequest_winsize	int
>	O
0	int
&&	O
CSEQDIFF	O
(	O
iIrecseq	int
,	O
iIlocal_ack	int
)	O
>=	O
cIack_frequency	int
)	O
{	O
char	O
aback	array(char)
[	O
CHDRLEN	O
]	O
;	O
aback	array(char)
[	O
IHDR_INTRO	O
]	O
=	O
IINTRO	O
;	O
aback	array(char)
[	O
IHDR_LOCAL	O
]	O
=	O
IHDRWIN_SET	O
(	O
0	int
,	O
0	int
)	O
;	O
aback	array(char)
[	O
IHDR_REMOTE	O
]	O
=	O
IHDRWIN_SET	O
(	O
iIrecseq	int
,	O
0	int
)	O
;	O
iIlocal_ack	int
=	O
iIrecseq	int
;	O
aback	array(char)
[	O
IHDR_CONTENTS1	O
]	O
=	O
IHDRCON_SET1	O
(	O
ACK	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
0	int
)	O
;	O
aback	array(char)
[	O
IHDR_CONTENTS2	O
]	O
=	O
IHDRCON_SET2	O
(	O
ACK	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
0	int
)	O
;	O
aback	array(char)
[	O
IHDR_CHECK	O
]	O
=	O
IHDRCHECK_VAL	O
(	O
aback	array(char)
)	O
;	O
DEBUG_MESSAGE1	O
(	O
DEBUG_PROTO	O
,	O
"fiprocess_data: Sending ACK %d"	*(char)
,	O
iIrecseq	int
)	O
;	O
if	O
(	O
!	O
(	O
*	O
pfIsend	*((*(struct(*(struct`),*(void),*(struct`))),*(char),long,int)->(int))
)	O
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
,	O
aback	array(char)
,	O
CHDRLEN	O
,	O
TRUE	O
)	O
)	O
return	O
FALSE	O
;	O
}	O
}	O
if	O
(	O
pcneed	*(long)
!=	O
NULL	O
)	O
*	O
pcneed	*(long)
=	O
CHDRLEN	O
;	O
return	O
TRUE	O
;	O
}	O
static	O
boolean	int
fiprocess_packet	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(char),*(char),int,*(char),int,*(int))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
zhdr	*(char)
,	O
zfirst	*(char)
,	O
cfirst	long
,	O
zsecond	*(char)
,	O
csecond	long
,	O
pfexit	*(int)
)	O
struct	O
sdaemon	struct(*(void),*(char),int,*(struct(*(char),*(*(char)),*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),int,int,*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),*(struct(*(struct`),int,int,long,int)),long,long,*(char),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))),*(char),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),*(char),int,int,*(char),*(struct(int,*(struct`))),struct(*(*(char)),*(*(char)),int,*(*(char)),int),*(char),*(char),int,int,int,int,*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),*(*(char)),long,*(*(char)),*(*(char)),*(char),*(char),long,*(void))),*(char),*(struct(*(struct(*((*`)->(void)),*((*`,int,int)->(int)),*((*`)->(int)),*((*`,long,int,int)->(int)),*((*`,*`,*`,int)->(int)),*((*`,*`,*`,*`,*`,*`)->(int)),*((*`,*`,*`,long,int,int)->(int)),*((*`,*`,long)->(int)),*((*`,*`,*`,*`,*`)->(int)),*((*`)->(int)),*((*`,enum(int,int,int,int,int,int),enum(int,int,int),enum(int,int,int))->(int)),*((*`,int)->(int)),*((*`,*`)->(int)),*((*`)->(long)))),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`))))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)
*	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
;	O
const	O
char	O
*	O
zhdr	*(char)
;	O
const	O
char	O
*	O
zfirst	*(char)
;	O
int	O
cfirst	long
;	O
const	O
char	O
*	O
zsecond	*(char)
;	O
int	O
csecond	long
;	O
boolean	int
*	O
pfexit	*(int)
;	O
{	O
int	O
ttype	enum(int,int,int,int,int,int,int,int,int)
;	O
ttype	enum(int,int,int,int,int,int,int,int,int)
=	O
THDRCON_GETTYPE	O
(	O
zhdr	*(char)
[	O
IHDR_CONTENTS1	O
]	O
,	O
zhdr	*(char)
[	O
IHDR_CONTENTS2	O
]	O
)	O
;	O
switch	O
(	O
ttype	enum(int,int,int,int,int,int,int,int,int)
)	O
{	O
case	O
DATA	O
:	O
{	O
int	O
iseq	int
;	O
boolean	int
fret	int
;	O
iseq	int
=	O
IHDRWIN_GETSEQ	O
(	O
zhdr	*(char)
[	O
IHDR_LOCAL	O
]	O
)	O
;	O
DEBUG_MESSAGE4	O
(	O
DEBUG_PROTO	O
,	O
"fiprocess_packet: Got DATA packet %d size %d local %d remote %d"	*(char)
,	O
iseq	int
,	O
cfirst	long
+	O
csecond	long
,	O
IHDRWIN_GETCHAN	O
(	O
zhdr	*(char)
[	O
IHDR_REMOTE	O
]	O
)	O
,	O
IHDRWIN_GETCHAN	O
(	O
zhdr	*(char)
[	O
IHDR_LOCAL	O
]	O
)	O
)	O
;	O
fret	int
=	O
fgot_data	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)),*(char),long,*(char),long,int,int,long,int,*(int))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
,	O
zfirst	*(char)
,	O
(	O
size_t	long
)	O
cfirst	long
,	O
zsecond	*(char)
,	O
(	O
size_t	long
)	O
csecond	long
,	O
IHDRWIN_GETCHAN	O
(	O
zhdr	*(char)
[	O
IHDR_REMOTE	O
]	O
)	O
,	O
IHDRWIN_GETCHAN	O
(	O
zhdr	*(char)
[	O
IHDR_LOCAL	O
]	O
)	O
,	O
iIrecpos	long
,	O
INEXTSEQ	O
(	O
iIremote_ack	int
)	O
==	O
iIsendseq	int
,	O
pfexit	*(int)
)	O
;	O
iIrecpos	long
+=	O
cfirst	long
+	O
csecond	long
;	O
return	O
fret	int
;	O
}	O
case	O
SYNC	O
:	O
{	O
int	O
ipack	int
,	O
iwin	int
,	O
cchans	int
;	O
if	O
(	O
cfirst	long
+	O
csecond	long
<	O
3	int
)	O
{	O
ulog	(enum(int,int,int,int,int,int,int),*(char))->(void)
(	O
LOG_ERROR	int
,	O
"Bad SYNC packet"	*(char)
)	O
;	O
return	O
FALSE	O
;	O
}	O
ipack	int
=	O
(	O
zfirst	*(char)
[	O
0	int
]	O
&	O
0xff	int
)	O
<<	O
8	int
;	O
if	O
(	O
cfirst	long
>	O
1	int
)	O
ipack	int
|=	O
zfirst	*(char)
[	O
1	int
]	O
&	O
0xff	int
;	O
else	O
ipack	int
|=	O
zsecond	*(char)
[	O
0	int
]	O
;	O
if	O
(	O
cfirst	long
>	O
2	int
)	O
iwin	int
=	O
zfirst	*(char)
[	O
2	int
]	O
;	O
else	O
iwin	int
=	O
zsecond	*(char)
[	O
2	int
-	O
cfirst	long
]	O
;	O
if	O
(	O
cfirst	long
+	O
csecond	long
<=	O
3	int
)	O
cchans	int
=	O
0	int
;	O
else	O
{	O
if	O
(	O
cfirst	long
>	O
3	int
)	O
cchans	int
=	O
zfirst	*(char)
[	O
3	int
]	O
;	O
else	O
cchans	int
=	O
zsecond	*(char)
[	O
3	int
-	O
cfirst	long
]	O
;	O
if	O
(	O
cchans	int
>	O
0	int
&&	O
cchans	int
<	O
8	int
)	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
cchans	int
=	O
cchans	int
;	O
}	O
DEBUG_MESSAGE3	O
(	O
DEBUG_PROTO	O
,	O
"fiprocess_packet: Got SYNC packsize %d winsize %d channels %d"	*(char)
,	O
ipack	int
,	O
iwin	int
,	O
cchans	int
)	O
;	O
if	O
(	O
iIforced_remote_packsize	int
==	O
0	int
&&	O
(	O
iIalc_packsize	int
==	O
0	int
||	O
ipack	int
<=	O
iIalc_packsize	int
)	O
)	O
iIremote_packsize	int
=	O
ipack	int
;	O
iIremote_winsize	int
=	O
iwin	int
;	O
++	O
cIsyncs	int
;	O
*	O
pfexit	*(int)
=	O
TRUE	O
;	O
return	O
TRUE	O
;	O
}	O
case	O
ACK	O
:	O
DEBUG_MESSAGE1	O
(	O
DEBUG_PROTO	O
,	O
"fiprocess_packet: Got ACK %d"	*(char)
,	O
IHDRWIN_GETSEQ	O
(	O
zhdr	*(char)
[	O
IHDR_REMOTE	O
]	O
)	O
)	O
;	O
return	O
TRUE	O
;	O
case	O
NAK	O
:	O
{	O
int	O
iseq	int
;	O
char	O
*	O
zsend	*(char)
;	O
size_t	long
clen	long
;	O
++	O
cIremote_rejects	long
;	O
if	O
(	O
!	O
ficheck_errors	(*(struct(*(void),*(char),int,*(struct(*`,*`,*`,*`,int,int,*`,*`,*`,int,int,*`,*`,*`,*`,long,long,*`,*`,*`,struct`,*`,*`,*`,int,int,*`,*`,struct`,*`,*`,int,int,int,int,*`,*`,*`,*`,*`,*`,long,*`,*`,*`,*`,long,*`)),*(char),*(struct(*`,*`,*`)),*(struct(char,int,int,int,*`,*`,*`,*`,*`,*`,*`,*`)),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char)))->(int)
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
)	O
)	O
return	O
FALSE	O
;	O
iseq	int
=	O
IHDRWIN_GETSEQ	O
(	O
zhdr	*(char)
[	O
IHDR_LOCAL	O
]	O
)	O
;	O
if	O
(	O
iseq	int
==	O
iIsendseq	int
&&	O
INEXTSEQ	O
(	O
iIremote_ack	int
)	O
==	O
iIsendseq	int
)	O
{	O
char	O
aback	array(char)
[	O
CHDRLEN	O
]	O
;	O
aback	array(char)
[	O
IHDR_INTRO	O
]	O
=	O
IINTRO	O
;	O
aback	array(char)
[	O
IHDR_LOCAL	O
]	O
=	O
IHDRWIN_SET	O
(	O
0	int
,	O
0	int
)	O
;	O
aback	array(char)
[	O
IHDR_REMOTE	O
]	O
=	O
IHDRWIN_SET	O
(	O
iIrecseq	int
,	O
0	int
)	O
;	O
iIlocal_ack	int
=	O
iIrecseq	int
;	O
aback	array(char)
[	O
IHDR_CONTENTS1	O
]	O
=	O
IHDRCON_SET1	O
(	O
ACK	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
0	int
)	O
;	O
aback	array(char)
[	O
IHDR_CONTENTS2	O
]	O
=	O
IHDRCON_SET2	O
(	O
ACK	O
,	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
fcaller	int
,	O
0	int
)	O
;	O
aback	array(char)
[	O
IHDR_CHECK	O
]	O
=	O
IHDRCHECK_VAL	O
(	O
aback	array(char)
)	O
;	O
DEBUG_MESSAGE1	O
(	O
DEBUG_PROTO	O
,	O
"fiprocess_packet: Sending ACK %d"	*(char)
,	O
iIrecseq	int
)	O
;	O
return	O
(	O
*	O
pfIsend	*((*(struct(*(struct`),*(void),*(struct`))),*(char),long,int)->(int))
)	O
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
,	O
aback	array(char)
,	O
CHDRLEN	O
,	O
TRUE	O
)	O
;	O
}	O
else	O
{	O
if	O
(	O
iseq	int
==	O
iIsendseq	int
||	O
(	O
iIremote_winsize	int
>	O
0	int
&&	O
(	O
CSEQDIFF	O
(	O
iseq	int
,	O
iIremote_ack	int
)	O
>	O
iIremote_winsize	int
||	O
CSEQDIFF	O
(	O
iIsendseq	int
,	O
iseq	int
)	O
>	O
iIremote_winsize	int
)	O
)	O
)	O
{	O
DEBUG_MESSAGE2	O
(	O
DEBUG_PROTO	O
|	O
DEBUG_ABNORMAL	O
,	O
"fiprocess_packet: Ignoring out of order NAK %d (sendseq %d)"	*(char)
,	O
iseq	int
,	O
iIsendseq	int
)	O
;	O
return	O
TRUE	O
;	O
}	O
DEBUG_MESSAGE1	O
(	O
DEBUG_PROTO	O
|	O
DEBUG_ABNORMAL	O
,	O
"fiprocess_packet: Got NAK %d; resending packet"	*(char)
,	O
iseq	int
)	O
;	O
zsend	*(char)
=	O
azIsendbuffers	array(*(char))
[	O
iseq	int
]	O
+	O
CHDROFFSET	O
;	O
if	O
(	O
IHDRWIN_GETSEQ	O
(	O
zsend	*(char)
[	O
IHDR_REMOTE	O
]	O
)	O
!=	O
iIrecseq	int
)	O
{	O
int	O
iremote	int
;	O
iremote	int
=	O
IHDRWIN_GETCHAN	O
(	O
zsend	*(char)
[	O
IHDR_REMOTE	O
]	O
)	O
;	O
zsend	*(char)
[	O
IHDR_REMOTE	O
]	O
=	O
IHDRWIN_SET	O
(	O
iIrecseq	int
,	O
iremote	int
)	O
;	O
zsend	*(char)
[	O
IHDR_CHECK	O
]	O
=	O
IHDRCHECK_VAL	O
(	O
zsend	*(char)
)	O
;	O
iIlocal_ack	int
=	O
iIrecseq	int
;	O
}	O
++	O
cIresent_packets	long
;	O
clen	long
=	O
CHDRCON_GETBYTES	O
(	O
zsend	*(char)
[	O
IHDR_CONTENTS1	O
]	O
,	O
zsend	*(char)
[	O
IHDR_CONTENTS2	O
]	O
)	O
;	O
return	O
(	O
*	O
pfIsend	*((*(struct(*(struct`),*(void),*(struct`))),*(char),long,int)->(int))
)	O
(	O
qdaemon	*(struct(*(void),*(char),int,*(struct(*(char),*(*`),*(struct`),*(char),int,int,*(struct`),*(struct`),*(struct`),int,int,*(struct`),*(struct`),*(struct`),*(struct`),long,long,*(char),*(struct`),*(char),struct(*`,*`,int,*`,int),*(char),*(char),*(char),int,int,*(char),*(struct`),struct(*`,*`,int,*`,int),*(char),*(char),int,int,int,int,*(*`),*(*`),*(*`),*(*`),*(*`),*(*`),long,*(*`),*(*`),*(char),*(char),long,*(void))),*(char),*(struct(*(struct`),*(void),*(struct`))),*(struct),int,long,long,long,long,long,long,long,int,int,int,int,int,int,int,char))
->	O
qconn	*(struct(*(struct),*(void),*(struct(*(char),enum(int,int,int,int,int,int,int),*(char),*(struct`),int,*(char),*(void),union(struct`,struct`,struct`,struct`,struct`,struct`)))))
,	O
zsend	*(char)
,	O
CHDRLEN	O
+	O
clen	long
+	O
(	O
clen	long
>	O
0	int
?	O
CCKSUMLEN	O
:	O
0	int
)	O
,	O
TRUE	O
)	O
;	O
}	O
}	O
case	O
SPOS	O
:	O
{	O
char	O
abpos	array(char)
[	O
CCKSUMLEN	O
]	O
;	O
const	O
char	O
*	O
zpos	*(char)
;	O
if	O
(	O
cfirst	long
>=	O
CCKSUMLEN	O
)	O
zpos	*(char)
=	O
zfirst	*(char)
;	O
else	O
{	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
abpos	array(char)
,	O
zfirst	*(char)
,	O
(	O
size_t	long
)	O
cfirst	long
)	O
;	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
abpos	array(char)
+	O
cfirst	long
,	O
zsecond	*(char)
,	O
(	O
size_t	long
)	O
(	O
CCKSUMLEN	O
-	O
cfirst	long
)	O
)	O
;	O
zpos	*(char)
=	O
abpos	array(char)
;	O
}	O
iIrecpos	long
=	O
(	O
long	O
)	O
ICKSUM_GET	O
(	O
zpos	*(char)
)	O
;	O
DEBUG_MESSAGE1	O
(	O
DEBUG_PROTO	O
,	O
"fiprocess_packet: Got SPOS %ld"	*(char)
,	O
iIrecpos	long
)	O
;	O
return	O
TRUE	O
;	O
}	O
case	O
CLOSE	O
:	O
{	O
boolean	int
fexpected	int
;	O
fexpected	int
=	O
!	O
fLog_sighup	int
||	O
fIclosing	int
;	O
if	O
(	O
!	O
fexpected	int
)	O
ulog	(enum(int,int,int,int,int,int,int),*(char))->(void)
(	O
LOG_ERROR	int
,	O
"Received unexpected CLOSE packet"	*(char)
)	O
;	O
else	O
DEBUG_MESSAGE0	O
(	O
DEBUG_PROTO	O
,	O
"fiprocess_packet: Got CLOSE packet"	*(char)
)	O
;	O
fIclosing	int
=	O
TRUE	O
;	O
*	O
pfexit	*(int)
=	O
TRUE	O
;	O
return	O
fexpected	int
;	O
}	O
default	O
:	O
DEBUG_MESSAGE1	O
(	O
DEBUG_PROTO	O
,	O
"fiprocess_packet: Got packet type %d"	*(char)
,	O
ttype	enum(int,int,int,int,int,int,int,int,int)
)	O
;	O
return	O
TRUE	O
;	O
}	O
}	O
