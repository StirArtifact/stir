extern	O
struct	O
group	struct(*(char),*(char),int,*(*(char)))
*	O
getgrent	()->(*(struct(*(char),*(char),int,*(*(char)))))
(	O
)	O
;	O
extern	O
struct	O
passwd	struct(*(char),*(char),int,int,*(char),*(char),*(char))
*	O
getpwnam	(*(char))->(*(struct(*(char),*(char),int,int,*(char),*(char),*(char))))
(	O
)	O
;	O
boolean	int
fsuser_access	(*(struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))),int,*(char))->(int)
(	O
q	*(struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long)))
,	O
imode	int
,	O
zuser	*(char)
)	O
const	O
struct	O
stat	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
*	O
q	*(struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long)))
;	O
int	O
imode	int
;	O
const	O
char	O
*	O
zuser	*(char)
;	O
{	O
static	O
char	O
*	O
zuser_hold	*(char)
;	O
static	O
uid_t	int
iuid_hold	int
;	O
static	O
gid_t	int
igid_hold	int
;	O
static	O
int	O
cgroups_hold	int
;	O
static	O
gid_t	int
*	O
paigroups_hold	*(int)
;	O
unsigned	O
int	O
ir	int
,	O
iw	int
,	O
ix	int
,	O
iand	int
;	O
if	O
(	O
imode	int
==	O
F_OK	int
)	O
return	O
TRUE	O
;	O
if	O
(	O
zuser	*(char)
!=	O
NULL	O
)	O
{	O
if	O
(	O
zuser_hold	*(char)
==	O
NULL	O
||	O
strcmp	(*(char),*(char))->(int)
(	O
zuser_hold	*(char)
,	O
zuser	*(char)
)	O
!=	O
0	int
)	O
{	O
struct	O
passwd	struct(*(char),*(char),int,int,*(char),*(char),*(char))
*	O
qpwd	*(struct(*(char),*(char),int,int,*(char),*(char),*(char)))
;	O
if	O
(	O
zuser_hold	*(char)
!=	O
NULL	O
)	O
{	O
ubuffree	(*(char))->(void)
(	O
zuser_hold	*(char)
)	O
;	O
zuser_hold	*(char)
=	O
NULL	O
;	O
cgroups_hold	int
=	O
0	int
;	O
xfree	(*(void))->(void)
(	O
(	O
pointer	*(void)
)	O
paigroups_hold	*(int)
)	O
;	O
paigroups_hold	*(int)
=	O
NULL	O
;	O
}	O
qpwd	*(struct(*(char),*(char),int,int,*(char),*(char),*(char)))
=	O
getpwnam	(*(char))->(*(struct(*(char),*(char),int,int,*(char),*(char),*(char))))
(	O
(	O
char	O
*	O
)	O
zuser	*(char)
)	O
;	O
if	O
(	O
qpwd	*(struct(*(char),*(char),int,int,*(char),*(char),*(char)))
==	O
NULL	O
)	O
{	O
zuser	*(char)
=	O
NULL	O
;	O
}	O
else	O
{	O
struct	O
group	struct(*(char),*(char),int,*(*(char)))
*	O
qg	*(struct(*(char),*(char),int,*(*(char))))
;	O
zuser_hold	*(char)
=	O
zbufcpy	(*(char))->(*(char))
(	O
zuser	*(char)
)	O
;	O
iuid_hold	int
=	O
qpwd	*(struct(*(char),*(char),int,int,*(char),*(char),*(char)))
->	O
pw_uid	int
;	O
igid_hold	int
=	O
qpwd	*(struct(*(char),*(char),int,int,*(char),*(char),*(char)))
->	O
pw_gid	int
;	O
setgrent	()->(void)
(	O
)	O
;	O
while	O
(	O
(	O
qg	*(struct(*(char),*(char),int,*(*(char))))
=	O
getgrent	()->(*(struct(*(char),*(char),int,*(*(char)))))
(	O
)	O
)	O
!=	O
NULL	O
)	O
{	O
const	O
char	O
*	O
*	O
pz	*(*(char))
;	O
if	O
(	O
qg	*(struct(*(char),*(char),int,*(*(char))))
->	O
gr_gid	int
==	O
igid_hold	int
)	O
continue	O
;	O
for	O
(	O
pz	*(*(char))
=	O
(	O
const	O
char	O
*	O
*	O
)	O
qg	*(struct(*(char),*(char),int,*(*(char))))
->	O
gr_mem	*(*(char))
;	O
*	O
pz	*(*(char))
!=	O
NULL	O
;	O
pz	*(*(char))
++	O
)	O
{	O
if	O
(	O
(	O
*	O
pz	*(*(char))
)	O
[	O
0	int
]	O
==	O
*	O
zuser	*(char)
&&	O
strcmp	(*(char),*(char))->(int)
(	O
*	O
pz	*(*(char))
,	O
zuser	*(char)
)	O
==	O
0	int
)	O
{	O
paigroups_hold	*(int)
=	O
(	O
(	O
gid_t	int
*	O
)	O
(	O
xrealloc	(*(void),long)->(*(void))
(	O
(	O
pointer	*(void)
)	O
paigroups_hold	*(int)
,	O
(	O
(	O
cgroups_hold	int
+	O
1	int
)	O
*	O
sizeof	O
(	O
gid_t	int
)	O
)	O
)	O
)	O
)	O
;	O
paigroups_hold	*(int)
[	O
cgroups_hold	int
]	O
=	O
qg	*(struct(*(char),*(char),int,*(*(char))))
->	O
gr_gid	int
;	O
++	O
cgroups_hold	int
;	O
break	O
;	O
}	O
}	O
}	O
endgrent	()->(void)
(	O
)	O
;	O
}	O
}	O
}	O
if	O
(	O
zuser	*(char)
!=	O
NULL	O
)	O
{	O
if	O
(	O
iuid_hold	int
==	O
0	int
)	O
return	O
TRUE	O
;	O
if	O
(	O
iuid_hold	int
==	O
geteuid	()->(int)
(	O
)	O
)	O
return	O
TRUE	O
;	O
}	O
ir	int
=	O
S_IROTH	O
;	O
iw	int
=	O
S_IWOTH	O
;	O
ix	int
=	O
S_IXOTH	O
;	O
if	O
(	O
zuser	*(char)
!=	O
NULL	O
)	O
{	O
if	O
(	O
iuid_hold	int
==	O
q	*(struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long)))
->	O
st_uid	int
)	O
{	O
ir	int
=	O
S_IRUSR	O
;	O
iw	int
=	O
S_IWUSR	O
;	O
ix	int
=	O
S_IXUSR	O
;	O
}	O
else	O
{	O
boolean	int
fgroup	int
;	O
fgroup	int
=	O
FALSE	O
;	O
if	O
(	O
igid_hold	int
==	O
q	*(struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long)))
->	O
st_gid	int
)	O
fgroup	int
=	O
TRUE	O
;	O
else	O
{	O
int	O
i	int
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
cgroups_hold	int
;	O
i	int
++	O
)	O
{	O
if	O
(	O
paigroups_hold	*(int)
[	O
i	int
]	O
==	O
q	*(struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long)))
->	O
st_gid	int
)	O
{	O
fgroup	int
=	O
TRUE	O
;	O
break	O
;	O
}	O
}	O
}	O
if	O
(	O
fgroup	int
)	O
{	O
ir	int
=	O
S_IRGRP	O
;	O
iw	int
=	O
S_IWGRP	O
;	O
ix	int
=	O
S_IXGRP	O
;	O
}	O
}	O
}	O
iand	int
=	O
0	int
;	O
if	O
(	O
(	O
imode	int
&	O
R_OK	int
)	O
!=	O
0	int
)	O
iand	int
|=	O
ir	int
;	O
if	O
(	O
(	O
imode	int
&	O
W_OK	int
)	O
!=	O
0	int
)	O
iand	int
|=	O
iw	int
;	O
if	O
(	O
(	O
imode	int
&	O
X_OK	int
)	O
!=	O
0	int
)	O
iand	int
|=	O
ix	int
;	O
return	O
(	O
q	*(struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long)))
->	O
st_mode	int
&	O
iand	int
)	O
==	O
iand	int
;	O
}	O
