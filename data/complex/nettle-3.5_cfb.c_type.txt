void	O
cfb_encrypt	O
(	O
const	O
void	O
*	O
ctx	*(void)
,	O
nettle_cipher_func	(*(void),long,*(char),*(char))->(void)
*	O
f	*((*(void),long,*(char),*(char))->(void))
,	O
size_t	long
block_size	long
,	O
uint8_t	char
*	O
iv	*(char)
,	O
size_t	long
length	long
,	O
uint8_t	char
*	O
dst	*(char)
,	O
const	O
uint8_t	char
*	O
src	*(char)
)	O
{	O
uint8_t	char
*	O
p	*(void)
;	O
TMP_DECL	O
(	O
buffer	*(char)
,	O
uint8_t	char
,	O
NETTLE_MAX_CIPHER_BLOCK_SIZE	O
)	O
;	O
TMP_ALLOC	O
(	O
buffer	*(char)
,	O
block_size	long
)	O
;	O
if	O
(	O
src	*(char)
!=	O
dst	*(char)
)	O
{	O
for	O
(	O
p	*(void)
=	O
iv	*(char)
;	O
length	long
>=	O
block_size	long
;	O
p	*(void)
=	O
dst	*(char)
,	O
dst	*(char)
+=	O
block_size	long
,	O
src	*(char)
+=	O
block_size	long
,	O
length	long
-=	O
block_size	long
)	O
{	O
f	*((*(void),long,*(char),*(char))->(void))
(	O
ctx	*(void)
,	O
block_size	long
,	O
dst	*(char)
,	O
p	*(void)
)	O
;	O
memxor	O
(	O
dst	*(char)
,	O
src	*(char)
,	O
block_size	long
)	O
;	O
}	O
}	O
else	O
{	O
for	O
(	O
p	*(void)
=	O
iv	*(char)
;	O
length	long
>=	O
block_size	long
;	O
p	*(void)
=	O
dst	*(char)
,	O
dst	*(char)
+=	O
block_size	long
,	O
src	*(char)
+=	O
block_size	long
,	O
length	long
-=	O
block_size	long
)	O
{	O
f	*((*(void),long,*(char),*(char))->(void))
(	O
ctx	*(void)
,	O
block_size	long
,	O
buffer	*(char)
,	O
p	*(void)
)	O
;	O
memxor	O
(	O
dst	*(char)
,	O
buffer	*(char)
,	O
block_size	long
)	O
;	O
}	O
}	O
if	O
(	O
p	*(void)
!=	O
iv	*(char)
)	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
iv	*(char)
,	O
p	*(void)
,	O
block_size	long
)	O
;	O
if	O
(	O
length	long
)	O
{	O
f	*((*(void),long,*(char),*(char))->(void))
(	O
ctx	*(void)
,	O
block_size	long
,	O
buffer	*(char)
,	O
iv	*(char)
)	O
;	O
memxor3	O
(	O
dst	*(char)
,	O
buffer	*(char)
,	O
src	*(char)
,	O
length	long
)	O
;	O
}	O
}	O
void	O
cfb_decrypt	O
(	O
const	O
void	O
*	O
ctx	*(void)
,	O
nettle_cipher_func	(*(void),long,*(char),*(char))->(void)
*	O
f	*((*(void),long,*(char),*(char))->(void))
,	O
size_t	long
block_size	long
,	O
uint8_t	char
*	O
iv	*(char)
,	O
size_t	long
length	long
,	O
uint8_t	char
*	O
dst	*(char)
,	O
const	O
uint8_t	char
*	O
src	*(char)
)	O
{	O
if	O
(	O
src	*(char)
!=	O
dst	*(char)
)	O
{	O
size_t	long
left	long
=	O
length	long
%	O
block_size	long
;	O
length	long
-=	O
left	long
;	O
if	O
(	O
length	long
>	O
0	int
)	O
{	O
f	*((*(void),long,*(char),*(char))->(void))
(	O
ctx	*(void)
,	O
block_size	long
,	O
dst	*(char)
,	O
iv	*(char)
)	O
;	O
f	*((*(void),long,*(char),*(char))->(void))
(	O
ctx	*(void)
,	O
length	long
-	O
block_size	long
,	O
dst	*(char)
+	O
block_size	long
,	O
src	*(char)
)	O
;	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
iv	*(char)
,	O
src	*(char)
+	O
length	long
-	O
block_size	long
,	O
block_size	long
)	O
;	O
memxor	O
(	O
dst	*(char)
,	O
src	*(char)
,	O
length	long
)	O
;	O
}	O
if	O
(	O
left	long
>	O
0	int
)	O
{	O
TMP_DECL	O
(	O
buffer	*(char)
,	O
uint8_t	char
,	O
NETTLE_MAX_CIPHER_BLOCK_SIZE	O
)	O
;	O
TMP_ALLOC	O
(	O
buffer	*(char)
,	O
block_size	long
)	O
;	O
f	*((*(void),long,*(char),*(char))->(void))
(	O
ctx	*(void)
,	O
block_size	long
,	O
buffer	*(char)
,	O
iv	*(char)
)	O
;	O
memxor3	O
(	O
dst	*(char)
+	O
length	long
,	O
src	*(char)
+	O
length	long
,	O
buffer	*(char)
,	O
left	long
)	O
;	O
}	O
}	O
else	O
{	O
TMP_DECL	O
(	O
buffer	*(char)
,	O
uint8_t	char
,	O
CFB_BUFFER_LIMIT	int
)	O
;	O
TMP_DECL	O
(	O
initial_iv	*(char)
,	O
uint8_t	char
,	O
NETTLE_MAX_CIPHER_BLOCK_SIZE	O
)	O
;	O
size_t	long
buffer_size	long
;	O
size_t	long
left	long
;	O
buffer_size	long
=	O
CFB_BUFFER_LIMIT	int
-	O
(	O
CFB_BUFFER_LIMIT	int
%	O
block_size	long
)	O
;	O
TMP_ALLOC	O
(	O
buffer	*(char)
,	O
buffer_size	long
)	O
;	O
TMP_ALLOC	O
(	O
initial_iv	*(char)
,	O
block_size	long
)	O
;	O
left	long
=	O
length	long
%	O
block_size	long
;	O
length	long
-=	O
left	long
;	O
while	O
(	O
length	long
>	O
0	int
)	O
{	O
size_t	long
part	long
=	O
length	long
>	O
buffer_size	long
?	O
buffer_size	long
:	O
length	long
;	O
f	*((*(void),long,*(char),*(char))->(void))
(	O
ctx	*(void)
,	O
block_size	long
,	O
buffer	*(char)
,	O
iv	*(char)
)	O
;	O
f	*((*(void),long,*(char),*(char))->(void))
(	O
ctx	*(void)
,	O
part	long
-	O
block_size	long
,	O
buffer	*(char)
+	O
block_size	long
,	O
dst	*(char)
)	O
;	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
iv	*(char)
,	O
dst	*(char)
+	O
part	long
-	O
block_size	long
,	O
block_size	long
)	O
;	O
memxor	O
(	O
dst	*(char)
,	O
buffer	*(char)
,	O
part	long
)	O
;	O
length	long
-=	O
part	long
;	O
dst	*(char)
+=	O
part	long
;	O
}	O
if	O
(	O
left	long
>	O
0	int
)	O
{	O
f	*((*(void),long,*(char),*(char))->(void))
(	O
ctx	*(void)
,	O
block_size	long
,	O
buffer	*(char)
,	O
iv	*(char)
)	O
;	O
memxor	O
(	O
dst	*(char)
,	O
buffer	*(char)
,	O
left	long
)	O
;	O
}	O
}	O
}	O
void	O
cfb8_encrypt	O
(	O
const	O
void	O
*	O
ctx	*(void)
,	O
nettle_cipher_func	(*(void),long,*(char),*(char))->(void)
*	O
f	*((*(void),long,*(char),*(char))->(void))
,	O
size_t	long
block_size	long
,	O
uint8_t	char
*	O
iv	*(char)
,	O
size_t	long
length	long
,	O
uint8_t	char
*	O
dst	*(char)
,	O
const	O
uint8_t	char
*	O
src	*(char)
)	O
{	O
TMP_DECL	O
(	O
buffer	*(char)
,	O
uint8_t	char
,	O
NETTLE_MAX_CIPHER_BLOCK_SIZE	O
*	O
2	int
)	O
;	O
TMP_DECL	O
(	O
outbuf	*(char)
,	O
uint8_t	char
,	O
NETTLE_MAX_CIPHER_BLOCK_SIZE	O
)	O
;	O
TMP_ALLOC	O
(	O
buffer	*(char)
,	O
block_size	long
*	O
2	int
)	O
;	O
TMP_ALLOC	O
(	O
outbuf	*(char)
,	O
block_size	long
)	O
;	O
uint8_t	char
pos	char
;	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
buffer	*(char)
,	O
iv	*(char)
,	O
block_size	long
)	O
;	O
pos	char
=	O
0	int
;	O
while	O
(	O
length	long
)	O
{	O
uint8_t	char
t	char
;	O
if	O
(	O
pos	char
==	O
block_size	long
)	O
{	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
buffer	*(char)
,	O
buffer	*(char)
+	O
block_size	long
,	O
block_size	long
)	O
;	O
pos	char
=	O
0	int
;	O
}	O
f	*((*(void),long,*(char),*(char))->(void))
(	O
ctx	*(void)
,	O
block_size	long
,	O
outbuf	*(char)
,	O
buffer	*(char)
+	O
pos	char
)	O
;	O
t	char
=	O
*	O
(	O
dst	*(char)
++	O
)	O
=	O
*	O
(	O
src	*(char)
++	O
)	O
^	O
outbuf	*(char)
[	O
0	int
]	O
;	O
buffer	*(char)
[	O
pos	char
+	O
block_size	long
]	O
=	O
t	char
;	O
length	long
--	O
;	O
pos	char
++	O
;	O
}	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
iv	*(char)
,	O
buffer	*(char)
+	O
pos	char
,	O
block_size	long
)	O
;	O
}	O
void	O
cfb8_decrypt	O
(	O
const	O
void	O
*	O
ctx	*(void)
,	O
nettle_cipher_func	(*(void),long,*(char),*(char))->(void)
*	O
f	*((*(void),long,*(char),*(char))->(void))
,	O
size_t	long
block_size	long
,	O
uint8_t	char
*	O
iv	*(char)
,	O
size_t	long
length	long
,	O
uint8_t	char
*	O
dst	*(char)
,	O
const	O
uint8_t	char
*	O
src	*(char)
)	O
{	O
TMP_DECL	O
(	O
buffer	*(char)
,	O
uint8_t	char
,	O
NETTLE_MAX_CIPHER_BLOCK_SIZE	O
*	O
2	int
)	O
;	O
TMP_DECL	O
(	O
outbuf	*(char)
,	O
uint8_t	char
,	O
NETTLE_MAX_CIPHER_BLOCK_SIZE	O
*	O
2	int
)	O
;	O
TMP_ALLOC	O
(	O
buffer	*(char)
,	O
block_size	long
*	O
2	int
)	O
;	O
TMP_ALLOC	O
(	O
outbuf	*(char)
,	O
block_size	long
*	O
2	int
)	O
;	O
uint8_t	char
i	char
=	O
0	int
;	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
buffer	*(char)
,	O
iv	*(char)
,	O
block_size	long
)	O
;	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
buffer	*(char)
+	O
block_size	long
,	O
src	*(char)
,	O
length	long
<	O
block_size	long
?	O
length	long
:	O
block_size	long
)	O
;	O
while	O
(	O
length	long
)	O
{	O
for	O
(	O
i	char
=	O
0	int
;	O
i	char
<	O
length	long
&&	O
i	char
<	O
block_size	long
;	O
i	char
++	O
)	O
f	*((*(void),long,*(char),*(char))->(void))
(	O
ctx	*(void)
,	O
block_size	long
,	O
outbuf	*(char)
+	O
i	char
,	O
buffer	*(char)
+	O
i	char
)	O
;	O
memxor3	O
(	O
dst	*(char)
,	O
src	*(char)
,	O
outbuf	*(char)
,	O
i	char
)	O
;	O
length	long
-=	O
i	char
;	O
src	*(char)
+=	O
i	char
;	O
dst	*(char)
+=	O
i	char
;	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
buffer	*(char)
,	O
buffer	*(char)
+	O
block_size	long
,	O
block_size	long
)	O
;	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
buffer	*(char)
+	O
block_size	long
,	O
src	*(char)
,	O
length	long
<	O
block_size	long
?	O
length	long
:	O
block_size	long
)	O
;	O
}	O
memcpy	(*(void),*(void),long)->(*(void))
(	O
iv	*(char)
,	O
buffer	*(char)
+	O
i	char
,	O
block_size	long
)	O
;	O
}	O
