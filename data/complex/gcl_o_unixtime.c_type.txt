int	O
runtime	()->(int)
(	O
void	O
)	O
{	O
{	O
struct	O
tms	O
buf	struct
;	O
times	()->(int)
(	O
&	O
buf	struct
)	O
;	O
return	O
(	O
buf	struct
.	O
tms_utime	O
)	O
;	O
}	O
}	O
object	O
unix_time_to_universal_time	(int)->(int)
(	O
int	O
i	int
)	O
{	O
object	O
x	O
;	O
vs_mark	O
;	O
vs_push	()->(int)
(	O
make_fixnum	()->(int)
(	O
24	int
*	O
60	int
*	O
60	int
)	O
)	O
;	O
vs_push	()->(int)
(	O
make_fixnum	()->(int)
(	O
70	int
*	O
365	int
+	O
17	int
)	O
)	O
;	O
x	O
=	O
number_times	()->(int)
(	O
vs_top	O
[	O
-	O
1	int
]	O
,	O
vs_top	O
[	O
-	O
2	int
]	O
)	O
;	O
vs_push	()->(int)
(	O
x	O
)	O
;	O
vs_push	()->(int)
(	O
make_fixnum	()->(int)
(	O
i	int
)	O
)	O
;	O
x	O
=	O
number_plus	()->(int)
(	O
vs_top	O
[	O
-	O
1	int
]	O
,	O
vs_top	O
[	O
-	O
2	int
]	O
)	O
;	O
vs_reset	O
;	O
return	O
(	O
x	O
)	O
;	O
}	O
DEFUN_NEW	()->(int)
(	O
"GET-UNIVERSAL-TIME"	*(char)
,	O
object	O
,	O
fLget_universal_time	O
,	O
LISP	O
,	O
0	int
,	O
0	int
,	O
NONE	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
(	O
void	O
)	O
,	O
""	*(char)
)	O
{	O
RETURN1	()->(int)
(	O
unix_time_to_universal_time	(int)->(int)
(	O
time	()->(int)
(	O
0	int
)	O
)	O
)	O
;	O
}	O
LFD	(int)->(int)
(	O
Lsleep	int
)	O
(	O
void	O
)	O
{	O
object	O
z	O
;	O
check_arg	()->(int)
(	O
1	int
)	O
;	O
check_type_or_rational_float	()->(int)
(	O
&	O
vs_base	O
[	O
0	int
]	O
)	O
;	O
if	O
(	O
number_minusp	()->(int)
(	O
vs_base	O
[	O
0	int
]	O
)	O
==	O
TRUE	O
)	O
FEerror	()->(int)
(	O
"~S is not a non-negative number."	*(char)
,	O
1	int
,	O
vs_base	O
[	O
0	int
]	O
)	O
;	O
vs_base	O
[	O
0	int
]	O
=	O
number_times	()->(int)
(	O
vs_base	O
[	O
0	int
]	O
,	O
make_fixnum	()->(int)
(	O
1000000	int
)	O
)	O
;	O
Lround	()->(int)
(	O
)	O
;	O
z	O
=	O
vs_base	O
[	O
0	int
]	O
;	O
if	O
(	O
type_of	()->(int)
(	O
z	O
)	O
==	O
t_fixnum	O
)	O
usleep	(int)->(int)
(	O
fix	()->(int)
(	O
z	O
)	O
)	O
;	O
else	O
for	O
(	O
;	O
;	O
)	O
sleep	(int)->(int)
(	O
1000	int
)	O
;	O
vs_top	O
=	O
vs_base	O
;	O
vs_push	()->(int)
(	O
Cnil	O
)	O
;	O
}	O
LFD	(int)->(int)
(	O
Lget_internal_run_time	int
)	O
(	O
void	O
)	O
{	O
struct	O
tms	O
buf	struct
;	O
check_arg	()->(int)
(	O
0	int
)	O
;	O
times	()->(int)
(	O
&	O
buf	struct
)	O
;	O
vs_push	()->(int)
(	O
make_fixnum	()->(int)
(	O
buf	struct
.	O
tms_utime	O
)	O
)	O
;	O
vs_push	()->(int)
(	O
make_fixnum	()->(int)
(	O
buf	struct
.	O
tms_cutime	O
)	O
)	O
;	O
vs_push	()->(int)
(	O
make_fixnum	()->(int)
(	O
buf	struct
.	O
tms_stime	O
)	O
)	O
;	O
vs_push	()->(int)
(	O
make_fixnum	()->(int)
(	O
buf	struct
.	O
tms_cstime	O
)	O
)	O
;	O
}	O
DEFUN_NEW	()->(int)
(	O
"GETTIMEOFDAY"	*(char)
,	O
object	O
,	O
fSgettimeofday	O
,	O
SI	O
,	O
0	int
,	O
0	int
,	O
NONE	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
(	O
void	O
)	O
,	O
"Return time with maximum resolution"	*(char)
)	O
{	O
}	O
DEFUN_NEW	()->(int)
(	O
"GET-INTERNAL-REAL-TIME"	*(char)
,	O
object	O
,	O
fLget_internal_real_time	O
,	O
LISP	O
,	O
0	int
,	O
0	int
,	O
NONE	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
(	O
void	O
)	O
,	O
"Run time relative to beginning"	*(char)
)	O
{	O
}	O
void	O
gcl_init_unixtime	()->(void)
(	O
void	O
)	O
{	O
make_constant	()->(int)
(	O
"INTERNAL-TIME-UNITS-PER-SECOND"	*(char)
,	O
make_fixnum	()->(int)
(	O
HZ1	O
)	O
)	O
;	O
make_function	()->(int)
(	O
"SLEEP"	*(char)
,	O
Lsleep	int
)	O
;	O
make_function	()->(int)
(	O
"GET-INTERNAL-RUN-TIME"	*(char)
,	O
Lget_internal_run_time	int
)	O
;	O
}	O
DEFUN_NEW	()->(int)
(	O
"CURRENT-TIMEZONE"	*(char)
,	O
object	O
,	O
fScurrent_timezone	O
,	O
SI	O
,	O
0	int
,	O
0	int
,	O
NONE	O
,	O
IO	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
(	O
void	O
)	O
,	O
""	*(char)
)	O
{	O
fixnum	O
_t	O
=	O
time	()->(int)
(	O
0	int
)	O
;	O
return	O
(	O
object	O
)	O
(	O
-	O
localtime	()->(int)
(	O
&	O
_t	O
)	O
->	O
tm_gmtoff	O
/	O
3600	int
)	O
;	O
}	O
DEFUN_NEW	()->(int)
(	O
"CURRENT-DSTP"	*(char)
,	O
object	O
,	O
fScurrent_dstp	O
,	O
SI	O
,	O
0	int
,	O
0	int
,	O
NONE	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
OO	O
,	O
(	O
void	O
)	O
,	O
""	*(char)
)	O
{	O
fixnum	O
_t	O
=	O
time	()->(int)
(	O
0	int
)	O
;	O
return	O
localtime	()->(int)
(	O
&	O
_t	O
)	O
->	O
tm_isdst	O
>	O
0	int
?	O
Ct	O
:	O
Cnil	O
;	O
}	O
