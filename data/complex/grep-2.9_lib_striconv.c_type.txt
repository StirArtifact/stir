int	O
mem_cd_iconv	(*(char),long,*(void),*(*(char)),*(long))->(int)
(	O
const	O
char	O
*	O
src	*(char)
,	O
size_t	long
srclen	long
,	O
iconv_t	*(void)
cd	*(void)
,	O
char	O
*	O
*	O
resultp	*(*(char))
,	O
size_t	long
*	O
lengthp	*(long)
)	O
{	O
size_t	long
length	long
;	O
char	O
*	O
result	*(char)
;	O
iconv	(*(void),*(*(char)),*(long),*(*(char)),*(long))->(long)
(	O
cd	*(void)
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
)	O
;	O
{	O
size_t	long
count	long
=	O
0	int
;	O
union	O
{	O
unsigned	O
int	O
align	int
;	O
char	O
buf	array(char)
[	O
tmpbufsize	int
]	O
;	O
}	O
tmp	union(int,array(char))
;	O
const	O
char	O
*	O
inptr	*(char)
=	O
src	*(char)
;	O
size_t	long
insize	long
=	O
srclen	long
;	O
while	O
(	O
insize	long
>	O
0	int
)	O
{	O
char	O
*	O
outptr	*(char)
=	O
tmpbuf	O
;	O
size_t	long
outsize	long
=	O
tmpbufsize	int
;	O
size_t	long
res	long
=	O
iconv	(*(void),*(*(char)),*(long),*(*(char)),*(long))->(long)
(	O
cd	*(void)
,	O
(	O
ICONV_CONST	O
char	O
*	O
*	O
)	O
&	O
inptr	*(char)
,	O
&	O
insize	long
,	O
&	O
outptr	*(char)
,	O
&	O
outsize	long
)	O
;	O
if	O
(	O
res	long
==	O
(	O
size_t	long
)	O
(	O
-	O
1	int
)	O
)	O
{	O
if	O
(	O
errno	O
==	O
E2BIG	int
)	O
;	O
else	O
if	O
(	O
errno	O
==	O
EINVAL	int
)	O
break	O
;	O
else	O
return	O
-	O
1	int
;	O
}	O
count	long
+=	O
outptr	*(char)
-	O
tmpbuf	O
;	O
}	O
{	O
char	O
*	O
outptr	*(char)
=	O
tmpbuf	O
;	O
size_t	long
outsize	long
=	O
tmpbufsize	int
;	O
size_t	long
res	long
=	O
iconv	(*(void),*(*(char)),*(long),*(*(char)),*(long))->(long)
(	O
cd	*(void)
,	O
NULL	O
,	O
NULL	O
,	O
&	O
outptr	*(char)
,	O
&	O
outsize	long
)	O
;	O
if	O
(	O
res	long
==	O
(	O
size_t	long
)	O
(	O
-	O
1	int
)	O
)	O
return	O
-	O
1	int
;	O
count	long
+=	O
outptr	*(char)
-	O
tmpbuf	O
;	O
}	O
length	long
=	O
count	long
;	O
}	O
if	O
(	O
length	long
==	O
0	int
)	O
{	O
*	O
lengthp	*(long)
=	O
0	int
;	O
return	O
0	int
;	O
}	O
if	O
(	O
*	O
resultp	*(*(char))
!=	O
NULL	O
&&	O
*	O
lengthp	*(long)
>=	O
length	long
)	O
result	*(char)
=	O
*	O
resultp	*(*(char))
;	O
else	O
{	O
result	*(char)
=	O
(	O
char	O
*	O
)	O
malloc	(long)->(*(void))
(	O
length	long
)	O
;	O
if	O
(	O
result	*(char)
==	O
NULL	O
)	O
{	O
errno	O
=	O
ENOMEM	int
;	O
return	O
-	O
1	int
;	O
}	O
}	O
iconv	(*(void),*(*(char)),*(long),*(*(char)),*(long))->(long)
(	O
cd	*(void)
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
)	O
;	O
{	O
const	O
char	O
*	O
inptr	*(char)
=	O
src	*(char)
;	O
size_t	long
insize	long
=	O
srclen	long
;	O
char	O
*	O
outptr	*(char)
=	O
result	*(char)
;	O
size_t	long
outsize	long
=	O
length	long
;	O
while	O
(	O
insize	long
>	O
0	int
)	O
{	O
size_t	long
res	long
=	O
iconv	(*(void),*(*(char)),*(long),*(*(char)),*(long))->(long)
(	O
cd	*(void)
,	O
(	O
ICONV_CONST	O
char	O
*	O
*	O
)	O
&	O
inptr	*(char)
,	O
&	O
insize	long
,	O
&	O
outptr	*(char)
,	O
&	O
outsize	long
)	O
;	O
if	O
(	O
res	long
==	O
(	O
size_t	long
)	O
(	O
-	O
1	int
)	O
)	O
{	O
if	O
(	O
errno	O
==	O
EINVAL	int
)	O
break	O
;	O
else	O
goto	O
fail	O
;	O
}	O
}	O
{	O
size_t	long
res	long
=	O
iconv	(*(void),*(*(char)),*(long),*(*(char)),*(long))->(long)
(	O
cd	*(void)
,	O
NULL	O
,	O
NULL	O
,	O
&	O
outptr	*(char)
,	O
&	O
outsize	long
)	O
;	O
if	O
(	O
res	long
==	O
(	O
size_t	long
)	O
(	O
-	O
1	int
)	O
)	O
goto	O
fail	O
;	O
}	O
if	O
(	O
outsize	long
!=	O
0	int
)	O
abort	()->(void)
(	O
)	O
;	O
}	O
*	O
resultp	*(*(char))
=	O
result	*(char)
;	O
*	O
lengthp	*(long)
=	O
length	long
;	O
return	O
0	int
;	O
fail	O
:	O
{	O
if	O
(	O
result	*(char)
!=	O
*	O
resultp	*(*(char))
)	O
{	O
int	O
saved_errno	int
=	O
errno	O
;	O
free	(*(void))->(void)
(	O
result	*(char)
)	O
;	O
errno	O
=	O
saved_errno	int
;	O
}	O
return	O
-	O
1	int
;	O
}	O
}	O
char	O
*	O
str_cd_iconv	(*(char),*(void))->(*(char))
(	O
const	O
char	O
*	O
src	*(char)
,	O
iconv_t	*(void)
cd	*(void)
)	O
{	O
char	O
*	O
result	*(char)
;	O
size_t	long
result_size	long
;	O
size_t	long
length	long
;	O
const	O
char	O
*	O
inptr	*(char)
=	O
src	*(char)
;	O
size_t	long
inbytes_remaining	long
=	O
strlen	(*(char))->(long)
(	O
src	*(char)
)	O
;	O
result_size	long
=	O
inbytes_remaining	long
;	O
{	O
size_t	long
approx_sqrt_SIZE_MAX	long
=	O
SIZE_MAX	O
>>	O
(	O
sizeof	O
(	O
size_t	long
)	O
*	O
CHAR_BIT	O
/	O
2	int
)	O
;	O
if	O
(	O
result_size	long
<=	O
approx_sqrt_SIZE_MAX	long
/	O
MB_LEN_MAX	int
)	O
result_size	long
*=	O
MB_LEN_MAX	int
;	O
}	O
result_size	long
+=	O
1	int
;	O
result	*(char)
=	O
(	O
char	O
*	O
)	O
malloc	(long)->(*(void))
(	O
result_size	long
)	O
;	O
if	O
(	O
result	*(char)
==	O
NULL	O
)	O
{	O
errno	O
=	O
ENOMEM	int
;	O
return	O
NULL	O
;	O
}	O
iconv	(*(void),*(*(char)),*(long),*(*(char)),*(long))->(long)
(	O
cd	*(void)
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
,	O
NULL	O
)	O
;	O
{	O
char	O
*	O
outptr	*(char)
=	O
result	*(char)
;	O
size_t	long
outbytes_remaining	long
=	O
result_size	long
-	O
1	int
;	O
for	O
(	O
;	O
;	O
)	O
{	O
size_t	long
res	long
=	O
iconv	(*(void),*(*(char)),*(long),*(*(char)),*(long))->(long)
(	O
cd	*(void)
,	O
(	O
ICONV_CONST	O
char	O
*	O
*	O
)	O
&	O
inptr	*(char)
,	O
&	O
inbytes_remaining	long
,	O
&	O
outptr	*(char)
,	O
&	O
outbytes_remaining	long
)	O
;	O
if	O
(	O
res	long
==	O
(	O
size_t	long
)	O
(	O
-	O
1	int
)	O
)	O
{	O
if	O
(	O
errno	O
==	O
EINVAL	int
)	O
break	O
;	O
else	O
if	O
(	O
errno	O
==	O
E2BIG	int
)	O
{	O
size_t	long
used	long
=	O
outptr	*(char)
-	O
result	*(char)
;	O
size_t	long
newsize	long
=	O
result_size	long
*	O
2	int
;	O
char	O
*	O
newresult	*(char)
;	O
if	O
(	O
!	O
(	O
newsize	long
>	O
result_size	long
)	O
)	O
{	O
errno	O
=	O
ENOMEM	int
;	O
goto	O
failed	O
;	O
}	O
newresult	*(char)
=	O
(	O
char	O
*	O
)	O
realloc	(*(void),long)->(*(void))
(	O
result	*(char)
,	O
newsize	long
)	O
;	O
if	O
(	O
newresult	*(char)
==	O
NULL	O
)	O
{	O
errno	O
=	O
ENOMEM	int
;	O
goto	O
failed	O
;	O
}	O
result	*(char)
=	O
newresult	*(char)
;	O
result_size	long
=	O
newsize	long
;	O
outptr	*(char)
=	O
result	*(char)
+	O
used	long
;	O
outbytes_remaining	long
=	O
result_size	long
-	O
1	int
-	O
used	long
;	O
}	O
else	O
goto	O
failed	O
;	O
}	O
else	O
break	O
;	O
}	O
for	O
(	O
;	O
;	O
)	O
{	O
size_t	long
res	long
=	O
iconv	(*(void),*(*(char)),*(long),*(*(char)),*(long))->(long)
(	O
cd	*(void)
,	O
NULL	O
,	O
NULL	O
,	O
&	O
outptr	*(char)
,	O
&	O
outbytes_remaining	long
)	O
;	O
if	O
(	O
res	long
==	O
(	O
size_t	long
)	O
(	O
-	O
1	int
)	O
)	O
{	O
if	O
(	O
errno	O
==	O
E2BIG	int
)	O
{	O
size_t	long
used	long
=	O
outptr	*(char)
-	O
result	*(char)
;	O
size_t	long
newsize	long
=	O
result_size	long
*	O
2	int
;	O
char	O
*	O
newresult	*(char)
;	O
if	O
(	O
!	O
(	O
newsize	long
>	O
result_size	long
)	O
)	O
{	O
errno	O
=	O
ENOMEM	int
;	O
goto	O
failed	O
;	O
}	O
newresult	*(char)
=	O
(	O
char	O
*	O
)	O
realloc	(*(void),long)->(*(void))
(	O
result	*(char)
,	O
newsize	long
)	O
;	O
if	O
(	O
newresult	*(char)
==	O
NULL	O
)	O
{	O
errno	O
=	O
ENOMEM	int
;	O
goto	O
failed	O
;	O
}	O
result	*(char)
=	O
newresult	*(char)
;	O
result_size	long
=	O
newsize	long
;	O
outptr	*(char)
=	O
result	*(char)
+	O
used	long
;	O
outbytes_remaining	long
=	O
result_size	long
-	O
1	int
-	O
used	long
;	O
}	O
else	O
goto	O
failed	O
;	O
}	O
else	O
break	O
;	O
}	O
*	O
outptr	*(char)
++	O
=	O
'\0'	O
;	O
length	long
=	O
outptr	*(char)
-	O
result	*(char)
;	O
}	O
if	O
(	O
length	long
<	O
result_size	long
)	O
{	O
char	O
*	O
smaller_result	*(char)
=	O
(	O
char	O
*	O
)	O
realloc	(*(void),long)->(*(void))
(	O
result	*(char)
,	O
length	long
)	O
;	O
if	O
(	O
smaller_result	*(char)
!=	O
NULL	O
)	O
result	*(char)
=	O
smaller_result	*(char)
;	O
}	O
return	O
result	*(char)
;	O
failed	O
:	O
{	O
int	O
saved_errno	int
=	O
errno	O
;	O
free	(*(void))->(void)
(	O
result	*(char)
)	O
;	O
errno	O
=	O
saved_errno	int
;	O
return	O
NULL	O
;	O
}	O
}	O
char	O
*	O
str_iconv	(*(char),*(char),*(char))->(*(char))
(	O
const	O
char	O
*	O
src	*(char)
,	O
const	O
char	O
*	O
from_codeset	*(char)
,	O
const	O
char	O
*	O
to_codeset	*(char)
)	O
{	O
if	O
(	O
*	O
src	*(char)
==	O
'\0'	O
||	O
c_strcasecmp	(*(char),*(char))->(int)
(	O
from_codeset	*(char)
,	O
to_codeset	*(char)
)	O
==	O
0	int
)	O
{	O
char	O
*	O
result	*(char)
=	O
strdup	(*(char))->(*(char))
(	O
src	*(char)
)	O
;	O
if	O
(	O
result	*(char)
==	O
NULL	O
)	O
errno	O
=	O
ENOMEM	int
;	O
return	O
result	*(char)
;	O
}	O
else	O
{	O
iconv_t	*(void)
cd	*(void)
;	O
char	O
*	O
result	*(char)
;	O
cd	*(void)
=	O
iconv_open	(*(char),*(char))->(*(void))
(	O
to_codeset	*(char)
,	O
from_codeset	*(char)
)	O
;	O
if	O
(	O
cd	*(void)
==	O
(	O
iconv_t	*(void)
)	O
-	O
1	int
)	O
return	O
NULL	O
;	O
result	*(char)
=	O
str_cd_iconv	(*(char),*(void))->(*(char))
(	O
src	*(char)
,	O
cd	*(void)
)	O
;	O
if	O
(	O
result	*(char)
==	O
NULL	O
)	O
{	O
int	O
saved_errno	int
=	O
errno	O
;	O
iconv_close	(*(void))->(int)
(	O
cd	*(void)
)	O
;	O
errno	O
=	O
saved_errno	int
;	O
}	O
else	O
{	O
if	O
(	O
iconv_close	(*(void))->(int)
(	O
cd	*(void)
)	O
<	O
0	int
)	O
{	O
int	O
saved_errno	int
=	O
errno	O
;	O
free	(*(void))->(void)
(	O
result	*(char)
)	O
;	O
errno	O
=	O
saved_errno	int
;	O
return	O
NULL	O
;	O
}	O
}	O
return	O
result	*(char)
;	O
}	O
}	O
