typedef	O
struct	O
{	O
char	O
*	O
me	*(char)
;	O
char	O
*	O
device	*(char)
;	O
char	O
*	O
host_name	*(char)
;	O
int	O
host_port	int
;	O
char	O
*	O
proxy_name	*(char)
;	O
int	O
proxy_port	int
;	O
size_t	long
proxy_buffer_size	long
;	O
int	O
proxy_buffer_timeout	int
;	O
size_t	long
content_length	long
;	O
int	O
forward_port	int
;	O
int	O
use_std	int
;	O
int	O
use_daemon	int
;	O
int	O
strict_content_length	int
;	O
int	O
keep_alive	int
;	O
int	O
max_connection_age	int
;	O
char	O
*	O
proxy_authorization	*(char)
;	O
char	O
*	O
user_agent	*(char)
;	O
}	O
Arguments	struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char))
;	O
int	O
debug_level	int
=	O
0	int
;	O
FILE	struct
*	O
debug_file	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
=	O
NULL	O
;	O
static	O
void	O
usage	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(void)
(	O
FILE	struct
*	O
f	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
const	O
char	O
*	O
me	*(char)
)	O
{	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
f	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
"Usage: %s [OPTION]... HOST[:PORT]\n"	*(char)
"Set up a httptunnel connection to PORT at HOST (default port is %d).\n"	*(char)
"When a connection is made, I/O is redirected from the source specified\n"	*(char)
"by the --device, --forward-port or --stdin-stdout switch to the tunnel.\n"	*(char)
"\n"	*(char)
"  -A, --proxy-authorization USER:PASSWORD  proxy authorization\n"	*(char)
"  -z, --proxy-authorization-file FILE      proxy authorization file\n"	*(char)
"  -B, --proxy-buffer-size BYTES  assume a proxy buffer size of BYTES bytes\n"	*(char)
"                                 (k, M, and G postfixes recognized)\n"	*(char)
"  -c, --content-length BYTES     use HTTP PUT requests of BYTES size\n"	*(char)
"                                 (k, M, and G postfixes recognized)\n"	*(char)
"  -d, --device DEVICE            use DEVICE for input and output\n"	*(char)
"  -F, --forward-port PORT        use TCP port PORT for input and output\n"	*(char)
"  -h, --help                     display this help and exit\n"	*(char)
"  -k, --keep-alive SECONDS       send keepalive bytes every SECONDS seconds\n"	*(char)
"                                 (default is %d)\n"	*(char)
"  -M, --max-connection-age SEC   maximum time a connection will stay\n"	*(char)
"                                 open is SEC seconds (default is %d)\n"	*(char)
"  -P, --proxy HOSTNAME[:PORT]    use a HTTP proxy (default port is %d)\n"	*(char)
"  -s, --stdin-stdout             use stdin/stdout for communication\n"	*(char)
"                                 (implies --no-daemon)\n"	*(char)
"  -S, --strict-content-length    always write Content-Length bytes in requests\n"	*(char)
"  -T, --timeout TIME             timeout, in milliseconds, before sending\n"	*(char)
"                                 padding to a buffering proxy\n"	*(char)
"  -U, --user-agent STRING        specify User-Agent value in HTTP requests\n"	*(char)
"  -V, --version                  output version information and exit\n"	*(char)
"  -w, --no-daemon                don't fork into the background\n"	*(char)
"\n"	*(char)
"Report bugs to %s.\n"	*(char)
,	O
me	*(char)
,	O
DEFAULT_HOST_PORT	int
,	O
DEFAULT_KEEP_ALIVE	int
,	O
DEFAULT_MAX_CONNECTION_AGE	int
,	O
DEFAULT_PROXY_PORT	int
,	O
BUG_REPORT_EMAIL	*(char)
)	O
;	O
}	O
static	O
int	O
wait_for_connection_on_socket	(int)->(int)
(	O
int	O
s	int
)	O
{	O
struct	O
sockaddr	struct(short,array(char))
addr	struct(int)
;	O
socklen_t	int
len	long
;	O
int	O
t	int
;	O
len	long
=	O
sizeof	O
addr	struct(int)
;	O
t	int
=	O
accept	(int,*(struct(short,array(char))),*(int))->(int)
(	O
s	int
,	O
&	O
addr	struct(int)
,	O
&	O
len	long
)	O
;	O
if	O
(	O
t	int
==	O
-	O
1	int
)	O
return	O
-	O
1	int
;	O
return	O
t	int
;	O
}	O
static	O
void	O
parse_arguments	(int,*(*(char)),*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char))))->(void)
(	O
int	O
argc	int
,	O
char	O
*	O
*	O
argv	*(*(char))
,	O
Arguments	struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char))
*	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
)	O
{	O
int	O
c	int
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
=	O
argv	*(*(char))
[	O
0	int
]	O
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
device	*(char)
=	O
NULL	O
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
forward_port	int
=	O
-	O
1	int
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
host_name	*(char)
=	O
NULL	O
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
host_port	int
=	O
DEFAULT_HOST_PORT	int
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_name	*(char)
=	O
NO_PROXY	O
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_port	int
=	O
DEFAULT_PROXY_PORT	int
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_buffer_size	long
=	O
NO_PROXY_BUFFER	int
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_buffer_timeout	int
=	O
-	O
1	int
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
content_length	long
=	O
DEFAULT_CONTENT_LENGTH	O
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
use_std	int
=	O
FALSE	int
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
use_daemon	int
=	O
TRUE	int
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
strict_content_length	int
=	O
FALSE	int
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
keep_alive	int
=	O
DEFAULT_KEEP_ALIVE	int
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
max_connection_age	int
=	O
DEFAULT_CONNECTION_MAX_TIME	int
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_authorization	*(char)
=	O
NULL	O
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
user_agent	*(char)
=	O
NULL	O
;	O
for	O
(	O
;	O
;	O
)	O
{	O
int	O
option_index	int
=	O
0	int
;	O
static	O
struct	O
option	struct(*(char),int,*(int),int)
long_options	array(struct(*(char),int,*(int),int))
[	O
]	O
=	O
{	O
{	O
"help"	*(char)
,	O
no_argument	int
,	O
0	int
,	O
'h'	O
}	O
,	O
{	O
"version"	*(char)
,	O
no_argument	int
,	O
0	int
,	O
'V'	O
}	O
,	O
{	O
"no-daemon"	*(char)
,	O
no_argument	int
,	O
0	int
,	O
'w'	O
}	O
,	O
{	O
"stdin-stdout"	*(char)
,	O
no_argument	int
,	O
0	int
,	O
's'	O
}	O
,	O
{	O
"proxy"	*(char)
,	O
required_argument	int
,	O
0	int
,	O
'P'	O
}	O
,	O
{	O
"device"	*(char)
,	O
required_argument	int
,	O
0	int
,	O
'd'	O
}	O
,	O
{	O
"timeout"	*(char)
,	O
required_argument	int
,	O
0	int
,	O
'T'	O
}	O
,	O
{	O
"keep-alive"	*(char)
,	O
required_argument	int
,	O
0	int
,	O
'k'	O
}	O
,	O
{	O
"user-agent"	*(char)
,	O
required_argument	int
,	O
0	int
,	O
'U'	O
}	O
,	O
{	O
"forward-port"	*(char)
,	O
required_argument	int
,	O
0	int
,	O
'F'	O
}	O
,	O
{	O
"content-length"	*(char)
,	O
required_argument	int
,	O
0	int
,	O
'c'	O
}	O
,	O
{	O
"strict-content-length"	*(char)
,	O
no_argument	int
,	O
0	int
,	O
'S'	O
}	O
,	O
{	O
"proxy-buffer-size"	*(char)
,	O
required_argument	int
,	O
0	int
,	O
'B'	O
}	O
,	O
{	O
"proxy-authorization"	*(char)
,	O
required_argument	int
,	O
0	int
,	O
'A'	O
}	O
,	O
{	O
"max-connection-age"	*(char)
,	O
required_argument	int
,	O
0	int
,	O
'M'	O
}	O
,	O
{	O
"proxy-authorization-file"	*(char)
,	O
required_argument	int
,	O
0	int
,	O
'z'	O
}	O
,	O
{	O
0	int
,	O
0	int
,	O
0	int
,	O
0	int
}	O
}	O
;	O
static	O
const	O
char	O
*	O
short_options	*(char)
=	O
"A:B:c:d:F:hk:M:P:sST:U:Vwz:"	*(char)
;	O
c	int
=	O
getopt_long	(int,*(*(char)),*(char),*(struct(*(char),int,*(int),int)),*(int))->(int)
(	O
argc	int
,	O
argv	*(*(char))
,	O
short_options	*(char)
,	O
long_options	array(struct(*(char),int,*(int),int))
,	O
&	O
option_index	int
)	O
;	O
if	O
(	O
c	int
==	O
-	O
1	int
)	O
break	O
;	O
switch	O
(	O
c	int
)	O
{	O
case	O
0	int
:	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
"option %s"	*(char)
,	O
long_options	array(struct(*(char),int,*(int),int))
[	O
option_index	int
]	O
.	O
name	*(char)
)	O
;	O
if	O
(	O
optarg	*(char)
)	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
" with arg %s"	*(char)
,	O
optarg	*(char)
)	O
;	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
"\n"	*(char)
)	O
;	O
break	O
;	O
case	O
'A'	O
:	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_authorization	*(char)
=	O
optarg	*(char)
;	O
break	O
;	O
case	O
'B'	O
:	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_buffer_size	long
=	O
atoi_with_postfix	(*(char))->(int)
(	O
optarg	*(char)
)	O
;	O
break	O
;	O
case	O
'c'	O
:	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
content_length	long
=	O
atoi_with_postfix	(*(char))->(int)
(	O
optarg	*(char)
)	O
;	O
break	O
;	O
case	O
'd'	O
:	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
device	*(char)
=	O
optarg	*(char)
;	O
break	O
;	O
case	O
'F'	O
:	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
forward_port	int
=	O
atoi	(*(char))->(int)
(	O
optarg	*(char)
)	O
;	O
break	O
;	O
case	O
'k'	O
:	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
keep_alive	int
=	O
atoi	(*(char))->(int)
(	O
optarg	*(char)
)	O
;	O
break	O
;	O
case	O
'M'	O
:	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
max_connection_age	int
=	O
atoi	(*(char))->(int)
(	O
optarg	*(char)
)	O
;	O
break	O
;	O
case	O
'h'	O
:	O
usage	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(void)
(	O
stdout	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
)	O
;	O
exit	(int)->(void)
(	O
0	int
)	O
;	O
case	O
'P'	O
:	O
name_and_port	(*(char),*(*(char)),*(int))->(void)
(	O
optarg	*(char)
,	O
&	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_name	*(char)
,	O
&	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_port	int
)	O
;	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_port	int
==	O
-	O
1	int
)	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_port	int
=	O
DEFAULT_PROXY_PORT	int
;	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_buffer_timeout	int
==	O
-	O
1	int
)	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_buffer_timeout	int
=	O
DEFAULT_PROXY_BUFFER_TIMEOUT	int
;	O
break	O
;	O
case	O
's'	O
:	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
use_std	int
=	O
TRUE	int
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
use_daemon	int
=	O
FALSE	int
;	O
break	O
;	O
case	O
'S'	O
:	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
strict_content_length	int
=	O
TRUE	int
;	O
break	O
;	O
case	O
'T'	O
:	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_buffer_timeout	int
=	O
atoi	(*(char))->(int)
(	O
optarg	*(char)
)	O
;	O
break	O
;	O
case	O
'U'	O
:	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
user_agent	*(char)
=	O
optarg	*(char)
;	O
break	O
;	O
case	O
'V'	O
:	O
printf	(*(char))->(int)
(	O
"htc (%s) %s\n"	*(char)
,	O
PACKAGE	*(char)
,	O
VERSION	*(char)
)	O
;	O
exit	(int)->(void)
(	O
0	int
)	O
;	O
case	O
'w'	O
:	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
use_daemon	int
=	O
FALSE	int
;	O
break	O
;	O
case	O
'z'	O
:	O
{	O
struct	O
stat	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
s	int
;	O
char	O
*	O
auth	*(char)
;	O
int	O
f	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
;	O
f	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
=	O
open	(*(char),int)->(int)
(	O
optarg	*(char)
,	O
O_RDONLY	int
)	O
;	O
if	O
(	O
f	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
==	O
-	O
1	int
)	O
{	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
"couldn't open %s: %s\n"	*(char)
,	O
optarg	*(char)
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
if	O
(	O
fstat	(int,*(struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))))->(int)
(	O
f	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
&	O
s	int
)	O
==	O
-	O
1	int
)	O
{	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
"error fstating %s: %s\n"	*(char)
,	O
optarg	*(char)
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
auth	*(char)
=	O
malloc	(long)->(*(void))
(	O
s	int
.	O
st_size	long
+	O
1	int
)	O
;	O
if	O
(	O
auth	*(char)
==	O
NULL	O
)	O
{	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
"out of memory whilst allocating "	*(char)
"authentication string\n"	*(char)
)	O
;	O
exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
if	O
(	O
read_all	(int,*(void),long)->(long)
(	O
f	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
auth	*(char)
,	O
s	int
.	O
st_size	long
)	O
==	O
-	O
1	int
)	O
{	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
"error reading %s: %s\n"	*(char)
,	O
optarg	*(char)
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
if	O
(	O
s	int
.	O
st_size	long
>=	O
1	int
&&	O
auth	*(char)
[	O
s	int
.	O
st_size	long
-	O
1	int
]	O
==	O
'\n'	O
)	O
{	O
s	int
.	O
st_size	long
-=	O
(	O
s	int
.	O
st_size	long
>=	O
2	int
&&	O
auth	*(char)
[	O
s	int
.	O
st_size	long
-	O
2	int
]	O
==	O
'\r'	O
)	O
?	O
2	int
:	O
1	int
;	O
}	O
auth	*(char)
[	O
s	int
.	O
st_size	long
]	O
=	O
0	int
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_authorization	*(char)
=	O
auth	*(char)
;	O
}	O
break	O
;	O
case	O
'?'	O
:	O
break	O
;	O
default	O
:	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
"?? getopt returned character code 0%o ??\n"	*(char)
,	O
c	int
)	O
;	O
}	O
}	O
if	O
(	O
optind	int
==	O
argc	int
-	O
1	int
)	O
{	O
name_and_port	(*(char),*(*(char)),*(int))->(void)
(	O
argv	*(*(char))
[	O
optind	int
]	O
,	O
&	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
host_name	*(char)
,	O
&	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
host_port	int
)	O
;	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
host_port	int
==	O
-	O
1	int
)	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
host_port	int
=	O
DEFAULT_HOST_PORT	int
;	O
}	O
else	O
{	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
"%s: the destination of the tunnel must be specified.\n"	*(char)
"%s: try '%s --help' for help.\n"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
)	O
;	O
exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
device	*(char)
==	O
NULL	O
&&	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
forward_port	int
==	O
-	O
1	int
&&	O
!	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
use_std	int
)	O
{	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
"%s: one of --device, --forward-port or --stdin-stdout must be used.\n"	*(char)
"%s: try '%s -help' for help.\n"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
)	O
;	O
exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
if	O
(	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
device	*(char)
!=	O
NULL	O
&&	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
forward_port	int
!=	O
-	O
1	int
)	O
||	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
device	*(char)
!=	O
NULL	O
&&	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
use_std	int
)	O
||	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
forward_port	int
!=	O
-	O
1	int
&&	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
use_std	int
)	O
)	O
{	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
"%s: only one of --device, --forward-port or --stdin-stdout can be used.\n"	*(char)
"%s: try '%s --help' for help.\n"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
)	O
;	O
exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
host_name	*(char)
==	O
NULL	O
||	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
host_port	int
==	O
-	O
1	int
||	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_name	*(char)
!=	O
NO_PROXY	O
&&	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_port	int
==	O
-	O
1	int
)	O
)	O
{	O
usage	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(void)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
)	O
;	O
exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
if	O
(	O
debug_level	int
==	O
0	int
&&	O
debug_file	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
!=	O
NULL	O
)	O
{	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
"%s: --logfile can't be used without debugging\n"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
)	O
;	O
exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_name	*(char)
==	O
NO_PROXY	O
)	O
{	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_buffer_size	long
!=	O
NO_PROXY_BUFFER	int
)	O
{	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
"%s: warning: --proxy-buffer-size can't be "	*(char)
"used without --proxy\n"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
)	O
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_buffer_size	long
=	O
NO_PROXY_BUFFER	int
;	O
}	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_buffer_timeout	int
!=	O
-	O
1	int
)	O
{	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
"%s: warning: --proxy-buffer-timeout can't be "	*(char)
"used without --proxy\n"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
)	O
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_buffer_timeout	int
=	O
-	O
1	int
;	O
}	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_authorization	*(char)
!=	O
NULL	O
)	O
{	O
fprintf	(*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,*`,int,int,long,short,char,array(char),*`,long,*`,*`,*`,*`,long,int,array(char))),*(void),long,int,array(char))),*(char))->(int)
(	O
stderr	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
,	O
"%s: warning: --proxy-authorization can't be "	*(char)
"used without --proxy\n"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
me	*(char)
)	O
;	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_authorization	*(char)
=	O
NULL	O
;	O
}	O
}	O
else	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_buffer_size	long
==	O
NO_PROXY_BUFFER	int
)	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
->	O
proxy_buffer_timeout	int
=	O
-	O
1	int
;	O
}	O
int	O
main	(int,*(*(char)))->(int)
(	O
int	O
argc	int
,	O
char	O
*	O
*	O
argv	*(*(char))
)	O
{	O
int	O
s	int
=	O
-	O
1	int
;	O
int	O
fd	int
=	O
-	O
1	int
;	O
Arguments	struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char))
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
;	O
Tunnel	struct
*	O
tunnel	*(struct)
;	O
int	O
closed	*(int)
;	O
parse_arguments	(int,*(*(char)),*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char))))->(void)
(	O
argc	int
,	O
argv	*(*(char))
,	O
&	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
)	O
;	O
if	O
(	O
(	O
debug_level	int
==	O
0	int
||	O
debug_file	*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),int,int,long,short,char,array(char),*(void),long,*(struct),*(struct),*(struct(int,*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(char),*(struct`),*(struct`),int,int,long,short,char,array(char),*(void),long,*(struct`),*(struct`),*(struct`),*(void),long,int,array(char))),*(void),long,int,array(char)))
!=	O
NULL	O
)	O
&&	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
use_daemon	int
)	O
daemon	(int,int)->(int)
(	O
0	int
,	O
1	int
)	O
;	O
openlog	(*(char),int,int)->(void)
(	O
"htc"	*(char)
,	O
LOG_PID	int
,	O
LOG_DAEMON	O
)	O
;	O
log_notice	(*(char))->(void)
(	O
"htc (%s) %s started with arguments:"	*(char)
,	O
PACKAGE	*(char)
,	O
VERSION	*(char)
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  me = %s"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
me	*(char)
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  device = %s"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
device	*(char)
?	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
device	*(char)
:	O
"(null)"	*(char)
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  host_name = %s"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
host_name	*(char)
?	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
host_name	*(char)
:	O
"(null)"	*(char)
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  host_port = %d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
host_port	int
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  proxy_name = %s"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_name	*(char)
?	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_name	*(char)
:	O
"(null)"	*(char)
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  proxy_port = %d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_port	int
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  proxy_buffer_size = %d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_buffer_size	long
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  proxy_buffer_timeout = %d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_buffer_timeout	int
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  content_length = %d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
content_length	long
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  forward_port = %d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
forward_port	int
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  max_connection_age = %d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
max_connection_age	int
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  use_std = %d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
use_std	int
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  strict_content_length = %d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
strict_content_length	int
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  keep_alive = %d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
keep_alive	int
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  proxy_authorization = %s"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_authorization	*(char)
?	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_authorization	*(char)
:	O
"(null)"	*(char)
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  user_agent = %s"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
user_agent	*(char)
?	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
user_agent	*(char)
:	O
"(null)"	*(char)
)	O
;	O
log_notice	(*(char))->(void)
(	O
"  debug_level = %d"	*(char)
,	O
debug_level	int
)	O
;	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
forward_port	int
!=	O
-	O
1	int
)	O
{	O
struct	O
in_addr	struct(int)
addr	struct(int)
;	O
addr	struct(int)
.	O
s_addr	int
=	O
INADDR_ANY	O
;	O
s	int
=	O
server_socket	(struct(int),int,int)->(int)
(	O
addr	struct(int)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
forward_port	int
,	O
0	int
)	O
;	O
log_debug	()->(void)
(	O
"server_socket (%d) = %d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
forward_port	int
,	O
s	int
)	O
;	O
if	O
(	O
s	int
==	O
-	O
1	int
)	O
{	O
log_error	(*(char))->(void)
(	O
"couldn't create server socket: %s"	*(char)
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
log_exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
}	O
signal	(int,*((int)->(void)))->(*((int)->(void)))
(	O
SIGPIPE	int
,	O
SIG_IGN	O
)	O
;	O
for	O
(	O
;	O
;	O
)	O
{	O
time_t	long
last_tunnel_write	long
;	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
device	*(char)
)	O
{	O
fd	int
=	O
open_device	(*(char))->(int)
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
device	*(char)
)	O
;	O
log_debug	()->(void)
(	O
"open_device (\"%s\") = %d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
device	*(char)
,	O
fd	int
)	O
;	O
if	O
(	O
fd	int
==	O
-	O
1	int
)	O
{	O
log_error	(*(char))->(void)
(	O
"couldn't open %s: %s"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
device	*(char)
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
log_exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
if	O
(	O
fd	int
==	O
0	int
)	O
{	O
log_notice	(*(char))->(void)
(	O
"changing fd from %d to 3"	*(char)
,	O
fd	int
)	O
;	O
if	O
(	O
dup2	(int,int)->(int)
(	O
fd	int
,	O
3	int
)	O
!=	O
3	int
)	O
{	O
log_error	(*(char))->(void)
(	O
"couldn't dup2(%d,3): %s"	*(char)
,	O
fd	int
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
log_exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
}	O
}	O
else	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
forward_port	int
!=	O
-	O
1	int
)	O
{	O
log_debug	()->(void)
(	O
"waiting for connection on port %d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
forward_port	int
)	O
;	O
fd	int
=	O
wait_for_connection_on_socket	(int)->(int)
(	O
s	int
)	O
;	O
log_debug	()->(void)
(	O
"wait_for_connection_on_socket (%d) = %d"	*(char)
,	O
s	int
,	O
fd	int
)	O
;	O
if	O
(	O
fd	int
==	O
-	O
1	int
)	O
{	O
log_error	(*(char))->(void)
(	O
"couldn't forward port %d: %s"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
forward_port	int
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
log_exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
if	O
(	O
fd	int
==	O
0	int
)	O
{	O
log_notice	(*(char))->(void)
(	O
"changing fd from %d to 3"	*(char)
,	O
fd	int
)	O
;	O
if	O
(	O
dup2	(int,int)->(int)
(	O
fd	int
,	O
3	int
)	O
!=	O
3	int
)	O
{	O
log_error	(*(char))->(void)
(	O
"couldn't dup2(%d,3): %s"	*(char)
,	O
fd	int
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
log_exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
}	O
}	O
else	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
use_std	int
)	O
{	O
log_debug	()->(void)
(	O
"using stdin as fd"	*(char)
)	O
;	O
fd	int
=	O
0	int
;	O
if	O
(	O
fcntl	(int,int)->(int)
(	O
fd	int
,	O
F_SETFL	int
,	O
O_NONBLOCK	int
)	O
==	O
-	O
1	int
)	O
{	O
log_error	(*(char))->(void)
(	O
"couldn't set stdin to non-blocking mode: %s"	*(char)
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
log_exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
}	O
log_debug	()->(void)
(	O
"creating a new tunnel"	*(char)
)	O
;	O
tunnel	*(struct)
=	O
tunnel_new_client	(*(char),int,*(char),int,long)->(*(struct))
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
host_name	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
host_port	int
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_name	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_port	int
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
content_length	long
)	O
;	O
if	O
(	O
tunnel	*(struct)
==	O
NULL	O
)	O
{	O
log_error	(*(char))->(void)
(	O
"couldn't create tunnel"	*(char)
)	O
;	O
log_exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
if	O
(	O
tunnel_setopt	(*(struct),*(char),*(void))->(int)
(	O
tunnel	*(struct)
,	O
"strict_content_length"	*(char)
,	O
&	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
strict_content_length	int
)	O
==	O
-	O
1	int
)	O
log_debug	()->(void)
(	O
"tunnel_setopt strict_content_length error: %s"	*(char)
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
if	O
(	O
tunnel_setopt	(*(struct),*(char),*(void))->(int)
(	O
tunnel	*(struct)
,	O
"keep_alive"	*(char)
,	O
&	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
keep_alive	int
)	O
==	O
-	O
1	int
)	O
log_debug	()->(void)
(	O
"tunnel_setopt keep_alive error: %s"	*(char)
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
if	O
(	O
tunnel_setopt	(*(struct),*(char),*(void))->(int)
(	O
tunnel	*(struct)
,	O
"max_connection_age"	*(char)
,	O
&	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
max_connection_age	int
)	O
==	O
-	O
1	int
)	O
log_debug	()->(void)
(	O
"tunnel_setopt max_connection_age error: %s"	*(char)
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_authorization	*(char)
!=	O
NULL	O
)	O
{	O
ssize_t	long
len	long
;	O
char	O
*	O
auth	*(char)
;	O
len	long
=	O
encode_base64	(*(void),long,*(*(char)))->(long)
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_authorization	*(char)
,	O
strlen	(*(char))->(long)
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_authorization	*(char)
)	O
,	O
&	O
auth	*(char)
)	O
;	O
if	O
(	O
len	long
==	O
-	O
1	int
)	O
{	O
log_error	(*(char))->(void)
(	O
"encode_base64 error: %s"	*(char)
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
}	O
else	O
{	O
char	O
*	O
str	*(*(char))
=	O
malloc	(long)->(*(void))
(	O
len	long
+	O
7	int
)	O
;	O
if	O
(	O
str	*(*(char))
==	O
NULL	O
)	O
{	O
log_error	(*(char))->(void)
(	O
"out of memory when encoding "	*(char)
"authorization string"	*(char)
)	O
;	O
log_exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
strcpy	(*(char),*(char))->(*(char))
(	O
str	*(*(char))
,	O
"Basic "	*(char)
)	O
;	O
strcat	(*(char),*(char))->(*(char))
(	O
str	*(*(char))
,	O
auth	*(char)
)	O
;	O
free	(*(void))->(void)
(	O
auth	*(char)
)	O
;	O
if	O
(	O
tunnel_setopt	(*(struct),*(char),*(void))->(int)
(	O
tunnel	*(struct)
,	O
"proxy_authorization"	*(char)
,	O
str	*(*(char))
)	O
==	O
-	O
1	int
)	O
log_error	(*(char))->(void)
(	O
"tunnel_setopt proxy_authorization error: %s"	*(char)
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
free	(*(void))->(void)
(	O
str	*(*(char))
)	O
;	O
}	O
}	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
user_agent	*(char)
!=	O
NULL	O
)	O
{	O
if	O
(	O
tunnel_setopt	(*(struct),*(char),*(void))->(int)
(	O
tunnel	*(struct)
,	O
"user_agent"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
user_agent	*(char)
)	O
==	O
-	O
1	int
)	O
log_error	(*(char))->(void)
(	O
"tunnel_setopt user_agent error: %s"	*(char)
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
}	O
if	O
(	O
tunnel_connect	(*(struct))->(int)
(	O
tunnel	*(struct)
)	O
==	O
-	O
1	int
)	O
{	O
log_error	(*(char))->(void)
(	O
"couldn't open tunnel: %s"	*(char)
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
log_exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_name	*(char)
)	O
log_notice	(*(char))->(void)
(	O
"connected to %s:%d via %s:%d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
host_name	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
host_port	int
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_name	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_port	int
)	O
;	O
else	O
log_notice	(*(char))->(void)
(	O
"connected to %s:%d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
host_name	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
host_port	int
)	O
;	O
closed	*(int)
=	O
FALSE	int
;	O
time	()->(int)
(	O
&	O
last_tunnel_write	long
)	O
;	O
while	O
(	O
!	O
closed	*(int)
)	O
{	O
struct	O
pollfd	struct(int,short,short)
pollfd	struct(int,short,short)
[	O
2	int
]	O
;	O
int	O
keep_alive_timeout	int
;	O
int	O
timeout	int
;	O
time_t	long
t	int
;	O
int	O
n	long
;	O
pollfd	struct(int,short,short)
[	O
0	int
]	O
.	O
fd	int
=	O
fd	int
;	O
pollfd	struct(int,short,short)
[	O
0	int
]	O
.	O
events	short
=	O
POLLIN	int
;	O
pollfd	struct(int,short,short)
[	O
1	int
]	O
.	O
fd	int
=	O
tunnel_pollin_fd	(*(struct))->(int)
(	O
tunnel	*(struct)
)	O
;	O
pollfd	struct(int,short,short)
[	O
1	int
]	O
.	O
events	short
=	O
POLLIN	int
;	O
time	()->(int)
(	O
&	O
t	int
)	O
;	O
timeout	int
=	O
1000	int
*	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
keep_alive	int
-	O
(	O
t	int
-	O
last_tunnel_write	long
)	O
)	O
;	O
keep_alive_timeout	int
=	O
TRUE	int
;	O
if	O
(	O
timeout	int
<	O
0	int
)	O
timeout	int
=	O
0	int
;	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_buffer_timeout	int
!=	O
-	O
1	int
&&	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_buffer_timeout	int
<	O
timeout	int
)	O
{	O
timeout	int
=	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_buffer_timeout	int
;	O
keep_alive_timeout	int
=	O
FALSE	int
;	O
}	O
log_annoying	()->(void)
(	O
"poll () ..."	*(char)
)	O
;	O
n	long
=	O
poll	(*(struct(int,short,short)),long,int)->(int)
(	O
pollfd	struct(int,short,short)
,	O
2	int
,	O
timeout	int
)	O
;	O
log_annoying	()->(void)
(	O
"... = %d"	*(char)
,	O
n	long
)	O
;	O
if	O
(	O
n	long
==	O
-	O
1	int
)	O
{	O
log_error	(*(char))->(void)
(	O
"poll error: %s"	*(char)
,	O
strerror	(int)->(*(char))
(	O
errno	O
)	O
)	O
;	O
log_exit	(int)->(void)
(	O
1	int
)	O
;	O
}	O
else	O
if	O
(	O
n	long
==	O
0	int
)	O
{	O
log_verbose	()->(void)
(	O
"poll() timed out"	*(char)
)	O
;	O
if	O
(	O
keep_alive_timeout	int
)	O
{	O
tunnel_padding	(*(struct),long)->(long)
(	O
tunnel	*(struct)
,	O
1	int
)	O
;	O
time	()->(int)
(	O
&	O
last_tunnel_write	long
)	O
;	O
}	O
else	O
{	O
if	O
(	O
tunnel_maybe_pad	(*(struct),long)->(int)
(	O
tunnel	*(struct)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_buffer_size	long
)	O
>	O
0	int
)	O
time	()->(int)
(	O
&	O
last_tunnel_write	long
)	O
;	O
}	O
continue	O
;	O
}	O
handle_input	(*(char),*(struct),int,int,*((*(struct),int,int)->(int)),*(int))->(void)
(	O
"device or port"	*(char)
,	O
tunnel	*(struct)
,	O
fd	int
,	O
pollfd	struct(int,short,short)
[	O
0	int
]	O
.	O
revents	short
,	O
handle_device_input	(*(struct),int,int)->(int)
,	O
&	O
closed	*(int)
)	O
;	O
handle_input	(*(char),*(struct),int,int,*((*(struct),int,int)->(int)),*(int))->(void)
(	O
"tunnel"	*(char)
,	O
tunnel	*(struct)
,	O
fd	int
,	O
pollfd	struct(int,short,short)
[	O
1	int
]	O
.	O
revents	short
,	O
handle_tunnel_input	(*(struct),int,int)->(int)
,	O
&	O
closed	*(int)
)	O
;	O
if	O
(	O
pollfd	struct(int,short,short)
[	O
0	int
]	O
.	O
revents	short
&	O
POLLIN	int
)	O
time	()->(int)
(	O
&	O
last_tunnel_write	long
)	O
;	O
}	O
log_debug	()->(void)
(	O
"destroying tunnel"	*(char)
)	O
;	O
if	O
(	O
fd	int
!=	O
0	int
)	O
{	O
close	(int)->(int)
(	O
fd	int
)	O
;	O
}	O
tunnel_destroy	(*(struct))->(void)
(	O
tunnel	*(struct)
)	O
;	O
if	O
(	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_name	*(char)
)	O
log_notice	(*(char))->(void)
(	O
"disconnected from %s:%d via %s:%d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
host_name	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
host_port	int
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_name	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
proxy_port	int
)	O
;	O
else	O
log_notice	(*(char))->(void)
(	O
"disconnected from %s%d"	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
host_name	*(char)
,	O
arg	*(struct(*(char),*(char),*(char),int,*(char),int,long,int,long,int,int,int,int,int,int,*(char),*(char)))
.	O
host_port	int
)	O
;	O
}	O
log_debug	()->(void)
(	O
"closing server socket"	*(char)
)	O
;	O
close	(int)->(int)
(	O
s	int
)	O
;	O
log_exit	(int)->(void)
(	O
0	int
)	O
;	O
}	O
