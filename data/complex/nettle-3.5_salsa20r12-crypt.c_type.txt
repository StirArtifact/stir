void	O
salsa20r12_crypt	O
(	O
struct	O
salsa20_ctx	struct(array(int))
*	O
ctx	*(void)
,	O
size_t	long
length	long
,	O
uint8_t	char
*	O
c	int
,	O
const	O
uint8_t	char
*	O
m	*(char)
)	O
{	O
uint32_t	int
x	array(int)
[	O
_SALSA20_INPUT_LENGTH	int
]	O
;	O
if	O
(	O
!	O
length	long
)	O
return	O
;	O
for	O
(	O
;	O
;	O
)	O
{	O
_salsa20_core	O
(	O
x	array(int)
,	O
ctx	*(void)
->	O
input	array(int)
,	O
12	int
)	O
;	O
ctx	*(void)
->	O
input	array(int)
[	O
9	int
]	O
+=	O
(	O
++	O
ctx	*(void)
->	O
input	array(int)
[	O
8	int
]	O
==	O
0	int
)	O
;	O
if	O
(	O
length	long
<=	O
SALSA20_BLOCK_SIZE	int
)	O
{	O
memxor3	O
(	O
c	int
,	O
m	*(char)
,	O
x	array(int)
,	O
length	long
)	O
;	O
return	O
;	O
}	O
memxor3	O
(	O
c	int
,	O
m	*(char)
,	O
x	array(int)
,	O
SALSA20_BLOCK_SIZE	int
)	O
;	O
length	long
-=	O
SALSA20_BLOCK_SIZE	int
;	O
c	int
+=	O
SALSA20_BLOCK_SIZE	int
;	O
m	*(char)
+=	O
SALSA20_BLOCK_SIZE	int
;	O
}	O
}	O
