extern	O
dev_t	long
curr_dev	long
;	O
extern	O
ino_t	long
curr_ino	long
;	O
typedef	O
POSITION	long
BLOCKNUM	long
;	O
public	O
int	O
ignore_eoi	int
;	O
struct	O
bufnode	struct(*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))))
{	O
struct	O
bufnode	struct(*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))))
*	O
next	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
,	O
*	O
prev	*(char)
;	O
struct	O
bufnode	struct(*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))))
*	O
hnext	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
,	O
*	O
hprev	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
;	O
}	O
;	O
struct	O
buf	*(char)
{	O
struct	O
bufnode	struct(*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))))
node	struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))
;	O
BLOCKNUM	long
block	long
;	O
unsigned	O
int	O
datasize	int
;	O
unsigned	O
char	O
data	array(char)
[	O
LBUFSIZE	int
]	O
;	O
}	O
;	O
struct	O
filestate	*(void)
{	O
struct	O
bufnode	struct(*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))))
buflist	struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))
;	O
struct	O
bufnode	struct(*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))))
hashtbl	array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))))))
[	O
BUFHASH_SIZE	int
]	O
;	O
int	O
file	int
;	O
int	O
flags	int
;	O
POSITION	long
fpos	long
;	O
int	O
nbufs	int
;	O
BLOCKNUM	long
block	long
;	O
unsigned	O
int	O
offset	int
;	O
POSITION	long
fsize	long
;	O
}	O
;	O
static	O
struct	O
filestate	*(void)
*	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
;	O
static	O
int	O
ch_ungotchar	int
=	O
-	O
1	int
;	O
static	O
int	O
maxbufs	int
=	O
-	O
1	int
;	O
extern	O
int	O
autobuf	int
;	O
extern	O
int	O
sigs	int
;	O
extern	O
int	O
secure	int
;	O
extern	O
int	O
screen_trashed	int
;	O
extern	O
int	O
follow_mode	int
;	O
extern	O
constant	O
char	O
helpdata	array(char)
[	O
]	O
;	O
extern	O
constant	O
int	O
size_helpdata	int
;	O
extern	O
IFILE	O
curr_ifile	*(void)
;	O
extern	O
int	O
logfile	int
;	O
extern	O
char	O
*	O
namelogfile	*(char)
;	O
static	O
int	O
ch_addbuf	()->(int)
(	O
)	O
;	O
int	O
ch_get	()->(int)
(	O
)	O
{	O
struct	O
buf	*(char)
*	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
;	O
struct	O
bufnode	struct(*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))))
*	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
;	O
int	O
n	int
;	O
int	O
slept	int
;	O
int	O
h	*(void)
;	O
POSITION	long
pos	long
;	O
POSITION	long
len	int
;	O
if	O
(	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
==	O
NULL	O
)	O
return	O
(	O
EOI	O
)	O
;	O
if	O
(	O
ch_bufhead	O
!=	O
END_OF_CHAIN	O
)	O
{	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
=	O
bufnode_buf	O
(	O
ch_bufhead	O
)	O
;	O
if	O
(	O
ch_block	O
==	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
block	long
&&	O
ch_offset	O
<	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
datasize	int
)	O
return	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
data	array(char)
[	O
ch_offset	O
]	O
;	O
}	O
slept	int
=	O
FALSE	int
;	O
h	*(void)
=	O
BUFHASH	O
(	O
ch_block	O
)	O
;	O
FOR_BUFS_IN_CHAIN	O
(	O
h	*(void)
,	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
{	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
=	O
bufnode_buf	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
;	O
if	O
(	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
block	long
==	O
ch_block	O
)	O
{	O
if	O
(	O
ch_offset	O
>=	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
datasize	int
)	O
break	O
;	O
goto	O
found	O
;	O
}	O
}	O
if	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
==	O
END_OF_HCHAIN	O
(	O
h	*(void)
)	O
)	O
{	O
if	O
(	O
ch_buftail	O
==	O
END_OF_CHAIN	O
||	O
bufnode_buf	O
(	O
ch_buftail	O
)	O
->	O
block	long
!=	O
-	O
1	int
)	O
{	O
if	O
(	O
(	O
autobuf	int
&&	O
!	O
(	O
ch_flags	O
&	O
CH_CANSEEK	int
)	O
)	O
||	O
(	O
maxbufs	int
<	O
0	int
||	O
ch_nbufs	O
<	O
maxbufs	int
)	O
)	O
if	O
(	O
ch_addbuf	()->(int)
(	O
)	O
)	O
autobuf	int
=	O
OPT_OFF	int
;	O
}	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
=	O
ch_buftail	O
;	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
=	O
bufnode_buf	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
;	O
BUF_HASH_RM	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
;	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
block	long
=	O
ch_block	O
;	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
datasize	int
=	O
0	int
;	O
BUF_HASH_INS	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
,	O
h	*(void)
)	O
;	O
}	O
read_more	O
:	O
pos	long
=	O
(	O
ch_block	O
*	O
LBUFSIZE	int
)	O
+	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
datasize	int
;	O
if	O
(	O
(	O
len	int
=	O
ch_length	()->(long)
(	O
)	O
)	O
!=	O
NULL_POSITION	O
&&	O
pos	long
>=	O
len	int
)	O
return	O
(	O
EOI	O
)	O
;	O
if	O
(	O
pos	long
!=	O
ch_fpos	O
)	O
{	O
if	O
(	O
!	O
(	O
ch_flags	O
&	O
CH_CANSEEK	int
)	O
)	O
return	O
(	O
'?'	O
)	O
;	O
if	O
(	O
lseek	(int,long,int)->(long)
(	O
ch_file	O
,	O
(	O
off_t	long
)	O
pos	long
,	O
SEEK_SET	int
)	O
==	O
BAD_LSEEK	O
)	O
{	O
error	(*(char),*(union(*(char),int,long)))->(void)
(	O
"seek error"	*(char)
,	O
NULL_PARG	O
)	O
;	O
clear_eol	()->(void)
(	O
)	O
;	O
return	O
(	O
EOI	O
)	O
;	O
}	O
ch_fpos	O
=	O
pos	long
;	O
}	O
if	O
(	O
ch_ungotchar	int
!=	O
-	O
1	int
)	O
{	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
data	array(char)
[	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
datasize	int
]	O
=	O
ch_ungotchar	int
;	O
n	int
=	O
1	int
;	O
ch_ungotchar	int
=	O
-	O
1	int
;	O
}	O
else	O
if	O
(	O
ch_flags	O
&	O
CH_HELPFILE	int
)	O
{	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
data	array(char)
[	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
datasize	int
]	O
=	O
helpdata	array(char)
[	O
ch_fpos	O
]	O
;	O
n	int
=	O
1	int
;	O
}	O
else	O
{	O
n	int
=	O
iread	(int,*(char),int)->(int)
(	O
ch_file	O
,	O
&	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
data	array(char)
[	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
datasize	int
]	O
,	O
(	O
unsigned	O
int	O
)	O
(	O
LBUFSIZE	int
-	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
datasize	int
)	O
)	O
;	O
}	O
if	O
(	O
n	int
==	O
READ_INTR	O
)	O
return	O
(	O
EOI	O
)	O
;	O
if	O
(	O
n	int
<	O
0	int
)	O
{	O
{	O
error	(*(char),*(union(*(char),int,long)))->(void)
(	O
"read error"	*(char)
,	O
NULL_PARG	O
)	O
;	O
clear_eol	()->(void)
(	O
)	O
;	O
}	O
n	int
=	O
0	int
;	O
}	O
if	O
(	O
!	O
secure	int
&&	O
logfile	int
>=	O
0	int
&&	O
n	int
>	O
0	int
)	O
write	(int,*(void),long)->(long)
(	O
logfile	int
,	O
(	O
char	O
*	O
)	O
&	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
data	array(char)
[	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
datasize	int
]	O
,	O
n	int
)	O
;	O
ch_fpos	O
+=	O
n	int
;	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
datasize	int
+=	O
n	int
;	O
if	O
(	O
n	int
==	O
0	int
)	O
{	O
ch_fsize	O
=	O
pos	long
;	O
if	O
(	O
ignore_eoi	int
)	O
{	O
if	O
(	O
!	O
slept	int
)	O
{	O
PARG	union(*(char),int,long)
parg	union(*(char),int,long)
;	O
parg	union(*(char),int,long)
.	O
p_string	*(char)
=	O
wait_message	()->(*(char))
(	O
)	O
;	O
ierror	(*(char),*(union(*(char),int,long)))->(void)
(	O
"%s"	*(char)
,	O
&	O
parg	union(*(char),int,long)
)	O
;	O
}	O
sleep	(int)->(int)
(	O
1	int
)	O
;	O
slept	int
=	O
TRUE	int
;	O
if	O
(	O
follow_mode	int
==	O
FOLLOW_NAME	int
)	O
{	O
struct	O
stat	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
st	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
;	O
POSITION	long
curr_pos	long
=	O
ch_tell	()->(long)
(	O
)	O
;	O
int	O
r	int
=	O
stat	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
(	O
get_filename	(*(void))->(*(char))
(	O
curr_ifile	*(void)
)	O
,	O
&	O
st	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
)	O
;	O
if	O
(	O
r	int
==	O
0	int
&&	O
(	O
st	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
.	O
st_ino	long
!=	O
curr_ino	long
||	O
st	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
.	O
st_dev	long
!=	O
curr_dev	long
||	O
(	O
curr_pos	long
!=	O
NULL_POSITION	O
&&	O
st	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
.	O
st_size	long
<	O
curr_pos	long
)	O
)	O
)	O
{	O
screen_trashed	int
=	O
2	int
;	O
return	O
(	O
EOI	O
)	O
;	O
}	O
}	O
}	O
if	O
(	O
sigs	int
)	O
return	O
(	O
EOI	O
)	O
;	O
}	O
found	O
:	O
if	O
(	O
ch_bufhead	O
!=	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
{	O
BUF_RM	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
;	O
BUF_INS_HEAD	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
;	O
BUF_HASH_RM	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
;	O
BUF_HASH_INS	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
,	O
h	*(void)
)	O
;	O
}	O
if	O
(	O
ch_offset	O
>=	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
datasize	int
)	O
goto	O
read_more	O
;	O
return	O
(	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
data	array(char)
[	O
ch_offset	O
]	O
)	O
;	O
}	O
public	O
void	O
ch_ungetchar	(int)->(void)
(	O
c	int
)	O
int	O
c	int
;	O
{	O
if	O
(	O
c	int
!=	O
-	O
1	int
&&	O
ch_ungotchar	int
!=	O
-	O
1	int
)	O
error	(*(char),*(union(*(char),int,long)))->(void)
(	O
"ch_ungetchar overrun"	*(char)
,	O
NULL_PARG	O
)	O
;	O
ch_ungotchar	int
=	O
c	int
;	O
}	O
public	O
void	O
end_logfile	()->(void)
(	O
)	O
{	O
static	O
int	O
tried	int
=	O
FALSE	int
;	O
if	O
(	O
logfile	int
<	O
0	int
)	O
return	O
;	O
if	O
(	O
!	O
tried	int
&&	O
ch_fsize	O
==	O
NULL_POSITION	O
)	O
{	O
tried	int
=	O
TRUE	int
;	O
ierror	(*(char),*(union(*(char),int,long)))->(void)
(	O
"Finishing logfile"	*(char)
,	O
NULL_PARG	O
)	O
;	O
while	O
(	O
ch_forw_get	()->(int)
(	O
)	O
!=	O
EOI	O
)	O
if	O
(	O
ABORT_SIGS	O
(	O
)	O
)	O
break	O
;	O
}	O
close	(int)->(int)
(	O
logfile	int
)	O
;	O
logfile	int
=	O
-	O
1	int
;	O
namelogfile	*(char)
=	O
NULL	O
;	O
}	O
public	O
void	O
sync_logfile	()->(void)
(	O
)	O
{	O
struct	O
buf	*(char)
*	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
;	O
struct	O
bufnode	struct(*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))))
*	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
;	O
int	O
warned	int
=	O
FALSE	int
;	O
BLOCKNUM	long
block	long
;	O
BLOCKNUM	long
nblocks	long
;	O
nblocks	long
=	O
(	O
ch_fpos	O
+	O
LBUFSIZE	int
-	O
1	int
)	O
/	O
LBUFSIZE	int
;	O
for	O
(	O
block	long
=	O
0	int
;	O
block	long
<	O
nblocks	long
;	O
block	long
++	O
)	O
{	O
int	O
wrote	int
=	O
FALSE	int
;	O
FOR_BUFS	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
{	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
=	O
bufnode_buf	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
;	O
if	O
(	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
block	long
==	O
block	long
)	O
{	O
write	(int,*(void),long)->(long)
(	O
logfile	int
,	O
(	O
char	O
*	O
)	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
data	array(char)
,	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
datasize	int
)	O
;	O
wrote	int
=	O
TRUE	int
;	O
break	O
;	O
}	O
}	O
if	O
(	O
!	O
wrote	int
&&	O
!	O
warned	int
)	O
{	O
error	(*(char),*(union(*(char),int,long)))->(void)
(	O
"Warning: log file is incomplete"	*(char)
,	O
NULL_PARG	O
)	O
;	O
warned	int
=	O
TRUE	int
;	O
}	O
}	O
}	O
static	O
int	O
buffered	(long)->(int)
(	O
block	long
)	O
BLOCKNUM	long
block	long
;	O
{	O
struct	O
buf	*(char)
*	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
;	O
struct	O
bufnode	struct(*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))))
*	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
;	O
int	O
h	*(void)
;	O
h	*(void)
=	O
BUFHASH	O
(	O
block	long
)	O
;	O
FOR_BUFS_IN_CHAIN	O
(	O
h	*(void)
,	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
{	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
=	O
bufnode_buf	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
;	O
if	O
(	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
block	long
==	O
block	long
)	O
return	O
(	O
TRUE	int
)	O
;	O
}	O
return	O
(	O
FALSE	int
)	O
;	O
}	O
public	O
int	O
ch_seek	(long)->(int)
(	O
pos	long
)	O
POSITION	long
pos	long
;	O
{	O
BLOCKNUM	long
new_block	long
;	O
POSITION	long
len	int
;	O
if	O
(	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
==	O
NULL	O
)	O
return	O
(	O
0	int
)	O
;	O
len	int
=	O
ch_length	()->(long)
(	O
)	O
;	O
if	O
(	O
pos	long
<	O
ch_zero	O
(	O
)	O
||	O
(	O
len	int
!=	O
NULL_POSITION	O
&&	O
pos	long
>	O
len	int
)	O
)	O
return	O
(	O
1	int
)	O
;	O
new_block	long
=	O
pos	long
/	O
LBUFSIZE	int
;	O
if	O
(	O
!	O
(	O
ch_flags	O
&	O
CH_CANSEEK	int
)	O
&&	O
pos	long
!=	O
ch_fpos	O
&&	O
!	O
buffered	(long)->(int)
(	O
new_block	long
)	O
)	O
{	O
if	O
(	O
ch_fpos	O
>	O
pos	long
)	O
return	O
(	O
1	int
)	O
;	O
while	O
(	O
ch_fpos	O
<	O
pos	long
)	O
{	O
if	O
(	O
ch_forw_get	()->(int)
(	O
)	O
==	O
EOI	O
)	O
return	O
(	O
1	int
)	O
;	O
if	O
(	O
ABORT_SIGS	O
(	O
)	O
)	O
return	O
(	O
1	int
)	O
;	O
}	O
return	O
(	O
0	int
)	O
;	O
}	O
ch_block	O
=	O
new_block	long
;	O
ch_offset	O
=	O
pos	long
%	O
LBUFSIZE	int
;	O
return	O
(	O
0	int
)	O
;	O
}	O
public	O
int	O
ch_end_seek	()->(int)
(	O
)	O
{	O
POSITION	long
len	int
;	O
if	O
(	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
==	O
NULL	O
)	O
return	O
(	O
0	int
)	O
;	O
if	O
(	O
ch_flags	O
&	O
CH_CANSEEK	int
)	O
ch_fsize	O
=	O
filesize	(int)->(long)
(	O
ch_file	O
)	O
;	O
len	int
=	O
ch_length	()->(long)
(	O
)	O
;	O
if	O
(	O
len	int
!=	O
NULL_POSITION	O
)	O
return	O
(	O
ch_seek	(long)->(int)
(	O
len	int
)	O
)	O
;	O
while	O
(	O
ch_forw_get	()->(int)
(	O
)	O
!=	O
EOI	O
)	O
if	O
(	O
ABORT_SIGS	O
(	O
)	O
)	O
return	O
(	O
1	int
)	O
;	O
return	O
(	O
0	int
)	O
;	O
}	O
public	O
int	O
ch_end_buffer_seek	()->(int)
(	O
)	O
{	O
struct	O
buf	*(char)
*	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
;	O
struct	O
bufnode	struct(*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))))
*	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
;	O
POSITION	long
buf_pos	long
;	O
POSITION	long
end_pos	long
;	O
if	O
(	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
==	O
NULL	O
||	O
(	O
ch_flags	O
&	O
CH_CANSEEK	int
)	O
)	O
return	O
(	O
ch_end_seek	()->(int)
(	O
)	O
)	O
;	O
end_pos	long
=	O
0	int
;	O
FOR_BUFS	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
{	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
=	O
bufnode_buf	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
;	O
buf_pos	long
=	O
(	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
block	long
*	O
LBUFSIZE	int
)	O
+	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
datasize	int
;	O
if	O
(	O
buf_pos	long
>	O
end_pos	long
)	O
end_pos	long
=	O
buf_pos	long
;	O
}	O
return	O
(	O
ch_seek	(long)->(int)
(	O
end_pos	long
)	O
)	O
;	O
}	O
public	O
int	O
ch_beg_seek	()->(int)
(	O
)	O
{	O
struct	O
bufnode	struct(*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))))
*	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
;	O
struct	O
bufnode	struct(*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))))
*	O
firstbn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
;	O
if	O
(	O
ch_seek	(long)->(int)
(	O
ch_zero	O
(	O
)	O
)	O
==	O
0	int
)	O
return	O
(	O
0	int
)	O
;	O
firstbn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
=	O
ch_bufhead	O
;	O
if	O
(	O
firstbn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
==	O
END_OF_CHAIN	O
)	O
return	O
(	O
1	int
)	O
;	O
FOR_BUFS	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
{	O
if	O
(	O
bufnode_buf	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
->	O
block	long
<	O
bufnode_buf	O
(	O
firstbn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
->	O
block	long
)	O
firstbn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
=	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
;	O
}	O
ch_block	O
=	O
bufnode_buf	O
(	O
firstbn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
->	O
block	long
;	O
ch_offset	O
=	O
0	int
;	O
return	O
(	O
0	int
)	O
;	O
}	O
public	O
POSITION	long
ch_length	()->(long)
(	O
)	O
{	O
if	O
(	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
==	O
NULL	O
)	O
return	O
(	O
NULL_POSITION	O
)	O
;	O
if	O
(	O
ignore_eoi	int
)	O
return	O
(	O
NULL_POSITION	O
)	O
;	O
if	O
(	O
ch_flags	O
&	O
CH_HELPFILE	int
)	O
return	O
(	O
size_helpdata	int
)	O
;	O
if	O
(	O
ch_flags	O
&	O
CH_NODATA	int
)	O
return	O
(	O
0	int
)	O
;	O
return	O
(	O
ch_fsize	O
)	O
;	O
}	O
public	O
POSITION	long
ch_tell	()->(long)
(	O
)	O
{	O
if	O
(	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
==	O
NULL	O
)	O
return	O
(	O
NULL_POSITION	O
)	O
;	O
return	O
(	O
ch_block	O
*	O
LBUFSIZE	int
)	O
+	O
ch_offset	O
;	O
}	O
public	O
int	O
ch_forw_get	()->(int)
(	O
)	O
{	O
int	O
c	int
;	O
if	O
(	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
==	O
NULL	O
)	O
return	O
(	O
EOI	O
)	O
;	O
c	int
=	O
ch_get	()->(int)
(	O
)	O
;	O
if	O
(	O
c	int
==	O
EOI	O
)	O
return	O
(	O
EOI	O
)	O
;	O
if	O
(	O
ch_offset	O
<	O
LBUFSIZE	int
-	O
1	int
)	O
ch_offset	O
++	O
;	O
else	O
{	O
ch_block	O
++	O
;	O
ch_offset	O
=	O
0	int
;	O
}	O
return	O
(	O
c	int
)	O
;	O
}	O
public	O
int	O
ch_back_get	()->(int)
(	O
)	O
{	O
if	O
(	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
==	O
NULL	O
)	O
return	O
(	O
EOI	O
)	O
;	O
if	O
(	O
ch_offset	O
>	O
0	int
)	O
ch_offset	O
--	O
;	O
else	O
{	O
if	O
(	O
ch_block	O
<=	O
0	int
)	O
return	O
(	O
EOI	O
)	O
;	O
if	O
(	O
!	O
(	O
ch_flags	O
&	O
CH_CANSEEK	int
)	O
&&	O
!	O
buffered	(long)->(int)
(	O
ch_block	O
-	O
1	int
)	O
)	O
return	O
(	O
EOI	O
)	O
;	O
ch_block	O
--	O
;	O
ch_offset	O
=	O
LBUFSIZE	int
-	O
1	int
;	O
}	O
return	O
(	O
ch_get	()->(int)
(	O
)	O
)	O
;	O
}	O
public	O
void	O
ch_setbufspace	(int)->(void)
(	O
bufspace	int
)	O
int	O
bufspace	int
;	O
{	O
if	O
(	O
bufspace	int
<	O
0	int
)	O
maxbufs	int
=	O
-	O
1	int
;	O
else	O
{	O
maxbufs	int
=	O
(	O
(	O
bufspace	int
*	O
1024	int
)	O
+	O
LBUFSIZE	int
-	O
1	int
)	O
/	O
LBUFSIZE	int
;	O
if	O
(	O
maxbufs	int
<	O
1	int
)	O
maxbufs	int
=	O
1	int
;	O
}	O
}	O
public	O
void	O
ch_flush	()->(void)
(	O
)	O
{	O
struct	O
bufnode	struct(*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))))
*	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
;	O
if	O
(	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
==	O
NULL	O
)	O
return	O
;	O
if	O
(	O
!	O
(	O
ch_flags	O
&	O
CH_CANSEEK	int
)	O
)	O
{	O
ch_fsize	O
=	O
NULL_POSITION	O
;	O
return	O
;	O
}	O
FOR_BUFS	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
{	O
bufnode_buf	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
->	O
block	long
=	O
-	O
1	int
;	O
}	O
ch_fsize	O
=	O
filesize	(int)->(long)
(	O
ch_file	O
)	O
;	O
ch_fpos	O
=	O
0	int
;	O
ch_block	O
=	O
0	int
;	O
ch_offset	O
=	O
0	int
;	O
if	O
(	O
ch_fsize	O
==	O
0	int
)	O
{	O
ch_fsize	O
=	O
NULL_POSITION	O
;	O
ch_flags	O
&=	O
~	O
CH_CANSEEK	int
;	O
}	O
if	O
(	O
lseek	(int,long,int)->(long)
(	O
ch_file	O
,	O
(	O
off_t	long
)	O
0	int
,	O
SEEK_SET	int
)	O
==	O
BAD_LSEEK	O
)	O
{	O
error	(*(char),*(union(*(char),int,long)))->(void)
(	O
"seek error to 0"	*(char)
,	O
NULL_PARG	O
)	O
;	O
}	O
}	O
static	O
int	O
ch_addbuf	()->(int)
(	O
)	O
{	O
struct	O
buf	*(char)
*	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
;	O
struct	O
bufnode	struct(*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))))
*	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
;	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
=	O
(	O
struct	O
buf	*(char)
*	O
)	O
calloc	(long,long)->(*(void))
(	O
1	int
,	O
sizeof	O
(	O
struct	O
buf	*(char)
)	O
)	O
;	O
if	O
(	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
==	O
NULL	O
)	O
return	O
(	O
1	int
)	O
;	O
ch_nbufs	O
++	O
;	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
block	long
=	O
-	O
1	int
;	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
=	O
&	O
bp	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),long,int,array(char)))
->	O
node	struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))
;	O
BUF_INS_TAIL	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
;	O
BUF_HASH_INS	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
,	O
0	int
)	O
;	O
return	O
(	O
0	int
)	O
;	O
}	O
static	O
void	O
init_hashtbl	()->(void)
(	O
)	O
{	O
int	O
h	*(void)
;	O
for	O
(	O
h	*(void)
=	O
0	int
;	O
h	*(void)
<	O
BUFHASH_SIZE	int
;	O
h	*(void)
++	O
)	O
{	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
->	O
hashtbl	array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))))))
[	O
h	*(void)
]	O
.	O
hnext	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
=	O
END_OF_HCHAIN	O
(	O
h	*(void)
)	O
;	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
->	O
hashtbl	array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))))))
[	O
h	*(void)
]	O
.	O
hprev	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
=	O
END_OF_HCHAIN	O
(	O
h	*(void)
)	O
;	O
}	O
}	O
static	O
void	O
ch_delbufs	()->(void)
(	O
)	O
{	O
struct	O
bufnode	struct(*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))),*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))))))
*	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
;	O
while	O
(	O
ch_bufhead	O
!=	O
END_OF_CHAIN	O
)	O
{	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
=	O
ch_bufhead	O
;	O
BUF_RM	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
;	O
free	(*(void))->(void)
(	O
bufnode_buf	O
(	O
bn	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
)	O
)	O
;	O
}	O
ch_nbufs	O
=	O
0	int
;	O
init_hashtbl	()->(void)
(	O
)	O
;	O
}	O
public	O
int	O
seekable	(int)->(int)
(	O
f	int
)	O
int	O
f	int
;	O
{	O
return	O
(	O
lseek	(int,long,int)->(long)
(	O
f	int
,	O
(	O
off_t	long
)	O
1	int
,	O
SEEK_SET	int
)	O
!=	O
BAD_LSEEK	O
)	O
;	O
}	O
public	O
void	O
ch_set_eof	()->(void)
(	O
)	O
{	O
ch_fsize	O
=	O
ch_fpos	O
;	O
}	O
public	O
void	O
ch_init	(int,int)->(void)
(	O
f	int
,	O
flags	int
)	O
int	O
f	int
;	O
int	O
flags	int
;	O
{	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
=	O
(	O
struct	O
filestate	*(void)
*	O
)	O
get_filestate	(*(void))->(*(void))
(	O
curr_ifile	*(void)
)	O
;	O
if	O
(	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
==	O
NULL	O
)	O
{	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
=	O
(	O
struct	O
filestate	*(void)
*	O
)	O
calloc	(long,long)->(*(void))
(	O
1	int
,	O
sizeof	O
(	O
struct	O
filestate	*(void)
)	O
)	O
;	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
->	O
buflist	struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))
.	O
next	*(struct(*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`))),*(struct(*(struct`),*(struct`),*(struct`),*(struct`)))))
=	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
->	O
buflist	struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))
.	O
prev	*(char)
=	O
END_OF_CHAIN	O
;	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
->	O
nbufs	int
=	O
0	int
;	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
->	O
flags	int
=	O
flags	int
;	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
->	O
fpos	long
=	O
0	int
;	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
->	O
block	long
=	O
0	int
;	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
->	O
offset	int
=	O
0	int
;	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
->	O
file	int
=	O
-	O
1	int
;	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
->	O
fsize	long
=	O
NULL_POSITION	O
;	O
init_hashtbl	()->(void)
(	O
)	O
;	O
if	O
(	O
(	O
flags	int
&	O
CH_CANSEEK	int
)	O
&&	O
!	O
seekable	(int)->(int)
(	O
f	int
)	O
)	O
ch_flags	O
&=	O
~	O
CH_CANSEEK	int
;	O
set_filestate	(*(void),*(void))->(void)
(	O
curr_ifile	*(void)
,	O
(	O
void	O
*	O
)	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
)	O
;	O
}	O
if	O
(	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
->	O
file	int
==	O
-	O
1	int
)	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
->	O
file	int
=	O
f	int
;	O
ch_flush	()->(void)
(	O
)	O
;	O
}	O
public	O
void	O
ch_close	()->(void)
(	O
)	O
{	O
int	O
keepstate	int
=	O
FALSE	int
;	O
if	O
(	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
==	O
NULL	O
)	O
return	O
;	O
if	O
(	O
(	O
ch_flags	O
&	O
(	O
CH_CANSEEK	int
|	O
CH_POPENED	int
|	O
CH_HELPFILE	int
)	O
)	O
&&	O
!	O
(	O
ch_flags	O
&	O
CH_KEEPOPEN	int
)	O
)	O
{	O
ch_delbufs	()->(void)
(	O
)	O
;	O
}	O
else	O
keepstate	int
=	O
TRUE	int
;	O
if	O
(	O
!	O
(	O
ch_flags	O
&	O
CH_KEEPOPEN	int
)	O
)	O
{	O
if	O
(	O
!	O
(	O
ch_flags	O
&	O
(	O
CH_POPENED	int
|	O
CH_HELPFILE	int
)	O
)	O
)	O
close	(int)->(int)
(	O
ch_file	O
)	O
;	O
ch_file	O
=	O
-	O
1	int
;	O
}	O
else	O
keepstate	int
=	O
TRUE	int
;	O
if	O
(	O
!	O
keepstate	int
)	O
{	O
free	(*(void))->(void)
(	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
)	O
;	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
=	O
NULL	O
;	O
set_filestate	(*(void),*(void))->(void)
(	O
curr_ifile	*(void)
,	O
(	O
void	O
*	O
)	O
NULL	O
)	O
;	O
}	O
}	O
public	O
int	O
ch_getflags	()->(int)
(	O
)	O
{	O
if	O
(	O
thisfile	*(struct(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`))),array(struct(*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))),*(struct(*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)),*(struct(*`,*`,*`,*`)))))),int,int,long,int,long,int,long))
==	O
NULL	O
)	O
return	O
(	O
0	int
)	O
;	O
return	O
(	O
ch_flags	O
)	O
;	O
}	O
