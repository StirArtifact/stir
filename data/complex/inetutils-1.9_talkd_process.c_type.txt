int	O
find_user	(*(char),*(char))->(int)
(	O
char	O
*	O
name	*(char)
,	O
char	O
*	O
tty	*(char)
)	O
;	O
void	O
do_announce	(*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))),*(struct(char,char,char,char,int,struct(short,array(char)))))->(void)
(	O
CTL_MSG	struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))
*	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
,	O
CTL_RESPONSE	struct(char,char,char,char,int,struct(short,array(char)))
*	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
)	O
;	O
int	O
process_request	(*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))),*(struct(short,short,struct(int),array(char))),*(struct(char,char,char,char,int,struct(short,array(char)))))->(int)
(	O
CTL_MSG	struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))
*	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
,	O
struct	O
sockaddr_in	struct(short,short,struct(int),array(char))
*	O
sa_in	*(struct(short,short,struct(int),array(char)))
,	O
CTL_RESPONSE	struct(char,char,char,char,int,struct(short,array(char)))
*	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
)	O
{	O
CTL_MSG	struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))
*	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
;	O
if	O
(	O
debug	int
)	O
{	O
print_request	(*(char),*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))))->(int)
(	O
"process_request"	*(char)
,	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
)	O
;	O
}	O
if	O
(	O
acl_match	(*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))),*(struct(short,short,struct(int),array(char))))->(int)
(	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
,	O
sa_in	*(struct(short,short,struct(int),array(char)))
)	O
)	O
{	O
syslog	(int,*(char))->(void)
(	O
LOG_NOTICE	int
,	O
"dropping request: %s@%s"	*(char)
,	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
l_name	array(char)
,	O
inet_ntoa	(struct(int))->(*(char))
(	O
sa_in	*(struct(short,short,struct(int),array(char)))
->	O
sin_addr	struct(int)
)	O
)	O
;	O
return	O
1	int
;	O
}	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
vers	char
=	O
TALK_VERSION	int
;	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
type	char
=	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
type	char
;	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
id_num	int
=	O
htonl	(int)->(int)
(	O
0	int
)	O
;	O
if	O
(	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
vers	char
!=	O
TALK_VERSION	int
)	O
{	O
syslog	(int,*(char))->(void)
(	O
LOG_ERR	int
,	O
"Bad protocol version %d"	*(char)
,	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
vers	char
)	O
;	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
answer	char
=	O
BADVERSION	int
;	O
return	O
0	int
;	O
}	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
id_num	int
=	O
ntohl	(int)->(int)
(	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
id_num	int
)	O
;	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
addr	struct(short,array(char))
.	O
sa_family	short
=	O
ntohs	(short)->(short)
(	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
addr	struct(short,array(char))
.	O
sa_family	short
)	O
;	O
if	O
(	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
addr	struct(short,array(char))
.	O
sa_family	short
!=	O
AF_INET	O
)	O
{	O
syslog	(int,*(char))->(void)
(	O
LOG_ERR	int
,	O
"Bad address, family %d"	*(char)
,	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
addr	struct(short,array(char))
.	O
sa_family	short
)	O
;	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
answer	char
=	O
BADADDR	int
;	O
return	O
0	int
;	O
}	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
ctl_addr	struct(short,array(char))
.	O
sa_family	short
=	O
ntohs	(short)->(short)
(	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
ctl_addr	struct(short,array(char))
.	O
sa_family	short
)	O
;	O
if	O
(	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
ctl_addr	struct(short,array(char))
.	O
sa_family	short
!=	O
AF_INET	O
)	O
{	O
syslog	(int,*(char))->(void)
(	O
LOG_WARNING	int
,	O
"Bad control address, family %d"	*(char)
,	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
ctl_addr	struct(short,array(char))
.	O
sa_family	short
)	O
;	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
answer	char
=	O
BADCTLADDR	int
;	O
return	O
0	int
;	O
}	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
pid	int
=	O
ntohl	(int)->(int)
(	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
pid	int
)	O
;	O
switch	O
(	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
type	char
)	O
{	O
case	O
ANNOUNCE	int
:	O
do_announce	(*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))),*(struct(char,char,char,char,int,struct(short,array(char)))))->(void)
(	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
,	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
)	O
;	O
break	O
;	O
case	O
LEAVE_INVITE	int
:	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
=	O
find_request	(*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))))->(*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))))
(	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
)	O
;	O
if	O
(	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
)	O
{	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
id_num	int
=	O
htonl	(int)->(int)
(	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
id_num	int
)	O
;	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
answer	char
=	O
SUCCESS	int
;	O
}	O
else	O
insert_table	(*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))),*(struct(char,char,char,char,int,struct(short,array(char)))))->(int)
(	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
,	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
)	O
;	O
break	O
;	O
case	O
LOOK_UP	int
:	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
=	O
find_match	(*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))))->(*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))))
(	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
)	O
;	O
if	O
(	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
)	O
{	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
id_num	int
=	O
htonl	(int)->(int)
(	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
id_num	int
)	O
;	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
addr	struct(short,array(char))
=	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
addr	struct(short,array(char))
;	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
addr	struct(short,array(char))
.	O
sa_family	short
=	O
htons	(short)->(short)
(	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
addr	struct(short,array(char))
.	O
sa_family	short
)	O
;	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
answer	char
=	O
SUCCESS	int
;	O
}	O
else	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
answer	char
=	O
NOT_HERE	int
;	O
break	O
;	O
case	O
DELETE	int
:	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
answer	char
=	O
delete_invite	(long)->(int)
(	O
msg	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
id_num	int
)	O
;	O
break	O
;	O
default	O
:	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
answer	char
=	O
UNKNOWN_REQUEST	int
;	O
break	O
;	O
}	O
if	O
(	O
debug	int
)	O
print_response	(*(char),*(struct(char,char,char,char,int,struct(short,array(char)))))->(int)
(	O
"process_request response"	*(char)
,	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
)	O
;	O
return	O
0	int
;	O
}	O
void	O
do_announce	(*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))),*(struct(char,char,char,char,int,struct(short,array(char)))))->(void)
(	O
CTL_MSG	struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))
*	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
,	O
CTL_RESPONSE	struct(char,char,char,char,int,struct(short,array(char)))
*	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
)	O
{	O
struct	O
hostent	struct(*(char),*(*(char)),int,int,*(*(char)))
*	O
hp	*(struct(*(char),*(*(char)),int,int,*(*(char))))
;	O
CTL_MSG	struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))
*	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
;	O
int	O
result	int
;	O
result	int
=	O
find_user	(*(char),*(char))->(int)
(	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
r_name	array(char)
,	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
r_tty	array(char)
)	O
;	O
if	O
(	O
result	int
!=	O
SUCCESS	int
)	O
{	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
answer	char
=	O
result	int
;	O
return	O
;	O
}	O
hp	*(struct(*(char),*(*(char)),int,int,*(*(char))))
=	O
gethostbyaddr	(*(void),int,int)->(*(struct(*(char),*(*(char)),int,int,*(*(char)))))
(	O
(	O
char	O
*	O
)	O
&	O
os2sin_addr	O
(	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
ctl_addr	struct(short,array(char))
)	O
,	O
sizeof	O
(	O
struct	O
in_addr	struct(int)
)	O
,	O
AF_INET	O
)	O
;	O
if	O
(	O
!	O
hp	*(struct(*(char),*(*(char)),int,int,*(*(char))))
)	O
{	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
answer	char
=	O
MACHINE_UNKNOWN	int
;	O
return	O
;	O
}	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
=	O
find_request	(*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))))->(*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))))
(	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
)	O
;	O
if	O
(	O
!	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
)	O
{	O
insert_table	(*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))),*(struct(char,char,char,char,int,struct(short,array(char)))))->(int)
(	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
,	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
)	O
;	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
answer	char
=	O
announce	(*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))),*(char))->(int)
(	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
,	O
hp	*(struct(*(char),*(*(char)),int,int,*(*(char))))
->	O
h_name	*(char)
)	O
;	O
return	O
;	O
}	O
if	O
(	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
id_num	int
>	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
id_num	int
)	O
{	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
id_num	int
=	O
new_id	()->(int)
(	O
)	O
;	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
id_num	int
=	O
htonl	(int)->(int)
(	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
id_num	int
)	O
;	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
answer	char
=	O
announce	(*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char))),*(char))->(int)
(	O
mp	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
,	O
hp	*(struct(*(char),*(*(char)),int,int,*(*(char))))
->	O
h_name	*(char)
)	O
;	O
}	O
else	O
{	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
id_num	int
=	O
htonl	(int)->(int)
(	O
ptr	*(struct(char,char,char,char,int,struct(short,array(char)),struct(short,array(char)),int,array(char),array(char),array(char)))
->	O
id_num	int
)	O
;	O
rp	*(struct(char,char,char,char,int,struct(short,array(char))))
->	O
answer	char
=	O
SUCCESS	int
;	O
}	O
}	O
int	O
find_user	(*(char),*(char))->(int)
(	O
char	O
*	O
name	*(char)
,	O
char	O
*	O
tty	*(char)
)	O
{	O
STRUCT_UTMP	struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char))
*	O
utmpbuf	*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))
,	O
*	O
uptr	*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))
;	O
size_t	long
utmp_count	long
;	O
int	O
status	int
;	O
struct	O
stat	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
statb	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
;	O
char	O
ftty	array(char)
[	O
sizeof	O
(	O
PATH_DEV	O
)	O
+	O
sizeof	O
(	O
uptr	*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))
->	O
ut_line	array(char)
)	O
]	O
;	O
time_t	long
last_time	long
=	O
0	int
;	O
int	O
notty	int
;	O
notty	int
=	O
(	O
*	O
tty	*(char)
==	O
'\0'	O
)	O
;	O
status	int
=	O
NOT_HERE	int
;	O
strcpy	(*(char),*(char))->(*(char))
(	O
ftty	array(char)
,	O
PATH_DEV	O
)	O
;	O
read_utmp	(*(char),*(long),*(*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))),int)->(int)
(	O
PATH_UTMP	O
,	O
&	O
utmp_count	long
,	O
&	O
utmpbuf	*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))
,	O
READ_UTMP_USER_PROCESS	int
|	O
READ_UTMP_CHECK_PIDS	int
)	O
;	O
for	O
(	O
uptr	*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))
=	O
utmpbuf	*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))
;	O
uptr	*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))
<	O
utmpbuf	*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))
+	O
utmp_count	long
;	O
uptr	*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))
++	O
)	O
{	O
if	O
(	O
!	O
strncmp	(*(char),*(char),long)->(int)
(	O
UT_USER	O
(	O
uptr	*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))
)	O
,	O
name	*(char)
,	O
sizeof	O
(	O
UT_USER	O
(	O
uptr	*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))
)	O
)	O
)	O
)	O
{	O
if	O
(	O
notty	int
)	O
{	O
strncpy	(*(char),*(char),long)->(*(char))
(	O
ftty	array(char)
+	O
sizeof	O
(	O
PATH_DEV	O
)	O
-	O
1	int
,	O
uptr	*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))
->	O
ut_line	array(char)
,	O
sizeof	O
(	O
ftty	array(char)
)	O
-	O
sizeof	O
(	O
PATH_DEV	O
)	O
-	O
1	int
)	O
;	O
ftty	array(char)
[	O
sizeof	O
(	O
ftty	array(char)
)	O
-	O
1	int
]	O
=	O
0	int
;	O
if	O
(	O
stat	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
(	O
ftty	array(char)
,	O
&	O
statb	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
)	O
==	O
0	int
)	O
{	O
if	O
(	O
!	O
(	O
statb	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
.	O
st_mode	int
&	O
S_IWGRP	O
)	O
)	O
{	O
if	O
(	O
status	int
!=	O
SUCCESS	int
)	O
status	int
=	O
PERMISSION_DENIED	int
;	O
continue	O
;	O
}	O
if	O
(	O
statb	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
.	O
st_atime	O
>	O
last_time	long
)	O
{	O
last_time	long
=	O
statb	struct(long,long,long,int,int,int,int,long,long,long,long,struct(long,long),struct(long,long),struct(long,long),array(long))
.	O
st_atime	O
;	O
strcpy	(*(char),*(char))->(*(char))
(	O
tty	*(char)
,	O
uptr	*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))
->	O
ut_line	array(char)
)	O
;	O
status	int
=	O
SUCCESS	int
;	O
}	O
continue	O
;	O
}	O
}	O
if	O
(	O
!	O
strcmp	(*(char),*(char))->(int)
(	O
uptr	*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))
->	O
ut_line	array(char)
,	O
tty	*(char)
)	O
)	O
{	O
status	int
=	O
SUCCESS	int
;	O
break	O
;	O
}	O
}	O
}	O
free	(*(void))->(void)
(	O
utmpbuf	*(struct(short,int,array(char),array(char),array(char),array(char),struct(short,short),int,struct(int,int),array(int),array(char)))
)	O
;	O
return	O
status	int
;	O
}	O
