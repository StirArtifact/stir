void	O
chacha_crypt	O
(	O
struct	O
chacha_ctx	struct(array(int))
*	O
ctx	*(void)
,	O
size_t	long
length	long
,	O
uint8_t	char
*	O
c	int
,	O
const	O
uint8_t	char
*	O
m	*(char)
)	O
{	O
if	O
(	O
!	O
length	long
)	O
return	O
;	O
for	O
(	O
;	O
;	O
)	O
{	O
uint32_t	int
x	array(int)
[	O
_CHACHA_STATE_LENGTH	int
]	O
;	O
_chacha_core	O
(	O
x	array(int)
,	O
ctx	*(void)
->	O
state	array(int)
,	O
CHACHA_ROUNDS	int
)	O
;	O
ctx	*(void)
->	O
state	array(int)
[	O
13	int
]	O
+=	O
(	O
++	O
ctx	*(void)
->	O
state	array(int)
[	O
12	int
]	O
==	O
0	int
)	O
;	O
if	O
(	O
length	long
<=	O
CHACHA_BLOCK_SIZE	int
)	O
{	O
memxor3	O
(	O
c	int
,	O
m	*(char)
,	O
x	array(int)
,	O
length	long
)	O
;	O
return	O
;	O
}	O
memxor3	O
(	O
c	int
,	O
m	*(char)
,	O
x	array(int)
,	O
CHACHA_BLOCK_SIZE	int
)	O
;	O
length	long
-=	O
CHACHA_BLOCK_SIZE	int
;	O
c	int
+=	O
CHACHA_BLOCK_SIZE	int
;	O
m	*(char)
+=	O
CHACHA_BLOCK_SIZE	int
;	O
}	O
}	O
