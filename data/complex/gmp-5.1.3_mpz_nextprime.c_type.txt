static	O
const	O
unsigned	O
char	O
primegap	array(char)
[	O
]	O
=	O
{	O
2	int
,	O
2	int
,	O
4	int
,	O
2	int
,	O
4	int
,	O
2	int
,	O
4	int
,	O
6	int
,	O
2	int
,	O
6	int
,	O
4	int
,	O
2	int
,	O
4	int
,	O
6	int
,	O
6	int
,	O
2	int
,	O
6	int
,	O
4	int
,	O
2	int
,	O
6	int
,	O
4	int
,	O
6	int
,	O
8	int
,	O
4	int
,	O
2	int
,	O
4	int
,	O
2	int
,	O
4	int
,	O
14	int
,	O
4	int
,	O
6	int
,	O
2	int
,	O
10	int
,	O
2	int
,	O
6	int
,	O
6	int
,	O
4	int
,	O
6	int
,	O
6	int
,	O
2	int
,	O
10	int
,	O
2	int
,	O
4	int
,	O
2	int
,	O
12	int
,	O
12	int
,	O
4	int
,	O
2	int
,	O
4	int
,	O
6	int
,	O
2	int
,	O
10	int
,	O
6	int
,	O
6	int
,	O
6	int
,	O
2	int
,	O
6	int
,	O
4	int
,	O
2	int
,	O
10	int
,	O
14	int
,	O
4	int
,	O
2	int
,	O
4	int
,	O
14	int
,	O
6	int
,	O
10	int
,	O
2	int
,	O
4	int
,	O
6	int
,	O
8	int
,	O
6	int
,	O
6	int
,	O
4	int
,	O
6	int
,	O
8	int
,	O
4	int
,	O
8	int
,	O
10	int
,	O
2	int
,	O
10	int
,	O
2	int
,	O
6	int
,	O
4	int
,	O
6	int
,	O
8	int
,	O
4	int
,	O
2	int
,	O
4	int
,	O
12	int
,	O
8	int
,	O
4	int
,	O
8	int
,	O
4	int
,	O
6	int
,	O
12	int
,	O
2	int
,	O
18	int
,	O
6	int
,	O
10	int
,	O
6	int
,	O
6	int
,	O
2	int
,	O
6	int
,	O
10	int
,	O
6	int
,	O
6	int
,	O
2	int
,	O
6	int
,	O
6	int
,	O
4	int
,	O
2	int
,	O
12	int
,	O
10	int
,	O
2	int
,	O
4	int
,	O
6	int
,	O
6	int
,	O
2	int
,	O
12	int
,	O
4	int
,	O
6	int
,	O
8	int
,	O
10	int
,	O
8	int
,	O
10	int
,	O
8	int
,	O
6	int
,	O
6	int
,	O
4	int
,	O
8	int
,	O
6	int
,	O
4	int
,	O
8	int
,	O
4	int
,	O
14	int
,	O
10	int
,	O
12	int
,	O
2	int
,	O
10	int
,	O
2	int
,	O
4	int
,	O
2	int
,	O
10	int
,	O
14	int
,	O
4	int
,	O
2	int
,	O
4	int
,	O
14	int
,	O
4	int
,	O
2	int
,	O
4	int
,	O
20	int
,	O
4	int
,	O
8	int
,	O
10	int
,	O
8	int
,	O
4	int
,	O
6	int
,	O
6	int
,	O
14	int
,	O
4	int
,	O
6	int
,	O
6	int
,	O
8	int
,	O
6	int
,	O
12	int
}	O
;	O
void	O
mpz_nextprime	O
(	O
mpz_ptr	*(struct(int,int,*(long)))
p	*(char)
,	O
mpz_srcptr	*(struct(int,int,*(long)))
n	long
)	O
{	O
unsigned	O
short	O
*	O
moduli	*(short)
;	O
unsigned	O
long	O
difference	long
;	O
int	O
i	long
;	O
unsigned	O
prime_limit	int
;	O
unsigned	O
long	O
prime	long
;	O
mp_size_t	long
pn	long
;	O
mp_bitcnt_t	long
nbits	long
;	O
unsigned	O
incr	int
;	O
TMP_SDECL	O
;	O
if	O
(	O
mpz_cmp_ui	O
(	O
n	long
,	O
2	int
)	O
<	O
0	int
)	O
{	O
mpz_set_ui	O
(	O
p	*(char)
,	O
2	int
)	O
;	O
return	O
;	O
}	O
mpz_add_ui	O
(	O
p	*(char)
,	O
n	long
,	O
1	int
)	O
;	O
mpz_setbit	O
(	O
p	*(char)
,	O
0	int
)	O
;	O
if	O
(	O
mpz_cmp_ui	O
(	O
p	*(char)
,	O
7	int
)	O
<=	O
0	int
)	O
return	O
;	O
pn	long
=	O
SIZ	O
(	O
p	*(char)
)	O
;	O
MPN_SIZEINBASE_2EXP	O
(	O
nbits	long
,	O
PTR	O
(	O
p	*(char)
)	O
,	O
pn	long
,	O
1	int
)	O
;	O
if	O
(	O
nbits	long
/	O
2	int
>=	O
NUMBER_OF_PRIMES	int
)	O
prime_limit	int
=	O
NUMBER_OF_PRIMES	int
-	O
1	int
;	O
else	O
prime_limit	int
=	O
nbits	long
/	O
2	int
;	O
TMP_SMARK	O
;	O
moduli	*(short)
=	O
TMP_SALLOC_TYPE	O
(	O
prime_limit	int
*	O
sizeof	O
moduli	*(short)
[	O
0	int
]	O
,	O
unsigned	O
short	O
)	O
;	O
for	O
(	O
;	O
;	O
)	O
{	O
prime	long
=	O
3	int
;	O
for	O
(	O
i	long
=	O
0	int
;	O
i	long
<	O
prime_limit	int
;	O
i	long
++	O
)	O
{	O
moduli	*(short)
[	O
i	long
]	O
=	O
mpz_fdiv_ui	O
(	O
p	*(char)
,	O
prime	long
)	O
;	O
prime	long
+=	O
primegap	array(char)
[	O
i	long
]	O
;	O
}	O
for	O
(	O
difference	long
=	O
incr	int
=	O
0	int
;	O
incr	int
<	O
INCR_LIMIT	int
;	O
difference	long
+=	O
2	int
)	O
{	O
prime	long
=	O
3	int
;	O
for	O
(	O
i	long
=	O
0	int
;	O
i	long
<	O
prime_limit	int
;	O
i	long
++	O
)	O
{	O
unsigned	O
r	int
;	O
r	int
=	O
(	O
moduli	*(short)
[	O
i	long
]	O
+	O
incr	int
)	O
%	O
prime	long
;	O
prime	long
+=	O
primegap	array(char)
[	O
i	long
]	O
;	O
if	O
(	O
r	int
==	O
0	int
)	O
goto	O
next	*(struct(*(struct(*(struct`),long)),long))
;	O
}	O
mpz_add_ui	O
(	O
p	*(char)
,	O
p	*(char)
,	O
difference	long
)	O
;	O
difference	long
=	O
0	int
;	O
if	O
(	O
mpz_millerrabin	O
(	O
p	*(char)
,	O
25	int
)	O
)	O
goto	O
done	O
;	O
next	*(struct(*(struct(*(struct`),long)),long))
:	O
;	O
incr	int
+=	O
2	int
;	O
}	O
mpz_add_ui	O
(	O
p	*(char)
,	O
p	*(char)
,	O
difference	long
)	O
;	O
difference	long
=	O
0	int
;	O
}	O
done	O
:	O
TMP_SFREE	O
;	O
}	O
