static	O
char	O
*	O
stash_tar_linkname	(*(char))->(*(char))
(	O
char	O
*	O
linkname	array(char)
)	O
{	O
static	O
char	O
hold_tar_linkname	array(char)
[	O
TARLINKNAMESIZE	int
+	O
1	int
]	O
;	O
strncpy	(*(char),*(char),long)->(*(char))
(	O
hold_tar_linkname	array(char)
,	O
linkname	array(char)
,	O
TARLINKNAMESIZE	int
)	O
;	O
hold_tar_linkname	array(char)
[	O
TARLINKNAMESIZE	int
]	O
=	O
'\0'	O
;	O
return	O
hold_tar_linkname	array(char)
;	O
}	O
static	O
size_t	long
split_long_name	(*(char),long)->(long)
(	O
const	O
char	O
*	O
name	*(char)
,	O
size_t	long
length	long
)	O
{	O
size_t	long
i	int
;	O
if	O
(	O
length	long
>	O
TARPREFIXSIZE	int
)	O
length	long
=	O
TARPREFIXSIZE	int
+	O
2	int
;	O
for	O
(	O
i	int
=	O
length	long
-	O
1	int
;	O
i	int
>	O
0	int
;	O
i	int
--	O
)	O
if	O
(	O
name	*(char)
[	O
i	int
]	O
==	O
'/'	O
)	O
break	O
;	O
return	O
i	int
;	O
}	O
static	O
char	O
*	O
stash_tar_filename	(*(char),*(char))->(*(char))
(	O
char	O
*	O
prefix	array(char)
,	O
char	O
*	O
filename	*(char)
)	O
{	O
static	O
char	O
hold_tar_filename	array(char)
[	O
TARNAMESIZE	int
+	O
TARPREFIXSIZE	int
+	O
2	int
]	O
;	O
if	O
(	O
prefix	array(char)
==	O
NULL	O
||	O
*	O
prefix	array(char)
==	O
'\0'	O
)	O
{	O
strncpy	(*(char),*(char),long)->(*(char))
(	O
hold_tar_filename	array(char)
,	O
filename	*(char)
,	O
TARNAMESIZE	int
)	O
;	O
hold_tar_filename	array(char)
[	O
TARNAMESIZE	int
]	O
=	O
'\0'	O
;	O
}	O
else	O
{	O
strncpy	(*(char),*(char),long)->(*(char))
(	O
hold_tar_filename	array(char)
,	O
prefix	array(char)
,	O
TARPREFIXSIZE	int
)	O
;	O
hold_tar_filename	array(char)
[	O
TARPREFIXSIZE	int
]	O
=	O
'\0'	O
;	O
strcat	(*(char),*(char))->(*(char))
(	O
hold_tar_filename	array(char)
,	O
"/"	*(char)
)	O
;	O
strncat	(*(char),*(char),long)->(*(char))
(	O
hold_tar_filename	array(char)
,	O
filename	*(char)
,	O
TARNAMESIZE	int
)	O
;	O
hold_tar_filename	array(char)
[	O
TARPREFIXSIZE	int
+	O
TARNAMESIZE	int
]	O
=	O
'\0'	O
;	O
}	O
return	O
hold_tar_filename	array(char)
;	O
}	O
static	O
int	O
to_oct_or_error	(long,long,*(char),*(char),*(char))->(int)
(	O
uintmax_t	long
value	long
,	O
size_t	long
digits	long
,	O
char	O
*	O
where	*(char)
,	O
char	O
const	O
*	O
field	*(char)
,	O
char	O
const	O
*	O
file	*(char)
)	O
{	O
if	O
(	O
to_ascii	(*(char),long,long,int,bool)->(int)
(	O
where	*(char)
,	O
value	long
,	O
digits	long
,	O
LG_8	int
,	O
true	int
)	O
)	O
{	O
field_width_error	(*(char),*(char),long,long,bool)->(void)
(	O
file	*(char)
,	O
field	*(char)
,	O
value	long
,	O
digits	long
,	O
true	int
)	O
;	O
return	O
1	int
;	O
}	O
return	O
0	int
;	O
}	O
unsigned	O
int	O
tar_checksum	(*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char))))->(int)
(	O
struct	O
tar_header	struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char))
*	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
)	O
{	O
unsigned	O
int	O
sum	int
=	O
0	int
;	O
char	O
*	O
p	*(void)
=	O
(	O
char	O
*	O
)	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
;	O
char	O
*	O
q	*(char)
=	O
p	*(void)
+	O
TARRECORDSIZE	int
;	O
int	O
i	int
;	O
while	O
(	O
p	*(void)
<	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
chksum	array(char)
)	O
sum	int
+=	O
*	O
p	*(void)
++	O
&	O
0xff	int
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
8	int
;	O
++	O
i	int
)	O
{	O
sum	int
+=	O
' '	O
;	O
++	O
p	*(void)
;	O
}	O
while	O
(	O
p	*(void)
<	O
q	*(char)
)	O
sum	int
+=	O
*	O
p	*(void)
++	O
&	O
0xff	int
;	O
return	O
sum	int
;	O
}	O
int	O
write_out_tar_header	(*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char))),int)->(int)
(	O
struct	O
cpio_file_stat	struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char))
*	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
,	O
int	O
out_des	int
)	O
{	O
int	O
name_len	int
;	O
union	O
tar_record	union(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)),array(char))
tar_rec	union(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)),array(char))
;	O
struct	O
tar_header	struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char))
*	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
=	O
(	O
struct	O
tar_header	struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char))
*	O
)	O
&	O
tar_rec	union(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)),array(char))
;	O
memset	(*(void),int,long)->(*(void))
(	O
&	O
tar_rec	union(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)),array(char))
,	O
0	int
,	O
sizeof	O
tar_rec	union(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)),array(char))
)	O
;	O
name_len	int
=	O
strlen	(*(char))->(long)
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_name	*(char)
)	O
;	O
if	O
(	O
name_len	int
<=	O
TARNAMESIZE	int
)	O
{	O
strncpy	(*(char),*(char),long)->(*(char))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
name	*(char)
,	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_name	*(char)
,	O
name_len	int
)	O
;	O
}	O
else	O
{	O
int	O
prefix_len	int
=	O
split_long_name	(*(char),long)->(long)
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_name	*(char)
,	O
name_len	int
)	O
;	O
strncpy	(*(char),*(char),long)->(*(char))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
prefix	array(char)
,	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_name	*(char)
,	O
prefix_len	int
)	O
;	O
strncpy	(*(char),*(char),long)->(*(char))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
name	*(char)
,	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_name	*(char)
+	O
prefix_len	int
+	O
1	int
,	O
name_len	int
-	O
prefix_len	int
-	O
1	int
)	O
;	O
}	O
TO_OCT	O
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
,	O
c_mode	short
&	O
MODE_ALL	O
,	O
8	int
,	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
,	O
mode	int
)	O
;	O
TO_OCT	O
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
,	O
c_uid	short
,	O
8	int
,	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
,	O
uid	int
)	O
;	O
TO_OCT	O
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
,	O
c_gid	short
,	O
8	int
,	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
,	O
gid	int
)	O
;	O
TO_OCT	O
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
,	O
c_filesize	array(char)
,	O
12	int
,	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
,	O
size	int
)	O
;	O
TO_OCT	O
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
,	O
c_mtime	array(char)
,	O
12	int
,	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
,	O
mtime	long
)	O
;	O
switch	O
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_mode	short
&	O
CP_IFMT	int
)	O
{	O
case	O
CP_IFREG	int
:	O
if	O
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_tar_linkname	*(char)
)	O
{	O
strncpy	(*(char),*(char),long)->(*(char))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
linkname	array(char)
,	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_tar_linkname	*(char)
,	O
TARLINKNAMESIZE	int
)	O
;	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
typeflag	char
=	O
LNKTYPE	char
;	O
to_ascii	(*(char),long,long,int,bool)->(int)
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
size	int
,	O
0	int
,	O
12	int
,	O
LG_8	int
,	O
true	int
)	O
;	O
}	O
else	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
typeflag	char
=	O
REGTYPE	char
;	O
break	O
;	O
case	O
CP_IFDIR	int
:	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
typeflag	char
=	O
DIRTYPE	char
;	O
break	O
;	O
case	O
CP_IFCHR	int
:	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
typeflag	char
=	O
CHRTYPE	char
;	O
break	O
;	O
case	O
CP_IFBLK	int
:	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
typeflag	char
=	O
BLKTYPE	char
;	O
break	O
;	O
case	O
CP_IFIFO	int
:	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
typeflag	char
=	O
FIFOTYPE	char
;	O
break	O
;	O
case	O
CP_IFLNK	int
:	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
typeflag	char
=	O
SYMTYPE	char
;	O
strncpy	(*(char),*(char),long)->(*(char))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
linkname	array(char)
,	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_tar_linkname	*(char)
,	O
TARLINKNAMESIZE	int
)	O
;	O
to_ascii	(*(char),long,long,int,bool)->(int)
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
size	int
,	O
0	int
,	O
12	int
,	O
LG_8	int
,	O
true	int
)	O
;	O
break	O
;	O
}	O
if	O
(	O
archive_format	enum(int,int,int,int,int,int,int,int,int)
==	O
arf_ustar	int
)	O
{	O
char	O
*	O
name	*(char)
;	O
strncpy	(*(char),*(char),long)->(*(char))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
magic	array(char)
,	O
TMAGIC	*(char)
,	O
TMAGLEN	int
)	O
;	O
strncpy	(*(char),*(char),long)->(*(char))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
version	array(char)
,	O
TVERSION	*(char)
,	O
TVERSLEN	int
)	O
;	O
name	*(char)
=	O
getuser	(int)->(*(char))
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_uid	short
)	O
;	O
if	O
(	O
name	*(char)
)	O
strcpy	(*(char),*(char))->(*(char))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
uname	array(char)
,	O
name	*(char)
)	O
;	O
name	*(char)
=	O
getgroup	(int)->(*(char))
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_gid	short
)	O
;	O
if	O
(	O
name	*(char)
)	O
strcpy	(*(char),*(char))->(*(char))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
gname	array(char)
,	O
name	*(char)
)	O
;	O
TO_OCT	O
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
,	O
c_rdev_maj	array(char)
,	O
8	int
,	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
,	O
devmajor	array(char)
)	O
;	O
TO_OCT	O
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
,	O
c_rdev_min	array(char)
,	O
8	int
,	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
,	O
devminor	array(char)
)	O
;	O
}	O
to_ascii	(*(char),long,long,int,bool)->(int)
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
chksum	array(char)
,	O
tar_checksum	(*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char))))->(int)
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
)	O
,	O
8	int
,	O
LG_8	int
,	O
true	int
)	O
;	O
tape_buffered_write	(*(char),int,long)->(void)
(	O
(	O
char	O
*	O
)	O
&	O
tar_rec	union(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)),array(char))
,	O
out_des	int
,	O
TARRECORDSIZE	int
)	O
;	O
return	O
0	int
;	O
}	O
int	O
null_block	(*(long),int)->(int)
(	O
long	O
*	O
block	*(long)
,	O
int	O
size	int
)	O
{	O
register	O
long	O
*	O
p	*(void)
=	O
block	*(long)
;	O
register	O
int	O
i	int
=	O
size	int
/	O
sizeof	O
(	O
long	O
)	O
;	O
while	O
(	O
i	int
--	O
)	O
if	O
(	O
*	O
p	*(void)
++	O
)	O
return	O
0	int
;	O
return	O
1	int
;	O
}	O
void	O
read_in_tar_header	(*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char))),int)->(void)
(	O
struct	O
cpio_file_stat	struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char))
*	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
,	O
int	O
in_des	int
)	O
{	O
long	O
bytes_skipped	long
=	O
0	int
;	O
int	O
warned	int
=	O
false	int
;	O
union	O
tar_record	union(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)),array(char))
tar_rec	union(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)),array(char))
;	O
struct	O
tar_header	struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char))
*	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
=	O
(	O
struct	O
tar_header	struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char))
*	O
)	O
&	O
tar_rec	union(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)),array(char))
;	O
uid_t	int
*	O
uidp	*(int)
;	O
gid_t	int
*	O
gidp	*(int)
;	O
tape_buffered_read	(*(char),int,long)->(void)
(	O
(	O
char	O
*	O
)	O
&	O
tar_rec	union(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)),array(char))
,	O
in_des	int
,	O
TARRECORDSIZE	int
)	O
;	O
if	O
(	O
null_block	(*(long),int)->(int)
(	O
(	O
long	O
*	O
)	O
&	O
tar_rec	union(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)),array(char))
,	O
TARRECORDSIZE	int
)	O
)	O
{	O
{	O
cpio_set_c_name	(*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char))),*(char))->(void)
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
,	O
CPIO_TRAILER_NAME	*(char)
)	O
;	O
return	O
;	O
}	O
}	O
while	O
(	O
1	int
)	O
{	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_chksum	array(char)
=	O
FROM_OCTAL	O
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
chksum	array(char)
)	O
;	O
if	O
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_chksum	array(char)
!=	O
tar_checksum	(*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char))))->(int)
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
)	O
)	O
{	O
if	O
(	O
!	O
warned	int
)	O
{	O
error	(int,int,*(char))->(void)
(	O
0	int
,	O
0	int
,	O
_	O
(	O
"invalid header: checksum error"	*(char)
)	O
)	O
;	O
warned	int
=	O
true	int
;	O
}	O
memmove	(*(void),*(void),long)->(*(void))
(	O
&	O
tar_rec	union(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)),array(char))
,	O
(	O
(	O
char	O
*	O
)	O
&	O
tar_rec	union(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)),array(char))
)	O
+	O
1	int
,	O
TARRECORDSIZE	int
-	O
1	int
)	O
;	O
tape_buffered_read	(*(char),int,long)->(void)
(	O
(	O
(	O
char	O
*	O
)	O
&	O
tar_rec	union(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)),array(char))
)	O
+	O
(	O
TARRECORDSIZE	int
-	O
1	int
)	O
,	O
in_des	int
,	O
1	int
)	O
;	O
++	O
bytes_skipped	long
;	O
continue	O
;	O
}	O
if	O
(	O
archive_format	enum(int,int,int,int,int,int,int,int,int)
!=	O
arf_ustar	int
)	O
cpio_set_c_name	(*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char))),*(char))->(void)
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
,	O
stash_tar_filename	(*(char),*(char))->(*(char))
(	O
NULL	O
,	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
name	*(char)
)	O
)	O
;	O
else	O
cpio_set_c_name	(*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char))),*(char))->(void)
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
,	O
stash_tar_filename	(*(char),*(char))->(*(char))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
prefix	array(char)
,	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
name	*(char)
)	O
)	O
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_nlink	short
=	O
1	int
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_mode	short
=	O
FROM_OCTAL	O
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
mode	int
)	O
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_mode	short
=	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_mode	short
&	O
07777	int
;	O
if	O
(	O
archive_format	enum(int,int,int,int,int,int,int,int,int)
==	O
arf_ustar	int
&&	O
!	O
numeric_uid	int
&&	O
(	O
uidp	*(int)
=	O
getuidbyname	(*(char))->(*(int))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
uname	array(char)
)	O
)	O
)	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_uid	short
=	O
*	O
uidp	*(int)
;	O
else	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_uid	short
=	O
FROM_OCTAL	O
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
uid	int
)	O
;	O
if	O
(	O
archive_format	enum(int,int,int,int,int,int,int,int,int)
==	O
arf_ustar	int
&&	O
!	O
numeric_uid	int
&&	O
(	O
gidp	*(int)
=	O
getgidbyname	(*(char))->(*(int))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
gname	array(char)
)	O
)	O
)	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_gid	short
=	O
*	O
gidp	*(int)
;	O
else	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_gid	short
=	O
FROM_OCTAL	O
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
gid	int
)	O
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_filesize	array(char)
=	O
FROM_OCTAL	O
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
size	int
)	O
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_mtime	array(char)
=	O
FROM_OCTAL	O
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
mtime	long
)	O
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_rdev_maj	array(char)
=	O
FROM_OCTAL	O
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
devmajor	array(char)
)	O
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_rdev_min	array(char)
=	O
FROM_OCTAL	O
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
devminor	array(char)
)	O
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_tar_linkname	*(char)
=	O
NULL	O
;	O
switch	O
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
typeflag	char
)	O
{	O
case	O
REGTYPE	char
:	O
case	O
CONTTYPE	char
:	O
default	O
:	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_mode	short
|=	O
CP_IFREG	int
;	O
break	O
;	O
case	O
DIRTYPE	char
:	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_mode	short
|=	O
CP_IFDIR	int
;	O
break	O
;	O
case	O
CHRTYPE	char
:	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_mode	short
|=	O
CP_IFCHR	int
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_tar_linkname	*(char)
=	O
stash_tar_linkname	(*(char))->(*(char))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
linkname	array(char)
)	O
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_filesize	array(char)
=	O
0	int
;	O
break	O
;	O
case	O
BLKTYPE	char
:	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_mode	short
|=	O
CP_IFBLK	int
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_tar_linkname	*(char)
=	O
stash_tar_linkname	(*(char))->(*(char))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
linkname	array(char)
)	O
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_filesize	array(char)
=	O
0	int
;	O
break	O
;	O
case	O
FIFOTYPE	char
:	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_mode	short
|=	O
CP_IFIFO	int
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_tar_linkname	*(char)
=	O
stash_tar_linkname	(*(char))->(*(char))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
linkname	array(char)
)	O
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_filesize	array(char)
=	O
0	int
;	O
break	O
;	O
case	O
SYMTYPE	char
:	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_mode	short
|=	O
CP_IFLNK	int
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_tar_linkname	*(char)
=	O
stash_tar_linkname	(*(char))->(*(char))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
linkname	array(char)
)	O
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_filesize	array(char)
=	O
0	int
;	O
break	O
;	O
case	O
LNKTYPE	char
:	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_mode	short
|=	O
CP_IFREG	int
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_tar_linkname	*(char)
=	O
stash_tar_linkname	(*(char))->(*(char))
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
linkname	array(char)
)	O
;	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_filesize	array(char)
=	O
0	int
;	O
break	O
;	O
case	O
AREGTYPE	char
:	O
if	O
(	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_name	*(char)
[	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_namesize	short
-	O
1	int
]	O
==	O
'/'	O
)	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_mode	short
|=	O
CP_IFDIR	int
;	O
else	O
file_hdr	*(struct(short,long,int,int,int,long,long,long,long,long,long,long,long,int,*(char),long,*(char)))
->	O
c_mode	short
|=	O
CP_IFREG	int
;	O
break	O
;	O
}	O
break	O
;	O
}	O
if	O
(	O
bytes_skipped	long
>	O
0	int
)	O
warn_junk_bytes	(long)->(void)
(	O
bytes_skipped	long
)	O
;	O
}	O
int	O
is_tar_header	(*(char))->(int)
(	O
char	O
*	O
buf	*(char)
)	O
{	O
struct	O
tar_header	struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char))
*	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
=	O
(	O
struct	O
tar_header	struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char))
*	O
)	O
buf	*(char)
;	O
unsigned	O
long	O
chksum	array(char)
;	O
chksum	array(char)
=	O
FROM_OCTAL	O
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
chksum	array(char)
)	O
;	O
if	O
(	O
chksum	array(char)
!=	O
tar_checksum	(*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char))))->(int)
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
)	O
)	O
return	O
0	int
;	O
if	O
(	O
!	O
strncmp	(*(char),*(char),long)->(int)
(	O
tar_hdr	*(struct(array(char),array(char),array(char),array(char),array(char),array(char),array(char),char,array(char),array(char),array(char),array(char),array(char),array(char),array(char),array(char)))
->	O
magic	array(char)
,	O
TMAGIC	*(char)
,	O
TMAGLEN	int
-	O
1	int
)	O
)	O
return	O
2	int
;	O
return	O
1	int
;	O
}	O
int	O
is_tar_filename_too_long	(*(char))->(int)
(	O
char	O
*	O
name	*(char)
)	O
{	O
int	O
whole_name_len	int
;	O
int	O
prefix_name_len	int
;	O
whole_name_len	int
=	O
strlen	(*(char))->(long)
(	O
name	*(char)
)	O
;	O
if	O
(	O
whole_name_len	int
<=	O
TARNAMESIZE	int
)	O
return	O
false	int
;	O
if	O
(	O
archive_format	enum(int,int,int,int,int,int,int,int,int)
!=	O
arf_ustar	int
)	O
return	O
true	int
;	O
if	O
(	O
whole_name_len	int
>	O
TARNAMESIZE	int
+	O
TARPREFIXSIZE	int
+	O
1	int
)	O
return	O
true	int
;	O
prefix_name_len	int
=	O
split_long_name	(*(char),long)->(long)
(	O
name	*(char)
,	O
whole_name_len	int
)	O
;	O
if	O
(	O
prefix_name_len	int
==	O
0	int
||	O
whole_name_len	int
-	O
prefix_name_len	int
-	O
1	int
>	O
TARNAMESIZE	int
)	O
return	O
true	int
;	O
return	O
false	int
;	O
}	O
