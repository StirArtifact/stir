LFD	(int)->(int)
(	O
Lvalues	int
)	O
(	O
void	O
)	O
{	O
if	O
(	O
vs_base	O
==	O
vs_top	O
)	O
vs_base	O
[	O
0	int
]	O
=	O
Cnil	O
;	O
}	O
LFD	(int)->(int)
(	O
Lvalues_list	int
)	O
(	O
void	O
)	O
{	O
object	O
list	O
;	O
check_arg	()->(int)
(	O
1	int
)	O
;	O
list	O
=	O
vs_base	O
[	O
0	int
]	O
;	O
vs_top	O
=	O
vs_base	O
;	O
while	O
(	O
!	O
endp_prop	()->(int)
(	O
list	O
)	O
)	O
{	O
vs_push	()->(int)
(	O
MMcar	()->(int)
(	O
list	O
)	O
)	O
;	O
list	O
=	O
MMcdr	()->(int)
(	O
list	O
)	O
;	O
}	O
if	O
(	O
vs_top	O
==	O
vs_base	O
)	O
vs_base	O
[	O
0	int
]	O
=	O
Cnil	O
;	O
}	O
static	O
void	O
FFN	(int)->(int)
(	O
Fmultiple_value_list	int
)	O
(	O
object	O
form	int
)	O
{	O
object	O
*	O
top	O
=	O
vs_top	O
;	O
if	O
(	O
endp	()->(int)
(	O
form	int
)	O
)	O
FEtoo_few_argumentsF	()->(int)
(	O
form	int
)	O
;	O
if	O
(	O
!	O
endp	()->(int)
(	O
MMcdr	()->(int)
(	O
form	int
)	O
)	O
)	O
FEtoo_many_argumentsF	()->(int)
(	O
form	int
)	O
;	O
vs_push	()->(int)
(	O
Cnil	O
)	O
;	O
eval	()->(int)
(	O
MMcar	()->(int)
(	O
form	int
)	O
)	O
;	O
while	O
(	O
vs_base	O
<	O
vs_top	O
)	O
{	O
top	O
[	O
0	int
]	O
=	O
MMcons	()->(int)
(	O
vs_top	O
[	O
-	O
1	int
]	O
,	O
top	O
[	O
0	int
]	O
)	O
;	O
vs_top	O
--	O
;	O
}	O
vs_base	O
=	O
top	O
;	O
vs_top	O
=	O
top	O
+	O
1	int
;	O
}	O
static	O
void	O
FFN	(int)->(int)
(	O
Fmultiple_value_call	int
)	O
(	O
object	O
form	int
)	O
{	O
object	O
*	O
top	O
=	O
vs_top	O
;	O
object	O
*	O
top1	O
;	O
object	O
*	O
top2	O
;	O
if	O
(	O
endp	()->(int)
(	O
form	int
)	O
)	O
FEtoo_few_argumentsF	()->(int)
(	O
form	int
)	O
;	O
eval	()->(int)
(	O
MMcar	()->(int)
(	O
form	int
)	O
)	O
;	O
vs_top	O
=	O
top	O
;	O
vs_push	()->(int)
(	O
vs_base	O
[	O
0	int
]	O
)	O
;	O
form	int
=	O
MMcdr	()->(int)
(	O
form	int
)	O
;	O
while	O
(	O
!	O
endp	()->(int)
(	O
form	int
)	O
)	O
{	O
top1	O
=	O
vs_top	O
;	O
eval	()->(int)
(	O
MMcar	()->(int)
(	O
form	int
)	O
)	O
;	O
top2	O
=	O
vs_top	O
;	O
vs_top	O
=	O
top1	O
;	O
while	O
(	O
vs_base	O
<	O
top2	O
)	O
{	O
vs_push	()->(int)
(	O
vs_base	O
[	O
0	int
]	O
)	O
;	O
vs_base	O
++	O
;	O
}	O
form	int
=	O
MMcdr	()->(int)
(	O
form	int
)	O
;	O
}	O
vs_base	O
=	O
top	O
+	O
1	int
;	O
super_funcall	()->(int)
(	O
top	O
[	O
0	int
]	O
)	O
;	O
}	O
static	O
void	O
FFN	(int)->(int)
(	O
Fmultiple_value_prog1	int
)	O
(	O
object	O
forms	int
)	O
{	O
object	O
*	O
top	O
;	O
object	O
*	O
base	O
=	O
vs_top	O
;	O
if	O
(	O
endp	()->(int)
(	O
forms	int
)	O
)	O
FEtoo_few_argumentsF	()->(int)
(	O
forms	int
)	O
;	O
eval	()->(int)
(	O
MMcar	()->(int)
(	O
forms	int
)	O
)	O
;	O
top	O
=	O
vs_top	O
;	O
vs_top	O
=	O
base	O
;	O
while	O
(	O
vs_base	O
<	O
top	O
)	O
{	O
vs_push	()->(int)
(	O
vs_base	O
[	O
0	int
]	O
)	O
;	O
vs_base	O
++	O
;	O
}	O
top	O
=	O
vs_top	O
;	O
forms	int
=	O
MMcdr	()->(int)
(	O
forms	int
)	O
;	O
while	O
(	O
!	O
endp	()->(int)
(	O
forms	int
)	O
)	O
{	O
eval	()->(int)
(	O
MMcar	()->(int)
(	O
forms	int
)	O
)	O
;	O
vs_top	O
=	O
top	O
;	O
forms	int
=	O
MMcdr	()->(int)
(	O
forms	int
)	O
;	O
}	O
vs_base	O
=	O
base	O
;	O
vs_top	O
=	O
top	O
;	O
if	O
(	O
vs_base	O
==	O
vs_top	O
)	O
vs_base	O
[	O
0	int
]	O
=	O
Cnil	O
;	O
}	O
void	O
gcl_init_multival	()->(void)
(	O
void	O
)	O
{	O
make_constant	()->(int)
(	O
"MULTIPLE-VALUES-LIMIT"	*(char)
,	O
make_fixnum	()->(int)
(	O
32	int
)	O
)	O
;	O
make_function	()->(int)
(	O
"VALUES"	*(char)
,	O
Lvalues	int
)	O
;	O
make_function	()->(int)
(	O
"VALUES-LIST"	*(char)
,	O
Lvalues_list	int
)	O
;	O
make_special_form	()->(int)
(	O
"MULTIPLE-VALUE-CALL"	*(char)
,	O
Fmultiple_value_call	int
)	O
;	O
make_special_form	()->(int)
(	O
"MULTIPLE-VALUE-PROG1"	*(char)
,	O
Fmultiple_value_prog1	int
)	O
;	O
make_special_form	()->(int)
(	O
"MULTIPLE-VALUE-LIST"	*(char)
,	O
Fmultiple_value_list	int
)	O
;	O
}	O
