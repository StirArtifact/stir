boolean	enum
no_show_indent_level	enum
;	O
boolean	enum
no_show_line_number	enum
;	O
typedef	O
enum	O
{	O
NO_LAYOUT	int
,	O
ONE_ON_ONE	int
,	O
TWO_ON_ONE	int
,	O
THREE_ON_ONE	int
,	O
FOUR_ON_ONE	int
}	O
page_layouts	enum
;	O
static	O
unsigned	O
short	O
logical_pages_on_physical_page	short
;	O
static	O
long	O
physical_page_no	long
;	O
static	O
short	O
greenlines	short
;	O
static	O
boolean	enum
no_holepunch	enum
;	O
static	O
boolean	enum
no_top_holepunch	enum
;	O
static	O
boolean	enum
page_furniture	enum
;	O
static	O
int	O
interline_gap	int
;	O
static	O
boolean	enum
include_headers	enum
;	O
static	O
boolean	enum
include_footers	enum
;	O
static	O
short	O
pointsize	short
;	O
static	O
char	O
orientation	char
;	O
static	O
page_layouts	enum
layout	enum
;	O
static	O
boolean	enum
rotate_alternate_sheets	enum
;	O
static	O
boolean	enum
no_cover_sheet	enum
;	O
static	O
char	O
*	O
user_name	pointer
;	O
static	O
unsigned	O
short	O
printable_width	short
;	O
static	O
unsigned	O
short	O
printable_height	short
;	O
static	O
unsigned	O
short	O
virtual_width	short
;	O
static	O
unsigned	O
short	O
virtual_height	short
;	O
static	O
unsigned	O
short	O
header_box_height	short
;	O
static	O
unsigned	O
short	O
footer_box_height	short
;	O
static	O
unsigned	O
short	O
logical_pages_rotated	short
;	O
static	O
unsigned	O
short	O
pos_left	short
;	O
static	O
unsigned	O
short	O
pos_centre_left	short
;	O
static	O
unsigned	O
short	O
pos_centre_right	short
;	O
static	O
unsigned	O
short	O
pos_right	short
;	O
static	O
unsigned	O
short	O
pos_bottom	short
;	O
static	O
unsigned	O
short	O
pos_centre_bottom	short
;	O
static	O
unsigned	O
short	O
pos_centre_top	short
;	O
static	O
unsigned	O
short	O
pos_top	short
;	O
static	O
unsigned	O
short	O
logical_page_no	short
;	O
static	O
unsigned	O
short	O
left_margin	short
;	O
static	O
unsigned	O
short	O
right_margin	short
;	O
static	O
unsigned	O
short	O
top_margin	short
;	O
static	O
unsigned	O
short	O
bottom_margin	short
;	O
static	O
boolean	enum
left_page	enum
,	O
right_page	enum
;	O
static	O
char	O
no_of_sides	char
;	O
static	O
char	O
ps_level	char
;	O
static	O
void	O
balance_strings	function
(	O
char	O
*	O
string1	pointer
,	O
char	O
*	O
string2	pointer
,	O
char	O
*	O
string3	pointer
,	O
long	O
page_no	long
,	O
boolean	enum
index_page	enum
)	O
;	O
static	O
void	O
set_layout_default	function
(	O
void	O
)	O
;	O
static	O
void	O
set_layout_1	function
(	O
const	O
char	O
*	O
p	pointer
,	O
const	O
char	O
*	O
s	pointer
)	O
;	O
static	O
void	O
set_layout_2	function
(	O
const	O
char	O
*	O
p	pointer
,	O
const	O
char	O
*	O
s	pointer
)	O
;	O
static	O
void	O
set_layout_3	function
(	O
const	O
char	O
*	O
p	pointer
,	O
const	O
char	O
*	O
s	pointer
)	O
;	O
static	O
void	O
set_layout_4	function
(	O
const	O
char	O
*	O
p	pointer
,	O
const	O
char	O
*	O
s	pointer
)	O
;	O
static	O
boolean	enum
PS_side_full	function
(	O
void	O
)	O
;	O
static	O
void	O
set_no_of_sides	function
(	O
const	O
char	O
*	O
p	pointer
,	O
const	O
char	O
*	O
s	pointer
,	O
char	O
value	pointer
)	O
;	O
static	O
void	O
set_no_of_sides_default	function
(	O
char	O
value	pointer
)	O
;	O
void	O
setup_postscript	function
(	O
void	O
)	O
{	O
pointsize	short
=	O
-	O
1	int
;	O
short_option	function
(	O
"p"	pointer
,	O
"point-size"	pointer
,	O
10	int
,	O
NULL	O
,	O
0	int
,	O
MINPOINTSIZE	int
,	O
MAXPOINTSIZE	int
,	O
&	O
pointsize	short
,	O
NULL	O
,	O
NULL	O
,	O
OPT_TEXT_FORMAT	int
,	O
"specify point size (default 10)"	pointer
,	O
NULL	O
)	O
;	O
boolean_option	function
(	O
"C"	pointer
,	O
"no-cover-sheet"	pointer
,	O
"cover-sheet"	pointer
,	O
FALSE	int
,	O
&	O
no_cover_sheet	enum
,	O
NULL	O
,	O
NULL	O
,	O
OPT_PRINT	int
,	O
"don't print cover sheet"	pointer
,	O
"print cover sheet"	pointer
)	O
;	O
boolean_option	function
(	O
"I"	pointer
,	O
"no-holepunch"	pointer
,	O
"holepunch"	pointer
,	O
TRUE	int
,	O
&	O
no_holepunch	enum
,	O
NULL	O
,	O
NULL	O
,	O
OPT_PAGE_FORMAT	int
,	O
"don't leave space for holepunch at the side of each page"	pointer
,	O
"leave space for holepunch at the side of each page"	pointer
)	O
;	O
boolean_option	function
(	O
"J"	pointer
,	O
"no-top-holepunch"	pointer
,	O
"top-holepunch"	pointer
,	O
TRUE	int
,	O
&	O
no_top_holepunch	enum
,	O
NULL	O
,	O
NULL	O
,	O
OPT_PAGE_FORMAT	int
,	O
"don't leave space for holepunch at the top of each page"	pointer
,	O
"leave space for holepunch at the top of each page"	pointer
)	O
;	O
boolean_option	function
(	O
"u"	pointer
,	O
"page-furniture-lines"	pointer
,	O
"no-page-furniture-lines"	pointer
,	O
TRUE	int
,	O
&	O
page_furniture	enum
,	O
NULL	O
,	O
NULL	O
,	O
OPT_PAGE_FURNITURE	int
,	O
"Draw lines around headers and footers and include left margin line"	pointer
,	O
"No lines around headers or footers and no left margin line"	pointer
)	O
;	O
greenlines	short
=	O
-	O
1	int
;	O
short_option	function
(	O
"G"	pointer
,	O
"gray-bands"	pointer
,	O
0	int
,	O
NULL	O
,	O
0	int
,	O
0	int
,	O
MAXGREENLINES	int
,	O
&	O
greenlines	short
,	O
NULL	O
,	O
NULL	O
,	O
OPT_PAGE_FURNITURE	int
,	O
"<lines> emulate the old lineprinter paper with gray bands\n"	pointer
"    across each page.  The value of <lines> gives the width of\n"	pointer
"    the bands and the gaps between them"	pointer
,	O
NULL	O
)	O
;	O
interline_gap	int
=	O
-	O
1	int
;	O
int_option	function
(	O
"g"	pointer
,	O
"leading"	pointer
,	O
1	int
,	O
NULL	O
,	O
0	int
,	O
MININTERLINE_GAP	int
,	O
MAXINTERLINE_GAP	int
,	O
&	O
interline_gap	int
,	O
NULL	O
,	O
NULL	O
,	O
OPT_TEXT_FORMAT	int
,	O
"specify interline gap in points (default 1)"	pointer
,	O
NULL	O
)	O
;	O
boolean_option	function
(	O
"K"	pointer
,	O
"headers"	pointer
,	O
"no-headers"	pointer
,	O
TRUE	int
,	O
&	O
include_headers	enum
,	O
NULL	O
,	O
NULL	O
,	O
OPT_PAGE_FURNITURE	int
,	O
"include the header on each page"	pointer
,	O
"suppress the header on each page"	pointer
)	O
;	O
boolean_option	function
(	O
"k"	pointer
,	O
"footers"	pointer
,	O
"no-footers"	pointer
,	O
TRUE	int
,	O
&	O
include_footers	enum
,	O
NULL	O
,	O
NULL	O
,	O
OPT_PAGE_FURNITURE	int
,	O
"include the footer on each page"	pointer
,	O
"suppress the footer on each page"	pointer
)	O
;	O
user_name	pointer
=	O
NULL	O
;	O
string_option	function
(	O
"U"	pointer
,	O
"username"	pointer
,	O
NULL	O
,	O
&	O
user_name	pointer
,	O
NULL	O
,	O
NULL	O
,	O
OPT_MISC	int
,	O
"set username for coversheet"	pointer
)	O
;	O
boolean_option	function
(	O
"i"	pointer
,	O
"no-braces-depth"	pointer
,	O
"braces-depth"	pointer
,	O
FALSE	int
,	O
&	O
no_show_indent_level	enum
,	O
NULL	O
,	O
NULL	O
,	O
OPT_PAGE_FURNITURE	int
,	O
"exclude the braces depth count"	pointer
,	O
"include the braces depth count"	pointer
)	O
;	O
boolean_option	function
(	O
"n"	pointer
,	O
"no-line-numbers"	pointer
,	O
"line-numbers"	pointer
,	O
FALSE	int
,	O
&	O
no_show_line_number	enum
,	O
NULL	O
,	O
NULL	O
,	O
OPT_PAGE_FURNITURE	int
,	O
"exclude the line number count"	pointer
,	O
"include the line number count"	pointer
)	O
;	O
choice_option	function
(	O
"o"	pointer
,	O
"portrait"	pointer
,	O
"landscape"	pointer
,	O
'p'	O
,	O
'l'	O
,	O
&	O
orientation	char
,	O
NULL	O
,	O
NULL	O
,	O
OPT_PAGE_FORMAT	int
,	O
"print using portrait orientation"	pointer
,	O
"print using landscape orientation"	pointer
)	O
;	O
no_of_sides	char
=	O
'0'	O
;	O
choice_option	function
(	O
"S"	pointer
,	O
"single-sided"	pointer
,	O
"double-sided"	pointer
,	O
'1'	O
,	O
'2'	O
,	O
NULL	O
,	O
set_no_of_sides	function
,	O
set_no_of_sides_default	function
,	O
OPT_PAGE_FORMAT	int
,	O
"print single-sided"	pointer
,	O
"print double-sided"	pointer
)	O
;	O
ps_level	char
=	O
'2'	O
;	O
choice_option	function
(	O
"R"	pointer
,	O
"ps-level-two"	pointer
,	O
"ps-level-one"	pointer
,	O
'2'	O
,	O
'1'	O
,	O
&	O
ps_level	char
,	O
NULL	O
,	O
NULL	O
,	O
OPT_PAGE_FORMAT	int
,	O
"generate postscript level 2 code"	pointer
,	O
"generate postscript level 1 code"	pointer
)	O
;	O
layout	enum
=	O
NO_LAYOUT	int
;	O
noparm_option	function
(	O
"1"	pointer
,	O
"one-up"	pointer
,	O
TRUE	int
,	O
&	O
set_layout_1	function
,	O
&	O
set_layout_default	function
,	O
OPT_PAGE_FORMAT	int
,	O
"print 1-on-1 (default)"	pointer
)	O
;	O
noparm_option	function
(	O
"2"	pointer
,	O
"two-up"	pointer
,	O
FALSE	int
,	O
&	O
set_layout_2	function
,	O
NULL	O
,	O
OPT_PAGE_FORMAT	int
,	O
"print 2-on-1"	pointer
)	O
;	O
noparm_option	function
(	O
"3"	pointer
,	O
"two-tall-up"	pointer
,	O
FALSE	int
,	O
&	O
set_layout_3	function
,	O
NULL	O
,	O
OPT_PAGE_FORMAT	int
,	O
"print 2-on-1 at 4-on-1 pointsize"	pointer
)	O
;	O
noparm_option	function
(	O
"4"	pointer
,	O
"four-up"	pointer
,	O
FALSE	int
,	O
&	O
set_layout_4	function
,	O
NULL	O
,	O
OPT_PAGE_FORMAT	int
,	O
"print 4-on-1"	pointer
)	O
;	O
boolean_option	function
(	O
NULL	O
,	O
"rotate-alternate-sheets"	pointer
,	O
"no-rotate-alternate-sheets"	pointer
,	O
FALSE	int
,	O
&	O
rotate_alternate_sheets	enum
,	O
NULL	O
,	O
NULL	O
,	O
OPT_PAGE_FURNITURE	int
,	O
"rotate every other sheet 180 degrees. Only works in double-sided modes"	pointer
,	O
"don't rotate every other sheet 180 degrees."	pointer
)	O
;	O
}	O
void	O
init_postscript	function
(	O
void	O
)	O
{	O
physical_page_no	long
=	O
1	int
;	O
logical_page_no	short
=	O
0	int
;	O
right_page	enum
=	O
TRUE	int
;	O
left_page	enum
=	O
FALSE	int
;	O
}	O
void	O
set_layout_default	function
(	O
void	O
)	O
{	O
if	O
(	O
layout	enum
!=	O
NO_LAYOUT	int
)	O
return	O
;	O
layout	enum
=	O
ONE_ON_ONE	int
;	O
}	O
void	O
set_layout_1	function
(	O
const	O
char	O
*	O
p	pointer
,	O
const	O
char	O
*	O
s	pointer
)	O
{	O
if	O
(	O
layout	enum
!=	O
NO_LAYOUT	int
)	O
return	O
;	O
layout	enum
=	O
ONE_ON_ONE	int
;	O
}	O
void	O
set_layout_2	function
(	O
const	O
char	O
*	O
p	pointer
,	O
const	O
char	O
*	O
s	pointer
)	O
{	O
if	O
(	O
layout	enum
!=	O
NO_LAYOUT	int
)	O
return	O
;	O
layout	enum
=	O
TWO_ON_ONE	int
;	O
}	O
void	O
set_layout_3	function
(	O
const	O
char	O
*	O
p	pointer
,	O
const	O
char	O
*	O
s	pointer
)	O
{	O
if	O
(	O
layout	enum
!=	O
NO_LAYOUT	int
)	O
return	O
;	O
layout	enum
=	O
THREE_ON_ONE	int
;	O
}	O
void	O
set_layout_4	function
(	O
const	O
char	O
*	O
p	pointer
,	O
const	O
char	O
*	O
s	pointer
)	O
{	O
if	O
(	O
layout	enum
!=	O
NO_LAYOUT	int
)	O
return	O
;	O
layout	enum
=	O
FOUR_ON_ONE	int
;	O
}	O
void	O
PS_header	function
(	O
char	O
*	O
version	pointer
,	O
boolean	enum
print_body	enum
)	O
{	O
unsigned	O
int	O
file_index	int
;	O
printf	function
(	O
"%%!PS-Adobe-%c.0\n"	pointer
,	O
ps_level	char
)	O
;	O
printf	function
(	O
"statusdict /setduplexmode known {\n"	pointer
)	O
;	O
if	O
(	O
no_of_sides	char
==	O
'2'	O
)	O
{	O
printf	function
(	O
"  true "	pointer
)	O
;	O
}	O
else	O
{	O
printf	function
(	O
"  false "	pointer
)	O
;	O
}	O
printf	function
(	O
"statusdict /setduplexmode get exec\n} if\n"	pointer
)	O
;	O
printf	function
(	O
"/Ps	%d def\n"	pointer
,	O
pointsize	short
)	O
;	O
printf	function
(	O
"/SPs	%d def\n"	pointer
,	O
(	O
pointsize	short
*	O
3	int
)	O
/	O
4	int
)	O
;	O
printf	function
(	O
"/Lh	%d def\n"	pointer
,	O
pointsize	short
+	O
interline_gap	int
)	O
;	O
printf	function
(	O
"/Rm	%d def\n"	pointer
,	O
virtual_width	short
)	O
;	O
printf	function
(	O
"/Tm	%d def\n"	pointer
,	O
virtual_height	short
)	O
;	O
printf	function
(	O
"/Bh	%d def\n"	pointer
,	O
header_box_height	short
)	O
;	O
printf	function
(	O
"/Bf	%d def\n"	pointer
,	O
footer_box_height	short
)	O
;	O
printf	function
(	O
"/CF	/Courier findfont Ps scalefont def\n"	pointer
)	O
;	O
printf	function
(	O
"/IF	/Courier-Oblique findfont Ps scalefont def\n"	pointer
)	O
;	O
printf	function
(	O
"/BF	/Courier-Bold findfont Ps scalefont def\n"	pointer
)	O
;	O
printf	function
(	O
"/CFs	/Courier findfont SPs scalefont def\n"	pointer
)	O
;	O
printf	function
(	O
"/IFs	/Courier-Oblique findfont SPs scalefont def\n"	pointer
)	O
;	O
printf	function
(	O
"/BFs	/Courier-Bold findfont SPs scalefont def\n"	pointer
)	O
;	O
printf	function
(	O
"/HF	/Helvetica findfont Ps scalefont def\n"	pointer
)	O
;	O
if	O
(	O
(	O
no_show_line_number	enum
==	O
FALSE	int
)	O
||	O
(	O
no_show_indent_level	enum
==	O
FALSE	int
)	O
)	O
printf	function
(	O
"/Li CFs setfont (1234567890) stringwidth pop def\n"	pointer
)	O
;	O
else	O
printf	function
(	O
"/Li 0 def\n"	pointer
)	O
;	O
printf	function
(	O
"/Nl	{ /Vpos Vpos Lh sub def } def\n"	pointer
)	O
;	O
printf	function
(	O
"/Lpt	{ 0 Vpos moveto } def\n"	pointer
)	O
;	O
printf	function
(	O
"/Gb	{\n"	pointer
)	O
;	O
if	O
(	O
greenlines	short
!=	O
0	int
)	O
{	O
printf	function
(	O
"		gsave /Cv Tm Bh sub def\n"	pointer
)	O
;	O
printf	function
(	O
"		{ Li Cv moveto Rm Li sub 0 rlineto 0 -%d Lh mul rlineto\n"	pointer
,	O
greenlines	short
)	O
;	O
printf	function
(	O
"		  Rm Li sub neg 0 rlineto 0 %d Lh mul rlineto\n"	pointer
,	O
greenlines	short
)	O
;	O
printf	function
(	O
"		  0.98 setgray fill\n"	pointer
)	O
;	O
printf	function
(	O
"		  /Cv Cv %d Lh mul sub def\n"	pointer
,	O
greenlines	short
*	O
2	int
)	O
;	O
printf	function
(	O
"		  Cv 0 lt { exit } if\n"	pointer
)	O
;	O
printf	function
(	O
"		} loop\n"	pointer
)	O
;	O
printf	function
(	O
"		grestore\n"	pointer
)	O
;	O
}	O
printf	function
(	O
"		} def\n"	pointer
)	O
;	O
if	O
(	O
page_furniture	enum
)	O
{	O
printf	function
(	O
"/Ip	{ Gb .5 setlinewidth\n"	pointer
)	O
;	O
if	O
(	O
include_headers	enum
)	O
{	O
printf	function
(	O
"		0 Tm moveto 0 Bh neg rlineto Rm 0 rlineto 0 Bh rlineto closepath\n"	pointer
)	O
;	O
}	O
else	O
{	O
printf	function
(	O
"		0 Tm moveto Rm 0 rlineto\n"	pointer
)	O
;	O
}	O
printf	function
(	O
"		gsave .98 setgray fill grestore stroke\n"	pointer
)	O
;	O
if	O
(	O
include_footers	enum
)	O
{	O
printf	function
(	O
"		0 0 moveto 0 Bf rlineto Rm 0 rlineto 0 Bf neg rlineto closepath\n"	pointer
)	O
;	O
}	O
else	O
{	O
printf	function
(	O
"		0 0 moveto Rm 0 rlineto\n"	pointer
)	O
;	O
}	O
printf	function
(	O
"		gsave .98 setgray fill grestore stroke\n"	pointer
)	O
;	O
printf	function
(	O
"		0 Bf moveto 0 Tm Bh sub lineto stroke newpath\n"	pointer
)	O
;	O
printf	function
(	O
"		} def\n"	pointer
)	O
;	O
}	O
else	O
{	O
printf	function
(	O
"/Ip { } def\n"	pointer
)	O
;	O
}	O
printf	function
(	O
"/Cp	{ Ip .3 setlinewidth newpath\n"	pointer
)	O
;	O
printf	function
(	O
"		Li 0 Bf add moveto Li Tm Bh sub lineto stroke newpath\n"	pointer
)	O
;	O
printf	function
(	O
"		} def\n"	pointer
)	O
;	O
printf	function
(	O
"/So	{ gsave dup stringwidth pop Ps 3 div 0 exch rmoveto 0 rlineto fill grestore } def\n"	pointer
)	O
;	O
printf	function
(	O
"/Ul	{ gsave	dup stringwidth pop 0 -1 rmoveto 0 rlineto fill grestore } def\n"	pointer
)	O
;	O
printf	function
(	O
"/Bs	{ gsave	dup show grestore 0.5 0.5 rmoveto show } def\n"	pointer
)	O
;	O
if	O
(	O
ps_level	char
==	O
'2'	O
)	O
{	O
printf	function
(	O
"<</PageSize [%d %d]>> setpagedevice\n"	pointer
,	O
left_margin	short
+	O
right_margin	short
,	O
top_margin	short
+	O
bottom_margin	short
)	O
;	O
}	O
if	O
(	O
no_cover_sheet	enum
==	O
FALSE	int
)	O
{	O
if	O
(	O
user_name	pointer
==	O
NULL	O
)	O
{	O
dm	function
(	O
'h'	O
,	O
3	int
,	O
"postscript.c:PS_header() use_environment = %d\n"	pointer
,	O
use_environment	enum
)	O
;	O
if	O
(	O
!	O
use_environment	enum
)	O
user_name	pointer
=	O
"testuser"	pointer
;	O
else	O
{	O
char	O
*	O
u	pointer
=	O
getenv	function
(	O
"USER"	pointer
)	O
;	O
if	O
(	O
u	pointer
==	O
0	int
)	O
{	O
user_name	pointer
=	O
""	pointer
;	O
}	O
else	O
{	O
user_name	pointer
=	O
strdup	function
(	O
u	pointer
)	O
;	O
}	O
}	O
if	O
(	O
*	O
user_name	pointer
==	O
'\0'	O
)	O
user_name	pointer
=	O
"Unknown user"	pointer
;	O
dm	function
(	O
'h'	O
,	O
3	int
,	O
"postscript.c:PS_header() Username = %s\n"	pointer
,	O
user_name	pointer
)	O
;	O
}	O
printf	function
(	O
"%%%%Page: Cover %ld\n"	pointer
,	O
physical_page_no	long
++	O
)	O
;	O
printf	function
(	O
"70 70 moveto\n"	pointer
)	O
;	O
printf	function
(	O
"/Helvetica findfont 10 scalefont setfont\n"	pointer
)	O
;	O
printf	function
(	O
"(Trueprint %s) show\n"	pointer
,	O
version	pointer
)	O
;	O
printf	function
(	O
"70 725 moveto\n"	pointer
)	O
;	O
printf	function
(	O
"/Helvetica-Bold findfont 20 scalefont setfont\n"	pointer
)	O
;	O
printf	function
(	O
"(For: %s) show\n"	pointer
,	O
user_name	pointer
)	O
;	O
printf	function
(	O
"70 700 moveto\n"	pointer
)	O
;	O
printf	function
(	O
"(Printed on: %s) show\n"	pointer
,	O
expand_string	function
(	O
"%L"	pointer
,	O
TRUE	int
)	O
)	O
;	O
if	O
(	O
print_body	enum
==	O
TRUE	int
)	O
{	O
printf	function
(	O
"70 675 moveto\n"	pointer
)	O
;	O
printf	function
(	O
"(Last page number: %ld) show\n"	pointer
,	O
total_pages	long
)	O
;	O
for	O
(	O
file_index	int
=	O
0	int
;	O
file_index	int
<	O
(	O
no_of_files	int
>	O
20	int
?	O
20	int
:	O
no_of_files	int
)	O
;	O
file_index	int
++	O
)	O
printf	function
(	O
"70 %d moveto (File: %s) show\n"	pointer
,	O
650	int
-	O
(	O
file_index	int
*	O
25	int
)	O
,	O
file_name	function
(	O
file_index	int
)	O
)	O
;	O
if	O
(	O
no_of_files	int
>	O
20	int
)	O
printf	function
(	O
"70 150 moveto (Etc....) show\n"	pointer
)	O
;	O
}	O
printf	function
(	O
"showpage\n"	pointer
)	O
;	O
if	O
(	O
no_of_sides	char
==	O
'2'	O
)	O
{	O
printf	function
(	O
"%%%%Page: Coverback %ld\n"	pointer
,	O
physical_page_no	long
++	O
)	O
;	O
printf	function
(	O
"showpage\n"	pointer
)	O
;	O
}	O
}	O
}	O
boolean	enum
PS_side_full	function
(	O
void	O
)	O
{	O
boolean	enum
retval	enum
=	O
FALSE	int
;	O
if	O
(	O
logical_page_no	short
!=	O
0	int
)	O
{	O
retval	enum
=	O
(	O
(	O
logical_page_no	short
%	O
logical_pages_on_physical_page	short
)	O
==	O
0	int
)	O
;	O
}	O
dm	function
(	O
'O'	O
,	O
2	int
,	O
"postscript.c:PS_side_full() returning %d\n"	pointer
,	O
retval	enum
)	O
;	O
return	O
retval	enum
;	O
}	O
boolean	enum
PS_endpage	function
(	O
boolean	enum
print_page	enum
)	O
{	O
static	O
boolean	enum
page_has_printing	enum
=	O
FALSE	int
;	O
boolean	enum
reached_end_of_sheet	enum
;	O
if	O
(	O
print_page	enum
)	O
{	O
page_has_printing	enum
=	O
TRUE	int
;	O
}	O
reached_end_of_sheet	enum
=	O
(	O
(	O
(	O
no_of_sides	char
==	O
'2'	O
)	O
&&	O
left_page	enum
&&	O
(	O
(	O
logical_page_no	short
%	O
logical_pages_on_physical_page	short
)	O
==	O
0	int
)	O
)	O
||	O
(	O
(	O
no_of_sides	char
==	O
'1'	O
)	O
&&	O
(	O
(	O
logical_page_no	short
%	O
logical_pages_on_physical_page	short
)	O
==	O
0	int
)	O
)	O
)	O
;	O
if	O
(	O
PS_side_full	function
(	O
)	O
)	O
{	O
physical_page_no	long
++	O
;	O
if	O
(	O
no_of_sides	char
==	O
'2'	O
)	O
{	O
left_page	enum
=	O
!	O
left_page	enum
;	O
right_page	enum
=	O
!	O
right_page	enum
;	O
}	O
if	O
(	O
pass	short
==	O
1	int
)	O
{	O
if	O
(	O
page_has_printing	enum
)	O
{	O
printf	function
(	O
"showpage\n"	pointer
)	O
;	O
}	O
else	O
{	O
printf	function
(	O
"erasepage initgraphics\n"	pointer
)	O
;	O
}	O
}	O
page_has_printing	enum
=	O
FALSE	int
;	O
}	O
return	O
reached_end_of_sheet	enum
;	O
}	O
void	O
PS_startpage	function
(	O
char	O
*	O
head1	pointer
,	O
char	O
*	O
head2	pointer
,	O
char	O
*	O
head3	pointer
,	O
char	O
*	O
foot1	pointer
,	O
char	O
*	O
foot2	pointer
,	O
char	O
*	O
foot3	pointer
,	O
char	O
*	O
msg_string	pointer
,	O
long	O
page_no	long
,	O
long	O
hdr_total_pages	long
,	O
boolean	enum
index_page	enum
)	O
{	O
short	O
message_pointsize	short
;	O
char	O
*	O
message	pointer
;	O
unsigned	O
short	O
gap	short
;	O
logical_page_no	short
++	O
;	O
dm	function
(	O
'O'	O
,	O
2	int
,	O
"postscript.c:PS_startpage(), logical page = %d, physical page = %d\n"	pointer
,	O
logical_page_no	short
,	O
physical_page_no	long
)	O
;	O
if	O
(	O
pass	short
==	O
0	int
)	O
return	O
;	O
dm	function
(	O
'h'	O
,	O
4	int
,	O
"Printing page %s/%s/%s %s/%s/%s + %s, page %d, total %d, index %d\n"	pointer
,	O
head1	pointer
,	O
head2	pointer
,	O
head3	pointer
,	O
foot1	pointer
,	O
foot2	pointer
,	O
foot3	pointer
,	O
msg_string	pointer
,	O
page_no	long
,	O
hdr_total_pages	long
,	O
index_page	enum
)	O
;	O
dm	function
(	O
'h'	O
,	O
4	int
,	O
"postscript.c:PS_startpage layout %d no_of_sides %c page_no %d\n"	pointer
,	O
layout	enum
,	O
no_of_sides	char
,	O
page_no	long
)	O
;	O
message	pointer
=	O
expand_string	function
(	O
msg_string	pointer
,	O
index_page	enum
)	O
;	O
if	O
(	O
!	O
no_holepunch	enum
&&	O
right_page	enum
)	O
gap	short
=	O
HOLEPUNCH_WIDTH	int
-	O
pos_left	short
;	O
else	O
gap	short
=	O
0	int
;	O
switch	O
(	O
layout	enum
)	O
{	O
case	O
ONE_ON_ONE	int
:	O
printf	function
(	O
"%%%%Page: %d %ld\n"	pointer
,	O
logical_page_no	short
,	O
physical_page_no	long
)	O
;	O
if	O
(	O
rotate_alternate_sheets	enum
&&	O
left_page	enum
)	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate 180 rotate\n"	pointer
,	O
pos_right	short
+	O
gap	short
,	O
pos_top	short
)	O
;	O
if	O
(	O
orientation	char
==	O
'l'	O
)	O
printf	function
(	O
"%d %d translate 270 rotate\n"	pointer
,	O
pos_left	short
+	O
gap	short
,	O
pos_top	short
)	O
;	O
}	O
else	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate\n"	pointer
,	O
pos_left	short
+	O
gap	short
,	O
pos_bottom	short
)	O
;	O
if	O
(	O
orientation	char
==	O
'l'	O
)	O
printf	function
(	O
"%d %d translate 90 rotate\n"	pointer
,	O
pos_right	short
+	O
gap	short
,	O
pos_bottom	short
)	O
;	O
}	O
break	O
;	O
case	O
TWO_ON_ONE	int
:	O
switch	O
(	O
logical_page_no	short
&	O
1	int
)	O
{	O
case	O
1	int
:	O
printf	function
(	O
"%%%%Page: %d %ld\n"	pointer
,	O
logical_page_no	short
,	O
physical_page_no	long
)	O
;	O
printf	function
(	O
"gsave\n"	pointer
)	O
;	O
if	O
(	O
rotate_alternate_sheets	enum
&&	O
left_page	enum
)	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .64 .64 scale 270 rotate\n"	pointer
,	O
pos_left	short
+	O
gap	short
,	O
pos_top	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .64 .64 scale 180 rotate\n"	pointer
,	O
pos_right	short
+	O
gap	short
,	O
pos_centre_bottom	short
)	O
;	O
}	O
else	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .64 .64 scale 90 rotate\n"	pointer
,	O
pos_right	short
+	O
gap	short
,	O
pos_bottom	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .64 .64 scale\n"	pointer
,	O
pos_left	short
+	O
gap	short
,	O
pos_centre_top	short
)	O
;	O
}	O
break	O
;	O
case	O
0	int
:	O
printf	function
(	O
"grestore\n"	pointer
)	O
;	O
if	O
(	O
rotate_alternate_sheets	enum
&&	O
left_page	enum
)	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .64 .64 scale 270 rotate\n"	pointer
,	O
pos_left	short
+	O
gap	short
,	O
pos_centre_bottom	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .64 .64 scale 180 rotate\n"	pointer
,	O
pos_right	short
+	O
gap	short
,	O
pos_top	short
)	O
;	O
}	O
else	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .64 .64 scale 90 rotate\n"	pointer
,	O
pos_right	short
+	O
gap	short
,	O
pos_centre_top	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .64 .64 scale\n"	pointer
,	O
pos_left	short
+	O
gap	short
,	O
pos_bottom	short
)	O
;	O
}	O
}	O
break	O
;	O
case	O
THREE_ON_ONE	int
:	O
switch	O
(	O
logical_page_no	short
&	O
1	int
)	O
{	O
case	O
1	int
:	O
printf	function
(	O
"%%%%Page: %d %ld\n"	pointer
,	O
logical_page_no	short
,	O
physical_page_no	long
)	O
;	O
printf	function
(	O
"gsave\n"	pointer
)	O
;	O
if	O
(	O
rotate_alternate_sheets	enum
&&	O
left_page	enum
)	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .5 .5 scale 180 rotate\n"	pointer
,	O
pos_right	short
+	O
gap	short
,	O
pos_top	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .5 .5 scale 270 rotate\n"	pointer
,	O
pos_centre_right	short
+	O
gap	short
,	O
pos_top	short
)	O
;	O
}	O
else	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .5 .5 scale\n"	pointer
,	O
pos_left	short
+	O
gap	short
,	O
pos_bottom	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .5 .5 scale 90 rotate\n"	pointer
,	O
pos_centre_left	short
+	O
gap	short
,	O
pos_bottom	short
)	O
;	O
}	O
break	O
;	O
case	O
0	int
:	O
printf	function
(	O
"grestore\n"	pointer
)	O
;	O
if	O
(	O
rotate_alternate_sheets	enum
&&	O
left_page	enum
)	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .5 .5 scale 180 rotate\n"	pointer
,	O
pos_centre_left	short
+	O
gap	short
,	O
pos_top	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .5 .5 scale 270 rotate\n"	pointer
,	O
pos_left	short
+	O
gap	short
,	O
pos_top	short
)	O
;	O
}	O
else	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .5 .5 scale\n"	pointer
,	O
pos_centre_right	short
+	O
gap	short
,	O
pos_bottom	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .5 .5 scale 90 rotate\n"	pointer
,	O
pos_right	short
+	O
gap	short
,	O
pos_bottom	short
)	O
;	O
}	O
}	O
break	O
;	O
case	O
FOUR_ON_ONE	int
:	O
switch	O
(	O
logical_page_no	short
&	O
3	int
)	O
{	O
case	O
1	int
:	O
printf	function
(	O
"%%%%Page: %d %ld\n"	pointer
,	O
logical_page_no	short
,	O
physical_page_no	long
)	O
;	O
printf	function
(	O
"gsave\n"	pointer
)	O
;	O
if	O
(	O
rotate_alternate_sheets	enum
&&	O
left_page	enum
)	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .5 .5 scale 180 rotate\n"	pointer
,	O
pos_right	short
+	O
gap	short
,	O
pos_centre_bottom	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .5 .5 scale 270 rotate\n"	pointer
,	O
pos_centre_right	short
+	O
gap	short
,	O
pos_top	short
)	O
;	O
}	O
else	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .5 .5 scale\n"	pointer
,	O
pos_left	short
+	O
gap	short
,	O
pos_centre_top	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .5 .5 scale 90 rotate\n"	pointer
,	O
pos_centre_left	short
+	O
gap	short
,	O
pos_bottom	short
)	O
;	O
}	O
break	O
;	O
case	O
2	int
:	O
printf	function
(	O
"grestore gsave\n"	pointer
)	O
;	O
if	O
(	O
rotate_alternate_sheets	enum
&&	O
left_page	enum
)	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .5 .5 scale 180 rotate\n"	pointer
,	O
pos_right	short
+	O
gap	short
,	O
pos_top	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .5 .5 scale 270 rotate\n"	pointer
,	O
pos_left	short
+	O
gap	short
,	O
pos_top	short
)	O
;	O
}	O
else	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .5 .5 scale\n"	pointer
,	O
pos_left	short
+	O
gap	short
,	O
pos_bottom	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .5 .5 scale 90 rotate\n"	pointer
,	O
pos_right	short
+	O
gap	short
,	O
pos_bottom	short
)	O
;	O
}	O
break	O
;	O
case	O
3	int
:	O
printf	function
(	O
"grestore gsave\n"	pointer
)	O
;	O
if	O
(	O
rotate_alternate_sheets	enum
&&	O
left_page	enum
)	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .5 .5 scale 180 rotate\n"	pointer
,	O
pos_centre_left	short
+	O
gap	short
,	O
pos_centre_bottom	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .5 .5 scale 270 rotate\n"	pointer
,	O
pos_centre_right	short
+	O
gap	short
,	O
pos_centre_bottom	short
)	O
;	O
}	O
else	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .5 .5 scale\n"	pointer
,	O
pos_centre_right	short
+	O
gap	short
,	O
pos_centre_top	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .5 .5 scale 90 rotate\n"	pointer
,	O
pos_centre_left	short
+	O
gap	short
,	O
pos_centre_top	short
)	O
;	O
}	O
break	O
;	O
case	O
0	int
:	O
printf	function
(	O
"grestore\n"	pointer
)	O
;	O
if	O
(	O
rotate_alternate_sheets	enum
&&	O
left_page	enum
)	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .5 .5 scale 180 rotate\n"	pointer
,	O
pos_centre_left	short
+	O
gap	short
,	O
pos_top	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .5 .5 scale 270 rotate\n"	pointer
,	O
pos_left	short
+	O
gap	short
,	O
pos_centre_bottom	short
)	O
;	O
}	O
else	O
{	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
printf	function
(	O
"%d %d translate .5 .5 scale\n"	pointer
,	O
pos_centre_right	short
+	O
gap	short
,	O
pos_bottom	short
)	O
;	O
else	O
printf	function
(	O
"%d %d translate .5 .5 scale 90 rotate\n"	pointer
,	O
pos_right	short
+	O
gap	short
,	O
pos_centre_top	short
)	O
;	O
}	O
}	O
break	O
;	O
case	O
NO_LAYOUT	int
:	O
abort	function
(	O
)	O
;	O
}	O
if	O
(	O
!	O
index_page	enum
&&	O
(	O
(	O
no_show_line_number	enum
==	O
FALSE	int
)	O
||	O
(	O
no_show_indent_level	enum
==	O
FALSE	int
)	O
)	O
)	O
printf	function
(	O
"Cp "	pointer
)	O
;	O
else	O
printf	function
(	O
"Ip "	pointer
)	O
;	O
if	O
(	O
(	O
message	pointer
!=	O
NULL	O
)	O
&&	O
(	O
strlen	function
(	O
message	pointer
)	O
!=	O
0	int
)	O
)	O
{	O
message_pointsize	short
=	O
printable_width	short
/	O
strlen	function
(	O
message	pointer
)	O
;	O
printf	function
(	O
"gsave\n"	pointer
)	O
;	O
printf	function
(	O
".9 setgray\n"	pointer
)	O
;	O
printf	function
(	O
"Rm 2 div Tm 2 div translate "	pointer
)	O
;	O
if	O
(	O
orientation	char
==	O
'l'	O
)	O
printf	function
(	O
"30 rotate\n"	pointer
)	O
;	O
else	O
printf	function
(	O
"60 rotate\n"	pointer
)	O
;	O
printf	function
(	O
"/Courier-Bold findfont %d scalefont setfont "	pointer
,	O
message_pointsize	short
)	O
;	O
printf	function
(	O
"-216 0 moveto (%s) show\n"	pointer
,	O
message	pointer
)	O
;	O
printf	function
(	O
"grestore\n"	pointer
)	O
;	O
}	O
if	O
(	O
include_headers	enum
)	O
{	O
printf	function
(	O
"HF setfont /Ypos Tm Bh sub Ps 2 div add def\n"	pointer
)	O
;	O
balance_strings	function
(	O
head1	pointer
,	O
head2	pointer
,	O
head3	pointer
,	O
page_no	long
,	O
index_page	enum
)	O
;	O
}	O
if	O
(	O
include_footers	enum
)	O
{	O
printf	function
(	O
"HF setfont /Ypos Ps 2 div def\n"	pointer
)	O
;	O
balance_strings	function
(	O
foot1	pointer
,	O
foot2	pointer
,	O
foot3	pointer
,	O
page_no	long
,	O
index_page	enum
)	O
;	O
}	O
if	O
(	O
index_page	enum
)	O
{	O
printf	function
(	O
"CF setfont "	pointer
)	O
;	O
}	O
printf	function
(	O
"/Vpos Tm Bh sub Ps sub def\n"	pointer
)	O
;	O
}	O
void	O
PS_end_output	function
(	O
void	O
)	O
{	O
printf	function
(	O
"%%%%Trailer\n"	pointer
)	O
;	O
printf	function
(	O
"%%%%EOF\n"	pointer
)	O
;	O
}	O
void	O
balance_strings	function
(	O
char	O
*	O
string1	pointer
,	O
char	O
*	O
string2	pointer
,	O
char	O
*	O
string3	pointer
,	O
long	O
page_no	long
,	O
boolean	enum
index_page	enum
)	O
{	O
char	O
*	O
s1	pointer
,	O
*	O
s2	pointer
,	O
*	O
s3	pointer
;	O
if	O
(	O
right_page	enum
)	O
{	O
s1	pointer
=	O
strdup	function
(	O
expand_string	function
(	O
string1	pointer
,	O
index_page	enum
)	O
)	O
;	O
s2	pointer
=	O
strdup	function
(	O
expand_string	function
(	O
string2	pointer
,	O
index_page	enum
)	O
)	O
;	O
s3	pointer
=	O
strdup	function
(	O
expand_string	function
(	O
string3	pointer
,	O
index_page	enum
)	O
)	O
;	O
}	O
else	O
{	O
s1	pointer
=	O
strdup	function
(	O
expand_string	function
(	O
string3	pointer
,	O
index_page	enum
)	O
)	O
;	O
s2	pointer
=	O
strdup	function
(	O
expand_string	function
(	O
string2	pointer
,	O
index_page	enum
)	O
)	O
;	O
s3	pointer
=	O
strdup	function
(	O
expand_string	function
(	O
string1	pointer
,	O
index_page	enum
)	O
)	O
;	O
}	O
printf	function
(	O
"Ps Ypos moveto\n"	pointer
)	O
;	O
printf	function
(	O
"(%s) show "	pointer
,	O
s1	pointer
)	O
;	O
printf	function
(	O
"currentpoint pop dup "	pointer
)	O
;	O
printf	function
(	O
"Rm Ps sub "	pointer
)	O
;	O
printf	function
(	O
"(%s) stringwidth pop "	pointer
,	O
s3	pointer
)	O
;	O
printf	function
(	O
"sub dup Ypos moveto\n"	pointer
)	O
;	O
printf	function
(	O
"(%s) show\n"	pointer
,	O
s3	pointer
)	O
;	O
printf	function
(	O
"exch sub 2 div add "	pointer
)	O
;	O
printf	function
(	O
"(%s) stringwidth pop "	pointer
,	O
s2	pointer
)	O
;	O
printf	function
(	O
"2 div sub Ypos moveto\n"	pointer
)	O
;	O
printf	function
(	O
"(%s) show\n"	pointer
,	O
s2	pointer
)	O
;	O
}	O
void	O
PS_pagesize	function
(	O
char	O
*	O
printer	pointer
,	O
int	O
*	O
width_ptr	pointer
,	O
int	O
*	O
length_ptr	pointer
)	O
{	O
float	O
margin_height	float
;	O
short	O
tmp_sides	short
;	O
printer_stats	function
(	O
printer	pointer
,	O
&	O
tmp_sides	short
,	O
&	O
left_margin	short
,	O
&	O
right_margin	short
,	O
&	O
top_margin	short
,	O
&	O
bottom_margin	short
)	O
;	O
if	O
(	O
no_of_sides	char
==	O
'0'	O
)	O
{	O
if	O
(	O
tmp_sides	short
==	O
1	int
)	O
no_of_sides	char
=	O
'1'	O
;	O
else	O
no_of_sides	char
=	O
'2'	O
;	O
}	O
dm	function
(	O
'O'	O
,	O
3	int
,	O
"postscript.c:PS_pagesize left %d right %d top %d bottom %d\n"	pointer
,	O
left_margin	short
,	O
right_margin	short
,	O
top_margin	short
,	O
bottom_margin	short
)	O
;	O
dm	function
(	O
'O'	O
,	O
3	int
,	O
"postscript.c:PS_pagesize pointsize %d\n"	pointer
,	O
pointsize	short
)	O
;	O
if	O
(	O
HOLEPUNCH_WIDTH	int
<	O
left_margin	short
)	O
no_holepunch	enum
=	O
TRUE	int
;	O
if	O
(	O
!	O
no_holepunch	enum
)	O
printable_width	short
=	O
right_margin	short
-	O
HOLEPUNCH_WIDTH	int
;	O
else	O
printable_width	short
=	O
right_margin	short
-	O
left_margin	short
;	O
if	O
(	O
!	O
no_top_holepunch	enum
)	O
printable_height	short
=	O
top_margin	short
-	O
bottom_margin	short
-	O
HOLEPUNCH_HEIGHT	int
;	O
else	O
printable_height	short
=	O
top_margin	short
-	O
bottom_margin	short
;	O
if	O
(	O
(	O
*	O
length_ptr	pointer
==	O
-	O
1	int
)	O
&&	O
(	O
pointsize	short
==	O
0	int
)	O
)	O
abort	function
(	O
)	O
;	O
if	O
(	O
layout	enum
==	O
ONE_ON_ONE	int
)	O
{	O
logical_pages_on_physical_page	short
=	O
1	int
;	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
{	O
logical_pages_rotated	short
=	O
FALSE	int
;	O
virtual_width	short
=	O
printable_width	short
;	O
virtual_height	short
=	O
printable_height	short
;	O
}	O
else	O
{	O
logical_pages_rotated	short
=	O
TRUE	int
;	O
virtual_width	short
=	O
printable_height	short
;	O
virtual_height	short
=	O
printable_width	short
;	O
}	O
}	O
else	O
if	O
(	O
layout	enum
==	O
TWO_ON_ONE	int
)	O
{	O
logical_pages_on_physical_page	short
=	O
2	int
;	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
{	O
logical_pages_rotated	short
=	O
TRUE	int
;	O
virtual_width	short
=	O
printable_height	short
/	O
2	int
*	O
1.56	int
-	O
3	int
;	O
virtual_height	short
=	O
printable_width	short
*	O
1.56	int
;	O
}	O
else	O
{	O
logical_pages_rotated	short
=	O
FALSE	int
;	O
virtual_width	short
=	O
printable_width	short
*	O
1.56	int
;	O
virtual_height	short
=	O
printable_height	short
/	O
2	int
*	O
1.56	int
-	O
3	int
;	O
}	O
}	O
else	O
if	O
(	O
layout	enum
==	O
THREE_ON_ONE	int
)	O
{	O
logical_pages_on_physical_page	short
=	O
2	int
;	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
{	O
logical_pages_rotated	short
=	O
FALSE	int
;	O
virtual_width	short
=	O
printable_width	short
-	O
4	int
;	O
virtual_height	short
=	O
printable_height	short
*	O
2	int
;	O
}	O
else	O
{	O
logical_pages_rotated	short
=	O
TRUE	int
;	O
virtual_width	short
=	O
printable_height	short
*	O
2	int
;	O
virtual_height	short
=	O
printable_width	short
-	O
4	int
;	O
}	O
}	O
else	O
{	O
logical_pages_on_physical_page	short
=	O
4	int
;	O
if	O
(	O
orientation	char
==	O
'p'	O
)	O
{	O
logical_pages_rotated	short
=	O
FALSE	int
;	O
virtual_width	short
=	O
printable_width	short
-	O
4	int
;	O
virtual_height	short
=	O
printable_height	short
-	O
4	int
;	O
}	O
else	O
{	O
logical_pages_rotated	short
=	O
TRUE	int
;	O
virtual_width	short
=	O
printable_height	short
-	O
4	int
;	O
virtual_height	short
=	O
printable_width	short
-	O
4	int
;	O
}	O
}	O
pos_left	short
=	O
left_margin	short
;	O
pos_centre_left	short
=	O
left_margin	short
+	O
printable_width	short
/	O
2	int
-	O
2	int
;	O
pos_centre_right	short
=	O
left_margin	short
+	O
printable_width	short
/	O
2	int
+	O
2	int
;	O
pos_right	short
=	O
left_margin	short
+	O
printable_width	short
;	O
pos_bottom	short
=	O
bottom_margin	short
;	O
pos_centre_bottom	short
=	O
bottom_margin	short
+	O
printable_height	short
/	O
2	int
-	O
2	int
;	O
pos_centre_top	short
=	O
bottom_margin	short
+	O
printable_height	short
/	O
2	int
+	O
2	int
;	O
pos_top	short
=	O
bottom_margin	short
+	O
printable_height	short
;	O
dm	function
(	O
'O'	O
,	O
3	int
,	O
"postscript.c:PS_pagesize virtual width %d, virtual height %d\n"	pointer
,	O
virtual_width	short
,	O
virtual_height	short
)	O
;	O
dm	function
(	O
'O'	O
,	O
3	int
,	O
"postscript.c:PS_pagesize specified width %d, specified length %d\n"	pointer
,	O
*	O
width_ptr	pointer
,	O
*	O
length_ptr	pointer
)	O
;	O
if	O
(	O
!	O
include_headers	enum
)	O
header_box_height	short
=	O
0	int
;	O
else	O
header_box_height	short
=	O
1.5	int
*	O
pointsize	short
;	O
if	O
(	O
!	O
include_footers	enum
)	O
footer_box_height	short
=	O
0	int
;	O
else	O
footer_box_height	short
=	O
1.5	int
*	O
pointsize	short
;	O
margin_height	float
=	O
header_box_height	short
+	O
footer_box_height	short
;	O
if	O
(	O
*	O
length_ptr	pointer
==	O
-	O
1	int
)	O
*	O
length_ptr	pointer
=	O
(	O
virtual_height	short
-	O
margin_height	float
)	O
/	O
(	O
pointsize	short
+	O
interline_gap	int
)	O
;	O
else	O
pointsize	short
=	O
(	O
short	O
)	O
(	O
virtual_height	short
-	O
(	O
interline_gap	int
*	O
*	O
length_ptr	pointer
)	O
)	O
/	O
(	O
3	int
+	O
*	O
length_ptr	pointer
)	O
;	O
dm	function
(	O
'O'	O
,	O
3	int
,	O
"virtual_width = %d, pointsize = %d %d\n"	pointer
,	O
virtual_width	short
,	O
pointsize	short
,	O
0.6	int
*	O
pointsize	short
)	O
;	O
if	O
(	O
*	O
width_ptr	pointer
==	O
-	O
1	int
)	O
*	O
width_ptr	pointer
=	O
1.66	int
*	O
virtual_width	short
/	O
pointsize	short
;	O
dm	function
(	O
'O'	O
,	O
3	int
,	O
"postscript.c:PS_pagesize width to be used %d, length to be used %d\n"	pointer
,	O
*	O
width_ptr	pointer
,	O
*	O
length_ptr	pointer
)	O
;	O
if	O
(	O
(	O
(	O
no_show_line_number	enum
==	O
FALSE	int
)	O
||	O
(	O
no_show_indent_level	enum
==	O
FALSE	int
)	O
)	O
&&	O
(	O
*	O
width_ptr	pointer
>=	O
8	int
)	O
)	O
(	O
*	O
width_ptr	pointer
)	O
-=	O
8	int
;	O
dm	function
(	O
'O'	O
,	O
3	int
,	O
"postscript.c:PS_pagesize width to be used %d, length to be used %d\n"	pointer
,	O
*	O
width_ptr	pointer
,	O
*	O
length_ptr	pointer
)	O
;	O
}	O
static	O
void	O
set_no_of_sides_default	function
(	O
char	O
value	pointer
)	O
{	O
no_of_sides	char
=	O
'0'	O
;	O
}	O
static	O
void	O
set_no_of_sides	function
(	O
const	O
char	O
*	O
p	pointer
,	O
const	O
char	O
*	O
s	pointer
,	O
char	O
value	pointer
)	O
{	O
no_of_sides	char
=	O
value	pointer
;	O
}	O
