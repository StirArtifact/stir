struct	O
gnufdisk_stack	struct
{	O
void	O
*	O
data	pointer
;	O
int	O
size	int
;	O
int	O
index	function
;	O
}	O
;	O
struct	O
gnufdisk_stack	struct
*	O
gnufdisk_stack_new	function
(	O
void	O
)	O
{	O
struct	O
gnufdisk_stack	struct
*	O
ret	pointer
;	O
int	O
err	int
;	O
if	O
(	O
(	O
ret	int
=	O
malloc	function
(	O
sizeof	O
(	O
struct	O
gnufdisk_stack	struct
)	O
)	O
)	O
==	O
NULL	O
)	O
{	O
err	int
=	O
ENOMEM	int
;	O
goto	O
lb_out	O
;	O
}	O
memset	function
(	O
ret	int
,	O
0	int
,	O
sizeof	O
(	O
struct	O
gnufdisk_stack	struct
)	O
)	O
;	O
lb_out	O
:	O
errno	O
=	O
err	int
;	O
return	O
ret	int
;	O
}	O
int	O
gnufdisk_stack_delete	function
(	O
struct	O
gnufdisk_stack	struct
*	O
_s	pointer
)	O
{	O
int	O
ret	int
;	O
int	O
err	int
;	O
if	O
(	O
gnufdisk_check_memory	function
(	O
_s	pointer
,	O
sizeof	O
(	O
struct	O
gnufdisk_stack	struct
)	O
,	O
0	int
)	O
!=	O
0	int
)	O
{	O
err	int
=	O
errno	O
;	O
ret	int
=	O
-	O
1	int
;	O
goto	O
lb_out	O
;	O
}	O
if	O
(	O
_s	pointer
->	O
data	pointer
)	O
{	O
if	O
(	O
gnufdisk_check_memory	function
(	O
_s	pointer
->	O
data	pointer
,	O
_s	pointer
->	O
size	long
,	O
0	int
)	O
!=	O
0	int
)	O
{	O
err	int
=	O
errno	O
;	O
ret	int
=	O
-	O
1	int
;	O
goto	O
lb_out	O
;	O
}	O
free	function
(	O
_s	pointer
->	O
data	pointer
)	O
;	O
_s	pointer
->	O
data	pointer
=	O
NULL	O
;	O
}	O
free	function
(	O
_s	pointer
)	O
;	O
err	int
=	O
0	int
;	O
ret	int
=	O
0	int
;	O
lb_out	O
:	O
errno	O
=	O
err	int
;	O
return	O
ret	int
;	O
}	O
int	O
gnufdisk_stack_push	function
(	O
struct	O
gnufdisk_stack	struct
*	O
_s	pointer
,	O
void	O
*	O
_data	pointer
,	O
size_t	long
_size	long
)	O
{	O
int	O
ret	int
;	O
int	O
err	int
;	O
if	O
(	O
gnufdisk_check_memory	function
(	O
_s	pointer
,	O
sizeof	O
(	O
struct	O
gnufdisk_stack	struct
)	O
,	O
0	int
)	O
!=	O
0	int
)	O
{	O
err	int
=	O
errno	O
;	O
ret	int
=	O
-	O
1	int
;	O
goto	O
lb_out	O
;	O
}	O
else	O
if	O
(	O
gnufdisk_check_memory	function
(	O
_data	pointer
,	O
_size	int
,	O
1	int
)	O
!=	O
0	int
)	O
{	O
err	int
=	O
EFAULT	int
;	O
ret	int
=	O
-	O
1	int
;	O
goto	O
lb_out	O
;	O
}	O
if	O
(	O
_size	int
>	O
_s	pointer
->	O
size	long
-	O
_s	pointer
->	O
index	function
)	O
{	O
void	O
*	O
data	pointer
;	O
int	O
size	long
;	O
size	int
=	O
_s	pointer
->	O
size	long
+	O
32	int
;	O
if	O
(	O
(	O
data	pointer
=	O
malloc	function
(	O
size	long
)	O
)	O
==	O
NULL	O
)	O
{	O
err	int
=	O
ENOMEM	int
;	O
ret	int
=	O
-	O
1	int
;	O
goto	O
lb_out	O
;	O
}	O
if	O
(	O
_s	pointer
->	O
data	pointer
)	O
{	O
memcpy	function
(	O
data	pointer
,	O
_s	pointer
->	O
data	pointer
,	O
_s	pointer
->	O
index	function
)	O
;	O
free	function
(	O
_s	pointer
->	O
data	pointer
)	O
;	O
}	O
_s	pointer
->	O
data	pointer
=	O
data	pointer
;	O
_s	pointer
->	O
size	long
=	O
size	long
;	O
return	O
gnufdisk_stack_push	function
(	O
_s	pointer
,	O
_data	pointer
,	O
_size	pointer
)	O
;	O
}	O
memcpy	function
(	O
_s	pointer
->	O
data	pointer
+	O
_s	pointer
->	O
index	function
,	O
_data	int
,	O
_size	pointer
)	O
;	O
_s	pointer
->	O
index	function
+=	O
_size	int
;	O
err	int
=	O
0	int
;	O
ret	int
=	O
0	int
;	O
lb_out	O
:	O
errno	O
=	O
err	int
;	O
return	O
ret	int
;	O
}	O
int	O
gnufdisk_stack_pop	function
(	O
struct	O
gnufdisk_stack	struct
*	O
_s	pointer
,	O
void	O
*	O
_dest	pointer
,	O
size_t	long
_size	long
)	O
{	O
int	O
ret	int
;	O
int	O
err	int
;	O
if	O
(	O
gnufdisk_check_memory	function
(	O
_s	pointer
,	O
sizeof	O
(	O
struct	O
gnufdisk_stack	struct
)	O
,	O
0	int
)	O
!=	O
0	int
||	O
(	O
_s	pointer
->	O
data	pointer
&&	O
gnufdisk_check_memory	function
(	O
_s	pointer
->	O
data	pointer
,	O
_s	pointer
->	O
size	long
,	O
0	int
)	O
!=	O
0	int
)	O
||	O
gnufdisk_check_memory	function
(	O
_dest	pointer
,	O
_size	int
,	O
0	int
)	O
!=	O
0	int
)	O
{	O
err	int
=	O
errno	O
;	O
ret	int
=	O
-	O
1	int
;	O
goto	O
lb_out	O
;	O
}	O
else	O
if	O
(	O
_size	int
>	O
_s	pointer
->	O
index	function
)	O
{	O
err	int
=	O
ENOBUFS	int
;	O
ret	int
=	O
-	O
1	int
;	O
goto	O
lb_out	O
;	O
}	O
memcpy	function
(	O
_dest	pointer
,	O
_s	pointer
->	O
data	pointer
+	O
(	O
_s	pointer
->	O
index	function
-	O
_size	int
)	O
,	O
_size	pointer
)	O
;	O
_s	pointer
->	O
index	function
-=	O
_size	int
;	O
ret	int
=	O
0	int
;	O
err	int
=	O
0	int
;	O
lb_out	O
:	O
errno	O
=	O
err	int
;	O
return	O
ret	int
;	O
}	O