int	O
got_signal	int
=	O
0	int
;	O
static	O
void	O
signal_handler	function
(	O
int	O
dummy	int
UNUSEDP	O
)	O
{	O
got_signal	int
=	O
1	int
;	O
}	O
void	O
setup_signal	function
(	O
void	O
)	O
{	O
signal	function
(	O
SIGHUP	int
,	O
signal_handler	function
)	O
;	O
signal	function
(	O
SIGINT	int
,	O
signal_handler	function
)	O
;	O
signal	function
(	O
SIGTERM	int
,	O
signal_handler	function
)	O
;	O
signal	function
(	O
SIGQUIT	int
,	O
signal_handler	function
)	O
;	O
}	O
static	O
void	O
_allow_interrupt	function
(	O
saved_sig_state	struct
*	O
ss	pointer
,	O
int	O
sig	int
,	O
int	O
slot	long
)	O
{	O
struct	O
sigaction	struct
new	pointer
;	O
bzero	function
(	O
&	O
new	pointer
,	O
sizeof	O
(	O
new	pointer
)	O
)	O
;	O
new	struct
.	O
sa_handler	pointer
=	O
signal_handler	function
;	O
new	struct
.	O
sa_flags	int
&=	O
~	O
SA_RESTART	int
;	O
if	O
(	O
sigaction	struct
(	O
sig	int
,	O
&	O
new	pointer
,	O
&	O
ss	int
->	O
sa	pointer
[	O
slot	long
]	O
)	O
<	O
0	int
)	O
{	O
perror	function
(	O
"sigaction"	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
void	O
allow_interrupts	function
(	O
saved_sig_state	struct
*	O
ss	int
)	O
{	O
_allow_interrupt	function
(	O
ss	int
,	O
SIGINT	int
,	O
0	int
)	O
;	O
_allow_interrupt	function
(	O
ss	int
,	O
SIGINT	int
,	O
1	int
)	O
;	O
_allow_interrupt	function
(	O
ss	int
,	O
SIGINT	int
,	O
2	int
)	O
;	O
_allow_interrupt	function
(	O
ss	int
,	O
SIGINT	int
,	O
3	int
)	O
;	O
}	O
static	O
void	O
_restore_interrupt	function
(	O
saved_sig_state	struct
*	O
ss	pointer
,	O
int	O
sig	int
,	O
int	O
slot	long
)	O
{	O
if	O
(	O
sigaction	struct
(	O
sig	int
,	O
&	O
ss	int
->	O
sa	pointer
[	O
slot	int
]	O
,	O
NULL	O
)	O
<	O
0	int
)	O
{	O
perror	function
(	O
"restore sigaction"	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
void	O
restore_interrupts	function
(	O
saved_sig_state	struct
*	O
ss	int
)	O
{	O
_restore_interrupt	function
(	O
ss	int
,	O
SIGINT	int
,	O
0	int
)	O
;	O
_restore_interrupt	function
(	O
ss	int
,	O
SIGINT	int
,	O
1	int
)	O
;	O
_restore_interrupt	function
(	O
ss	int
,	O
SIGINT	int
,	O
2	int
)	O
;	O
_restore_interrupt	function
(	O
ss	int
,	O
SIGINT	int
,	O
3	int
)	O
;	O
}	O