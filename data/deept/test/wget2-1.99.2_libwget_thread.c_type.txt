struct	O
wget_thread_st	struct
{	O
gl_thread_t	int
tid	int
;	O
}	O
;	O
struct	O
wget_thread_mutex_st	struct
{	O
gl_lock_t	pointer
mutex	pointer
;	O
}	O
;	O
struct	O
wget_thread_cond_st	struct
{	O
gl_cond_t	struct
cond	O
;	O
}	O
;	O
int	O
wget_thread_mutex_init	function
(	O
wget_thread_mutex	pointer
*	O
mutex	pointer
)	O
{	O
*	O
mutex	pointer
=	O
wget_malloc	function
(	O
sizeof	O
(	O
struct	O
wget_thread_mutex_st	struct
)	O
)	O
;	O
if	O
(	O
!	O
*	O
mutex	pointer
)	O
return	O
WGET_E_MEMORY	int
;	O
return	O
glthread_lock_init	function
(	O
&	O
(	O
(	O
*	O
mutex	pointer
)	O
->	O
mutex	pointer
)	O
)	O
;	O
}	O
int	O
wget_thread_mutex_destroy	function
(	O
wget_thread_mutex	pointer
*	O
mutex	pointer
)	O
{	O
int	O
rc	int
=	O
glthread_lock_destroy	function
(	O
&	O
(	O
*	O
mutex	pointer
)	O
->	O
mutex	pointer
)	O
;	O
xfree	function
(	O
*	O
mutex	pointer
)	O
;	O
return	O
rc	int
;	O
}	O
void	O
wget_thread_mutex_lock	function
(	O
wget_thread_mutex	pointer
mutex	pointer
)	O
{	O
glthread_lock_lock	function
(	O
&	O
mutex	struct
->	O
mutex	double
)	O
;	O
}	O
void	O
wget_thread_mutex_unlock	function
(	O
wget_thread_mutex	pointer
mutex	pointer
)	O
{	O
glthread_lock_unlock	function
(	O
&	O
mutex	struct
->	O
mutex	double
)	O
;	O
}	O
int	O
wget_thread_cond_init	function
(	O
wget_thread_cond	struct
*	O
cond	struct
)	O
{	O
*	O
cond	struct
=	O
wget_malloc	function
(	O
sizeof	O
(	O
struct	O
wget_thread_cond_st	struct
)	O
)	O
;	O
if	O
(	O
!	O
*	O
cond	struct
)	O
return	O
WGET_E_MEMORY	int
;	O
return	O
glthread_cond_init	function
(	O
&	O
(	O
(	O
*	O
cond	struct
)	O
->	O
cond	struct
)	O
)	O
;	O
}	O
int	O
wget_thread_cond_destroy	function
(	O
wget_thread_cond	struct
*	O
cond	struct
)	O
{	O
int	O
rc	int
=	O
glthread_cond_destroy	function
(	O
&	O
(	O
*	O
cond	struct
)	O
->	O
cond	struct
)	O
;	O
xfree	function
(	O
*	O
cond	struct
)	O
;	O
return	O
rc	int
;	O
}	O
int	O
wget_thread_cond_signal	function
(	O
wget_thread_cond	struct
cond	O
)	O
{	O
return	O
glthread_cond_broadcast	function
(	O
&	O
cond	struct
->	O
cond	double
)	O
;	O
}	O
int	O
wget_thread_cond_wait	function
(	O
wget_thread_cond	int
cond	O
,	O
wget_thread_mutex	pointer
mutex	pointer
,	O
long	O
long	O
ms	bool
)	O
{	O
if	O
(	O
ms	int
<=	O
0	int
)	O
return	O
glthread_cond_wait	function
(	O
&	O
cond	struct
->	O
cond	struct
,	O
&	O
mutex	struct
->	O
mutex	double
)	O
;	O
struct	O
timespec	struct
ts	struct
;	O
gettime	function
(	O
&	O
ts	struct
)	O
;	O
ms	int
+=	O
ts	struct
.	O
tv_sec	long
*	O
1000LL	int
+	O
ts	struct
.	O
tv_nsec	long
/	O
1000000	int
;	O
ts	struct
.	O
tv_sec	long
=	O
ms	int
/	O
1000	int
;	O
ts	struct
.	O
tv_nsec	long
=	O
(	O
ms	int
%	O
1000	int
)	O
*	O
1000000	struct
;	O
return	O
glthread_cond_timedwait	function
(	O
&	O
cond	struct
->	O
cond	struct
,	O
&	O
mutex	struct
->	O
mutex	pointer
,	O
&	O
ts	struct
)	O
;	O
}	O
int	O
wget_thread_start	function
(	O
wget_thread	struct
*	O
thread	pointer
,	O
void	O
*	O
(	O
*	O
start_routine	pointer
)	O
(	O
void	O
*	O
)	O
,	O
void	O
*	O
arg	pointer
,	O
WGET_GCC_UNUSED	O
int	O
flags	int
)	O
{	O
if	O
(	O
wget_thread_support	function
(	O
)	O
)	O
{	O
*	O
thread	long
=	O
wget_malloc	function
(	O
sizeof	O
(	O
struct	O
wget_thread_st	struct
)	O
)	O
;	O
if	O
(	O
!	O
*	O
thread	long
)	O
return	O
WGET_E_MEMORY	int
;	O
return	O
glthread_create	function
(	O
&	O
(	O
(	O
*	O
thread	pointer
)	O
->	O
tid	long
)	O
,	O
start_routine	pointer
,	O
arg	pointer
)	O
;	O
}	O
*	O
thread	pointer
=	O
NULL	O
;	O
start_routine	function
(	O
arg	pointer
)	O
;	O
return	O
0	int
;	O
}	O
int	O
wget_thread_cancel	function
(	O
WGET_GCC_UNUSED	O
wget_thread	pointer
thread	long
)	O
{	O
return	O
0	int
;	O
}	O
int	O
wget_thread_kill	function
(	O
WGET_GCC_UNUSED	O
wget_thread	pointer
thread	long
,	O
WGET_GCC_UNUSED	O
int	O
sig	int
)	O
{	O
return	O
0	int
;	O
}	O
int	O
wget_thread_join	function
(	O
wget_thread	struct
*	O
thread	long
)	O
{	O
if	O
(	O
thread	long
&&	O
*	O
thread	long
&&	O
(	O
*	O
thread	pointer
)	O
->	O
tid	long
)	O
{	O
int	O
rc	int
=	O
glthread_join	function
(	O
(	O
*	O
thread	pointer
)	O
->	O
tid	pointer
,	O
NULL	O
)	O
;	O
xfree	function
(	O
*	O
thread	pointer
)	O
;	O
return	O
rc	int
;	O
}	O
if	O
(	O
wget_thread_support	function
(	O
)	O
)	O
{	O
errno	O
=	O
ESRCH	int
;	O
return	O
-	O
1	int
;	O
}	O
return	O
0	int
;	O
}	O
wget_thread_id	O
wget_thread_self	function
(	O
void	O
)	O
{	O
return	O
gl_thread_self	function
(	O
)	O
;	O
}	O
bool	bool
wget_thread_support	function
(	O
void	O
)	O
{	O
return	O
true	int
;	O
}	O