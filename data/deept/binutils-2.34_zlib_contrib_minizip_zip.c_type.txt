const	O
char	O
zip_copyright	array
[	O
]	O
=	O
" zip 1.01 Copyright 1998-2004 Gilles Vollant - http://www.winimage.com/zLibDll"	pointer
;	O
typedef	O
struct	O
linkedlist_datablock_internal_s	struct
{	O
struct	O
linkedlist_datablock_internal_s	struct
*	O
next_datablock	pointer
;	O
uLong	long
avail_in_this_block	long
;	O
uLong	long
filled_in_this_block	long
;	O
uLong	long
unused	long
;	O
unsigned	O
char	O
data	array
[	O
SIZEDATA_INDATABLOCK	O
]	O
;	O
}	O
linkedlist_datablock_internal	struct
;	O
typedef	O
struct	O
linkedlist_data_s	struct
{	O
linkedlist_datablock_internal	struct
*	O
first_block	pointer
;	O
linkedlist_datablock_internal	struct
*	O
last_block	pointer
;	O
}	O
linkedlist_data	struct
;	O
typedef	O
struct	O
{	O
z_stream	struct
stream	pointer
;	O
int	O
stream_initialised	int
;	O
uInt	int
pos_in_buffered_data	int
;	O
ZPOS64_T	long long
pos_local_header	long long
;	O
char	O
*	O
central_header	pointer
;	O
uLong	long
size_centralExtra	long
;	O
uLong	long
size_centralheader	long
;	O
uLong	long
size_centralExtraFree	long
;	O
uLong	long
flag	long
;	O
int	O
method	int
;	O
int	O
raw	int
;	O
Byte	char
buffered_data	array
[	O
Z_BUFSIZE	O
]	O
;	O
uLong	long
dosDate	long
;	O
uLong	long
crc32	function
;	O
int	O
encrypt	int
;	O
int	O
zip64	int
;	O
ZPOS64_T	long long
pos_zip64extrainfo	long long
;	O
ZPOS64_T	long long
totalCompressedData	long long
;	O
ZPOS64_T	long long
totalUncompressedData	long long
;	O
unsigned	O
long	O
keys	array
[	O
3	int
]	O
;	O
const	O
z_crc_t	int
*	O
pcrc_32_tab	pointer
;	O
int	O
crypt_header_size	int
;	O
}	O
curfile64_info	struct
;	O
typedef	O
struct	O
{	O
zlib_filefunc64_32_def	struct
z_filefunc	struct
;	O
voidpf	pointer
filestream	pointer
;	O
linkedlist_data	struct
central_dir	struct
;	O
int	O
in_opened_file_inzip	int
;	O
curfile64_info	struct
ci	struct
;	O
ZPOS64_T	long long
begin_pos	long long
;	O
ZPOS64_T	long long
add_position_when_writing_offset	long long
;	O
ZPOS64_T	long long
number_entry	long long
;	O
char	O
*	O
globalcomment	pointer
;	O
}	O
zip64_internal	struct
;	O
local	O
linkedlist_datablock_internal	struct
*	O
allocate_new_datablock	function
(	O
)	O
{	O
linkedlist_datablock_internal	struct
*	O
ldi	pointer
;	O
ldi	pointer
=	O
(	O
linkedlist_datablock_internal	struct
*	O
)	O
ALLOC	O
(	O
sizeof	O
(	O
linkedlist_datablock_internal	struct
)	O
)	O
;	O
if	O
(	O
ldi	pointer
!=	O
NULL	O
)	O
{	O
ldi	pointer
->	O
next_datablock	pointer
=	O
NULL	O
;	O
ldi	pointer
->	O
filled_in_this_block	long
=	O
0	int
;	O
ldi	pointer
->	O
avail_in_this_block	long
=	O
SIZEDATA_INDATABLOCK	O
;	O
}	O
return	O
ldi	pointer
;	O
}	O
local	O
void	O
free_datablock	function
(	O
linkedlist_datablock_internal	struct
*	O
ldi	pointer
)	O
{	O
while	O
(	O
ldi	pointer
!=	O
NULL	O
)	O
{	O
linkedlist_datablock_internal	struct
*	O
ldinext	pointer
=	O
ldi	pointer
->	O
next_datablock	pointer
;	O
TRYFREE	O
(	O
ldi	pointer
)	O
;	O
ldi	pointer
=	O
ldinext	pointer
;	O
}	O
}	O
local	O
void	O
init_linkedlist	function
(	O
linkedlist_data	struct
*	O
ll	pointer
)	O
{	O
ll	pointer
->	O
first_block	pointer
=	O
ll	pointer
->	O
last_block	pointer
=	O
NULL	O
;	O
}	O
local	O
void	O
free_linkedlist	function
(	O
linkedlist_data	struct
*	O
ll	pointer
)	O
{	O
free_datablock	function
(	O
ll	pointer
->	O
first_block	pointer
)	O
;	O
ll	pointer
->	O
first_block	pointer
=	O
ll	pointer
->	O
last_block	pointer
=	O
NULL	O
;	O
}	O
local	O
int	O
add_data_in_datablock	function
(	O
linkedlist_data	struct
*	O
ll	pointer
,	O
const	O
void	O
*	O
buf	pointer
,	O
uLong	long
len	int
)	O
{	O
linkedlist_datablock_internal	struct
*	O
ldi	pointer
;	O
const	O
unsigned	O
char	O
*	O
from_copy	pointer
;	O
if	O
(	O
ll	pointer
==	O
NULL	O
)	O
return	O
ZIP_INTERNALERROR	O
;	O
if	O
(	O
ll	pointer
->	O
last_block	pointer
==	O
NULL	O
)	O
{	O
ll	pointer
->	O
first_block	pointer
=	O
ll	pointer
->	O
last_block	pointer
=	O
allocate_new_datablock	function
(	O
)	O
;	O
if	O
(	O
ll	pointer
->	O
first_block	pointer
==	O
NULL	O
)	O
return	O
ZIP_INTERNALERROR	O
;	O
}	O
ldi	pointer
=	O
ll	pointer
->	O
last_block	pointer
;	O
from_copy	pointer
=	O
(	O
unsigned	O
char	O
*	O
)	O
buf	pointer
;	O
while	O
(	O
len	int
>	O
0	int
)	O
{	O
uInt	int
copy_this	int
;	O
uInt	int
i	int
;	O
unsigned	O
char	O
*	O
to_copy	pointer
;	O
if	O
(	O
ldi	pointer
->	O
avail_in_this_block	long
==	O
0	int
)	O
{	O
ldi	pointer
->	O
next_datablock	pointer
=	O
allocate_new_datablock	function
(	O
)	O
;	O
if	O
(	O
ldi	pointer
->	O
next_datablock	pointer
==	O
NULL	O
)	O
return	O
ZIP_INTERNALERROR	O
;	O
ldi	pointer
=	O
ldi	pointer
->	O
next_datablock	pointer
;	O
ll	pointer
->	O
last_block	pointer
=	O
ldi	pointer
;	O
}	O
if	O
(	O
ldi	pointer
->	O
avail_in_this_block	long
<	O
len	int
)	O
copy_this	int
=	O
(	O
uInt	int
)	O
ldi	pointer
->	O
avail_in_this_block	long
;	O
else	O
copy_this	int
=	O
(	O
uInt	int
)	O
len	int
;	O
to_copy	pointer
=	O
&	O
(	O
ldi	pointer
->	O
data	array
[	O
ldi	pointer
->	O
filled_in_this_block	long
]	O
)	O
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
copy_this	int
;	O
i	int
++	O
)	O
*	O
(	O
to_copy	pointer
+	O
i	int
)	O
=	O
*	O
(	O
from_copy	pointer
+	O
i	int
)	O
;	O
ldi	pointer
->	O
filled_in_this_block	long
+=	O
copy_this	int
;	O
ldi	pointer
->	O
avail_in_this_block	long
-=	O
copy_this	int
;	O
from_copy	pointer
+=	O
copy_this	int
;	O
len	int
-=	O
copy_this	int
;	O
}	O
return	O
ZIP_OK	O
;	O
}	O
local	O
int	O
zip64local_putValue	function
OF	O
(	O
(	O
const	O
zlib_filefunc64_32_def	struct
*	O
pzlib_filefunc_def	pointer
,	O
voidpf	pointer
filestream	pointer
,	O
ZPOS64_T	long long
x	long long
,	O
int	O
nbByte	int
)	O
)	O
;	O
local	O
int	O
zip64local_putValue	function
(	O
const	O
zlib_filefunc64_32_def	struct
*	O
pzlib_filefunc_def	pointer
,	O
voidpf	pointer
filestream	pointer
,	O
ZPOS64_T	long long
x	long long
,	O
int	O
nbByte	int
)	O
{	O
unsigned	O
char	O
buf	pointer
[	O
8	int
]	O
;	O
int	O
n	int
;	O
for	O
(	O
n	int
=	O
0	int
;	O
n	int
<	O
nbByte	int
;	O
n	int
++	O
)	O
{	O
buf	pointer
[	O
n	int
]	O
=	O
(	O
unsigned	O
char	O
)	O
(	O
x	long long
&	O
0xff	int
)	O
;	O
x	long long
>>=	O
8	int
;	O
}	O
if	O
(	O
x	long long
!=	O
0	int
)	O
{	O
for	O
(	O
n	int
=	O
0	int
;	O
n	int
<	O
nbByte	int
;	O
n	int
++	O
)	O
{	O
buf	pointer
[	O
n	int
]	O
=	O
0xff	int
;	O
}	O
}	O
if	O
(	O
ZWRITE64	O
(	O
*	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
buf	pointer
,	O
nbByte	int
)	O
!=	O
(	O
uLong	long
)	O
nbByte	int
)	O
return	O
ZIP_ERRNO	O
;	O
else	O
return	O
ZIP_OK	O
;	O
}	O
local	O
void	O
zip64local_putValue_inmemory	function
OF	O
(	O
(	O
void	O
*	O
dest	pointer
,	O
ZPOS64_T	long long
x	long long
,	O
int	O
nbByte	int
)	O
)	O
;	O
local	O
void	O
zip64local_putValue_inmemory	function
(	O
void	O
*	O
dest	pointer
,	O
ZPOS64_T	long long
x	long long
,	O
int	O
nbByte	int
)	O
{	O
unsigned	O
char	O
*	O
buf	pointer
=	O
(	O
unsigned	O
char	O
*	O
)	O
dest	pointer
;	O
int	O
n	int
;	O
for	O
(	O
n	int
=	O
0	int
;	O
n	int
<	O
nbByte	int
;	O
n	int
++	O
)	O
{	O
buf	pointer
[	O
n	int
]	O
=	O
(	O
unsigned	O
char	O
)	O
(	O
x	long long
&	O
0xff	int
)	O
;	O
x	long long
>>=	O
8	int
;	O
}	O
if	O
(	O
x	long long
!=	O
0	int
)	O
{	O
for	O
(	O
n	int
=	O
0	int
;	O
n	int
<	O
nbByte	int
;	O
n	int
++	O
)	O
{	O
buf	pointer
[	O
n	int
]	O
=	O
0xff	int
;	O
}	O
}	O
}	O
local	O
uLong	long
zip64local_TmzDateToDosDate	function
(	O
const	O
tm_zip	struct
*	O
ptm	pointer
)	O
{	O
uLong	long
year	long
=	O
(	O
uLong	long
)	O
ptm	pointer
->	O
tm_year	int
;	O
if	O
(	O
year	long
>=	O
1980	int
)	O
year	long
-=	O
1980	int
;	O
else	O
if	O
(	O
year	long
>=	O
80	int
)	O
year	long
-=	O
80	int
;	O
return	O
(	O
uLong	long
)	O
(	O
(	O
(	O
ptm	pointer
->	O
tm_mday	int
)	O
+	O
(	O
32	int
*	O
(	O
ptm	pointer
->	O
tm_mon	int
+	O
1	int
)	O
)	O
+	O
(	O
512	int
*	O
year	long
)	O
)	O
<<	O
16	int
)	O
|	O
(	O
(	O
ptm	pointer
->	O
tm_sec	int
/	O
2	int
)	O
+	O
(	O
32	int
*	O
ptm	pointer
->	O
tm_min	int
)	O
+	O
(	O
2048	int
*	O
(	O
uLong	long
)	O
ptm	pointer
->	O
tm_hour	int
)	O
)	O
;	O
}	O
local	O
int	O
zip64local_getByte	function
OF	O
(	O
(	O
const	O
zlib_filefunc64_32_def	struct
*	O
pzlib_filefunc_def	pointer
,	O
voidpf	pointer
filestream	pointer
,	O
int	O
*	O
pi	pointer
)	O
)	O
;	O
local	O
int	O
zip64local_getByte	function
(	O
const	O
zlib_filefunc64_32_def	struct
*	O
pzlib_filefunc_def	pointer
,	O
voidpf	pointer
filestream	pointer
,	O
int	O
*	O
pi	pointer
)	O
{	O
unsigned	O
char	O
c	int
;	O
int	O
err	int
=	O
(	O
int	O
)	O
ZREAD64	O
(	O
*	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
c	int
,	O
1	int
)	O
;	O
if	O
(	O
err	int
==	O
1	int
)	O
{	O
*	O
pi	pointer
=	O
(	O
int	O
)	O
c	int
;	O
return	O
ZIP_OK	O
;	O
}	O
else	O
{	O
if	O
(	O
ZERROR64	O
(	O
*	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
)	O
)	O
return	O
ZIP_ERRNO	O
;	O
else	O
return	O
ZIP_EOF	O
;	O
}	O
}	O
local	O
int	O
zip64local_getShort	function
OF	O
(	O
(	O
const	O
zlib_filefunc64_32_def	struct
*	O
pzlib_filefunc_def	pointer
,	O
voidpf	pointer
filestream	pointer
,	O
uLong	long
*	O
pX	pointer
)	O
)	O
;	O
local	O
int	O
zip64local_getShort	function
(	O
const	O
zlib_filefunc64_32_def	struct
*	O
pzlib_filefunc_def	pointer
,	O
voidpf	pointer
filestream	pointer
,	O
uLong	long
*	O
pX	pointer
)	O
{	O
uLong	long
x	long long
;	O
int	O
i	int
=	O
0	int
;	O
int	O
err	int
;	O
err	int
=	O
zip64local_getByte	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
i	int
)	O
;	O
x	long long
=	O
(	O
uLong	long
)	O
i	int
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_getByte	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
i	int
)	O
;	O
x	long long
+=	O
(	O
(	O
uLong	long
)	O
i	int
)	O
<<	O
8	int
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
*	O
pX	pointer
=	O
x	long long
;	O
else	O
*	O
pX	pointer
=	O
0	int
;	O
return	O
err	int
;	O
}	O
local	O
int	O
zip64local_getLong	function
OF	O
(	O
(	O
const	O
zlib_filefunc64_32_def	struct
*	O
pzlib_filefunc_def	pointer
,	O
voidpf	pointer
filestream	pointer
,	O
uLong	long
*	O
pX	pointer
)	O
)	O
;	O
local	O
int	O
zip64local_getLong	function
(	O
const	O
zlib_filefunc64_32_def	struct
*	O
pzlib_filefunc_def	pointer
,	O
voidpf	pointer
filestream	pointer
,	O
uLong	long
*	O
pX	pointer
)	O
{	O
uLong	long
x	long long
;	O
int	O
i	int
=	O
0	int
;	O
int	O
err	int
;	O
err	int
=	O
zip64local_getByte	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
i	int
)	O
;	O
x	long long
=	O
(	O
uLong	long
)	O
i	int
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_getByte	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
i	int
)	O
;	O
x	long long
+=	O
(	O
(	O
uLong	long
)	O
i	int
)	O
<<	O
8	int
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_getByte	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
i	int
)	O
;	O
x	long long
+=	O
(	O
(	O
uLong	long
)	O
i	int
)	O
<<	O
16	int
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_getByte	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
i	int
)	O
;	O
x	long long
+=	O
(	O
(	O
uLong	long
)	O
i	int
)	O
<<	O
24	int
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
*	O
pX	pointer
=	O
x	long long
;	O
else	O
*	O
pX	pointer
=	O
0	int
;	O
return	O
err	int
;	O
}	O
local	O
int	O
zip64local_getLong64	function
OF	O
(	O
(	O
const	O
zlib_filefunc64_32_def	struct
*	O
pzlib_filefunc_def	pointer
,	O
voidpf	pointer
filestream	pointer
,	O
ZPOS64_T	long long
*	O
pX	pointer
)	O
)	O
;	O
local	O
int	O
zip64local_getLong64	function
(	O
const	O
zlib_filefunc64_32_def	struct
*	O
pzlib_filefunc_def	pointer
,	O
voidpf	pointer
filestream	pointer
,	O
ZPOS64_T	long long
*	O
pX	pointer
)	O
{	O
ZPOS64_T	long long
x	long long
;	O
int	O
i	int
=	O
0	int
;	O
int	O
err	int
;	O
err	int
=	O
zip64local_getByte	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
i	int
)	O
;	O
x	long long
=	O
(	O
ZPOS64_T	long long
)	O
i	int
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_getByte	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
i	int
)	O
;	O
x	long long
+=	O
(	O
(	O
ZPOS64_T	long long
)	O
i	int
)	O
<<	O
8	int
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_getByte	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
i	int
)	O
;	O
x	long long
+=	O
(	O
(	O
ZPOS64_T	long long
)	O
i	int
)	O
<<	O
16	int
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_getByte	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
i	int
)	O
;	O
x	long long
+=	O
(	O
(	O
ZPOS64_T	long long
)	O
i	int
)	O
<<	O
24	int
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_getByte	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
i	int
)	O
;	O
x	long long
+=	O
(	O
(	O
ZPOS64_T	long long
)	O
i	int
)	O
<<	O
32	int
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_getByte	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
i	int
)	O
;	O
x	long long
+=	O
(	O
(	O
ZPOS64_T	long long
)	O
i	int
)	O
<<	O
40	int
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_getByte	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
i	int
)	O
;	O
x	long long
+=	O
(	O
(	O
ZPOS64_T	long long
)	O
i	int
)	O
<<	O
48	int
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_getByte	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
i	int
)	O
;	O
x	long long
+=	O
(	O
(	O
ZPOS64_T	long long
)	O
i	int
)	O
<<	O
56	int
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
*	O
pX	pointer
=	O
x	long long
;	O
else	O
*	O
pX	pointer
=	O
0	int
;	O
return	O
err	int
;	O
}	O
local	O
ZPOS64_T	long long
zip64local_SearchCentralDir	function
OF	O
(	O
(	O
const	O
zlib_filefunc64_32_def	struct
*	O
pzlib_filefunc_def	pointer
,	O
voidpf	pointer
filestream	pointer
)	O
)	O
;	O
local	O
ZPOS64_T	long long
zip64local_SearchCentralDir	function
(	O
const	O
zlib_filefunc64_32_def	struct
*	O
pzlib_filefunc_def	pointer
,	O
voidpf	pointer
filestream	pointer
)	O
{	O
unsigned	O
char	O
*	O
buf	pointer
;	O
ZPOS64_T	long long
uSizeFile	long long
;	O
ZPOS64_T	long long
uBackRead	long long
;	O
ZPOS64_T	long long
uMaxBack	long long
=	O
0xffff	int
;	O
ZPOS64_T	long long
uPosFound	long long
=	O
0	int
;	O
if	O
(	O
ZSEEK64	O
(	O
*	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
0	int
,	O
ZLIB_FILEFUNC_SEEK_END	O
)	O
!=	O
0	int
)	O
return	O
0	int
;	O
uSizeFile	long long
=	O
ZTELL64	O
(	O
*	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
)	O
;	O
if	O
(	O
uMaxBack	long long
>	O
uSizeFile	long long
)	O
uMaxBack	long long
=	O
uSizeFile	long long
;	O
buf	pointer
=	O
(	O
unsigned	O
char	O
*	O
)	O
ALLOC	O
(	O
BUFREADCOMMENT	O
+	O
4	int
)	O
;	O
if	O
(	O
buf	pointer
==	O
NULL	O
)	O
return	O
0	int
;	O
uBackRead	long long
=	O
4	int
;	O
while	O
(	O
uBackRead	long long
<	O
uMaxBack	long long
)	O
{	O
uLong	long
uReadSize	long
;	O
ZPOS64_T	long long
uReadPos	long long
;	O
int	O
i	int
;	O
if	O
(	O
uBackRead	long long
+	O
BUFREADCOMMENT	O
>	O
uMaxBack	long long
)	O
uBackRead	long long
=	O
uMaxBack	long long
;	O
else	O
uBackRead	long long
+=	O
BUFREADCOMMENT	O
;	O
uReadPos	long long
=	O
uSizeFile	long long
-	O
uBackRead	long long
;	O
uReadSize	long
=	O
(	O
(	O
BUFREADCOMMENT	O
+	O
4	int
)	O
<	O
(	O
uSizeFile	long long
-	O
uReadPos	long long
)	O
)	O
?	O
(	O
BUFREADCOMMENT	O
+	O
4	int
)	O
:	O
(	O
uLong	long
)	O
(	O
uSizeFile	long long
-	O
uReadPos	long long
)	O
;	O
if	O
(	O
ZSEEK64	O
(	O
*	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
uReadPos	long long
,	O
ZLIB_FILEFUNC_SEEK_SET	O
)	O
!=	O
0	int
)	O
break	O
;	O
if	O
(	O
ZREAD64	O
(	O
*	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
buf	pointer
,	O
uReadSize	long
)	O
!=	O
uReadSize	long
)	O
break	O
;	O
for	O
(	O
i	int
=	O
(	O
int	O
)	O
uReadSize	long
-	O
3	int
;	O
(	O
i	int
--	O
)	O
>	O
0	int
;	O
)	O
if	O
(	O
(	O
(	O
*	O
(	O
buf	pointer
+	O
i	int
)	O
)	O
==	O
0x50	int
)	O
&&	O
(	O
(	O
*	O
(	O
buf	pointer
+	O
i	int
+	O
1	int
)	O
)	O
==	O
0x4b	int
)	O
&&	O
(	O
(	O
*	O
(	O
buf	pointer
+	O
i	int
+	O
2	int
)	O
)	O
==	O
0x05	int
)	O
&&	O
(	O
(	O
*	O
(	O
buf	pointer
+	O
i	int
+	O
3	int
)	O
)	O
==	O
0x06	int
)	O
)	O
{	O
uPosFound	long long
=	O
uReadPos	long long
+	O
i	int
;	O
break	O
;	O
}	O
if	O
(	O
uPosFound	long long
!=	O
0	int
)	O
break	O
;	O
}	O
TRYFREE	O
(	O
buf	pointer
)	O
;	O
return	O
uPosFound	long long
;	O
}	O
local	O
ZPOS64_T	long long
zip64local_SearchCentralDir64	function
OF	O
(	O
(	O
const	O
zlib_filefunc64_32_def	struct
*	O
pzlib_filefunc_def	pointer
,	O
voidpf	pointer
filestream	pointer
)	O
)	O
;	O
local	O
ZPOS64_T	long long
zip64local_SearchCentralDir64	function
(	O
const	O
zlib_filefunc64_32_def	struct
*	O
pzlib_filefunc_def	pointer
,	O
voidpf	pointer
filestream	pointer
)	O
{	O
unsigned	O
char	O
*	O
buf	pointer
;	O
ZPOS64_T	long long
uSizeFile	long long
;	O
ZPOS64_T	long long
uBackRead	long long
;	O
ZPOS64_T	long long
uMaxBack	long long
=	O
0xffff	int
;	O
ZPOS64_T	long long
uPosFound	long long
=	O
0	int
;	O
uLong	long
uL	long
;	O
ZPOS64_T	long long
relativeOffset	long long
;	O
if	O
(	O
ZSEEK64	O
(	O
*	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
0	int
,	O
ZLIB_FILEFUNC_SEEK_END	O
)	O
!=	O
0	int
)	O
return	O
0	int
;	O
uSizeFile	long long
=	O
ZTELL64	O
(	O
*	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
)	O
;	O
if	O
(	O
uMaxBack	long long
>	O
uSizeFile	long long
)	O
uMaxBack	long long
=	O
uSizeFile	long long
;	O
buf	pointer
=	O
(	O
unsigned	O
char	O
*	O
)	O
ALLOC	O
(	O
BUFREADCOMMENT	O
+	O
4	int
)	O
;	O
if	O
(	O
buf	pointer
==	O
NULL	O
)	O
return	O
0	int
;	O
uBackRead	long long
=	O
4	int
;	O
while	O
(	O
uBackRead	long long
<	O
uMaxBack	long long
)	O
{	O
uLong	long
uReadSize	long
;	O
ZPOS64_T	long long
uReadPos	long long
;	O
int	O
i	int
;	O
if	O
(	O
uBackRead	long long
+	O
BUFREADCOMMENT	O
>	O
uMaxBack	long long
)	O
uBackRead	long long
=	O
uMaxBack	long long
;	O
else	O
uBackRead	long long
+=	O
BUFREADCOMMENT	O
;	O
uReadPos	long long
=	O
uSizeFile	long long
-	O
uBackRead	long long
;	O
uReadSize	long
=	O
(	O
(	O
BUFREADCOMMENT	O
+	O
4	int
)	O
<	O
(	O
uSizeFile	long long
-	O
uReadPos	long long
)	O
)	O
?	O
(	O
BUFREADCOMMENT	O
+	O
4	int
)	O
:	O
(	O
uLong	long
)	O
(	O
uSizeFile	long long
-	O
uReadPos	long long
)	O
;	O
if	O
(	O
ZSEEK64	O
(	O
*	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
uReadPos	long long
,	O
ZLIB_FILEFUNC_SEEK_SET	O
)	O
!=	O
0	int
)	O
break	O
;	O
if	O
(	O
ZREAD64	O
(	O
*	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
buf	pointer
,	O
uReadSize	long
)	O
!=	O
uReadSize	long
)	O
break	O
;	O
for	O
(	O
i	int
=	O
(	O
int	O
)	O
uReadSize	long
-	O
3	int
;	O
(	O
i	int
--	O
)	O
>	O
0	int
;	O
)	O
{	O
if	O
(	O
(	O
(	O
*	O
(	O
buf	pointer
+	O
i	int
)	O
)	O
==	O
0x50	int
)	O
&&	O
(	O
(	O
*	O
(	O
buf	pointer
+	O
i	int
+	O
1	int
)	O
)	O
==	O
0x4b	int
)	O
&&	O
(	O
(	O
*	O
(	O
buf	pointer
+	O
i	int
+	O
2	int
)	O
)	O
==	O
0x06	int
)	O
&&	O
(	O
(	O
*	O
(	O
buf	pointer
+	O
i	int
+	O
3	int
)	O
)	O
==	O
0x07	int
)	O
)	O
{	O
uPosFound	long long
=	O
uReadPos	long long
+	O
i	int
;	O
break	O
;	O
}	O
}	O
if	O
(	O
uPosFound	long long
!=	O
0	int
)	O
break	O
;	O
}	O
TRYFREE	O
(	O
buf	pointer
)	O
;	O
if	O
(	O
uPosFound	long long
==	O
0	int
)	O
return	O
0	int
;	O
if	O
(	O
ZSEEK64	O
(	O
*	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
uPosFound	long long
,	O
ZLIB_FILEFUNC_SEEK_SET	O
)	O
!=	O
0	int
)	O
return	O
0	int
;	O
if	O
(	O
zip64local_getLong	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
uL	long
)	O
!=	O
ZIP_OK	O
)	O
return	O
0	int
;	O
if	O
(	O
zip64local_getLong	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
uL	long
)	O
!=	O
ZIP_OK	O
)	O
return	O
0	int
;	O
if	O
(	O
uL	long
!=	O
0	int
)	O
return	O
0	int
;	O
if	O
(	O
zip64local_getLong64	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
relativeOffset	long long
)	O
!=	O
ZIP_OK	O
)	O
return	O
0	int
;	O
if	O
(	O
zip64local_getLong	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
uL	long
)	O
!=	O
ZIP_OK	O
)	O
return	O
0	int
;	O
if	O
(	O
uL	long
!=	O
1	int
)	O
return	O
0	int
;	O
if	O
(	O
ZSEEK64	O
(	O
*	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
relativeOffset	long long
,	O
ZLIB_FILEFUNC_SEEK_SET	O
)	O
!=	O
0	int
)	O
return	O
0	int
;	O
if	O
(	O
zip64local_getLong	function
(	O
pzlib_filefunc_def	pointer
,	O
filestream	pointer
,	O
&	O
uL	long
)	O
!=	O
ZIP_OK	O
)	O
return	O
0	int
;	O
if	O
(	O
uL	long
!=	O
0x06064b50	int
)	O
return	O
0	int
;	O
return	O
relativeOffset	long long
;	O
}	O
int	O
LoadCentralDirectoryRecord	function
(	O
zip64_internal	struct
*	O
pziinit	pointer
)	O
{	O
int	O
err	int
=	O
ZIP_OK	O
;	O
ZPOS64_T	long long
byte_before_the_zipfile	long long
;	O
ZPOS64_T	long long
size_central_dir	long long
;	O
ZPOS64_T	long long
offset_central_dir	long long
;	O
ZPOS64_T	long long
central_pos	long long
;	O
uLong	long
uL	long
;	O
uLong	long
number_disk	long
;	O
uLong	long
number_disk_with_CD	long
;	O
ZPOS64_T	long long
number_entry	long long
;	O
ZPOS64_T	long long
number_entry_CD	long long
;	O
uLong	long
VersionMadeBy	long
;	O
uLong	long
VersionNeeded	long
;	O
uLong	long
size_comment	long
;	O
int	O
hasZIP64Record	int
=	O
0	int
;	O
central_pos	long long
=	O
zip64local_SearchCentralDir64	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
)	O
;	O
if	O
(	O
central_pos	long long
>	O
0	int
)	O
{	O
hasZIP64Record	int
=	O
1	int
;	O
}	O
else	O
if	O
(	O
central_pos	long long
==	O
0	int
)	O
{	O
central_pos	long long
=	O
zip64local_SearchCentralDir	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
)	O
;	O
}	O
if	O
(	O
hasZIP64Record	int
)	O
{	O
ZPOS64_T	long long
sizeEndOfCentralDirectory	long long
;	O
if	O
(	O
ZSEEK64	O
(	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
central_pos	long long
,	O
ZLIB_FILEFUNC_SEEK_SET	O
)	O
!=	O
0	int
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
zip64local_getLong	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
uL	long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
zip64local_getLong64	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
sizeEndOfCentralDirectory	long long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
zip64local_getShort	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
VersionMadeBy	long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
zip64local_getShort	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
VersionNeeded	long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
zip64local_getLong	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
number_disk	long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
zip64local_getLong	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
number_disk_with_CD	long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
zip64local_getLong64	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
number_entry	long long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
zip64local_getLong64	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
number_entry_CD	long long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
(	O
number_entry_CD	long long
!=	O
number_entry	long long
)	O
||	O
(	O
number_disk_with_CD	long
!=	O
0	int
)	O
||	O
(	O
number_disk	long
!=	O
0	int
)	O
)	O
err	int
=	O
ZIP_BADZIPFILE	O
;	O
if	O
(	O
zip64local_getLong64	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
size_central_dir	long long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
zip64local_getLong64	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
offset_central_dir	long long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
size_comment	long
=	O
0	int
;	O
}	O
else	O
{	O
if	O
(	O
ZSEEK64	O
(	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
central_pos	long long
,	O
ZLIB_FILEFUNC_SEEK_SET	O
)	O
!=	O
0	int
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
zip64local_getLong	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
uL	long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
zip64local_getShort	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
number_disk	long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
zip64local_getShort	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
number_disk_with_CD	long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
number_entry	long long
=	O
0	int
;	O
if	O
(	O
zip64local_getShort	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
uL	long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
else	O
number_entry	long long
=	O
uL	long
;	O
number_entry_CD	long long
=	O
0	int
;	O
if	O
(	O
zip64local_getShort	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
uL	long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
else	O
number_entry_CD	long long
=	O
uL	long
;	O
if	O
(	O
(	O
number_entry_CD	long long
!=	O
number_entry	long long
)	O
||	O
(	O
number_disk_with_CD	long
!=	O
0	int
)	O
||	O
(	O
number_disk	long
!=	O
0	int
)	O
)	O
err	int
=	O
ZIP_BADZIPFILE	O
;	O
size_central_dir	long long
=	O
0	int
;	O
if	O
(	O
zip64local_getLong	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
uL	long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
else	O
size_central_dir	long long
=	O
uL	long
;	O
offset_central_dir	long long
=	O
0	int
;	O
if	O
(	O
zip64local_getLong	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
uL	long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
else	O
offset_central_dir	long long
=	O
uL	long
;	O
if	O
(	O
zip64local_getShort	function
(	O
&	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
&	O
size_comment	long
)	O
!=	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
}	O
if	O
(	O
(	O
central_pos	long long
<	O
offset_central_dir	long long
+	O
size_central_dir	long long
)	O
&&	O
(	O
err	int
==	O
ZIP_OK	O
)	O
)	O
err	int
=	O
ZIP_BADZIPFILE	O
;	O
if	O
(	O
err	int
!=	O
ZIP_OK	O
)	O
{	O
ZCLOSE64	O
(	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
)	O
;	O
return	O
ZIP_ERRNO	O
;	O
}	O
if	O
(	O
size_comment	long
>	O
0	int
)	O
{	O
pziinit	pointer
->	O
globalcomment	pointer
=	O
(	O
char	O
*	O
)	O
ALLOC	O
(	O
size_comment	long
+	O
1	int
)	O
;	O
if	O
(	O
pziinit	pointer
->	O
globalcomment	pointer
)	O
{	O
size_comment	long
=	O
ZREAD64	O
(	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
pziinit	pointer
->	O
globalcomment	pointer
,	O
size_comment	long
)	O
;	O
pziinit	pointer
->	O
globalcomment	pointer
[	O
size_comment	long
]	O
=	O
0	int
;	O
}	O
}	O
byte_before_the_zipfile	long long
=	O
central_pos	long long
-	O
(	O
offset_central_dir	long long
+	O
size_central_dir	long long
)	O
;	O
pziinit	pointer
->	O
add_position_when_writing_offset	long long
=	O
byte_before_the_zipfile	long long
;	O
{	O
ZPOS64_T	long long
size_central_dir_to_read	long long
=	O
size_central_dir	long long
;	O
size_t	long
buf_size	long
=	O
SIZEDATA_INDATABLOCK	O
;	O
void	O
*	O
buf_read	pointer
=	O
(	O
void	O
*	O
)	O
ALLOC	O
(	O
buf_size	long
)	O
;	O
if	O
(	O
ZSEEK64	O
(	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
offset_central_dir	long long
+	O
byte_before_the_zipfile	long long
,	O
ZLIB_FILEFUNC_SEEK_SET	O
)	O
!=	O
0	int
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
while	O
(	O
(	O
size_central_dir_to_read	long long
>	O
0	int
)	O
&&	O
(	O
err	int
==	O
ZIP_OK	O
)	O
)	O
{	O
ZPOS64_T	long long
read_this	long long
=	O
SIZEDATA_INDATABLOCK	O
;	O
if	O
(	O
read_this	long long
>	O
size_central_dir_to_read	long long
)	O
read_this	long long
=	O
size_central_dir_to_read	long long
;	O
if	O
(	O
ZREAD64	O
(	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
buf_read	pointer
,	O
(	O
uLong	long
)	O
read_this	long long
)	O
!=	O
read_this	long long
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
add_data_in_datablock	function
(	O
&	O
pziinit	pointer
->	O
central_dir	struct
,	O
buf_read	pointer
,	O
(	O
uLong	long
)	O
read_this	long long
)	O
;	O
size_central_dir_to_read	long long
-=	O
read_this	long long
;	O
}	O
TRYFREE	O
(	O
buf_read	pointer
)	O
;	O
}	O
pziinit	pointer
->	O
begin_pos	long long
=	O
byte_before_the_zipfile	long long
;	O
pziinit	pointer
->	O
number_entry	long long
=	O
number_entry_CD	long long
;	O
if	O
(	O
ZSEEK64	O
(	O
pziinit	pointer
->	O
z_filefunc	struct
,	O
pziinit	pointer
->	O
filestream	pointer
,	O
offset_central_dir	long long
+	O
byte_before_the_zipfile	long long
,	O
ZLIB_FILEFUNC_SEEK_SET	O
)	O
!=	O
0	int
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
return	O
err	int
;	O
}	O
extern	O
zipFile	pointer
ZEXPORT	O
zipOpen3	function
(	O
const	O
void	O
*	O
pathname	pointer
,	O
int	O
append	int
,	O
zipcharpc	pointer
*	O
globalcomment	pointer
,	O
zlib_filefunc64_32_def	struct
*	O
pzlib_filefunc64_32_def	pointer
)	O
{	O
zip64_internal	struct
ziinit	struct
;	O
zip64_internal	struct
*	O
zi	pointer
;	O
int	O
err	int
=	O
ZIP_OK	O
;	O
ziinit	struct
.	O
z_filefunc	struct
.	O
zseek32_file	pointer
=	O
NULL	O
;	O
ziinit	struct
.	O
z_filefunc	struct
.	O
ztell32_file	pointer
=	O
NULL	O
;	O
if	O
(	O
pzlib_filefunc64_32_def	pointer
==	O
NULL	O
)	O
fill_fopen64_filefunc	function
(	O
&	O
ziinit	struct
.	O
z_filefunc	struct
.	O
zfile_func64	struct
)	O
;	O
else	O
ziinit	struct
.	O
z_filefunc	struct
=	O
*	O
pzlib_filefunc64_32_def	pointer
;	O
ziinit	struct
.	O
filestream	pointer
=	O
ZOPEN64	O
(	O
ziinit	struct
.	O
z_filefunc	struct
,	O
pathname	pointer
,	O
(	O
append	int
==	O
APPEND_STATUS_CREATE	O
)	O
?	O
(	O
ZLIB_FILEFUNC_MODE_READ	O
|	O
ZLIB_FILEFUNC_MODE_WRITE	O
|	O
ZLIB_FILEFUNC_MODE_CREATE	O
)	O
:	O
(	O
ZLIB_FILEFUNC_MODE_READ	O
|	O
ZLIB_FILEFUNC_MODE_WRITE	O
|	O
ZLIB_FILEFUNC_MODE_EXISTING	O
)	O
)	O
;	O
if	O
(	O
ziinit	struct
.	O
filestream	pointer
==	O
NULL	O
)	O
return	O
NULL	O
;	O
if	O
(	O
append	int
==	O
APPEND_STATUS_CREATEAFTER	O
)	O
ZSEEK64	O
(	O
ziinit	struct
.	O
z_filefunc	struct
,	O
ziinit	struct
.	O
filestream	pointer
,	O
0	int
,	O
SEEK_END	int
)	O
;	O
ziinit	struct
.	O
begin_pos	long long
=	O
ZTELL64	O
(	O
ziinit	struct
.	O
z_filefunc	struct
,	O
ziinit	struct
.	O
filestream	pointer
)	O
;	O
ziinit	struct
.	O
in_opened_file_inzip	int
=	O
0	int
;	O
ziinit	struct
.	O
ci	struct
.	O
stream_initialised	int
=	O
0	int
;	O
ziinit	struct
.	O
number_entry	long long
=	O
0	int
;	O
ziinit	struct
.	O
add_position_when_writing_offset	long long
=	O
0	int
;	O
init_linkedlist	function
(	O
&	O
(	O
ziinit	struct
.	O
central_dir	struct
)	O
)	O
;	O
zi	pointer
=	O
(	O
zip64_internal	struct
*	O
)	O
ALLOC	O
(	O
sizeof	O
(	O
zip64_internal	struct
)	O
)	O
;	O
if	O
(	O
zi	pointer
==	O
NULL	O
)	O
{	O
ZCLOSE64	O
(	O
ziinit	struct
.	O
z_filefunc	struct
,	O
ziinit	struct
.	O
filestream	pointer
)	O
;	O
return	O
NULL	O
;	O
}	O
ziinit	struct
.	O
globalcomment	pointer
=	O
NULL	O
;	O
if	O
(	O
append	int
==	O
APPEND_STATUS_ADDINZIP	O
)	O
{	O
err	int
=	O
LoadCentralDirectoryRecord	function
(	O
&	O
ziinit	struct
)	O
;	O
}	O
if	O
(	O
globalcomment	pointer
)	O
{	O
*	O
globalcomment	pointer
=	O
ziinit	struct
.	O
globalcomment	pointer
;	O
}	O
if	O
(	O
err	int
!=	O
ZIP_OK	O
)	O
{	O
TRYFREE	O
(	O
ziinit	struct
.	O
globalcomment	pointer
)	O
;	O
TRYFREE	O
(	O
zi	pointer
)	O
;	O
return	O
NULL	O
;	O
}	O
else	O
{	O
*	O
zi	pointer
=	O
ziinit	struct
;	O
return	O
(	O
zipFile	pointer
)	O
zi	pointer
;	O
}	O
}	O
extern	O
zipFile	pointer
ZEXPORT	O
zipOpen2	function
(	O
const	O
char	O
*	O
pathname	pointer
,	O
int	O
append	int
,	O
zipcharpc	pointer
*	O
globalcomment	pointer
,	O
zlib_filefunc_def	struct
*	O
pzlib_filefunc32_def	pointer
)	O
{	O
if	O
(	O
pzlib_filefunc32_def	pointer
!=	O
NULL	O
)	O
{	O
zlib_filefunc64_32_def	struct
zlib_filefunc64_32_def_fill	struct
;	O
fill_zlib_filefunc64_32_def_from_filefunc32	function
(	O
&	O
zlib_filefunc64_32_def_fill	struct
,	O
pzlib_filefunc32_def	pointer
)	O
;	O
return	O
zipOpen3	function
(	O
pathname	pointer
,	O
append	int
,	O
globalcomment	pointer
,	O
&	O
zlib_filefunc64_32_def_fill	struct
)	O
;	O
}	O
else	O
return	O
zipOpen3	function
(	O
pathname	pointer
,	O
append	int
,	O
globalcomment	pointer
,	O
NULL	O
)	O
;	O
}	O
extern	O
zipFile	pointer
ZEXPORT	O
zipOpen2_64	function
(	O
const	O
void	O
*	O
pathname	pointer
,	O
int	O
append	int
,	O
zipcharpc	pointer
*	O
globalcomment	pointer
,	O
zlib_filefunc64_def	struct
*	O
pzlib_filefunc_def	pointer
)	O
{	O
if	O
(	O
pzlib_filefunc_def	pointer
!=	O
NULL	O
)	O
{	O
zlib_filefunc64_32_def	struct
zlib_filefunc64_32_def_fill	struct
;	O
zlib_filefunc64_32_def_fill	struct
.	O
zfile_func64	struct
=	O
*	O
pzlib_filefunc_def	pointer
;	O
zlib_filefunc64_32_def_fill	struct
.	O
ztell32_file	pointer
=	O
NULL	O
;	O
zlib_filefunc64_32_def_fill	struct
.	O
zseek32_file	pointer
=	O
NULL	O
;	O
return	O
zipOpen3	function
(	O
pathname	pointer
,	O
append	int
,	O
globalcomment	pointer
,	O
&	O
zlib_filefunc64_32_def_fill	struct
)	O
;	O
}	O
else	O
return	O
zipOpen3	function
(	O
pathname	pointer
,	O
append	int
,	O
globalcomment	pointer
,	O
NULL	O
)	O
;	O
}	O
extern	O
zipFile	pointer
ZEXPORT	O
zipOpen	function
(	O
const	O
char	O
*	O
pathname	pointer
,	O
int	O
append	int
)	O
{	O
return	O
zipOpen3	function
(	O
(	O
const	O
void	O
*	O
)	O
pathname	pointer
,	O
append	int
,	O
NULL	O
,	O
NULL	O
)	O
;	O
}	O
extern	O
zipFile	pointer
ZEXPORT	O
zipOpen64	function
(	O
const	O
void	O
*	O
pathname	pointer
,	O
int	O
append	int
)	O
{	O
return	O
zipOpen3	function
(	O
pathname	pointer
,	O
append	int
,	O
NULL	O
,	O
NULL	O
)	O
;	O
}	O
int	O
Write_LocalFileHeader	function
(	O
zip64_internal	struct
*	O
zi	pointer
,	O
const	O
char	O
*	O
filename	pointer
,	O
uInt	int
size_extrafield_local	int
,	O
const	O
void	O
*	O
extrafield_local	pointer
)	O
{	O
int	O
err	int
;	O
uInt	int
size_filename	int
=	O
(	O
uInt	int
)	O
strlen	function
(	O
filename	pointer
)	O
;	O
uInt	int
size_extrafield	int
=	O
size_extrafield_local	int
;	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
LOCALHEADERMAGIC	O
,	O
4	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
{	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
zip64	int
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
45	int
,	O
2	int
)	O
;	O
else	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
20	int
,	O
2	int
)	O
;	O
}	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
zi	pointer
->	O
ci	struct
.	O
flag	long
,	O
2	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
zi	pointer
->	O
ci	struct
.	O
method	int
,	O
2	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
zi	pointer
->	O
ci	struct
.	O
dosDate	long
,	O
4	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
0	int
,	O
4	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
{	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
zip64	int
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
0xFFFFFFFF	int
,	O
4	int
)	O
;	O
else	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
0	int
,	O
4	int
)	O
;	O
}	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
{	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
zip64	int
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
0xFFFFFFFF	int
,	O
4	int
)	O
;	O
else	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
0	int
,	O
4	int
)	O
;	O
}	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
size_filename	int
,	O
2	int
)	O
;	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
zip64	int
)	O
{	O
size_extrafield	int
+=	O
20	int
;	O
}	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
size_extrafield	int
,	O
2	int
)	O
;	O
if	O
(	O
(	O
err	int
==	O
ZIP_OK	O
)	O
&&	O
(	O
size_filename	int
>	O
0	int
)	O
)	O
{	O
if	O
(	O
ZWRITE64	O
(	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
filename	pointer
,	O
size_filename	int
)	O
!=	O
size_filename	int
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
}	O
if	O
(	O
(	O
err	int
==	O
ZIP_OK	O
)	O
&&	O
(	O
size_extrafield_local	int
>	O
0	int
)	O
)	O
{	O
if	O
(	O
ZWRITE64	O
(	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
extrafield_local	pointer
,	O
size_extrafield_local	int
)	O
!=	O
size_extrafield_local	int
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
}	O
if	O
(	O
(	O
err	int
==	O
ZIP_OK	O
)	O
&&	O
(	O
zi	pointer
->	O
ci	struct
.	O
zip64	int
)	O
)	O
{	O
short	O
HeaderID	short
=	O
1	int
;	O
short	O
DataSize	short
=	O
16	int
;	O
ZPOS64_T	long long
CompressedSize	long long
=	O
0	int
;	O
ZPOS64_T	long long
UncompressedSize	long long
=	O
0	int
;	O
zi	pointer
->	O
ci	struct
.	O
pos_zip64extrainfo	long long
=	O
ZTELL64	O
(	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
)	O
;	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
short	O
)	O
HeaderID	short
,	O
2	int
)	O
;	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
short	O
)	O
DataSize	short
,	O
2	int
)	O
;	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
ZPOS64_T	long long
)	O
UncompressedSize	long long
,	O
8	int
)	O
;	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
ZPOS64_T	long long
)	O
CompressedSize	long long
,	O
8	int
)	O
;	O
}	O
return	O
err	int
;	O
}	O
extern	O
int	O
ZEXPORT	O
zipOpenNewFileInZip4_64	function
(	O
zipFile	pointer
file	pointer
,	O
const	O
char	O
*	O
filename	pointer
,	O
const	O
zip_fileinfo	struct
*	O
zipfi	pointer
,	O
const	O
void	O
*	O
extrafield_local	pointer
,	O
uInt	int
size_extrafield_local	int
,	O
const	O
void	O
*	O
extrafield_global	pointer
,	O
uInt	int
size_extrafield_global	int
,	O
const	O
char	O
*	O
comment	pointer
,	O
int	O
method	int
,	O
int	O
level	int
,	O
int	O
raw	int
,	O
int	O
windowBits	int
,	O
int	O
memLevel	int
,	O
int	O
strategy	int
,	O
const	O
char	O
*	O
password	pointer
,	O
uLong	long
crcForCrypting	long
,	O
uLong	long
versionMadeBy	long
,	O
uLong	long
flagBase	long
,	O
int	O
zip64	int
)	O
{	O
zip64_internal	struct
*	O
zi	pointer
;	O
uInt	int
size_filename	int
;	O
uInt	int
size_comment	long
;	O
uInt	int
i	int
;	O
int	O
err	int
=	O
ZIP_OK	O
;	O
if	O
(	O
file	pointer
==	O
NULL	O
)	O
return	O
ZIP_PARAMERROR	O
;	O
if	O
(	O
(	O
method	int
!=	O
0	int
)	O
&&	O
(	O
method	int
!=	O
Z_DEFLATED	int
)	O
)	O
return	O
ZIP_PARAMERROR	O
;	O
zi	pointer
=	O
(	O
zip64_internal	struct
*	O
)	O
file	pointer
;	O
if	O
(	O
zi	pointer
->	O
in_opened_file_inzip	int
==	O
1	int
)	O
{	O
err	int
=	O
zipCloseFileInZip	function
(	O
file	pointer
)	O
;	O
if	O
(	O
err	int
!=	O
ZIP_OK	O
)	O
return	O
err	int
;	O
}	O
if	O
(	O
filename	pointer
==	O
NULL	O
)	O
filename	pointer
=	O
"-"	pointer
;	O
if	O
(	O
comment	pointer
==	O
NULL	O
)	O
size_comment	long
=	O
0	int
;	O
else	O
size_comment	long
=	O
(	O
uInt	int
)	O
strlen	function
(	O
comment	pointer
)	O
;	O
size_filename	int
=	O
(	O
uInt	int
)	O
strlen	function
(	O
filename	pointer
)	O
;	O
if	O
(	O
zipfi	pointer
==	O
NULL	O
)	O
zi	pointer
->	O
ci	struct
.	O
dosDate	long
=	O
0	int
;	O
else	O
{	O
if	O
(	O
zipfi	pointer
->	O
dosDate	long
!=	O
0	int
)	O
zi	pointer
->	O
ci	struct
.	O
dosDate	long
=	O
zipfi	pointer
->	O
dosDate	long
;	O
else	O
zi	pointer
->	O
ci	struct
.	O
dosDate	long
=	O
zip64local_TmzDateToDosDate	function
(	O
&	O
zipfi	pointer
->	O
tmz_date	struct
)	O
;	O
}	O
zi	pointer
->	O
ci	struct
.	O
flag	long
=	O
flagBase	long
;	O
if	O
(	O
(	O
level	int
==	O
8	int
)	O
||	O
(	O
level	int
==	O
9	int
)	O
)	O
zi	pointer
->	O
ci	struct
.	O
flag	long
|=	O
2	int
;	O
if	O
(	O
level	int
==	O
2	int
)	O
zi	pointer
->	O
ci	struct
.	O
flag	long
|=	O
4	int
;	O
if	O
(	O
level	int
==	O
1	int
)	O
zi	pointer
->	O
ci	struct
.	O
flag	long
|=	O
6	int
;	O
if	O
(	O
password	pointer
!=	O
NULL	O
)	O
zi	pointer
->	O
ci	struct
.	O
flag	long
|=	O
1	int
;	O
zi	pointer
->	O
ci	struct
.	O
crc32	function
=	O
0	int
;	O
zi	pointer
->	O
ci	struct
.	O
method	int
=	O
method	int
;	O
zi	pointer
->	O
ci	struct
.	O
encrypt	int
=	O
0	int
;	O
zi	pointer
->	O
ci	struct
.	O
stream_initialised	int
=	O
0	int
;	O
zi	pointer
->	O
ci	struct
.	O
pos_in_buffered_data	int
=	O
0	int
;	O
zi	pointer
->	O
ci	struct
.	O
raw	int
=	O
raw	int
;	O
zi	pointer
->	O
ci	struct
.	O
pos_local_header	long long
=	O
ZTELL64	O
(	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
)	O
;	O
zi	pointer
->	O
ci	struct
.	O
size_centralheader	long
=	O
SIZECENTRALHEADER	O
+	O
size_filename	int
+	O
size_extrafield_global	int
+	O
size_comment	long
;	O
zi	pointer
->	O
ci	struct
.	O
size_centralExtraFree	long
=	O
32	int
;	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
=	O
(	O
char	O
*	O
)	O
ALLOC	O
(	O
(	O
uInt	int
)	O
zi	pointer
->	O
ci	struct
.	O
size_centralheader	long
+	O
zi	pointer
->	O
ci	struct
.	O
size_centralExtraFree	long
)	O
;	O
zi	pointer
->	O
ci	struct
.	O
size_centralExtra	long
=	O
size_extrafield_global	int
;	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
,	O
(	O
uLong	long
)	O
CENTRALHEADERMAGIC	O
,	O
4	int
)	O
;	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
4	int
,	O
(	O
uLong	long
)	O
versionMadeBy	long
,	O
2	int
)	O
;	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
6	int
,	O
(	O
uLong	long
)	O
20	int
,	O
2	int
)	O
;	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
8	int
,	O
(	O
uLong	long
)	O
zi	pointer
->	O
ci	struct
.	O
flag	long
,	O
2	int
)	O
;	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
10	int
,	O
(	O
uLong	long
)	O
zi	pointer
->	O
ci	struct
.	O
method	int
,	O
2	int
)	O
;	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
12	int
,	O
(	O
uLong	long
)	O
zi	pointer
->	O
ci	struct
.	O
dosDate	long
,	O
4	int
)	O
;	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
16	int
,	O
(	O
uLong	long
)	O
0	int
,	O
4	int
)	O
;	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
20	int
,	O
(	O
uLong	long
)	O
0	int
,	O
4	int
)	O
;	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
24	int
,	O
(	O
uLong	long
)	O
0	int
,	O
4	int
)	O
;	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
28	int
,	O
(	O
uLong	long
)	O
size_filename	int
,	O
2	int
)	O
;	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
30	int
,	O
(	O
uLong	long
)	O
size_extrafield_global	int
,	O
2	int
)	O
;	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
32	int
,	O
(	O
uLong	long
)	O
size_comment	long
,	O
2	int
)	O
;	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
34	int
,	O
(	O
uLong	long
)	O
0	int
,	O
2	int
)	O
;	O
if	O
(	O
zipfi	pointer
==	O
NULL	O
)	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
36	int
,	O
(	O
uLong	long
)	O
0	int
,	O
2	int
)	O
;	O
else	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
36	int
,	O
(	O
uLong	long
)	O
zipfi	pointer
->	O
internal_fa	long
,	O
2	int
)	O
;	O
if	O
(	O
zipfi	pointer
==	O
NULL	O
)	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
38	int
,	O
(	O
uLong	long
)	O
0	int
,	O
4	int
)	O
;	O
else	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
38	int
,	O
(	O
uLong	long
)	O
zipfi	pointer
->	O
external_fa	long
,	O
4	int
)	O
;	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
pos_local_header	long long
>=	O
0xffffffff	int
)	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
42	int
,	O
(	O
uLong	long
)	O
0xffffffff	int
,	O
4	int
)	O
;	O
else	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
42	int
,	O
(	O
uLong	long
)	O
zi	pointer
->	O
ci	struct
.	O
pos_local_header	long long
-	O
zi	pointer
->	O
add_position_when_writing_offset	long long
,	O
4	int
)	O
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
size_filename	int
;	O
i	int
++	O
)	O
*	O
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
SIZECENTRALHEADER	O
+	O
i	int
)	O
=	O
*	O
(	O
filename	pointer
+	O
i	int
)	O
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
size_extrafield_global	int
;	O
i	int
++	O
)	O
*	O
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
SIZECENTRALHEADER	O
+	O
size_filename	int
+	O
i	int
)	O
=	O
*	O
(	O
(	O
(	O
const	O
char	O
*	O
)	O
extrafield_global	pointer
)	O
+	O
i	int
)	O
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
size_comment	long
;	O
i	int
++	O
)	O
*	O
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
SIZECENTRALHEADER	O
+	O
size_filename	int
+	O
size_extrafield_global	int
+	O
i	int
)	O
=	O
*	O
(	O
comment	pointer
+	O
i	int
)	O
;	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
==	O
NULL	O
)	O
return	O
ZIP_INTERNALERROR	O
;	O
zi	pointer
->	O
ci	struct
.	O
zip64	int
=	O
zip64	int
;	O
zi	pointer
->	O
ci	struct
.	O
totalCompressedData	long long
=	O
0	int
;	O
zi	pointer
->	O
ci	struct
.	O
totalUncompressedData	long long
=	O
0	int
;	O
zi	pointer
->	O
ci	struct
.	O
pos_zip64extrainfo	long long
=	O
0	int
;	O
err	int
=	O
Write_LocalFileHeader	function
(	O
zi	pointer
,	O
filename	pointer
,	O
size_extrafield_local	int
,	O
extrafield_local	pointer
)	O
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
avail_in	int
=	O
(	O
uInt	int
)	O
0	int
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
avail_out	int
=	O
(	O
uInt	int
)	O
Z_BUFSIZE	O
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
next_out	pointer
=	O
zi	pointer
->	O
ci	struct
.	O
buffered_data	array
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
total_in	long
=	O
0	int
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
total_out	long
=	O
0	int
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
data_type	int
=	O
Z_BINARY	int
;	O
if	O
(	O
(	O
err	int
==	O
ZIP_OK	O
)	O
&&	O
(	O
zi	pointer
->	O
ci	struct
.	O
method	int
==	O
Z_DEFLATED	int
)	O
&&	O
(	O
!	O
zi	pointer
->	O
ci	struct
.	O
raw	int
)	O
)	O
{	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
method	int
==	O
Z_DEFLATED	int
)	O
{	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
zalloc	pointer
=	O
(	O
alloc_func	pointer
)	O
0	int
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
zfree	pointer
=	O
(	O
free_func	pointer
)	O
0	int
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
opaque	pointer
=	O
(	O
voidpf	pointer
)	O
0	int
;	O
if	O
(	O
windowBits	int
>	O
0	int
)	O
windowBits	int
=	O
-	O
windowBits	int
;	O
err	int
=	O
deflateInit2	O
(	O
&	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
,	O
level	int
,	O
Z_DEFLATED	int
,	O
windowBits	int
,	O
memLevel	int
,	O
strategy	int
)	O
;	O
if	O
(	O
err	int
==	O
Z_OK	int
)	O
zi	pointer
->	O
ci	struct
.	O
stream_initialised	int
=	O
Z_DEFLATED	int
;	O
}	O
else	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
method	int
==	O
Z_BZIP2ED	int
)	O
{	O
}	O
}	O
zi	pointer
->	O
ci	struct
.	O
crypt_header_size	int
=	O
0	int
;	O
if	O
(	O
(	O
err	int
==	O
Z_OK	int
)	O
&&	O
(	O
password	pointer
!=	O
NULL	O
)	O
)	O
{	O
unsigned	O
char	O
bufHead	array
[	O
RAND_HEAD_LEN	int
]	O
;	O
unsigned	O
int	O
sizeHead	int
;	O
zi	pointer
->	O
ci	struct
.	O
encrypt	int
=	O
1	int
;	O
zi	pointer
->	O
ci	struct
.	O
pcrc_32_tab	pointer
=	O
get_crc_table	function
(	O
)	O
;	O
sizeHead	int
=	O
crypthead	function
(	O
password	pointer
,	O
bufHead	array
,	O
RAND_HEAD_LEN	int
,	O
zi	pointer
->	O
ci	struct
.	O
keys	array
,	O
zi	pointer
->	O
ci	struct
.	O
pcrc_32_tab	pointer
,	O
crcForCrypting	long
)	O
;	O
zi	pointer
->	O
ci	struct
.	O
crypt_header_size	int
=	O
sizeHead	int
;	O
if	O
(	O
ZWRITE64	O
(	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
bufHead	array
,	O
sizeHead	int
)	O
!=	O
sizeHead	int
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
}	O
if	O
(	O
err	int
==	O
Z_OK	int
)	O
zi	pointer
->	O
in_opened_file_inzip	int
=	O
1	int
;	O
return	O
err	int
;	O
}	O
extern	O
int	O
ZEXPORT	O
zipOpenNewFileInZip4	function
(	O
zipFile	pointer
file	pointer
,	O
const	O
char	O
*	O
filename	pointer
,	O
const	O
zip_fileinfo	struct
*	O
zipfi	pointer
,	O
const	O
void	O
*	O
extrafield_local	pointer
,	O
uInt	int
size_extrafield_local	int
,	O
const	O
void	O
*	O
extrafield_global	pointer
,	O
uInt	int
size_extrafield_global	int
,	O
const	O
char	O
*	O
comment	pointer
,	O
int	O
method	int
,	O
int	O
level	int
,	O
int	O
raw	int
,	O
int	O
windowBits	int
,	O
int	O
memLevel	int
,	O
int	O
strategy	int
,	O
const	O
char	O
*	O
password	pointer
,	O
uLong	long
crcForCrypting	long
,	O
uLong	long
versionMadeBy	long
,	O
uLong	long
flagBase	long
)	O
{	O
return	O
zipOpenNewFileInZip4_64	function
(	O
file	pointer
,	O
filename	pointer
,	O
zipfi	pointer
,	O
extrafield_local	pointer
,	O
size_extrafield_local	int
,	O
extrafield_global	pointer
,	O
size_extrafield_global	int
,	O
comment	pointer
,	O
method	int
,	O
level	int
,	O
raw	int
,	O
windowBits	int
,	O
memLevel	int
,	O
strategy	int
,	O
password	pointer
,	O
crcForCrypting	long
,	O
versionMadeBy	long
,	O
flagBase	long
,	O
0	int
)	O
;	O
}	O
extern	O
int	O
ZEXPORT	O
zipOpenNewFileInZip3	function
(	O
zipFile	pointer
file	pointer
,	O
const	O
char	O
*	O
filename	pointer
,	O
const	O
zip_fileinfo	struct
*	O
zipfi	pointer
,	O
const	O
void	O
*	O
extrafield_local	pointer
,	O
uInt	int
size_extrafield_local	int
,	O
const	O
void	O
*	O
extrafield_global	pointer
,	O
uInt	int
size_extrafield_global	int
,	O
const	O
char	O
*	O
comment	pointer
,	O
int	O
method	int
,	O
int	O
level	int
,	O
int	O
raw	int
,	O
int	O
windowBits	int
,	O
int	O
memLevel	int
,	O
int	O
strategy	int
,	O
const	O
char	O
*	O
password	pointer
,	O
uLong	long
crcForCrypting	long
)	O
{	O
return	O
zipOpenNewFileInZip4_64	function
(	O
file	pointer
,	O
filename	pointer
,	O
zipfi	pointer
,	O
extrafield_local	pointer
,	O
size_extrafield_local	int
,	O
extrafield_global	pointer
,	O
size_extrafield_global	int
,	O
comment	pointer
,	O
method	int
,	O
level	int
,	O
raw	int
,	O
windowBits	int
,	O
memLevel	int
,	O
strategy	int
,	O
password	pointer
,	O
crcForCrypting	long
,	O
VERSIONMADEBY	O
,	O
0	int
,	O
0	int
)	O
;	O
}	O
extern	O
int	O
ZEXPORT	O
zipOpenNewFileInZip3_64	function
(	O
zipFile	pointer
file	pointer
,	O
const	O
char	O
*	O
filename	pointer
,	O
const	O
zip_fileinfo	struct
*	O
zipfi	pointer
,	O
const	O
void	O
*	O
extrafield_local	pointer
,	O
uInt	int
size_extrafield_local	int
,	O
const	O
void	O
*	O
extrafield_global	pointer
,	O
uInt	int
size_extrafield_global	int
,	O
const	O
char	O
*	O
comment	pointer
,	O
int	O
method	int
,	O
int	O
level	int
,	O
int	O
raw	int
,	O
int	O
windowBits	int
,	O
int	O
memLevel	int
,	O
int	O
strategy	int
,	O
const	O
char	O
*	O
password	pointer
,	O
uLong	long
crcForCrypting	long
,	O
int	O
zip64	int
)	O
{	O
return	O
zipOpenNewFileInZip4_64	function
(	O
file	pointer
,	O
filename	pointer
,	O
zipfi	pointer
,	O
extrafield_local	pointer
,	O
size_extrafield_local	int
,	O
extrafield_global	pointer
,	O
size_extrafield_global	int
,	O
comment	pointer
,	O
method	int
,	O
level	int
,	O
raw	int
,	O
windowBits	int
,	O
memLevel	int
,	O
strategy	int
,	O
password	pointer
,	O
crcForCrypting	long
,	O
VERSIONMADEBY	O
,	O
0	int
,	O
zip64	int
)	O
;	O
}	O
extern	O
int	O
ZEXPORT	O
zipOpenNewFileInZip2	function
(	O
zipFile	pointer
file	pointer
,	O
const	O
char	O
*	O
filename	pointer
,	O
const	O
zip_fileinfo	struct
*	O
zipfi	pointer
,	O
const	O
void	O
*	O
extrafield_local	pointer
,	O
uInt	int
size_extrafield_local	int
,	O
const	O
void	O
*	O
extrafield_global	pointer
,	O
uInt	int
size_extrafield_global	int
,	O
const	O
char	O
*	O
comment	pointer
,	O
int	O
method	int
,	O
int	O
level	int
,	O
int	O
raw	int
)	O
{	O
return	O
zipOpenNewFileInZip4_64	function
(	O
file	pointer
,	O
filename	pointer
,	O
zipfi	pointer
,	O
extrafield_local	pointer
,	O
size_extrafield_local	int
,	O
extrafield_global	pointer
,	O
size_extrafield_global	int
,	O
comment	pointer
,	O
method	int
,	O
level	int
,	O
raw	int
,	O
-	O
MAX_WBITS	int
,	O
DEF_MEM_LEVEL	int
,	O
Z_DEFAULT_STRATEGY	int
,	O
NULL	O
,	O
0	int
,	O
VERSIONMADEBY	O
,	O
0	int
,	O
0	int
)	O
;	O
}	O
extern	O
int	O
ZEXPORT	O
zipOpenNewFileInZip2_64	function
(	O
zipFile	pointer
file	pointer
,	O
const	O
char	O
*	O
filename	pointer
,	O
const	O
zip_fileinfo	struct
*	O
zipfi	pointer
,	O
const	O
void	O
*	O
extrafield_local	pointer
,	O
uInt	int
size_extrafield_local	int
,	O
const	O
void	O
*	O
extrafield_global	pointer
,	O
uInt	int
size_extrafield_global	int
,	O
const	O
char	O
*	O
comment	pointer
,	O
int	O
method	int
,	O
int	O
level	int
,	O
int	O
raw	int
,	O
int	O
zip64	int
)	O
{	O
return	O
zipOpenNewFileInZip4_64	function
(	O
file	pointer
,	O
filename	pointer
,	O
zipfi	pointer
,	O
extrafield_local	pointer
,	O
size_extrafield_local	int
,	O
extrafield_global	pointer
,	O
size_extrafield_global	int
,	O
comment	pointer
,	O
method	int
,	O
level	int
,	O
raw	int
,	O
-	O
MAX_WBITS	int
,	O
DEF_MEM_LEVEL	int
,	O
Z_DEFAULT_STRATEGY	int
,	O
NULL	O
,	O
0	int
,	O
VERSIONMADEBY	O
,	O
0	int
,	O
zip64	int
)	O
;	O
}	O
extern	O
int	O
ZEXPORT	O
zipOpenNewFileInZip64	function
(	O
zipFile	pointer
file	pointer
,	O
const	O
char	O
*	O
filename	pointer
,	O
const	O
zip_fileinfo	struct
*	O
zipfi	pointer
,	O
const	O
void	O
*	O
extrafield_local	pointer
,	O
uInt	int
size_extrafield_local	int
,	O
const	O
void	O
*	O
extrafield_global	pointer
,	O
uInt	int
size_extrafield_global	int
,	O
const	O
char	O
*	O
comment	pointer
,	O
int	O
method	int
,	O
int	O
level	int
,	O
int	O
zip64	int
)	O
{	O
return	O
zipOpenNewFileInZip4_64	function
(	O
file	pointer
,	O
filename	pointer
,	O
zipfi	pointer
,	O
extrafield_local	pointer
,	O
size_extrafield_local	int
,	O
extrafield_global	pointer
,	O
size_extrafield_global	int
,	O
comment	pointer
,	O
method	int
,	O
level	int
,	O
0	int
,	O
-	O
MAX_WBITS	int
,	O
DEF_MEM_LEVEL	int
,	O
Z_DEFAULT_STRATEGY	int
,	O
NULL	O
,	O
0	int
,	O
VERSIONMADEBY	O
,	O
0	int
,	O
zip64	int
)	O
;	O
}	O
extern	O
int	O
ZEXPORT	O
zipOpenNewFileInZip	function
(	O
zipFile	pointer
file	pointer
,	O
const	O
char	O
*	O
filename	pointer
,	O
const	O
zip_fileinfo	struct
*	O
zipfi	pointer
,	O
const	O
void	O
*	O
extrafield_local	pointer
,	O
uInt	int
size_extrafield_local	int
,	O
const	O
void	O
*	O
extrafield_global	pointer
,	O
uInt	int
size_extrafield_global	int
,	O
const	O
char	O
*	O
comment	pointer
,	O
int	O
method	int
,	O
int	O
level	int
)	O
{	O
return	O
zipOpenNewFileInZip4_64	function
(	O
file	pointer
,	O
filename	pointer
,	O
zipfi	pointer
,	O
extrafield_local	pointer
,	O
size_extrafield_local	int
,	O
extrafield_global	pointer
,	O
size_extrafield_global	int
,	O
comment	pointer
,	O
method	int
,	O
level	int
,	O
0	int
,	O
-	O
MAX_WBITS	int
,	O
DEF_MEM_LEVEL	int
,	O
Z_DEFAULT_STRATEGY	int
,	O
NULL	O
,	O
0	int
,	O
VERSIONMADEBY	O
,	O
0	int
,	O
0	int
)	O
;	O
}	O
local	O
int	O
zip64FlushWriteBuffer	function
(	O
zip64_internal	struct
*	O
zi	pointer
)	O
{	O
int	O
err	int
=	O
ZIP_OK	O
;	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
encrypt	int
!=	O
0	int
)	O
{	O
uInt	int
i	int
;	O
int	O
t	int
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
zi	pointer
->	O
ci	struct
.	O
pos_in_buffered_data	int
;	O
i	int
++	O
)	O
zi	pointer
->	O
ci	struct
.	O
buffered_data	array
[	O
i	int
]	O
=	O
zencode	O
(	O
zi	pointer
->	O
ci	struct
.	O
keys	array
,	O
zi	pointer
->	O
ci	struct
.	O
pcrc_32_tab	pointer
,	O
zi	pointer
->	O
ci	struct
.	O
buffered_data	array
[	O
i	int
]	O
,	O
t	int
)	O
;	O
}	O
if	O
(	O
ZWRITE64	O
(	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
zi	pointer
->	O
ci	struct
.	O
buffered_data	array
,	O
zi	pointer
->	O
ci	struct
.	O
pos_in_buffered_data	int
)	O
!=	O
zi	pointer
->	O
ci	struct
.	O
pos_in_buffered_data	int
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
zi	pointer
->	O
ci	struct
.	O
totalCompressedData	long long
+=	O
zi	pointer
->	O
ci	struct
.	O
pos_in_buffered_data	int
;	O
{	O
zi	pointer
->	O
ci	struct
.	O
totalUncompressedData	long long
+=	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
total_in	long
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
total_in	long
=	O
0	int
;	O
}	O
zi	pointer
->	O
ci	struct
.	O
pos_in_buffered_data	int
=	O
0	int
;	O
return	O
err	int
;	O
}	O
extern	O
int	O
ZEXPORT	O
zipWriteInFileInZip	function
(	O
zipFile	pointer
file	pointer
,	O
const	O
void	O
*	O
buf	pointer
,	O
unsigned	O
int	O
len	int
)	O
{	O
zip64_internal	struct
*	O
zi	pointer
;	O
int	O
err	int
=	O
ZIP_OK	O
;	O
if	O
(	O
file	pointer
==	O
NULL	O
)	O
return	O
ZIP_PARAMERROR	O
;	O
zi	pointer
=	O
(	O
zip64_internal	struct
*	O
)	O
file	pointer
;	O
if	O
(	O
zi	pointer
->	O
in_opened_file_inzip	int
==	O
0	int
)	O
return	O
ZIP_PARAMERROR	O
;	O
zi	pointer
->	O
ci	struct
.	O
crc32	function
=	O
crc32	function
(	O
zi	pointer
->	O
ci	struct
.	O
crc32	function
,	O
buf	pointer
,	O
(	O
uInt	int
)	O
len	int
)	O
;	O
{	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
next_in	pointer
=	O
(	O
Bytef	char
*	O
)	O
buf	pointer
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
avail_in	int
=	O
len	int
;	O
while	O
(	O
(	O
err	int
==	O
ZIP_OK	O
)	O
&&	O
(	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
avail_in	int
>	O
0	int
)	O
)	O
{	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
avail_out	int
==	O
0	int
)	O
{	O
if	O
(	O
zip64FlushWriteBuffer	function
(	O
zi	pointer
)	O
==	O
ZIP_ERRNO	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
avail_out	int
=	O
(	O
uInt	int
)	O
Z_BUFSIZE	O
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
next_out	pointer
=	O
zi	pointer
->	O
ci	struct
.	O
buffered_data	array
;	O
}	O
if	O
(	O
err	int
!=	O
ZIP_OK	O
)	O
break	O
;	O
if	O
(	O
(	O
zi	pointer
->	O
ci	struct
.	O
method	int
==	O
Z_DEFLATED	int
)	O
&&	O
(	O
!	O
zi	pointer
->	O
ci	struct
.	O
raw	int
)	O
)	O
{	O
uLong	long
uTotalOutBefore	long
=	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
total_out	long
;	O
err	int
=	O
deflate	function
(	O
&	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
,	O
Z_NO_FLUSH	int
)	O
;	O
if	O
(	O
uTotalOutBefore	long
>	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
total_out	long
)	O
{	O
int	O
bBreak	int
=	O
0	int
;	O
bBreak	int
++	O
;	O
}	O
zi	pointer
->	O
ci	struct
.	O
pos_in_buffered_data	int
+=	O
(	O
uInt	int
)	O
(	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
total_out	long
-	O
uTotalOutBefore	long
)	O
;	O
}	O
else	O
{	O
uInt	int
copy_this	int
,	O
i	int
;	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
avail_in	int
<	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
avail_out	int
)	O
copy_this	int
=	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
avail_in	int
;	O
else	O
copy_this	int
=	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
avail_out	int
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
copy_this	int
;	O
i	int
++	O
)	O
*	O
(	O
(	O
(	O
char	O
*	O
)	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
next_out	pointer
)	O
+	O
i	int
)	O
=	O
*	O
(	O
(	O
(	O
const	O
char	O
*	O
)	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
next_in	pointer
)	O
+	O
i	int
)	O
;	O
{	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
avail_in	int
-=	O
copy_this	int
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
avail_out	int
-=	O
copy_this	int
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
next_in	pointer
+=	O
copy_this	int
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
next_out	pointer
+=	O
copy_this	int
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
total_in	long
+=	O
copy_this	int
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
total_out	long
+=	O
copy_this	int
;	O
zi	pointer
->	O
ci	struct
.	O
pos_in_buffered_data	int
+=	O
copy_this	int
;	O
}	O
}	O
}	O
}	O
return	O
err	int
;	O
}	O
extern	O
int	O
ZEXPORT	O
zipCloseFileInZipRaw	function
(	O
zipFile	pointer
file	pointer
,	O
uLong	long
uncompressed_size	long
,	O
uLong	long
crc32	function
)	O
{	O
return	O
zipCloseFileInZipRaw64	function
(	O
file	pointer
,	O
uncompressed_size	long
,	O
crc32	function
)	O
;	O
}	O
extern	O
int	O
ZEXPORT	O
zipCloseFileInZipRaw64	function
(	O
zipFile	pointer
file	pointer
,	O
ZPOS64_T	long long
uncompressed_size	long
,	O
uLong	long
crc32	function
)	O
{	O
zip64_internal	struct
*	O
zi	pointer
;	O
ZPOS64_T	long long
compressed_size	long long
;	O
uLong	long
invalidValue	long
=	O
0xffffffff	int
;	O
short	O
datasize	short
=	O
0	int
;	O
int	O
err	int
=	O
ZIP_OK	O
;	O
if	O
(	O
file	pointer
==	O
NULL	O
)	O
return	O
ZIP_PARAMERROR	O
;	O
zi	pointer
=	O
(	O
zip64_internal	struct
*	O
)	O
file	pointer
;	O
if	O
(	O
zi	pointer
->	O
in_opened_file_inzip	int
==	O
0	int
)	O
return	O
ZIP_PARAMERROR	O
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
avail_in	int
=	O
0	int
;	O
if	O
(	O
(	O
zi	pointer
->	O
ci	struct
.	O
method	int
==	O
Z_DEFLATED	int
)	O
&&	O
(	O
!	O
zi	pointer
->	O
ci	struct
.	O
raw	int
)	O
)	O
{	O
while	O
(	O
err	int
==	O
ZIP_OK	O
)	O
{	O
uLong	long
uTotalOutBefore	long
;	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
avail_out	int
==	O
0	int
)	O
{	O
if	O
(	O
zip64FlushWriteBuffer	function
(	O
zi	pointer
)	O
==	O
ZIP_ERRNO	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
avail_out	int
=	O
(	O
uInt	int
)	O
Z_BUFSIZE	O
;	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
next_out	pointer
=	O
zi	pointer
->	O
ci	struct
.	O
buffered_data	array
;	O
}	O
uTotalOutBefore	long
=	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
total_out	long
;	O
err	int
=	O
deflate	function
(	O
&	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
,	O
Z_FINISH	int
)	O
;	O
zi	pointer
->	O
ci	struct
.	O
pos_in_buffered_data	int
+=	O
(	O
uInt	int
)	O
(	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
total_out	long
-	O
uTotalOutBefore	long
)	O
;	O
}	O
}	O
else	O
if	O
(	O
(	O
zi	pointer
->	O
ci	struct
.	O
method	int
==	O
Z_BZIP2ED	int
)	O
&&	O
(	O
!	O
zi	pointer
->	O
ci	struct
.	O
raw	int
)	O
)	O
{	O
}	O
if	O
(	O
err	int
==	O
Z_STREAM_END	int
)	O
err	int
=	O
ZIP_OK	O
;	O
if	O
(	O
(	O
zi	pointer
->	O
ci	struct
.	O
pos_in_buffered_data	int
>	O
0	int
)	O
&&	O
(	O
err	int
==	O
ZIP_OK	O
)	O
)	O
{	O
if	O
(	O
zip64FlushWriteBuffer	function
(	O
zi	pointer
)	O
==	O
ZIP_ERRNO	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
}	O
if	O
(	O
(	O
zi	pointer
->	O
ci	struct
.	O
method	int
==	O
Z_DEFLATED	int
)	O
&&	O
(	O
!	O
zi	pointer
->	O
ci	struct
.	O
raw	int
)	O
)	O
{	O
int	O
tmp_err	int
=	O
deflateEnd	function
(	O
&	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
tmp_err	int
;	O
zi	pointer
->	O
ci	struct
.	O
stream_initialised	int
=	O
0	int
;	O
}	O
if	O
(	O
!	O
zi	pointer
->	O
ci	struct
.	O
raw	int
)	O
{	O
crc32	function
=	O
(	O
uLong	long
)	O
zi	pointer
->	O
ci	struct
.	O
crc32	function
;	O
uncompressed_size	long
=	O
zi	pointer
->	O
ci	struct
.	O
totalUncompressedData	long long
;	O
}	O
compressed_size	long long
=	O
zi	pointer
->	O
ci	struct
.	O
totalCompressedData	long long
;	O
compressed_size	long long
+=	O
zi	pointer
->	O
ci	struct
.	O
crypt_header_size	int
;	O
if	O
(	O
compressed_size	long long
>=	O
0xffffffff	int
||	O
uncompressed_size	long
>=	O
0xffffffff	int
||	O
zi	pointer
->	O
ci	struct
.	O
pos_local_header	long long
>=	O
0xffffffff	int
)	O
{	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
4	int
,	O
(	O
uLong	long
)	O
45	int
,	O
2	int
)	O
;	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
6	int
,	O
(	O
uLong	long
)	O
45	int
,	O
2	int
)	O
;	O
}	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
16	int
,	O
crc32	function
,	O
4	int
)	O
;	O
if	O
(	O
compressed_size	long long
>=	O
0xffffffff	int
)	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
20	int
,	O
invalidValue	long
,	O
4	int
)	O
;	O
else	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
20	int
,	O
compressed_size	long long
,	O
4	int
)	O
;	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
stream	pointer
.	O
data_type	int
==	O
Z_ASCII	O
)	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
36	int
,	O
(	O
uLong	long
)	O
Z_ASCII	O
,	O
2	int
)	O
;	O
if	O
(	O
uncompressed_size	long
>=	O
0xffffffff	int
)	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
24	int
,	O
invalidValue	long
,	O
4	int
)	O
;	O
else	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
24	int
,	O
uncompressed_size	long
,	O
4	int
)	O
;	O
if	O
(	O
uncompressed_size	long
>=	O
0xffffffff	int
)	O
datasize	short
+=	O
8	int
;	O
if	O
(	O
compressed_size	long long
>=	O
0xffffffff	int
)	O
datasize	short
+=	O
8	int
;	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
pos_local_header	long long
>=	O
0xffffffff	int
)	O
datasize	short
+=	O
8	int
;	O
if	O
(	O
datasize	short
>	O
0	int
)	O
{	O
char	O
*	O
p	pointer
=	O
NULL	O
;	O
if	O
(	O
(	O
uLong	long
)	O
(	O
datasize	short
+	O
4	int
)	O
>	O
zi	pointer
->	O
ci	struct
.	O
size_centralExtraFree	long
)	O
{	O
return	O
ZIP_BADZIPFILE	O
;	O
}	O
p	pointer
=	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
zi	pointer
->	O
ci	struct
.	O
size_centralheader	long
;	O
zip64local_putValue_inmemory	function
(	O
p	pointer
,	O
0x0001	int
,	O
2	int
)	O
;	O
p	pointer
+=	O
2	int
;	O
zip64local_putValue_inmemory	function
(	O
p	pointer
,	O
datasize	short
,	O
2	int
)	O
;	O
p	pointer
+=	O
2	int
;	O
if	O
(	O
uncompressed_size	long
>=	O
0xffffffff	int
)	O
{	O
zip64local_putValue_inmemory	function
(	O
p	pointer
,	O
uncompressed_size	long
,	O
8	int
)	O
;	O
p	pointer
+=	O
8	int
;	O
}	O
if	O
(	O
compressed_size	long long
>=	O
0xffffffff	int
)	O
{	O
zip64local_putValue_inmemory	function
(	O
p	pointer
,	O
compressed_size	long long
,	O
8	int
)	O
;	O
p	pointer
+=	O
8	int
;	O
}	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
pos_local_header	long long
>=	O
0xffffffff	int
)	O
{	O
zip64local_putValue_inmemory	function
(	O
p	pointer
,	O
zi	pointer
->	O
ci	struct
.	O
pos_local_header	long long
,	O
8	int
)	O
;	O
p	pointer
+=	O
8	int
;	O
}	O
zi	pointer
->	O
ci	struct
.	O
size_centralExtraFree	long
-=	O
datasize	short
+	O
4	int
;	O
zi	pointer
->	O
ci	struct
.	O
size_centralheader	long
+=	O
datasize	short
+	O
4	int
;	O
zi	pointer
->	O
ci	struct
.	O
size_centralExtra	long
+=	O
datasize	short
+	O
4	int
;	O
zip64local_putValue_inmemory	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
+	O
30	int
,	O
(	O
uLong	long
)	O
zi	pointer
->	O
ci	struct
.	O
size_centralExtra	long
,	O
2	int
)	O
;	O
}	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
add_data_in_datablock	function
(	O
&	O
zi	pointer
->	O
central_dir	struct
,	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
,	O
(	O
uLong	long
)	O
zi	pointer
->	O
ci	struct
.	O
size_centralheader	long
)	O
;	O
free	function
(	O
zi	pointer
->	O
ci	struct
.	O
central_header	pointer
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
{	O
ZPOS64_T	long long
cur_pos_inzip	long long
=	O
ZTELL64	O
(	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
)	O
;	O
if	O
(	O
ZSEEK64	O
(	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
zi	pointer
->	O
ci	struct
.	O
pos_local_header	long long
+	O
14	int
,	O
ZLIB_FILEFUNC_SEEK_SET	O
)	O
!=	O
0	int
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
crc32	function
,	O
4	int
)	O
;	O
if	O
(	O
uncompressed_size	long
>=	O
0xffffffff	int
||	O
compressed_size	long long
>=	O
0xffffffff	int
)	O
{	O
if	O
(	O
zi	pointer
->	O
ci	struct
.	O
pos_zip64extrainfo	long long
>	O
0	int
)	O
{	O
if	O
(	O
ZSEEK64	O
(	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
zi	pointer
->	O
ci	struct
.	O
pos_zip64extrainfo	long long
+	O
4	int
,	O
ZLIB_FILEFUNC_SEEK_SET	O
)	O
!=	O
0	int
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
uncompressed_size	long
,	O
8	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
compressed_size	long long
,	O
8	int
)	O
;	O
}	O
else	O
err	int
=	O
ZIP_BADZIPFILE	O
;	O
}	O
else	O
{	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
compressed_size	long long
,	O
4	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
uncompressed_size	long
,	O
4	int
)	O
;	O
}	O
if	O
(	O
ZSEEK64	O
(	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
cur_pos_inzip	long long
,	O
ZLIB_FILEFUNC_SEEK_SET	O
)	O
!=	O
0	int
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
}	O
zi	pointer
->	O
number_entry	long long
++	O
;	O
zi	pointer
->	O
in_opened_file_inzip	int
=	O
0	int
;	O
return	O
err	int
;	O
}	O
extern	O
int	O
ZEXPORT	O
zipCloseFileInZip	function
(	O
zipFile	pointer
file	pointer
)	O
{	O
return	O
zipCloseFileInZipRaw	function
(	O
file	pointer
,	O
0	int
,	O
0	int
)	O
;	O
}	O
int	O
Write_Zip64EndOfCentralDirectoryLocator	function
(	O
zip64_internal	struct
*	O
zi	pointer
,	O
ZPOS64_T	long long
zip64eocd_pos_inzip	long long
)	O
{	O
int	O
err	int
=	O
ZIP_OK	O
;	O
ZPOS64_T	long long
pos	long
=	O
zip64eocd_pos_inzip	long long
-	O
zi	pointer
->	O
add_position_when_writing_offset	long long
;	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
ZIP64ENDLOCHEADERMAGIC	O
,	O
4	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
0	int
,	O
4	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
pos	long
,	O
8	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
1	int
,	O
4	int
)	O
;	O
return	O
err	int
;	O
}	O
int	O
Write_Zip64EndOfCentralDirectoryRecord	function
(	O
zip64_internal	struct
*	O
zi	pointer
,	O
uLong	long
size_centraldir	long
,	O
ZPOS64_T	long long
centraldir_pos_inzip	long long
)	O
{	O
int	O
err	int
=	O
ZIP_OK	O
;	O
uLong	long
Zip64DataSize	long
=	O
44	int
;	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
ZIP64ENDHEADERMAGIC	O
,	O
4	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
ZPOS64_T	long long
)	O
Zip64DataSize	long
,	O
8	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
45	int
,	O
2	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
45	int
,	O
2	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
0	int
,	O
4	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
0	int
,	O
4	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
zi	pointer
->	O
number_entry	long long
,	O
8	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
zi	pointer
->	O
number_entry	long long
,	O
8	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
ZPOS64_T	long long
)	O
size_centraldir	long
,	O
8	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
{	O
ZPOS64_T	long long
pos	long
=	O
centraldir_pos_inzip	long long
-	O
zi	pointer
->	O
add_position_when_writing_offset	long long
;	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
ZPOS64_T	long long
)	O
pos	long
,	O
8	int
)	O
;	O
}	O
return	O
err	int
;	O
}	O
int	O
Write_EndOfCentralDirectoryRecord	function
(	O
zip64_internal	struct
*	O
zi	pointer
,	O
uLong	long
size_centraldir	long
,	O
ZPOS64_T	long long
centraldir_pos_inzip	long long
)	O
{	O
int	O
err	int
=	O
ZIP_OK	O
;	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
ENDHEADERMAGIC	O
,	O
4	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
0	int
,	O
2	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
0	int
,	O
2	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
{	O
{	O
if	O
(	O
zi	pointer
->	O
number_entry	long long
>=	O
0xFFFF	int
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
0xffff	int
,	O
2	int
)	O
;	O
else	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
zi	pointer
->	O
number_entry	long long
,	O
2	int
)	O
;	O
}	O
}	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
{	O
if	O
(	O
zi	pointer
->	O
number_entry	long long
>=	O
0xFFFF	int
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
0xffff	int
,	O
2	int
)	O
;	O
else	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
zi	pointer
->	O
number_entry	long long
,	O
2	int
)	O
;	O
}	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
size_centraldir	long
,	O
4	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
{	O
ZPOS64_T	long long
pos	long
=	O
centraldir_pos_inzip	long long
-	O
zi	pointer
->	O
add_position_when_writing_offset	long long
;	O
if	O
(	O
pos	long
>=	O
0xffffffff	int
)	O
{	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
0xffffffff	int
,	O
4	int
)	O
;	O
}	O
else	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
(	O
centraldir_pos_inzip	long long
-	O
zi	pointer
->	O
add_position_when_writing_offset	long long
)	O
,	O
4	int
)	O
;	O
}	O
return	O
err	int
;	O
}	O
int	O
Write_GlobalComment	function
(	O
zip64_internal	struct
*	O
zi	pointer
,	O
const	O
char	O
*	O
global_comment	pointer
)	O
{	O
int	O
err	int
=	O
ZIP_OK	O
;	O
uInt	int
size_global_comment	int
=	O
0	int
;	O
if	O
(	O
global_comment	pointer
!=	O
NULL	O
)	O
size_global_comment	int
=	O
(	O
uInt	int
)	O
strlen	function
(	O
global_comment	pointer
)	O
;	O
err	int
=	O
zip64local_putValue	function
(	O
&	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
(	O
uLong	long
)	O
size_global_comment	int
,	O
2	int
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
&&	O
size_global_comment	int
>	O
0	int
)	O
{	O
if	O
(	O
ZWRITE64	O
(	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
global_comment	pointer
,	O
size_global_comment	int
)	O
!=	O
size_global_comment	int
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
}	O
return	O
err	int
;	O
}	O
extern	O
int	O
ZEXPORT	O
zipClose	function
(	O
zipFile	pointer
file	pointer
,	O
const	O
char	O
*	O
global_comment	pointer
)	O
{	O
zip64_internal	struct
*	O
zi	pointer
;	O
int	O
err	int
=	O
0	int
;	O
uLong	long
size_centraldir	long
=	O
0	int
;	O
ZPOS64_T	long long
centraldir_pos_inzip	long long
;	O
ZPOS64_T	long long
pos	long
;	O
if	O
(	O
file	pointer
==	O
NULL	O
)	O
return	O
ZIP_PARAMERROR	O
;	O
zi	pointer
=	O
(	O
zip64_internal	struct
*	O
)	O
file	pointer
;	O
if	O
(	O
zi	pointer
->	O
in_opened_file_inzip	int
==	O
1	int
)	O
{	O
err	int
=	O
zipCloseFileInZip	function
(	O
file	pointer
)	O
;	O
}	O
if	O
(	O
global_comment	pointer
==	O
NULL	O
)	O
global_comment	pointer
=	O
zi	pointer
->	O
globalcomment	pointer
;	O
centraldir_pos_inzip	long long
=	O
ZTELL64	O
(	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
{	O
linkedlist_datablock_internal	struct
*	O
ldi	pointer
=	O
zi	pointer
->	O
central_dir	struct
.	O
first_block	pointer
;	O
while	O
(	O
ldi	pointer
!=	O
NULL	O
)	O
{	O
if	O
(	O
(	O
err	int
==	O
ZIP_OK	O
)	O
&&	O
(	O
ldi	pointer
->	O
filled_in_this_block	long
>	O
0	int
)	O
)	O
{	O
if	O
(	O
ZWRITE64	O
(	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
,	O
ldi	pointer
->	O
data	array
,	O
ldi	pointer
->	O
filled_in_this_block	long
)	O
!=	O
ldi	pointer
->	O
filled_in_this_block	long
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
}	O
size_centraldir	long
+=	O
ldi	pointer
->	O
filled_in_this_block	long
;	O
ldi	pointer
=	O
ldi	pointer
->	O
next_datablock	pointer
;	O
}	O
}	O
free_linkedlist	function
(	O
&	O
(	O
zi	pointer
->	O
central_dir	struct
)	O
)	O
;	O
pos	long
=	O
centraldir_pos_inzip	long long
-	O
zi	pointer
->	O
add_position_when_writing_offset	long long
;	O
if	O
(	O
pos	long
>=	O
0xffffffff	int
||	O
zi	pointer
->	O
number_entry	long long
>	O
0xFFFF	int
)	O
{	O
ZPOS64_T	long long
Zip64EOCDpos	long long
=	O
ZTELL64	O
(	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
)	O
;	O
Write_Zip64EndOfCentralDirectoryRecord	function
(	O
zi	pointer
,	O
size_centraldir	long
,	O
centraldir_pos_inzip	long long
)	O
;	O
Write_Zip64EndOfCentralDirectoryLocator	function
(	O
zi	pointer
,	O
Zip64EOCDpos	long long
)	O
;	O
}	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
Write_EndOfCentralDirectoryRecord	function
(	O
zi	pointer
,	O
size_centraldir	long
,	O
centraldir_pos_inzip	long long
)	O
;	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
Write_GlobalComment	function
(	O
zi	pointer
,	O
global_comment	pointer
)	O
;	O
if	O
(	O
ZCLOSE64	O
(	O
zi	pointer
->	O
z_filefunc	struct
,	O
zi	pointer
->	O
filestream	pointer
)	O
!=	O
0	int
)	O
if	O
(	O
err	int
==	O
ZIP_OK	O
)	O
err	int
=	O
ZIP_ERRNO	O
;	O
TRYFREE	O
(	O
zi	pointer
->	O
globalcomment	pointer
)	O
;	O
TRYFREE	O
(	O
zi	pointer
)	O
;	O
return	O
err	int
;	O
}	O
extern	O
int	O
ZEXPORT	O
zipRemoveExtraInfoBlock	function
(	O
char	O
*	O
pData	pointer
,	O
int	O
*	O
dataLen	pointer
,	O
short	O
sHeader	short
)	O
{	O
char	O
*	O
p	pointer
=	O
pData	pointer
;	O
int	O
size	int
=	O
0	int
;	O
char	O
*	O
pNewHeader	pointer
;	O
char	O
*	O
pTmp	pointer
;	O
short	O
header	array
;	O
short	O
dataSize	short
;	O
int	O
retVal	int
=	O
ZIP_OK	O
;	O
if	O
(	O
pData	pointer
==	O
NULL	O
||	O
*	O
dataLen	pointer
<	O
4	int
)	O
return	O
ZIP_PARAMERROR	O
;	O
pNewHeader	pointer
=	O
(	O
char	O
*	O
)	O
ALLOC	O
(	O
*	O
dataLen	pointer
)	O
;	O
pTmp	pointer
=	O
pNewHeader	pointer
;	O
while	O
(	O
p	pointer
<	O
(	O
pData	pointer
+	O
*	O
dataLen	pointer
)	O
)	O
{	O
header	array
=	O
*	O
(	O
short	O
*	O
)	O
p	pointer
;	O
dataSize	short
=	O
*	O
(	O
(	O
(	O
short	O
*	O
)	O
p	pointer
)	O
+	O
1	int
)	O
;	O
if	O
(	O
header	array
==	O
sHeader	short
)	O
{	O
p	pointer
+=	O
dataSize	short
+	O
4	int
;	O
}	O
else	O
{	O
memcpy	function
(	O
pTmp	pointer
,	O
p	pointer
,	O
dataSize	short
+	O
4	int
)	O
;	O
p	pointer
+=	O
dataSize	short
+	O
4	int
;	O
size	int
+=	O
dataSize	short
+	O
4	int
;	O
}	O
}	O
if	O
(	O
size	int
<	O
*	O
dataLen	pointer
)	O
{	O
memset	function
(	O
pData	pointer
,	O
0	int
,	O
*	O
dataLen	pointer
)	O
;	O
if	O
(	O
size	int
>	O
0	int
)	O
memcpy	function
(	O
pData	pointer
,	O
pNewHeader	pointer
,	O
size	int
)	O
;	O
*	O
dataLen	pointer
=	O
size	int
;	O
retVal	int
=	O
ZIP_OK	O
;	O
}	O
else	O
retVal	int
=	O
ZIP_ERRNO	O
;	O
TRYFREE	O
(	O
pNewHeader	pointer
)	O
;	O
return	O
retVal	int
;	O
}	O
