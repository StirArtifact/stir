public	O
char	O
ztags	array
[	O
]	O
=	O
"tags"	pointer
;	O
public	O
char	O
*	O
tags	pointer
=	O
ztags	array
;	O
static	O
int	O
total	int
;	O
static	O
int	O
curseq	int
;	O
extern	O
int	O
linenums	int
;	O
extern	O
int	O
sigs	int
;	O
extern	O
int	O
ctldisp	int
;	O
enum	O
tag_result	enum
{	O
TAG_FOUND	int
,	O
TAG_NOFILE	int
,	O
TAG_NOTAG	int
,	O
TAG_NOTYPE	int
,	O
TAG_INTR	int
}	O
;	O
enum	O
{	O
T_CTAGS	int
,	O
T_CTAGS_X	int
,	O
T_GTAGS	int
,	O
T_GRTAGS	int
,	O
T_GSYMS	int
,	O
T_GPATH	int
}	O
;	O
static	O
enum	O
tag_result	enum
findctag	function
(	O
)	O
;	O
static	O
enum	O
tag_result	enum
findgtag	function
(	O
)	O
;	O
static	O
char	O
*	O
nextgtag	function
(	O
)	O
;	O
static	O
char	O
*	O
prevgtag	function
(	O
)	O
;	O
static	O
POSITION	long
ctagsearch	function
(	O
)	O
;	O
static	O
POSITION	long
gtagsearch	function
(	O
)	O
;	O
static	O
int	O
getentry	function
(	O
)	O
;	O
struct	O
taglist	struct
{	O
struct	O
tag	pointer
*	O
tl_first	pointer
;	O
struct	O
tag	pointer
*	O
tl_last	pointer
;	O
}	O
;	O
struct	O
tag	pointer
{	O
struct	O
tag	pointer
*	O
next	pointer
,	O
*	O
prev	pointer
;	O
char	O
*	O
tag_file	pointer
;	O
LINENUM	long
tag_linenum	long
;	O
char	O
*	O
tag_pattern	pointer
;	O
char	O
tag_endline	char
;	O
}	O
;	O
static	O
struct	O
taglist	struct
taglist	struct
=	O
{	O
TAG_END	O
,	O
TAG_END	O
}	O
;	O
static	O
struct	O
tag	pointer
*	O
curtag	pointer
;	O
public	O
void	O
cleantags	function
(	O
)	O
{	O
struct	O
tag	pointer
*	O
tp	pointer
;	O
while	O
(	O
(	O
tp	pointer
=	O
taglist	struct
.	O
tl_first	pointer
)	O
!=	O
TAG_END	O
)	O
{	O
TAG_RM	O
(	O
tp	pointer
)	O
;	O
free	function
(	O
tp	pointer
->	O
tag_file	pointer
)	O
;	O
free	function
(	O
tp	pointer
->	O
tag_pattern	pointer
)	O
;	O
free	function
(	O
tp	pointer
)	O
;	O
}	O
curtag	pointer
=	O
NULL	O
;	O
total	int
=	O
curseq	int
=	O
0	int
;	O
}	O
static	O
struct	O
tag	pointer
*	O
maketagent	function
(	O
name	pointer
,	O
file	pointer
,	O
linenum	long
,	O
pattern	pointer
,	O
endline	int
)	O
char	O
*	O
name	pointer
;	O
char	O
*	O
file	pointer
;	O
LINENUM	long
linenum	long
;	O
char	O
*	O
pattern	pointer
;	O
int	O
endline	int
;	O
{	O
struct	O
tag	pointer
*	O
tp	pointer
;	O
tp	pointer
=	O
(	O
struct	O
tag	pointer
*	O
)	O
ecalloc	function
(	O
sizeof	O
(	O
struct	O
tag	pointer
)	O
,	O
1	int
)	O
;	O
tp	pointer
->	O
tag_file	pointer
=	O
(	O
char	O
*	O
)	O
ecalloc	function
(	O
strlen	function
(	O
file	pointer
)	O
+	O
1	int
,	O
sizeof	O
(	O
char	O
)	O
)	O
;	O
strcpy	function
(	O
tp	pointer
->	O
tag_file	pointer
,	O
file	pointer
)	O
;	O
tp	pointer
->	O
tag_linenum	long
=	O
linenum	long
;	O
tp	pointer
->	O
tag_endline	char
=	O
endline	int
;	O
if	O
(	O
pattern	pointer
==	O
NULL	O
)	O
tp	pointer
->	O
tag_pattern	pointer
=	O
NULL	O
;	O
else	O
{	O
tp	pointer
->	O
tag_pattern	pointer
=	O
(	O
char	O
*	O
)	O
ecalloc	function
(	O
strlen	function
(	O
pattern	pointer
)	O
+	O
1	int
,	O
sizeof	O
(	O
char	O
)	O
)	O
;	O
strcpy	function
(	O
tp	pointer
->	O
tag_pattern	pointer
,	O
pattern	pointer
)	O
;	O
}	O
return	O
(	O
tp	pointer
)	O
;	O
}	O
public	O
int	O
gettagtype	function
(	O
)	O
{	O
int	O
f	int
;	O
if	O
(	O
strcmp	function
(	O
tags	pointer
,	O
"GTAGS"	pointer
)	O
==	O
0	int
)	O
return	O
T_GTAGS	int
;	O
if	O
(	O
strcmp	function
(	O
tags	pointer
,	O
"GRTAGS"	pointer
)	O
==	O
0	int
)	O
return	O
T_GRTAGS	int
;	O
if	O
(	O
strcmp	function
(	O
tags	pointer
,	O
"GSYMS"	pointer
)	O
==	O
0	int
)	O
return	O
T_GSYMS	int
;	O
if	O
(	O
strcmp	function
(	O
tags	pointer
,	O
"GPATH"	pointer
)	O
==	O
0	int
)	O
return	O
T_GPATH	int
;	O
if	O
(	O
strcmp	function
(	O
tags	pointer
,	O
"-"	pointer
)	O
==	O
0	int
)	O
return	O
T_CTAGS_X	int
;	O
f	int
=	O
open	function
(	O
tags	pointer
,	O
OPEN_READ	O
)	O
;	O
if	O
(	O
f	int
>=	O
0	int
)	O
{	O
close	function
(	O
f	int
)	O
;	O
return	O
T_CTAGS	int
;	O
}	O
return	O
T_GTAGS	int
;	O
}	O
public	O
void	O
findtag	function
(	O
tag	pointer
)	O
char	O
*	O
tag	pointer
;	O
{	O
int	O
type	int
=	O
gettagtype	function
(	O
)	O
;	O
enum	O
tag_result	enum
result	enum
;	O
if	O
(	O
type	int
==	O
T_CTAGS	int
)	O
result	enum
=	O
findctag	function
(	O
tag	pointer
)	O
;	O
else	O
result	enum
=	O
findgtag	function
(	O
tag	pointer
,	O
type	int
)	O
;	O
switch	O
(	O
result	enum
)	O
{	O
case	O
TAG_FOUND	int
:	O
case	O
TAG_INTR	int
:	O
break	O
;	O
case	O
TAG_NOFILE	int
:	O
error	function
(	O
"No tags file"	pointer
,	O
NULL_PARG	O
)	O
;	O
break	O
;	O
case	O
TAG_NOTAG	int
:	O
error	function
(	O
"No such tag in tags file"	pointer
,	O
NULL_PARG	O
)	O
;	O
break	O
;	O
case	O
TAG_NOTYPE	int
:	O
error	function
(	O
"unknown tag type"	pointer
,	O
NULL_PARG	O
)	O
;	O
break	O
;	O
}	O
}	O
public	O
POSITION	long
tagsearch	function
(	O
)	O
{	O
if	O
(	O
curtag	pointer
==	O
NULL	O
)	O
return	O
(	O
NULL_POSITION	O
)	O
;	O
if	O
(	O
curtag	pointer
->	O
tag_linenum	long
!=	O
0	int
)	O
return	O
gtagsearch	function
(	O
)	O
;	O
else	O
return	O
ctagsearch	function
(	O
)	O
;	O
}	O
public	O
char	O
*	O
nexttag	function
(	O
n	int
)	O
int	O
n	int
;	O
{	O
char	O
*	O
tagfile	pointer
=	O
(	O
char	O
*	O
)	O
NULL	O
;	O
while	O
(	O
n	int
--	O
>	O
0	int
)	O
tagfile	pointer
=	O
nextgtag	function
(	O
)	O
;	O
return	O
tagfile	pointer
;	O
}	O
public	O
char	O
*	O
prevtag	function
(	O
n	int
)	O
int	O
n	int
;	O
{	O
char	O
*	O
tagfile	pointer
=	O
(	O
char	O
*	O
)	O
NULL	O
;	O
while	O
(	O
n	int
--	O
>	O
0	int
)	O
tagfile	pointer
=	O
prevgtag	function
(	O
)	O
;	O
return	O
tagfile	pointer
;	O
}	O
public	O
int	O
ntags	function
(	O
)	O
{	O
return	O
total	int
;	O
}	O
public	O
int	O
curr_tag	function
(	O
)	O
{	O
return	O
curseq	int
;	O
}	O
static	O
enum	O
tag_result	enum
findctag	function
(	O
tag	pointer
)	O
char	O
*	O
tag	pointer
;	O
{	O
char	O
*	O
p	pointer
;	O
FILE	struct
*	O
f	int
;	O
int	O
taglen	int
;	O
LINENUM	long
taglinenum	long
;	O
char	O
*	O
tagfile	pointer
;	O
char	O
*	O
tagpattern	pointer
;	O
int	O
tagendline	int
;	O
int	O
search_char	int
;	O
int	O
err	int
;	O
char	O
tline	array
[	O
TAGLINE_SIZE	int
]	O
;	O
struct	O
tag	pointer
*	O
tp	pointer
;	O
p	pointer
=	O
shell_unquote	function
(	O
tags	pointer
)	O
;	O
f	int
=	O
fopen	function
(	O
p	pointer
,	O
"r"	pointer
)	O
;	O
free	function
(	O
p	pointer
)	O
;	O
if	O
(	O
f	int
==	O
NULL	O
)	O
return	O
TAG_NOFILE	int
;	O
cleantags	function
(	O
)	O
;	O
total	int
=	O
0	int
;	O
taglen	int
=	O
(	O
int	O
)	O
strlen	function
(	O
tag	pointer
)	O
;	O
while	O
(	O
fgets	function
(	O
tline	array
,	O
sizeof	O
(	O
tline	array
)	O
,	O
f	int
)	O
!=	O
NULL	O
)	O
{	O
if	O
(	O
tline	array
[	O
0	int
]	O
==	O
'!'	O
)	O
continue	O
;	O
if	O
(	O
strncmp	function
(	O
tag	pointer
,	O
tline	array
,	O
taglen	int
)	O
!=	O
0	int
||	O
!	O
WHITESP	O
(	O
tline	array
[	O
taglen	int
]	O
)	O
)	O
continue	O
;	O
tagpattern	pointer
=	O
NULL	O
;	O
p	pointer
=	O
skipsp	function
(	O
tline	array
+	O
taglen	int
)	O
;	O
if	O
(	O
*	O
p	pointer
==	O
'\0'	O
)	O
continue	O
;	O
tagfile	pointer
=	O
p	pointer
;	O
while	O
(	O
!	O
WHITESP	O
(	O
*	O
p	pointer
)	O
&&	O
*	O
p	pointer
!=	O
'\0'	O
)	O
p	pointer
++	O
;	O
*	O
p	pointer
++	O
=	O
'\0'	O
;	O
p	pointer
=	O
skipsp	function
(	O
p	pointer
)	O
;	O
if	O
(	O
*	O
p	pointer
==	O
'\0'	O
)	O
continue	O
;	O
tagendline	int
=	O
0	int
;	O
taglinenum	long
=	O
getnum	function
(	O
&	O
p	pointer
,	O
0	int
,	O
&	O
err	int
)	O
;	O
if	O
(	O
err	int
)	O
{	O
taglinenum	long
=	O
0	int
;	O
search_char	int
=	O
*	O
p	pointer
++	O
;	O
if	O
(	O
*	O
p	pointer
==	O
'^'	O
)	O
p	pointer
++	O
;	O
tagpattern	pointer
=	O
p	pointer
;	O
while	O
(	O
*	O
p	pointer
!=	O
search_char	int
&&	O
*	O
p	pointer
!=	O
'\0'	O
)	O
{	O
if	O
(	O
*	O
p	pointer
==	O
'\\'	O
)	O
p	pointer
++	O
;	O
p	pointer
++	O
;	O
}	O
tagendline	int
=	O
(	O
p	pointer
[	O
-	O
1	int
]	O
==	O
'$'	O
)	O
;	O
if	O
(	O
tagendline	int
)	O
p	pointer
--	O
;	O
*	O
p	pointer
=	O
'\0'	O
;	O
}	O
tp	pointer
=	O
maketagent	function
(	O
tag	pointer
,	O
tagfile	pointer
,	O
taglinenum	long
,	O
tagpattern	pointer
,	O
tagendline	int
)	O
;	O
TAG_INS	O
(	O
tp	pointer
)	O
;	O
total	int
++	O
;	O
}	O
fclose	function
(	O
f	int
)	O
;	O
if	O
(	O
total	int
==	O
0	int
)	O
return	O
TAG_NOTAG	int
;	O
curtag	pointer
=	O
taglist	struct
.	O
tl_first	pointer
;	O
curseq	int
=	O
1	int
;	O
return	O
TAG_FOUND	int
;	O
}	O
public	O
int	O
edit_tagfile	function
(	O
)	O
{	O
if	O
(	O
curtag	pointer
==	O
NULL	O
)	O
return	O
(	O
1	int
)	O
;	O
return	O
(	O
edit	function
(	O
curtag	pointer
->	O
tag_file	pointer
)	O
)	O
;	O
}	O
static	O
int	O
curtag_match	function
(	O
char	O
const	O
*	O
line	pointer
,	O
POSITION	long
linepos	long
)	O
{	O
int	O
len	int
=	O
(	O
int	O
)	O
strlen	function
(	O
curtag	pointer
->	O
tag_pattern	pointer
)	O
;	O
if	O
(	O
strncmp	function
(	O
curtag	pointer
->	O
tag_pattern	pointer
,	O
line	pointer
,	O
len	int
)	O
==	O
0	int
&&	O
(	O
!	O
curtag	pointer
->	O
tag_endline	char
||	O
line	pointer
[	O
len	int
]	O
==	O
'\0'	O
||	O
line	pointer
[	O
len	int
]	O
==	O
'\r'	O
)	O
)	O
{	O
curtag	pointer
->	O
tag_linenum	long
=	O
find_linenum	function
(	O
linepos	long
)	O
;	O
return	O
1	int
;	O
}	O
return	O
0	int
;	O
}	O
static	O
POSITION	long
ctagsearch	function
(	O
)	O
{	O
POSITION	long
pos	long
,	O
linepos	long
;	O
LINENUM	long
linenum	long
;	O
int	O
line_len	int
;	O
char	O
*	O
line	pointer
;	O
int	O
found	int
;	O
pos	long
=	O
ch_zero	O
(	O
)	O
;	O
linenum	long
=	O
find_linenum	function
(	O
pos	long
)	O
;	O
for	O
(	O
found	int
=	O
0	int
;	O
!	O
found	int
;	O
)	O
{	O
if	O
(	O
ABORT_SIGS	O
(	O
)	O
)	O
return	O
(	O
NULL_POSITION	O
)	O
;	O
linepos	long
=	O
pos	long
;	O
pos	long
=	O
forw_raw_line	function
(	O
pos	long
,	O
&	O
line	pointer
,	O
&	O
line_len	int
)	O
;	O
if	O
(	O
linenum	long
!=	O
0	int
)	O
linenum	long
++	O
;	O
if	O
(	O
pos	long
==	O
NULL_POSITION	O
)	O
{	O
error	function
(	O
"Tag not found"	pointer
,	O
NULL_PARG	O
)	O
;	O
return	O
(	O
NULL_POSITION	O
)	O
;	O
}	O
if	O
(	O
linenums	int
)	O
add_lnum	function
(	O
linenum	long
,	O
pos	long
)	O
;	O
if	O
(	O
ctldisp	int
!=	O
OPT_ONPLUS	int
)	O
{	O
if	O
(	O
curtag_match	function
(	O
line	pointer
,	O
linepos	long
)	O
)	O
found	int
=	O
1	int
;	O
}	O
else	O
{	O
int	O
cvt_ops	int
=	O
CVT_ANSI	int
;	O
int	O
cvt_len	int
=	O
cvt_length	function
(	O
line_len	int
,	O
cvt_ops	int
)	O
;	O
int	O
*	O
chpos	pointer
=	O
cvt_alloc_chpos	function
(	O
cvt_len	int
)	O
;	O
char	O
*	O
cline	pointer
=	O
(	O
char	O
*	O
)	O
ecalloc	function
(	O
1	int
,	O
cvt_len	int
)	O
;	O
cvt_text	function
(	O
cline	pointer
,	O
line	pointer
,	O
chpos	pointer
,	O
&	O
line_len	int
,	O
cvt_ops	int
)	O
;	O
if	O
(	O
curtag_match	function
(	O
cline	pointer
,	O
linepos	long
)	O
)	O
found	int
=	O
1	int
;	O
free	function
(	O
chpos	pointer
)	O
;	O
free	function
(	O
cline	pointer
)	O
;	O
}	O
}	O
return	O
(	O
linepos	long
)	O
;	O
}	O
static	O
enum	O
tag_result	enum
findgtag	function
(	O
tag	pointer
,	O
type	int
)	O
char	O
*	O
tag	pointer
;	O
int	O
type	int
;	O
{	O
char	O
buf	pointer
[	O
256	int
]	O
;	O
FILE	struct
*	O
fp	pointer
;	O
struct	O
tag	pointer
*	O
tp	pointer
;	O
if	O
(	O
type	int
!=	O
T_CTAGS_X	int
&&	O
tag	pointer
==	O
NULL	O
)	O
return	O
TAG_NOFILE	int
;	O
cleantags	function
(	O
)	O
;	O
total	int
=	O
0	int
;	O
if	O
(	O
type	int
==	O
T_CTAGS_X	int
)	O
{	O
fp	pointer
=	O
stdin	pointer
;	O
tags	pointer
=	O
ztags	array
;	O
}	O
else	O
{	O
char	O
*	O
command	pointer
;	O
char	O
*	O
flag	pointer
;	O
char	O
*	O
qtag	pointer
;	O
char	O
*	O
cmd	pointer
=	O
lgetenv	function
(	O
"LESSGLOBALTAGS"	pointer
)	O
;	O
if	O
(	O
cmd	pointer
==	O
NULL	O
||	O
*	O
cmd	pointer
==	O
'\0'	O
)	O
return	O
TAG_NOFILE	int
;	O
switch	O
(	O
type	int
)	O
{	O
case	O
T_GTAGS	int
:	O
flag	pointer
=	O
""	pointer
;	O
break	O
;	O
case	O
T_GRTAGS	int
:	O
flag	pointer
=	O
"r"	pointer
;	O
break	O
;	O
case	O
T_GSYMS	int
:	O
flag	pointer
=	O
"s"	pointer
;	O
break	O
;	O
case	O
T_GPATH	int
:	O
flag	pointer
=	O
"P"	pointer
;	O
break	O
;	O
default	O
:	O
return	O
TAG_NOTYPE	int
;	O
}	O
qtag	pointer
=	O
shell_quote	function
(	O
tag	pointer
)	O
;	O
if	O
(	O
qtag	pointer
==	O
NULL	O
)	O
qtag	pointer
=	O
tag	pointer
;	O
command	pointer
=	O
(	O
char	O
*	O
)	O
ecalloc	function
(	O
strlen	function
(	O
cmd	pointer
)	O
+	O
strlen	function
(	O
flag	pointer
)	O
+	O
strlen	function
(	O
qtag	pointer
)	O
+	O
5	int
,	O
sizeof	O
(	O
char	O
)	O
)	O
;	O
sprintf	function
(	O
command	pointer
,	O
"%s -x%s %s"	pointer
,	O
cmd	pointer
,	O
flag	pointer
,	O
qtag	pointer
)	O
;	O
if	O
(	O
qtag	pointer
!=	O
tag	pointer
)	O
free	function
(	O
qtag	pointer
)	O
;	O
fp	pointer
=	O
popen	function
(	O
command	pointer
,	O
"r"	pointer
)	O
;	O
free	function
(	O
command	pointer
)	O
;	O
}	O
if	O
(	O
fp	pointer
!=	O
NULL	O
)	O
{	O
while	O
(	O
fgets	function
(	O
buf	pointer
,	O
sizeof	O
(	O
buf	pointer
)	O
,	O
fp	pointer
)	O
)	O
{	O
char	O
*	O
name	pointer
,	O
*	O
file	pointer
,	O
*	O
line	pointer
;	O
int	O
len	int
;	O
if	O
(	O
sigs	int
)	O
{	O
if	O
(	O
fp	pointer
!=	O
stdin	pointer
)	O
pclose	function
(	O
fp	pointer
)	O
;	O
return	O
TAG_INTR	int
;	O
}	O
len	int
=	O
(	O
int	O
)	O
strlen	function
(	O
buf	pointer
)	O
;	O
if	O
(	O
len	int
>	O
0	int
&&	O
buf	pointer
[	O
len	int
-	O
1	int
]	O
==	O
'\n'	O
)	O
buf	pointer
[	O
len	int
-	O
1	int
]	O
=	O
'\0'	O
;	O
else	O
{	O
int	O
c	int
;	O
do	O
{	O
c	int
=	O
fgetc	function
(	O
fp	pointer
)	O
;	O
}	O
while	O
(	O
c	int
!=	O
'\n'	O
&&	O
c	int
!=	O
EOF	O
)	O
;	O
}	O
if	O
(	O
getentry	function
(	O
buf	pointer
,	O
&	O
name	pointer
,	O
&	O
file	pointer
,	O
&	O
line	pointer
)	O
)	O
{	O
break	O
;	O
}	O
tp	pointer
=	O
maketagent	function
(	O
name	pointer
,	O
file	pointer
,	O
(	O
LINENUM	long
)	O
atoi	function
(	O
line	pointer
)	O
,	O
NULL	O
,	O
0	int
)	O
;	O
TAG_INS	O
(	O
tp	pointer
)	O
;	O
total	int
++	O
;	O
}	O
if	O
(	O
fp	pointer
!=	O
stdin	pointer
)	O
{	O
if	O
(	O
pclose	function
(	O
fp	pointer
)	O
)	O
{	O
curtag	pointer
=	O
NULL	O
;	O
total	int
=	O
curseq	int
=	O
0	int
;	O
return	O
TAG_NOFILE	int
;	O
}	O
}	O
}	O
tp	pointer
=	O
taglist	struct
.	O
tl_first	pointer
;	O
if	O
(	O
tp	pointer
==	O
TAG_END	O
)	O
return	O
TAG_NOTAG	int
;	O
curtag	pointer
=	O
tp	pointer
;	O
curseq	int
=	O
1	int
;	O
return	O
TAG_FOUND	int
;	O
}	O
static	O
int	O
circular	int
=	O
0	int
;	O
static	O
char	O
*	O
nextgtag	function
(	O
)	O
{	O
struct	O
tag	pointer
*	O
tp	pointer
;	O
if	O
(	O
curtag	pointer
==	O
NULL	O
)	O
return	O
NULL	O
;	O
tp	pointer
=	O
curtag	pointer
->	O
next	pointer
;	O
if	O
(	O
tp	pointer
==	O
TAG_END	O
)	O
{	O
if	O
(	O
!	O
circular	int
)	O
return	O
NULL	O
;	O
curtag	pointer
=	O
taglist	struct
.	O
tl_first	pointer
;	O
curseq	int
=	O
1	int
;	O
}	O
else	O
{	O
curtag	pointer
=	O
tp	pointer
;	O
curseq	int
++	O
;	O
}	O
return	O
(	O
curtag	pointer
->	O
tag_file	pointer
)	O
;	O
}	O
static	O
char	O
*	O
prevgtag	function
(	O
)	O
{	O
struct	O
tag	pointer
*	O
tp	pointer
;	O
if	O
(	O
curtag	pointer
==	O
NULL	O
)	O
return	O
NULL	O
;	O
tp	pointer
=	O
curtag	pointer
->	O
prev	pointer
;	O
if	O
(	O
tp	pointer
==	O
TAG_END	O
)	O
{	O
if	O
(	O
!	O
circular	int
)	O
return	O
NULL	O
;	O
curtag	pointer
=	O
taglist	struct
.	O
tl_last	pointer
;	O
curseq	int
=	O
total	int
;	O
}	O
else	O
{	O
curtag	pointer
=	O
tp	pointer
;	O
curseq	int
--	O
;	O
}	O
return	O
(	O
curtag	pointer
->	O
tag_file	pointer
)	O
;	O
}	O
static	O
POSITION	long
gtagsearch	function
(	O
)	O
{	O
if	O
(	O
curtag	pointer
==	O
NULL	O
)	O
return	O
(	O
NULL_POSITION	O
)	O
;	O
return	O
(	O
find_pos	function
(	O
curtag	pointer
->	O
tag_linenum	long
)	O
)	O
;	O
}	O
static	O
int	O
getentry	function
(	O
buf	pointer
,	O
tag	pointer
,	O
file	pointer
,	O
line	pointer
)	O
char	O
*	O
buf	pointer
;	O
char	O
*	O
*	O
tag	pointer
;	O
char	O
*	O
*	O
file	pointer
;	O
char	O
*	O
*	O
line	pointer
;	O
{	O
char	O
*	O
p	pointer
=	O
buf	pointer
;	O
for	O
(	O
*	O
tag	pointer
=	O
p	pointer
;	O
*	O
p	pointer
&&	O
!	O
IS_SPACE	O
(	O
*	O
p	pointer
)	O
;	O
p	pointer
++	O
)	O
;	O
if	O
(	O
*	O
p	pointer
==	O
0	int
)	O
return	O
(	O
-	O
1	int
)	O
;	O
*	O
p	pointer
++	O
=	O
0	int
;	O
for	O
(	O
;	O
*	O
p	pointer
&&	O
IS_SPACE	O
(	O
*	O
p	pointer
)	O
;	O
p	pointer
++	O
)	O
;	O
if	O
(	O
*	O
p	pointer
==	O
0	int
)	O
return	O
(	O
-	O
1	int
)	O
;	O
if	O
(	O
!	O
IS_DIGIT	O
(	O
*	O
p	pointer
)	O
)	O
{	O
for	O
(	O
;	O
*	O
p	pointer
&&	O
!	O
IS_SPACE	O
(	O
*	O
p	pointer
)	O
;	O
p	pointer
++	O
)	O
;	O
for	O
(	O
;	O
*	O
p	pointer
&&	O
IS_SPACE	O
(	O
*	O
p	pointer
)	O
;	O
p	pointer
++	O
)	O
;	O
}	O
if	O
(	O
!	O
IS_DIGIT	O
(	O
*	O
p	pointer
)	O
)	O
return	O
(	O
-	O
1	int
)	O
;	O
*	O
line	pointer
=	O
p	pointer
;	O
for	O
(	O
*	O
line	pointer
=	O
p	pointer
;	O
*	O
p	pointer
&&	O
!	O
IS_SPACE	O
(	O
*	O
p	pointer
)	O
;	O
p	pointer
++	O
)	O
;	O
if	O
(	O
*	O
p	pointer
==	O
0	int
)	O
return	O
(	O
-	O
1	int
)	O
;	O
*	O
p	pointer
++	O
=	O
0	int
;	O
for	O
(	O
;	O
*	O
p	pointer
&&	O
IS_SPACE	O
(	O
*	O
p	pointer
)	O
;	O
p	pointer
++	O
)	O
;	O
if	O
(	O
*	O
p	pointer
==	O
0	int
)	O
return	O
(	O
-	O
1	int
)	O
;	O
*	O
file	pointer
=	O
p	pointer
;	O
for	O
(	O
*	O
file	pointer
=	O
p	pointer
;	O
*	O
p	pointer
&&	O
!	O
IS_SPACE	O
(	O
*	O
p	pointer
)	O
;	O
p	pointer
++	O
)	O
;	O
if	O
(	O
*	O
p	pointer
==	O
0	int
)	O
return	O
(	O
-	O
1	int
)	O
;	O
*	O
p	pointer
=	O
0	int
;	O
if	O
(	O
strlen	function
(	O
*	O
tag	pointer
)	O
&&	O
strlen	function
(	O
*	O
line	pointer
)	O
&&	O
strlen	function
(	O
*	O
file	pointer
)	O
&&	O
atoi	function
(	O
*	O
line	pointer
)	O
>	O
0	int
)	O
return	O
(	O
0	int
)	O
;	O
return	O
(	O
-	O
1	int
)	O
;	O
}	O
