static	O
const	O
unsigned	O
char	O
http_ctype	array
[	O
256	int
]	O
=	O
{	O
[	O
'('	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
')'	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
'<'	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
'>'	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
'@'	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
','	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
';'	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
':'	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
'\\'	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
'\"'	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
'/'	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
'['	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
']'	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
'?'	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
'='	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
'{'	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
'}'	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
' '	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
,	O
[	O
'\t'	O
]	O
=	O
HTTP_CTYPE_SEPARATOR	O
}	O
;	O
const	O
char	O
*	O
wget_http_get_host	function
(	O
const	O
wget_http_connection	struct
*	O
conn	pointer
)	O
{	O
return	O
conn	pointer
->	O
esc_host	struct
;	O
}	O
uint16_t	short
wget_http_get_port	function
(	O
const	O
wget_http_connection	struct
*	O
conn	pointer
)	O
{	O
return	O
conn	pointer
->	O
port	short
;	O
}	O
wget_iri_scheme	enum
wget_http_get_scheme	function
(	O
const	O
wget_http_connection	struct
*	O
conn	pointer
)	O
{	O
return	O
conn	pointer
->	O
scheme	enum
;	O
}	O
int	O
wget_http_get_protocol	function
(	O
const	O
wget_http_connection	struct
*	O
conn	pointer
)	O
{	O
return	O
conn	pointer
->	O
protocol	int
;	O
}	O
bool	bool
wget_http_isseparator	function
(	O
char	O
c	int
)	O
{	O
return	O
_http_isseparator	O
(	O
c	int
)	O
;	O
}	O
bool	bool
wget_http_istoken	function
(	O
char	O
c	int
)	O
{	O
return	O
c	int
>	O
32	int
&&	O
c	int
<=	O
126	int
&&	O
!	O
_http_isseparator	O
(	O
c	int
)	O
;	O
}	O
const	O
char	O
*	O
wget_http_parse_token	function
(	O
const	O
char	O
*	O
s	pointer
,	O
const	O
char	O
*	O
*	O
token	pointer
)	O
{	O
const	O
char	O
*	O
p	pointer
;	O
for	O
(	O
p	pointer
=	O
s	pointer
;	O
wget_http_istoken	function
(	O
*	O
s	pointer
)	O
;	O
s	pointer
++	O
)	O
;	O
*	O
token	pointer
=	O
wget_strmemdup	function
(	O
p	pointer
,	O
s	pointer
-	O
p	pointer
)	O
;	O
return	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_quoted_string	function
(	O
const	O
char	O
*	O
s	pointer
,	O
const	O
char	O
*	O
*	O
qstring	pointer
)	O
{	O
if	O
(	O
*	O
s	pointer
==	O
'\"'	O
)	O
{	O
const	O
char	O
*	O
p	pointer
=	O
++	O
s	pointer
;	O
while	O
(	O
*	O
s	pointer
)	O
{	O
if	O
(	O
*	O
s	pointer
==	O
'\"'	O
)	O
break	O
;	O
else	O
if	O
(	O
*	O
s	pointer
==	O
'\\'	O
&&	O
s	pointer
[	O
1	int
]	O
)	O
{	O
s	pointer
+=	O
2	int
;	O
}	O
else	O
s	pointer
++	O
;	O
}	O
*	O
qstring	pointer
=	O
wget_strmemdup	function
(	O
p	pointer
,	O
s	pointer
-	O
p	pointer
)	O
;	O
if	O
(	O
*	O
s	pointer
==	O
'\"'	O
)	O
s	pointer
++	O
;	O
}	O
else	O
*	O
qstring	pointer
=	O
NULL	O
;	O
return	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_param	function
(	O
const	O
char	O
*	O
s	pointer
,	O
const	O
char	O
*	O
*	O
param	pointer
,	O
const	O
char	O
*	O
*	O
value	pointer
)	O
{	O
const	O
char	O
*	O
p	pointer
;	O
*	O
param	pointer
=	O
*	O
value	pointer
=	O
NULL	O
;	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
if	O
(	O
*	O
s	pointer
==	O
';'	O
)	O
{	O
s	pointer
++	O
;	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
}	O
if	O
(	O
!	O
*	O
s	pointer
)	O
return	O
s	pointer
;	O
for	O
(	O
p	pointer
=	O
s	pointer
;	O
wget_http_istoken	function
(	O
*	O
s	pointer
)	O
;	O
s	pointer
++	O
)	O
;	O
*	O
param	pointer
=	O
wget_strmemdup	function
(	O
p	pointer
,	O
s	pointer
-	O
p	pointer
)	O
;	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
if	O
(	O
*	O
s	pointer
&&	O
*	O
s	pointer
++	O
==	O
'='	O
)	O
{	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
if	O
(	O
*	O
s	pointer
==	O
'\"'	O
)	O
{	O
s	pointer
=	O
wget_http_parse_quoted_string	function
(	O
s	pointer
,	O
value	pointer
)	O
;	O
}	O
else	O
{	O
s	pointer
=	O
wget_http_parse_token	function
(	O
s	pointer
,	O
value	pointer
)	O
;	O
}	O
}	O
return	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_name	function
(	O
const	O
char	O
*	O
s	pointer
,	O
const	O
char	O
*	O
*	O
name	pointer
)	O
{	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
s	pointer
=	O
wget_http_parse_token	function
(	O
s	pointer
,	O
name	pointer
)	O
;	O
while	O
(	O
*	O
s	pointer
&&	O
*	O
s	pointer
!=	O
':'	O
)	O
s	pointer
++	O
;	O
return	O
*	O
s	pointer
==	O
':'	O
?	O
s	pointer
+	O
1	int
:	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_parse_name_fixed	function
(	O
const	O
char	O
*	O
s	pointer
,	O
const	O
char	O
*	O
*	O
name	pointer
,	O
size_t	long
*	O
namelen	pointer
)	O
{	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
*	O
name	pointer
=	O
s	pointer
;	O
while	O
(	O
wget_http_istoken	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
*	O
namelen	pointer
=	O
s	pointer
-	O
*	O
name	pointer
;	O
while	O
(	O
*	O
s	pointer
&&	O
*	O
s	pointer
!=	O
':'	O
)	O
s	pointer
++	O
;	O
return	O
*	O
s	pointer
==	O
':'	O
?	O
s	pointer
+	O
1	int
:	O
s	pointer
;	O
}	O
static	O
int	O
WGET_GCC_NONNULL_ALL	O
compare_param	function
(	O
wget_http_header_param	struct
*	O
p1	pointer
,	O
wget_http_header_param	struct
*	O
p2	pointer
)	O
{	O
return	O
wget_strcasecmp_ascii	function
(	O
p1	pointer
->	O
name	pointer
,	O
p2	pointer
->	O
name	pointer
)	O
;	O
}	O
void	O
wget_http_add_param	function
(	O
wget_vector	struct
*	O
*	O
params	pointer
,	O
wget_http_header_param	struct
*	O
param	pointer
)	O
{	O
if	O
(	O
!	O
*	O
params	pointer
)	O
*	O
params	pointer
=	O
wget_vector_create	function
(	O
4	int
,	O
(	O
wget_vector_compare_fn	function
*	O
)	O
compare_param	function
)	O
;	O
wget_vector_add_memdup	function
(	O
*	O
params	pointer
,	O
param	pointer
,	O
sizeof	O
(	O
*	O
param	pointer
)	O
)	O
;	O
}	O
const	O
char	O
*	O
wget_http_parse_link	function
(	O
const	O
char	O
*	O
s	pointer
,	O
wget_http_link	struct
*	O
link	function
)	O
{	O
memset	function
(	O
link	function
,	O
0	int
,	O
sizeof	O
(	O
*	O
link	function
)	O
)	O
;	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
if	O
(	O
*	O
s	pointer
==	O
'<'	O
)	O
{	O
const	O
char	O
*	O
p	pointer
=	O
s	pointer
+	O
1	int
;	O
if	O
(	O
(	O
s	pointer
=	O
strchr	function
(	O
p	pointer
,	O
'>'	O
)	O
)	O
!=	O
NULL	O
)	O
{	O
const	O
char	O
*	O
name	pointer
=	O
NULL	O
,	O
*	O
value	pointer
=	O
NULL	O
;	O
link	function
->	O
uri	pointer
=	O
wget_strmemdup	function
(	O
p	pointer
,	O
s	pointer
-	O
p	pointer
)	O
;	O
s	pointer
++	O
;	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
while	O
(	O
*	O
s	pointer
==	O
';'	O
)	O
{	O
s	pointer
=	O
wget_http_parse_param	function
(	O
s	pointer
,	O
&	O
name	pointer
,	O
&	O
value	pointer
)	O
;	O
if	O
(	O
name	pointer
&&	O
value	pointer
)	O
{	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
name	pointer
,	O
"rel"	pointer
)	O
)	O
{	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
value	pointer
,	O
"describedby"	pointer
)	O
)	O
link	function
->	O
rel	enum
=	O
link_rel_describedby	int
;	O
else	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
value	pointer
,	O
"duplicate"	pointer
)	O
)	O
link	function
->	O
rel	enum
=	O
link_rel_duplicate	int
;	O
}	O
else	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
name	pointer
,	O
"pri"	pointer
)	O
)	O
{	O
link	function
->	O
pri	int
=	O
atoi	function
(	O
value	pointer
)	O
;	O
}	O
else	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
name	pointer
,	O
"type"	pointer
)	O
)	O
{	O
if	O
(	O
!	O
link	function
->	O
type	pointer
)	O
{	O
link	function
->	O
type	pointer
=	O
value	pointer
;	O
value	pointer
=	O
NULL	O
;	O
}	O
}	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
}	O
xfree	O
(	O
name	pointer
)	O
;	O
xfree	O
(	O
value	pointer
)	O
;	O
}	O
while	O
(	O
*	O
s	pointer
&&	O
!	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
}	O
}	O
return	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_digest	function
(	O
const	O
char	O
*	O
s	pointer
,	O
wget_http_digest	struct
*	O
digest	pointer
)	O
{	O
memset	function
(	O
digest	pointer
,	O
0	int
,	O
sizeof	O
(	O
*	O
digest	pointer
)	O
)	O
;	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
s	pointer
=	O
wget_http_parse_token	function
(	O
s	pointer
,	O
&	O
digest	pointer
->	O
algorithm	pointer
)	O
;	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
if	O
(	O
*	O
s	pointer
==	O
'='	O
)	O
{	O
s	pointer
++	O
;	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
if	O
(	O
*	O
s	pointer
==	O
'\"'	O
)	O
{	O
s	pointer
=	O
wget_http_parse_quoted_string	function
(	O
s	pointer
,	O
&	O
digest	pointer
->	O
encoded_digest	pointer
)	O
;	O
}	O
else	O
{	O
const	O
char	O
*	O
p	pointer
;	O
for	O
(	O
p	pointer
=	O
s	pointer
;	O
*	O
s	pointer
&&	O
!	O
c_isblank	function
(	O
*	O
s	pointer
)	O
&&	O
*	O
s	pointer
!=	O
','	O
&&	O
*	O
s	pointer
!=	O
';'	O
;	O
s	pointer
++	O
)	O
;	O
digest	pointer
->	O
encoded_digest	pointer
=	O
wget_strmemdup	function
(	O
p	pointer
,	O
s	pointer
-	O
p	pointer
)	O
;	O
}	O
}	O
while	O
(	O
*	O
s	pointer
&&	O
!	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
return	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_challenge	function
(	O
const	O
char	O
*	O
s	pointer
,	O
wget_http_challenge	struct
*	O
challenge	pointer
)	O
{	O
memset	function
(	O
challenge	pointer
,	O
0	int
,	O
sizeof	O
(	O
*	O
challenge	pointer
)	O
)	O
;	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
s	pointer
=	O
wget_http_parse_token	function
(	O
s	pointer
,	O
&	O
challenge	pointer
->	O
auth_scheme	pointer
)	O
;	O
if	O
(	O
*	O
s	pointer
==	O
' '	O
)	O
s	pointer
++	O
;	O
else	O
{	O
xfree	O
(	O
challenge	pointer
->	O
auth_scheme	pointer
)	O
;	O
return	O
s	pointer
;	O
}	O
wget_http_header_param	struct
param	pointer
;	O
do	O
{	O
const	O
char	O
*	O
old	pointer
=	O
s	pointer
;	O
s	pointer
=	O
wget_http_parse_param	function
(	O
s	pointer
,	O
&	O
param	pointer
.	O
name	pointer
,	O
&	O
param	pointer
.	O
value	pointer
)	O
;	O
if	O
(	O
param	pointer
.	O
name	pointer
)	O
{	O
if	O
(	O
*	O
param	pointer
.	O
name	pointer
&&	O
!	O
param	pointer
.	O
value	pointer
)	O
{	O
xfree	O
(	O
param	pointer
.	O
name	pointer
)	O
;	O
return	O
old	pointer
;	O
}	O
if	O
(	O
!	O
param	pointer
.	O
value	pointer
)	O
{	O
xfree	O
(	O
param	pointer
.	O
name	pointer
)	O
;	O
continue	O
;	O
}	O
if	O
(	O
!	O
challenge	pointer
->	O
params	pointer
)	O
challenge	pointer
->	O
params	pointer
=	O
wget_stringmap_create_nocase	function
(	O
8	int
)	O
;	O
wget_stringmap_put	function
(	O
challenge	pointer
->	O
params	pointer
,	O
param	pointer
.	O
name	pointer
,	O
param	pointer
.	O
value	pointer
)	O
;	O
}	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
if	O
(	O
*	O
s	pointer
!=	O
','	O
)	O
break	O
;	O
else	O
if	O
(	O
*	O
s	pointer
)	O
s	pointer
++	O
;	O
}	O
while	O
(	O
*	O
s	pointer
)	O
;	O
return	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_challenges	function
(	O
const	O
char	O
*	O
s	pointer
,	O
wget_vector	struct
*	O
challenges	pointer
)	O
{	O
wget_http_challenge	struct
challenge	pointer
;	O
while	O
(	O
*	O
s	pointer
)	O
{	O
s	pointer
=	O
wget_http_parse_challenge	function
(	O
s	pointer
,	O
&	O
challenge	pointer
)	O
;	O
if	O
(	O
challenge	pointer
.	O
auth_scheme	pointer
)	O
{	O
wget_vector_add_memdup	function
(	O
challenges	pointer
,	O
&	O
challenge	pointer
,	O
sizeof	O
(	O
challenge	pointer
)	O
)	O
;	O
}	O
}	O
return	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_location	function
(	O
const	O
char	O
*	O
s	pointer
,	O
const	O
char	O
*	O
*	O
location	pointer
)	O
{	O
const	O
char	O
*	O
p	pointer
;	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
for	O
(	O
p	pointer
=	O
s	pointer
;	O
*	O
s	pointer
&&	O
*	O
s	pointer
!=	O
'\r'	O
&&	O
*	O
s	pointer
!=	O
'\n'	O
;	O
s	pointer
++	O
)	O
;	O
while	O
(	O
s	pointer
>	O
p	pointer
&&	O
c_isblank	function
(	O
*	O
(	O
s	pointer
-	O
1	int
)	O
)	O
)	O
s	pointer
--	O
;	O
*	O
location	pointer
=	O
wget_strmemdup	function
(	O
p	pointer
,	O
s	pointer
-	O
p	pointer
)	O
;	O
return	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_transfer_encoding	function
(	O
const	O
char	O
*	O
s	pointer
,	O
wget_transfer_encoding	enum
*	O
transfer_encoding	enum
)	O
{	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
s	pointer
,	O
"identity"	pointer
)	O
)	O
*	O
transfer_encoding	enum
=	O
wget_transfer_encoding_identity	int
;	O
else	O
*	O
transfer_encoding	enum
=	O
wget_transfer_encoding_chunked	int
;	O
while	O
(	O
wget_http_istoken	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
return	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_content_type	function
(	O
const	O
char	O
*	O
s	pointer
,	O
const	O
char	O
*	O
*	O
content_type	pointer
,	O
const	O
char	O
*	O
*	O
charset	pointer
)	O
{	O
wget_http_header_param	struct
param	pointer
;	O
const	O
char	O
*	O
p	pointer
;	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
for	O
(	O
p	pointer
=	O
s	pointer
;	O
*	O
s	pointer
&&	O
(	O
wget_http_istoken	function
(	O
*	O
s	pointer
)	O
||	O
*	O
s	pointer
==	O
'/'	O
)	O
;	O
s	pointer
++	O
)	O
;	O
if	O
(	O
content_type	pointer
)	O
*	O
content_type	pointer
=	O
wget_strmemdup	function
(	O
p	pointer
,	O
s	pointer
-	O
p	pointer
)	O
;	O
if	O
(	O
charset	pointer
)	O
{	O
*	O
charset	pointer
=	O
NULL	O
;	O
while	O
(	O
*	O
s	pointer
)	O
{	O
s	pointer
=	O
wget_http_parse_param	function
(	O
s	pointer
,	O
&	O
param	pointer
.	O
name	pointer
,	O
&	O
param	pointer
.	O
value	pointer
)	O
;	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
"charset"	pointer
,	O
param	pointer
.	O
name	pointer
)	O
)	O
{	O
xfree	O
(	O
param	pointer
.	O
name	pointer
)	O
;	O
*	O
charset	pointer
=	O
param	pointer
.	O
value	pointer
;	O
break	O
;	O
}	O
xfree	O
(	O
param	pointer
.	O
name	pointer
)	O
;	O
xfree	O
(	O
param	pointer
.	O
value	pointer
)	O
;	O
}	O
}	O
return	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_content_disposition	function
(	O
const	O
char	O
*	O
s	pointer
,	O
const	O
char	O
*	O
*	O
filename	pointer
)	O
{	O
wget_http_header_param	struct
param	pointer
;	O
char	O
*	O
p	pointer
;	O
if	O
(	O
filename	pointer
)	O
{	O
*	O
filename	pointer
=	O
NULL	O
;	O
while	O
(	O
*	O
s	pointer
&&	O
!	O
*	O
filename	pointer
)	O
{	O
s	pointer
=	O
wget_http_parse_param	function
(	O
s	pointer
,	O
&	O
param	pointer
.	O
name	pointer
,	O
&	O
param	pointer
.	O
value	pointer
)	O
;	O
if	O
(	O
param	pointer
.	O
value	pointer
&&	O
!	O
wget_strcasecmp_ascii	function
(	O
"filename"	pointer
,	O
param	pointer
.	O
name	pointer
)	O
)	O
{	O
if	O
(	O
!	O
*	O
filename	pointer
)	O
{	O
if	O
(	O
(	O
p	pointer
=	O
strpbrk	function
(	O
param	pointer
.	O
value	pointer
,	O
"/\\"	pointer
)	O
)	O
)	O
{	O
p	pointer
=	O
wget_strdup	function
(	O
p	pointer
+	O
1	int
)	O
;	O
}	O
else	O
{	O
p	pointer
=	O
(	O
char	O
*	O
)	O
param	pointer
.	O
value	pointer
;	O
param	pointer
.	O
value	pointer
=	O
NULL	O
;	O
}	O
wget_percent_unescape	function
(	O
p	pointer
)	O
;	O
if	O
(	O
!	O
wget_str_is_valid_utf8	function
(	O
p	pointer
)	O
)	O
{	O
*	O
filename	pointer
=	O
wget_str_to_utf8	function
(	O
p	pointer
,	O
"iso-8859-1"	pointer
)	O
;	O
xfree	O
(	O
p	pointer
)	O
;	O
}	O
else	O
{	O
*	O
filename	pointer
=	O
p	pointer
;	O
p	pointer
=	O
NULL	O
;	O
}	O
}	O
}	O
else	O
if	O
(	O
param	pointer
.	O
value	pointer
&&	O
!	O
wget_strcasecmp_ascii	function
(	O
"filename*"	pointer
,	O
param	pointer
.	O
name	pointer
)	O
)	O
{	O
if	O
(	O
(	O
p	pointer
=	O
strchr	function
(	O
param	pointer
.	O
value	pointer
,	O
'\''	O
)	O
)	O
)	O
{	O
const	O
char	O
*	O
charset	pointer
=	O
param	pointer
.	O
value	pointer
;	O
const	O
char	O
*	O
language	pointer
=	O
p	pointer
+	O
1	int
;	O
*	O
p	pointer
=	O
0	int
;	O
if	O
(	O
(	O
p	pointer
=	O
strchr	function
(	O
language	pointer
,	O
'\''	O
)	O
)	O
)	O
{	O
*	O
p	pointer
++	O
=	O
0	int
;	O
if	O
(	O
*	O
p	pointer
)	O
{	O
wget_percent_unescape	function
(	O
p	pointer
)	O
;	O
if	O
(	O
wget_str_needs_encoding	function
(	O
p	pointer
)	O
)	O
*	O
filename	pointer
=	O
wget_str_to_utf8	function
(	O
p	pointer
,	O
charset	pointer
)	O
;	O
else	O
*	O
filename	pointer
=	O
wget_strdup	function
(	O
p	pointer
)	O
;	O
if	O
(	O
*	O
filename	pointer
&&	O
(	O
p	pointer
=	O
strpbrk	function
(	O
*	O
filename	pointer
,	O
"/\\"	pointer
)	O
)	O
)	O
{	O
p	pointer
=	O
wget_strdup	function
(	O
p	pointer
+	O
1	int
)	O
;	O
xfree	O
(	O
*	O
filename	pointer
)	O
;	O
*	O
filename	pointer
=	O
p	pointer
;	O
}	O
xfree	O
(	O
param	pointer
.	O
name	pointer
)	O
;	O
xfree	O
(	O
param	pointer
.	O
value	pointer
)	O
;	O
break	O
;	O
}	O
}	O
}	O
}	O
xfree	O
(	O
param	pointer
.	O
name	pointer
)	O
;	O
xfree	O
(	O
param	pointer
.	O
value	pointer
)	O
;	O
}	O
}	O
return	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_public_key_pins	function
(	O
const	O
char	O
*	O
s	pointer
,	O
wget_hpkp	struct
*	O
hpkp	pointer
)	O
{	O
wget_http_header_param	struct
param	pointer
;	O
wget_hpkp_set_include_subdomains	function
(	O
hpkp	pointer
,	O
false	int
)	O
;	O
while	O
(	O
*	O
s	pointer
)	O
{	O
s	pointer
=	O
wget_http_parse_param	function
(	O
s	pointer
,	O
&	O
param	pointer
.	O
name	pointer
,	O
&	O
param	pointer
.	O
value	pointer
)	O
;	O
if	O
(	O
param	pointer
.	O
value	pointer
)	O
{	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
param	pointer
.	O
name	pointer
,	O
"max-age"	pointer
)	O
)	O
{	O
wget_hpkp_set_maxage	function
(	O
hpkp	pointer
,	O
(	O
time_t	long
)	O
atoll	function
(	O
param	pointer
.	O
value	pointer
)	O
)	O
;	O
}	O
else	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
param	pointer
.	O
name	pointer
,	O
"pin-"	pointer
,	O
4	int
)	O
)	O
{	O
wget_hpkp_pin_add	function
(	O
hpkp	pointer
,	O
param	pointer
.	O
name	pointer
+	O
4	int
,	O
param	pointer
.	O
value	pointer
)	O
;	O
}	O
}	O
else	O
{	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
param	pointer
.	O
name	pointer
,	O
"includeSubDomains"	pointer
)	O
)	O
wget_hpkp_set_include_subdomains	function
(	O
hpkp	pointer
,	O
true	int
)	O
;	O
}	O
xfree	O
(	O
param	pointer
.	O
name	pointer
)	O
;	O
xfree	O
(	O
param	pointer
.	O
value	pointer
)	O
;	O
}	O
return	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_strict_transport_security	function
(	O
const	O
char	O
*	O
s	pointer
,	O
time_t	long
*	O
maxage	long
,	O
char	O
*	O
include_subdomains	int
)	O
{	O
wget_http_header_param	struct
param	pointer
;	O
*	O
maxage	long
=	O
0	int
;	O
*	O
include_subdomains	int
=	O
0	int
;	O
while	O
(	O
*	O
s	pointer
)	O
{	O
s	pointer
=	O
wget_http_parse_param	function
(	O
s	pointer
,	O
&	O
param	pointer
.	O
name	pointer
,	O
&	O
param	pointer
.	O
value	pointer
)	O
;	O
if	O
(	O
param	pointer
.	O
value	pointer
)	O
{	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
param	pointer
.	O
name	pointer
,	O
"max-age"	pointer
)	O
)	O
{	O
*	O
maxage	long
=	O
(	O
time_t	long
)	O
atoll	function
(	O
param	pointer
.	O
value	pointer
)	O
;	O
}	O
}	O
else	O
{	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
param	pointer
.	O
name	pointer
,	O
"includeSubDomains"	pointer
)	O
)	O
{	O
*	O
include_subdomains	int
=	O
1	int
;	O
}	O
}	O
xfree	O
(	O
param	pointer
.	O
name	pointer
)	O
;	O
xfree	O
(	O
param	pointer
.	O
value	pointer
)	O
;	O
}	O
return	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_content_encoding	function
(	O
const	O
char	O
*	O
s	pointer
,	O
char	O
*	O
content_encoding	char
)	O
{	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
s	pointer
,	O
"gzip"	pointer
)	O
||	O
!	O
wget_strcasecmp_ascii	function
(	O
s	pointer
,	O
"x-gzip"	pointer
)	O
)	O
*	O
content_encoding	char
=	O
wget_content_encoding_gzip	int
;	O
else	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
s	pointer
,	O
"deflate"	pointer
)	O
)	O
*	O
content_encoding	char
=	O
wget_content_encoding_deflate	int
;	O
else	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
s	pointer
,	O
"bzip2"	pointer
)	O
)	O
*	O
content_encoding	char
=	O
wget_content_encoding_bzip2	int
;	O
else	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
s	pointer
,	O
"xz"	pointer
)	O
||	O
!	O
wget_strcasecmp_ascii	function
(	O
s	pointer
,	O
"lzma"	pointer
)	O
||	O
!	O
wget_strcasecmp_ascii	function
(	O
s	pointer
,	O
"x-lzma"	pointer
)	O
)	O
*	O
content_encoding	char
=	O
wget_content_encoding_lzma	int
;	O
else	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
s	pointer
,	O
"br"	pointer
)	O
)	O
*	O
content_encoding	char
=	O
wget_content_encoding_brotli	int
;	O
else	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
s	pointer
,	O
"zstd"	pointer
)	O
)	O
*	O
content_encoding	char
=	O
wget_content_encoding_zstd	int
;	O
else	O
*	O
content_encoding	char
=	O
wget_content_encoding_identity	int
;	O
while	O
(	O
wget_http_istoken	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
return	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_connection	function
(	O
const	O
char	O
*	O
s	pointer
,	O
char	O
*	O
keep_alive	char
)	O
{	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
s	pointer
,	O
"keep-alive"	pointer
)	O
)	O
*	O
keep_alive	char
=	O
1	int
;	O
else	O
*	O
keep_alive	char
=	O
0	int
;	O
while	O
(	O
wget_http_istoken	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
return	O
s	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_etag	function
(	O
const	O
char	O
*	O
s	pointer
,	O
const	O
char	O
*	O
*	O
etag	pointer
)	O
{	O
const	O
char	O
*	O
p	pointer
;	O
while	O
(	O
c_isblank	function
(	O
*	O
s	pointer
)	O
)	O
s	pointer
++	O
;	O
for	O
(	O
p	pointer
=	O
s	pointer
;	O
*	O
s	pointer
&&	O
!	O
c_isblank	function
(	O
*	O
s	pointer
)	O
;	O
s	pointer
++	O
)	O
;	O
*	O
etag	pointer
=	O
wget_strmemdup	function
(	O
p	pointer
,	O
s	pointer
-	O
p	pointer
)	O
;	O
return	O
s	pointer
;	O
}	O
static	O
int	O
leap_days	function
(	O
int	O
y1	int
,	O
int	O
y2	int
)	O
{	O
y1	int
--	O
;	O
y2	int
--	O
;	O
return	O
(	O
y2	int
/	O
4	int
-	O
y1	int
/	O
4	int
)	O
-	O
(	O
y2	int
/	O
100	int
-	O
y1	int
/	O
100	int
)	O
+	O
(	O
y2	int
/	O
400	int
-	O
y1	int
/	O
400	int
)	O
;	O
}	O
time_t	long
wget_http_parse_full_date	function
(	O
const	O
char	O
*	O
s	pointer
)	O
{	O
static	O
const	O
char	O
*	O
mnames	array
[	O
12	int
]	O
=	O
{	O
"Jan"	pointer
,	O
"Feb"	pointer
,	O
"Mar"	pointer
,	O
"Apr"	pointer
,	O
"May"	pointer
,	O
"Jun"	pointer
,	O
"Jul"	pointer
,	O
"Aug"	pointer
,	O
"Sep"	pointer
,	O
"Oct"	pointer
,	O
"Nov"	pointer
,	O
"Dec"	pointer
}	O
;	O
static	O
int	O
days_per_month	array
[	O
12	int
]	O
=	O
{	O
31	int
,	O
28	int
,	O
31	int
,	O
30	int
,	O
31	int
,	O
30	int
,	O
31	int
,	O
31	int
,	O
30	int
,	O
31	int
,	O
30	int
,	O
31	int
}	O
;	O
static	O
const	O
int	O
sum_of_days	array
[	O
12	int
]	O
=	O
{	O
0	int
,	O
31	int
,	O
59	int
,	O
90	int
,	O
120	int
,	O
151	int
,	O
181	int
,	O
212	int
,	O
243	int
,	O
273	int
,	O
304	int
,	O
334	int
}	O
;	O
int	O
day	int
,	O
mon	int
=	O
0	int
,	O
year	int
,	O
hour	int
,	O
min	int
,	O
sec	int
,	O
leap_month	int
,	O
leap_year	int
,	O
days	int
;	O
char	O
mname	array
[	O
4	int
]	O
=	O
""	pointer
;	O
if	O
(	O
sscanf	function
(	O
s	pointer
,	O
" %*[a-zA-Z], %02d %3s %4d %2d:%2d:%2d"	pointer
,	O
&	O
day	int
,	O
mname	array
,	O
&	O
year	int
,	O
&	O
hour	int
,	O
&	O
min	int
,	O
&	O
sec	int
)	O
>=	O
6	int
)	O
{	O
}	O
else	O
if	O
(	O
sscanf	function
(	O
s	pointer
,	O
" %*[a-zA-Z], %2d-%3s-%4d %2d:%2d:%2d"	pointer
,	O
&	O
day	int
,	O
mname	array
,	O
&	O
year	int
,	O
&	O
hour	int
,	O
&	O
min	int
,	O
&	O
sec	int
)	O
>=	O
6	int
)	O
{	O
}	O
else	O
if	O
(	O
sscanf	function
(	O
s	pointer
,	O
" %*[a-zA-Z] %3s %2d %2d:%2d:%2d %4d"	pointer
,	O
mname	array
,	O
&	O
day	int
,	O
&	O
hour	int
,	O
&	O
min	int
,	O
&	O
sec	int
,	O
&	O
year	int
)	O
>=	O
6	int
)	O
{	O
}	O
else	O
if	O
(	O
sscanf	function
(	O
s	pointer
,	O
" %d %3s %4d %2d:%2d:%2d"	pointer
,	O
&	O
day	int
,	O
mname	array
,	O
&	O
year	int
,	O
&	O
hour	int
,	O
&	O
min	int
,	O
&	O
sec	int
)	O
>=	O
6	int
)	O
{	O
}	O
else	O
{	O
error_printf	O
(	O
_	O
(	O
"Failed to parse date '%s'\n"	pointer
)	O
,	O
s	pointer
)	O
;	O
return	O
0	int
;	O
}	O
if	O
(	O
*	O
mname	array
)	O
{	O
unsigned	O
it	int
;	O
for	O
(	O
it	int
=	O
0	int
;	O
it	int
<	O
countof	O
(	O
mnames	array
)	O
;	O
it	int
++	O
)	O
{	O
if	O
(	O
!	O
wget_strcasecmp_ascii	function
(	O
mname	array
,	O
mnames	array
[	O
it	int
]	O
)	O
)	O
{	O
mon	int
=	O
it	int
+	O
1	int
;	O
break	O
;	O
}	O
}	O
}	O
if	O
(	O
year	int
<	O
70	int
&&	O
year	int
>=	O
0	int
)	O
year	int
+=	O
2000	int
;	O
else	O
if	O
(	O
year	int
>=	O
70	int
&&	O
year	int
<=	O
99	int
)	O
year	int
+=	O
1900	int
;	O
if	O
(	O
year	int
<	O
1970	int
)	O
year	int
=	O
1970	int
;	O
leap_year	int
=	O
year	int
%	O
4	int
==	O
0	int
&&	O
(	O
year	int
%	O
100	int
!=	O
0	int
||	O
year	int
%	O
400	int
==	O
0	int
)	O
;	O
leap_month	int
=	O
(	O
mon	int
==	O
2	int
&&	O
leap_year	int
)	O
;	O
if	O
(	O
mon	int
<	O
1	int
||	O
mon	int
>	O
12	int
||	O
day	int
<	O
1	int
||	O
(	O
day	int
>	O
days_per_month	array
[	O
mon	int
-	O
1	int
]	O
+	O
leap_month	int
)	O
||	O
hour	int
<	O
0	int
||	O
hour	int
>	O
23	int
||	O
min	int
<	O
0	int
||	O
min	int
>	O
60	int
||	O
sec	int
<	O
0	int
||	O
sec	int
>	O
60	int
)	O
{	O
error_printf	O
(	O
_	O
(	O
"Failed to parse date '%s'\n"	pointer
)	O
,	O
s	pointer
)	O
;	O
return	O
0	int
;	O
}	O
days	int
=	O
365	int
*	O
(	O
year	int
-	O
1970	int
)	O
+	O
leap_days	function
(	O
1970	int
,	O
year	int
)	O
;	O
days	int
+=	O
sum_of_days	array
[	O
mon	int
-	O
1	int
]	O
+	O
(	O
mon	int
>	O
2	int
&&	O
leap_year	int
)	O
;	O
days	int
+=	O
day	int
-	O
1	int
;	O
return	O
(	O
(	O
(	O
time_t	long
)	O
days	int
*	O
24	int
+	O
hour	int
)	O
*	O
60	int
+	O
min	int
)	O
*	O
60	int
+	O
sec	int
;	O
}	O
char	O
*	O
wget_http_print_date	function
(	O
time_t	long
t	long
,	O
char	O
*	O
buf	pointer
,	O
size_t	long
bufsize	long
)	O
{	O
static	O
const	O
char	O
*	O
dnames	array
[	O
7	int
]	O
=	O
{	O
"Sun"	pointer
,	O
"Mon"	pointer
,	O
"Tue"	pointer
,	O
"Wed"	pointer
,	O
"Thu"	pointer
,	O
"Fri"	pointer
,	O
"Sat"	pointer
}	O
;	O
static	O
const	O
char	O
*	O
mnames	array
[	O
12	int
]	O
=	O
{	O
"Jan"	pointer
,	O
"Feb"	pointer
,	O
"Mar"	pointer
,	O
"Apr"	pointer
,	O
"May"	pointer
,	O
"Jun"	pointer
,	O
"Jul"	pointer
,	O
"Aug"	pointer
,	O
"Sep"	pointer
,	O
"Oct"	pointer
,	O
"Nov"	pointer
,	O
"Dec"	pointer
}	O
;	O
struct	O
tm	struct
tm	struct
;	O
if	O
(	O
!	O
bufsize	long
)	O
return	O
buf	pointer
;	O
if	O
(	O
gmtime_r	function
(	O
&	O
t	long
,	O
&	O
tm	struct
)	O
)	O
{	O
wget_snprintf	function
(	O
buf	pointer
,	O
bufsize	long
,	O
"%s, %02d %s %d %02d:%02d:%02d GMT"	pointer
,	O
dnames	array
[	O
tm	struct
.	O
tm_wday	int
]	O
,	O
tm	struct
.	O
tm_mday	int
,	O
mnames	array
[	O
tm	struct
.	O
tm_mon	int
]	O
,	O
tm	struct
.	O
tm_year	int
+	O
1900	int
,	O
tm	struct
.	O
tm_hour	int
,	O
tm	struct
.	O
tm_min	int
,	O
tm	struct
.	O
tm_sec	int
)	O
;	O
}	O
else	O
*	O
buf	pointer
=	O
0	int
;	O
return	O
buf	pointer
;	O
}	O
const	O
char	O
*	O
wget_http_parse_setcookie	function
(	O
const	O
char	O
*	O
s	pointer
,	O
wget_cookie	struct
*	O
*	O
cookie	pointer
)	O
{	O
return	O
wget_cookie_parse_setcookie	function
(	O
s	pointer
,	O
cookie	pointer
)	O
;	O
}	O
static	O
void	O
cookie_free	function
(	O
void	O
*	O
cookie	pointer
)	O
{	O
if	O
(	O
cookie	pointer
)	O
wget_cookie_free	function
(	O
(	O
wget_cookie	struct
*	O
*	O
)	O
&	O
cookie	pointer
)	O
;	O
}	O
int	O
wget_http_parse_header_line	function
(	O
wget_http_response	struct
*	O
resp	pointer
,	O
const	O
char	O
*	O
name	pointer
,	O
size_t	long
namelen	pointer
,	O
const	O
char	O
*	O
value	pointer
,	O
size_t	long
valuelen	long
)	O
{	O
if	O
(	O
!	O
name	pointer
||	O
!	O
value	pointer
)	O
return	O
WGET_E_INVALID	int
;	O
char	O
valuebuf	array
[	O
256	int
]	O
;	O
char	O
*	O
value0	pointer
;	O
int	O
ret	int
=	O
WGET_E_SUCCESS	int
;	O
if	O
(	O
valuelen	long
<	O
sizeof	O
(	O
valuebuf	array
)	O
)	O
{	O
wget_strmemcpy	function
(	O
value0	pointer
=	O
valuebuf	array
,	O
sizeof	O
(	O
valuebuf	array
)	O
,	O
value	pointer
,	O
valuelen	long
)	O
;	O
}	O
else	O
{	O
if	O
(	O
!	O
(	O
value0	pointer
=	O
wget_strmemdup	function
(	O
value	pointer
,	O
valuelen	long
)	O
)	O
)	O
return	O
WGET_E_MEMORY	int
;	O
}	O
switch	O
(	O
*	O
name	pointer
|	O
0x20	int
)	O
{	O
case	O
':'	O
:	O
if	O
(	O
!	O
memcmp	function
(	O
name	pointer
,	O
":status"	pointer
,	O
namelen	pointer
)	O
&&	O
valuelen	long
==	O
3	int
)	O
{	O
resp	pointer
->	O
code	short
=	O
(	O
(	O
value	pointer
[	O
0	int
]	O
-	O
'0'	O
)	O
*	O
10	int
+	O
(	O
value	pointer
[	O
1	int
]	O
-	O
'0'	O
)	O
)	O
*	O
10	int
+	O
(	O
value	pointer
[	O
2	int
]	O
-	O
'0'	O
)	O
;	O
}	O
else	O
ret	int
=	O
WGET_E_UNKNOWN	int
;	O
break	O
;	O
case	O
'c'	O
:	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"content-encoding"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
wget_http_parse_content_encoding	function
(	O
value0	pointer
,	O
&	O
resp	pointer
->	O
content_encoding	char
)	O
;	O
}	O
else	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"content-type"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
if	O
(	O
!	O
resp	pointer
->	O
content_type	pointer
&&	O
!	O
resp	pointer
->	O
content_type_encoding	pointer
)	O
wget_http_parse_content_type	function
(	O
value0	pointer
,	O
&	O
resp	pointer
->	O
content_type	pointer
,	O
&	O
resp	pointer
->	O
content_type_encoding	pointer
)	O
;	O
}	O
else	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"content-length"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
resp	pointer
->	O
content_length	long
=	O
(	O
size_t	long
)	O
atoll	function
(	O
value0	pointer
)	O
;	O
resp	pointer
->	O
content_length_valid	bool
=	O
1	int
;	O
}	O
else	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"content-disposition"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
if	O
(	O
!	O
resp	pointer
->	O
content_filename	pointer
)	O
wget_http_parse_content_disposition	function
(	O
value0	pointer
,	O
&	O
resp	pointer
->	O
content_filename	pointer
)	O
;	O
}	O
else	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"connection"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
wget_http_parse_connection	function
(	O
value0	pointer
,	O
&	O
resp	pointer
->	O
keep_alive	char
)	O
;	O
}	O
else	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"Content-Security-Policy"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
resp	pointer
->	O
csp	bool
=	O
1	int
;	O
}	O
else	O
ret	int
=	O
WGET_E_UNKNOWN	int
;	O
break	O
;	O
case	O
'd'	O
:	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"digest"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
wget_http_digest	struct
digest	pointer
;	O
wget_http_parse_digest	function
(	O
value0	pointer
,	O
&	O
digest	pointer
)	O
;	O
if	O
(	O
!	O
resp	pointer
->	O
digests	pointer
)	O
{	O
resp	pointer
->	O
digests	pointer
=	O
wget_vector_create	function
(	O
4	int
,	O
NULL	O
)	O
;	O
wget_vector_set_destructor	function
(	O
resp	pointer
->	O
digests	pointer
,	O
(	O
wget_vector_destructor	function
*	O
)	O
wget_http_free_digest	function
)	O
;	O
}	O
wget_vector_add_memdup	function
(	O
resp	pointer
->	O
digests	pointer
,	O
&	O
digest	pointer
,	O
sizeof	O
(	O
digest	pointer
)	O
)	O
;	O
}	O
else	O
ret	int
=	O
WGET_E_UNKNOWN	int
;	O
break	O
;	O
case	O
'e'	O
:	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"etag"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
if	O
(	O
!	O
resp	pointer
->	O
etag	pointer
)	O
wget_http_parse_etag	function
(	O
value0	pointer
,	O
&	O
resp	pointer
->	O
etag	pointer
)	O
;	O
}	O
else	O
ret	int
=	O
WGET_E_UNKNOWN	int
;	O
break	O
;	O
case	O
'i'	O
:	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"icy-metaint"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
resp	pointer
->	O
icy_metaint	int
=	O
atoi	function
(	O
value0	pointer
)	O
;	O
}	O
else	O
ret	int
=	O
WGET_E_UNKNOWN	int
;	O
break	O
;	O
case	O
'l'	O
:	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"last-modified"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
resp	pointer
->	O
last_modified	long
=	O
wget_http_parse_full_date	function
(	O
value0	pointer
)	O
;	O
}	O
else	O
if	O
(	O
resp	pointer
->	O
code	short
/	O
100	int
==	O
3	int
&&	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"location"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
if	O
(	O
!	O
resp	pointer
->	O
location	pointer
)	O
wget_http_parse_location	function
(	O
value0	pointer
,	O
&	O
resp	pointer
->	O
location	pointer
)	O
;	O
}	O
else	O
if	O
(	O
resp	pointer
->	O
code	short
/	O
100	int
==	O
3	int
&&	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"link"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
wget_http_link	struct
link	function
;	O
wget_http_parse_link	function
(	O
value0	pointer
,	O
&	O
link	function
)	O
;	O
if	O
(	O
!	O
resp	pointer
->	O
links	pointer
)	O
{	O
resp	pointer
->	O
links	pointer
=	O
wget_vector_create	function
(	O
8	int
,	O
NULL	O
)	O
;	O
wget_vector_set_destructor	function
(	O
resp	pointer
->	O
links	pointer
,	O
(	O
wget_vector_destructor	function
*	O
)	O
wget_http_free_link	function
)	O
;	O
}	O
wget_vector_add_memdup	function
(	O
resp	pointer
->	O
links	pointer
,	O
&	O
link	function
,	O
sizeof	O
(	O
link	function
)	O
)	O
;	O
}	O
else	O
ret	int
=	O
WGET_E_UNKNOWN	int
;	O
break	O
;	O
case	O
'p'	O
:	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"public-key-pins"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
if	O
(	O
!	O
resp	pointer
->	O
hpkp	pointer
)	O
{	O
resp	pointer
->	O
hpkp	pointer
=	O
wget_hpkp_new	function
(	O
)	O
;	O
wget_http_parse_public_key_pins	function
(	O
value0	pointer
,	O
resp	pointer
->	O
hpkp	pointer
)	O
;	O
debug_printf	O
(	O
"new host pubkey pinnings added to hpkp db\n"	pointer
)	O
;	O
}	O
}	O
else	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"proxy-authenticate"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
wget_http_challenge	struct
*	O
challenge	pointer
=	O
wget_malloc	function
(	O
sizeof	O
(	O
wget_http_challenge	struct
)	O
)	O
;	O
if	O
(	O
!	O
challenge	pointer
)	O
{	O
ret	int
=	O
WGET_E_MEMORY	int
;	O
goto	O
out	pointer
;	O
}	O
wget_http_parse_challenge	function
(	O
value0	pointer
,	O
challenge	pointer
)	O
;	O
if	O
(	O
!	O
resp	pointer
->	O
challenges	pointer
)	O
{	O
resp	pointer
->	O
challenges	pointer
=	O
wget_vector_create	function
(	O
2	int
,	O
NULL	O
)	O
;	O
wget_vector_set_destructor	function
(	O
resp	pointer
->	O
challenges	pointer
,	O
(	O
wget_vector_destructor	function
*	O
)	O
wget_http_free_challenge	function
)	O
;	O
}	O
wget_vector_add	function
(	O
resp	pointer
->	O
challenges	pointer
,	O
challenge	pointer
)	O
;	O
}	O
else	O
ret	int
=	O
WGET_E_UNKNOWN	int
;	O
break	O
;	O
case	O
's'	O
:	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"set-cookie"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
wget_cookie	struct
*	O
cookie	pointer
;	O
wget_http_parse_setcookie	function
(	O
value0	pointer
,	O
&	O
cookie	pointer
)	O
;	O
if	O
(	O
cookie	pointer
)	O
{	O
if	O
(	O
!	O
resp	pointer
->	O
cookies	pointer
)	O
{	O
resp	pointer
->	O
cookies	pointer
=	O
wget_vector_create	function
(	O
4	int
,	O
NULL	O
)	O
;	O
wget_vector_set_destructor	function
(	O
resp	pointer
->	O
cookies	pointer
,	O
cookie_free	function
)	O
;	O
}	O
wget_vector_add	function
(	O
resp	pointer
->	O
cookies	pointer
,	O
cookie	pointer
)	O
;	O
}	O
}	O
else	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"strict-transport-security"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
resp	pointer
->	O
hsts	bool
=	O
1	int
;	O
wget_http_parse_strict_transport_security	function
(	O
value0	pointer
,	O
&	O
resp	pointer
->	O
hsts_maxage	long
,	O
&	O
resp	pointer
->	O
hsts_include_subdomains	char
)	O
;	O
}	O
else	O
ret	int
=	O
WGET_E_UNKNOWN	int
;	O
break	O
;	O
case	O
't'	O
:	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"transfer-encoding"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
wget_http_parse_transfer_encoding	function
(	O
value0	pointer
,	O
&	O
resp	pointer
->	O
transfer_encoding	enum
)	O
;	O
}	O
else	O
ret	int
=	O
WGET_E_UNKNOWN	int
;	O
break	O
;	O
case	O
'w'	O
:	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"www-authenticate"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
wget_http_challenge	struct
*	O
challenge	pointer
=	O
wget_malloc	function
(	O
sizeof	O
(	O
wget_http_challenge	struct
)	O
)	O
;	O
if	O
(	O
!	O
challenge	pointer
)	O
{	O
ret	int
=	O
WGET_E_MEMORY	int
;	O
goto	O
out	pointer
;	O
}	O
wget_http_parse_challenge	function
(	O
value0	pointer
,	O
challenge	pointer
)	O
;	O
if	O
(	O
!	O
resp	pointer
->	O
challenges	pointer
)	O
{	O
resp	pointer
->	O
challenges	pointer
=	O
wget_vector_create	function
(	O
2	int
,	O
NULL	O
)	O
;	O
wget_vector_set_destructor	function
(	O
resp	pointer
->	O
challenges	pointer
,	O
(	O
wget_vector_destructor	function
*	O
)	O
wget_http_free_challenge	function
)	O
;	O
}	O
wget_vector_add	function
(	O
resp	pointer
->	O
challenges	pointer
,	O
challenge	pointer
)	O
;	O
}	O
else	O
ret	int
=	O
WGET_E_UNKNOWN	int
;	O
break	O
;	O
case	O
'x'	O
:	O
if	O
(	O
!	O
wget_strncasecmp_ascii	function
(	O
name	pointer
,	O
"x-archive-orig-last-modified"	pointer
,	O
namelen	pointer
)	O
)	O
{	O
resp	pointer
->	O
last_modified	long
=	O
wget_http_parse_full_date	function
(	O
value0	pointer
)	O
;	O
}	O
else	O
ret	int
=	O
WGET_E_UNKNOWN	int
;	O
break	O
;	O
default	O
:	O
ret	int
=	O
WGET_E_UNKNOWN	int
;	O
break	O
;	O
}	O
out	pointer
:	O
if	O
(	O
value0	pointer
!=	O
valuebuf	array
)	O
xfree	O
(	O
value0	pointer
)	O
;	O
return	O
ret	int
;	O
}	O
wget_http_response	struct
*	O
wget_http_parse_response_header	function
(	O
char	O
*	O
buf	pointer
)	O
{	O
char	O
*	O
eol	pointer
;	O
wget_http_response	struct
*	O
resp	pointer
=	O
wget_calloc	function
(	O
1	int
,	O
sizeof	O
(	O
wget_http_response	struct
)	O
)	O
;	O
if	O
(	O
!	O
resp	pointer
)	O
return	O
NULL	O
;	O
if	O
(	O
sscanf	function
(	O
buf	pointer
,	O
" HTTP/%3hd.%3hd %3hd %31[^\r\n] "	pointer
,	O
&	O
resp	pointer
->	O
major	short
,	O
&	O
resp	pointer
->	O
minor	short
,	O
&	O
resp	pointer
->	O
code	short
,	O
resp	pointer
->	O
reason	array
)	O
>=	O
3	int
)	O
{	O
if	O
(	O
(	O
eol	pointer
=	O
strchr	function
(	O
buf	pointer
+	O
10	int
,	O
'\n'	O
)	O
)	O
)	O
{	O
}	O
else	O
{	O
return	O
resp	pointer
;	O
}	O
}	O
else	O
if	O
(	O
sscanf	function
(	O
buf	pointer
,	O
" ICY %3hd %31[^\r\n] "	pointer
,	O
&	O
resp	pointer
->	O
code	short
,	O
resp	pointer
->	O
reason	array
)	O
>=	O
1	int
)	O
{	O
if	O
(	O
(	O
eol	pointer
=	O
strchr	function
(	O
buf	pointer
+	O
4	int
,	O
'\n'	O
)	O
)	O
)	O
{	O
}	O
else	O
{	O
return	O
resp	pointer
;	O
}	O
}	O
else	O
{	O
error_printf	O
(	O
_	O
(	O
"HTTP response header not found\n"	pointer
)	O
)	O
;	O
xfree	O
(	O
resp	pointer
)	O
;	O
return	O
NULL	O
;	O
}	O
for	O
(	O
char	O
*	O
line	pointer
=	O
eol	pointer
+	O
1	int
;	O
eol	pointer
&&	O
*	O
line	pointer
&&	O
*	O
line	pointer
!=	O
'\r'	O
&&	O
*	O
line	pointer
!=	O
'\n'	O
;	O
line	pointer
=	O
eol	pointer
+	O
1	int
)	O
{	O
eol	pointer
=	O
strchr	function
(	O
line	pointer
,	O
'\n'	O
)	O
;	O
while	O
(	O
eol	pointer
&&	O
c_isblank	function
(	O
eol	pointer
[	O
1	int
]	O
)	O
)	O
{	O
*	O
eol	pointer
=	O
eol	pointer
[	O
-	O
1	int
]	O
=	O
' '	O
;	O
eol	pointer
=	O
strchr	function
(	O
eol	pointer
,	O
'\n'	O
)	O
;	O
}	O
if	O
(	O
eol	pointer
)	O
{	O
if	O
(	O
eol	pointer
[	O
-	O
1	int
]	O
==	O
'\r'	O
)	O
eol	pointer
[	O
-	O
1	int
]	O
=	O
0	int
;	O
else	O
*	O
eol	pointer
=	O
0	int
;	O
}	O
size_t	long
namelen	pointer
,	O
valuelen	long
;	O
const	O
char	O
*	O
name	pointer
;	O
const	O
char	O
*	O
value	pointer
=	O
wget_parse_name_fixed	function
(	O
line	pointer
,	O
&	O
name	pointer
,	O
&	O
namelen	pointer
)	O
;	O
if	O
(	O
eol	pointer
)	O
valuelen	long
=	O
eol	pointer
-	O
value	pointer
-	O
(	O
eol	pointer
[	O
-	O
1	int
]	O
==	O
0	int
)	O
;	O
else	O
valuelen	long
=	O
strlen	function
(	O
value	pointer
)	O
;	O
wget_http_parse_header_line	function
(	O
resp	pointer
,	O
name	pointer
,	O
namelen	pointer
,	O
value	pointer
,	O
valuelen	long
)	O
;	O
}	O
return	O
resp	pointer
;	O
}	O
void	O
wget_http_free_param	function
(	O
wget_http_header_param	struct
*	O
param	pointer
)	O
{	O
xfree	O
(	O
param	pointer
->	O
name	pointer
)	O
;	O
xfree	O
(	O
param	pointer
->	O
value	pointer
)	O
;	O
xfree	O
(	O
param	pointer
)	O
;	O
}	O
void	O
wget_http_free_link	function
(	O
wget_http_link	struct
*	O
link	function
)	O
{	O
xfree	O
(	O
link	function
->	O
uri	pointer
)	O
;	O
xfree	O
(	O
link	function
->	O
type	pointer
)	O
;	O
xfree	O
(	O
link	function
)	O
;	O
}	O
void	O
wget_http_free_links	function
(	O
wget_vector	struct
*	O
*	O
links	pointer
)	O
{	O
wget_vector_free	function
(	O
links	pointer
)	O
;	O
}	O
void	O
wget_http_free_digest	function
(	O
wget_http_digest	struct
*	O
digest	pointer
)	O
{	O
xfree	O
(	O
digest	pointer
->	O
algorithm	pointer
)	O
;	O
xfree	O
(	O
digest	pointer
->	O
encoded_digest	pointer
)	O
;	O
xfree	O
(	O
digest	pointer
)	O
;	O
}	O
void	O
wget_http_free_digests	function
(	O
wget_vector	struct
*	O
*	O
digests	pointer
)	O
{	O
wget_vector_free	function
(	O
digests	pointer
)	O
;	O
}	O
void	O
wget_http_free_challenge	function
(	O
wget_http_challenge	struct
*	O
challenge	pointer
)	O
{	O
xfree	O
(	O
challenge	pointer
->	O
auth_scheme	pointer
)	O
;	O
wget_stringmap_free	function
(	O
&	O
challenge	pointer
->	O
params	pointer
)	O
;	O
xfree	O
(	O
challenge	pointer
)	O
;	O
}	O
void	O
wget_http_free_challenges	function
(	O
wget_vector	struct
*	O
*	O
challenges	pointer
)	O
{	O
wget_vector_free	function
(	O
challenges	pointer
)	O
;	O
}	O
void	O
wget_http_free_cookies	function
(	O
wget_vector	struct
*	O
*	O
cookies	pointer
)	O
{	O
wget_vector_free	function
(	O
cookies	pointer
)	O
;	O
}	O
void	O
wget_http_free_hpkp_entries	function
(	O
wget_hpkp	struct
*	O
*	O
hpkp	pointer
)	O
{	O
if	O
(	O
hpkp	pointer
)	O
{	O
wget_hpkp_free	function
(	O
*	O
hpkp	pointer
)	O
;	O
*	O
hpkp	pointer
=	O
NULL	O
;	O
}	O
}	O
void	O
wget_http_free_response	function
(	O
wget_http_response	struct
*	O
*	O
resp	pointer
)	O
{	O
if	O
(	O
resp	pointer
&&	O
*	O
resp	pointer
)	O
{	O
wget_http_free_links	function
(	O
&	O
(	O
*	O
resp	pointer
)	O
->	O
links	pointer
)	O
;	O
wget_http_free_digests	function
(	O
&	O
(	O
*	O
resp	pointer
)	O
->	O
digests	pointer
)	O
;	O
wget_http_free_challenges	function
(	O
&	O
(	O
*	O
resp	pointer
)	O
->	O
challenges	pointer
)	O
;	O
wget_http_free_cookies	function
(	O
&	O
(	O
*	O
resp	pointer
)	O
->	O
cookies	pointer
)	O
;	O
wget_http_free_hpkp_entries	function
(	O
&	O
(	O
*	O
resp	pointer
)	O
->	O
hpkp	pointer
)	O
;	O
xfree	O
(	O
(	O
*	O
resp	pointer
)	O
->	O
content_type	pointer
)	O
;	O
xfree	O
(	O
(	O
*	O
resp	pointer
)	O
->	O
content_type_encoding	pointer
)	O
;	O
xfree	O
(	O
(	O
*	O
resp	pointer
)	O
->	O
content_filename	pointer
)	O
;	O
xfree	O
(	O
(	O
*	O
resp	pointer
)	O
->	O
location	pointer
)	O
;	O
xfree	O
(	O
(	O
*	O
resp	pointer
)	O
->	O
etag	pointer
)	O
;	O
wget_buffer_free	function
(	O
&	O
(	O
*	O
resp	pointer
)	O
->	O
header	pointer
)	O
;	O
wget_buffer_free	function
(	O
&	O
(	O
*	O
resp	pointer
)	O
->	O
body	pointer
)	O
;	O
xfree	O
(	O
*	O
resp	pointer
)	O
;	O
}	O
}	O
void	O
wget_http_free_request	function
(	O
wget_http_request	struct
*	O
*	O
req	pointer
)	O
{	O
if	O
(	O
req	pointer
&&	O
*	O
req	pointer
)	O
{	O
wget_buffer_deinit	function
(	O
&	O
(	O
*	O
req	pointer
)	O
->	O
esc_resource	struct
)	O
;	O
wget_buffer_deinit	function
(	O
&	O
(	O
*	O
req	pointer
)	O
->	O
esc_host	struct
)	O
;	O
wget_vector_free	function
(	O
&	O
(	O
*	O
req	pointer
)	O
->	O
headers	pointer
)	O
;	O
xfree	O
(	O
(	O
*	O
req	pointer
)	O
->	O
body	pointer
)	O
;	O
xfree	O
(	O
*	O
req	pointer
)	O
;	O
}	O
}	O
