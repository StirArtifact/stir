static	O
char	O
*	O
my_ltostr	function
(	O
long	O
v	long
,	O
char	O
*	O
str	pointer
)	O
{	O
long	O
d	long
,	O
r	long
;	O
char	O
temp	array
[	O
20	int
]	O
;	O
int	O
count	int
,	O
k	int
,	O
start	pointer
;	O
if	O
(	O
v	long
<	O
0	int
)	O
{	O
str	pointer
[	O
0	int
]	O
=	O
'-'	O
;	O
start	pointer
=	O
1	int
;	O
v	long
=	O
-	O
v	long
;	O
}	O
else	O
start	pointer
=	O
0	int
;	O
count	int
=	O
0	int
;	O
do	O
{	O
d	long
=	O
v	long
/	O
10	int
;	O
r	long
=	O
v	long
-	O
d	long
*	O
10	int
;	O
temp	array
[	O
start	pointer
+	O
count	int
]	O
=	O
'0'	O
+	O
(	O
char	O
)	O
r	long
;	O
count	int
++	O
;	O
v	long
=	O
d	long
;	O
}	O
while	O
(	O
v	long
)	O
;	O
for	O
(	O
k	int
=	O
0	int
;	O
k	int
<	O
count	int
;	O
k	int
++	O
)	O
str	pointer
[	O
k	int
+	O
start	pointer
]	O
=	O
temp	array
[	O
start	pointer
+	O
count	int
-	O
k	int
-	O
1	int
]	O
;	O
str	pointer
[	O
count	int
+	O
start	pointer
]	O
=	O
0	int
;	O
return	O
str	pointer
;	O
}	O
static	O
void	O
get_Name_type	function
(	O
ASN1_TYPE	O
cert_def	pointer
,	O
ASN1_TYPE	O
cert	pointer
,	O
const	O
char	O
*	O
root	pointer
,	O
unsigned	O
char	O
*	O
ans	pointer
)	O
{	O
int	O
k	int
,	O
k2	int
,	O
result	int
,	O
len	int
;	O
char	O
name	pointer
[	O
128	int
]	O
,	O
str	pointer
[	O
1024	int
]	O
,	O
str2	array
[	O
1024	int
]	O
,	O
name2	array
[	O
128	int
]	O
,	O
counter	array
[	O
5	int
]	O
,	O
name3	array
[	O
128	int
]	O
;	O
ASN1_TYPE	O
value	pointer
=	O
ASN1_TYPE_EMPTY	O
;	O
char	O
errorDescription	pointer
[	O
ASN1_MAX_ERROR_DESCRIPTION_SIZE	int
]	O
;	O
char	O
*	O
answer	pointer
=	O
(	O
char	O
*	O
)	O
ans	pointer
;	O
answer	pointer
[	O
0	int
]	O
=	O
0	int
;	O
k	int
=	O
1	int
;	O
do	O
{	O
strcpy	function
(	O
name	pointer
,	O
root	pointer
)	O
;	O
strcat	function
(	O
name	pointer
,	O
".rdnSequence.?"	pointer
)	O
;	O
my_ltostr	function
(	O
k	int
,	O
counter	array
)	O
;	O
strcat	function
(	O
name	pointer
,	O
counter	array
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
result	int
=	O
asn1_read_value	function
(	O
cert	pointer
,	O
name	pointer
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
if	O
(	O
result	int
==	O
ASN1_ELEMENT_NOT_FOUND	int
)	O
break	O
;	O
k2	int
=	O
1	int
;	O
do	O
{	O
strcpy	function
(	O
name2	array
,	O
name	pointer
)	O
;	O
strcat	function
(	O
name2	array
,	O
".?"	pointer
)	O
;	O
my_ltostr	function
(	O
k2	int
,	O
counter	array
)	O
;	O
strcat	function
(	O
name2	array
,	O
counter	array
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
result	int
=	O
asn1_read_value	function
(	O
cert	pointer
,	O
name2	array
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
if	O
(	O
result	int
==	O
ASN1_ELEMENT_NOT_FOUND	int
)	O
break	O
;	O
strcpy	function
(	O
name3	array
,	O
name2	array
)	O
;	O
strcat	function
(	O
name3	array
,	O
".type"	pointer
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
result	int
=	O
asn1_read_value	function
(	O
cert	pointer
,	O
name3	array
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
strcpy	function
(	O
name3	array
,	O
name2	array
)	O
;	O
strcat	function
(	O
name3	array
,	O
".value"	pointer
)	O
;	O
if	O
(	O
result	int
==	O
ASN1_SUCCESS	int
)	O
{	O
len	int
=	O
sizeof	O
(	O
str2	array
)	O
;	O
result	int
=	O
asn1_read_value	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.id-at-countryName"	pointer
,	O
str2	array
,	O
&	O
len	int
)	O
;	O
if	O
(	O
!	O
strcmp	function
(	O
str	pointer
,	O
str2	array
)	O
)	O
{	O
asn1_create_element	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.X520OrganizationName"	pointer
,	O
&	O
value	pointer
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
asn1_read_value	function
(	O
cert	pointer
,	O
name3	array
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
result	int
=	O
asn1_der_decoding	function
(	O
&	O
value	pointer
,	O
str	pointer
,	O
len	int
,	O
errorDescription	pointer
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
asn1_read_value	function
(	O
value	pointer
,	O
""	pointer
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
strcpy	function
(	O
name3	array
,	O
str	pointer
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
asn1_read_value	function
(	O
value	pointer
,	O
name3	array
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
str	pointer
[	O
len	int
]	O
=	O
0	int
;	O
strcat	function
(	O
answer	pointer
,	O
" C="	pointer
)	O
;	O
strcat	function
(	O
answer	pointer
,	O
str	pointer
)	O
;	O
asn1_delete_structure	function
(	O
&	O
value	pointer
)	O
;	O
}	O
else	O
{	O
len	int
=	O
sizeof	O
(	O
str2	array
)	O
;	O
result	int
=	O
asn1_read_value	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.id-at-organizationName"	pointer
,	O
str2	array
,	O
&	O
len	int
)	O
;	O
if	O
(	O
!	O
strcmp	function
(	O
str	pointer
,	O
str2	array
)	O
)	O
{	O
asn1_create_element	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.X520OrganizationName"	pointer
,	O
&	O
value	pointer
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
asn1_read_value	function
(	O
cert	pointer
,	O
name3	array
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
asn1_der_decoding	function
(	O
&	O
value	pointer
,	O
str	pointer
,	O
len	int
,	O
errorDescription	pointer
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
asn1_read_value	function
(	O
value	pointer
,	O
""	pointer
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
strcpy	function
(	O
name3	array
,	O
str	pointer
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
asn1_read_value	function
(	O
value	pointer
,	O
name3	array
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
str	pointer
[	O
len	int
]	O
=	O
0	int
;	O
strcat	function
(	O
answer	pointer
,	O
" O="	pointer
)	O
;	O
strcat	function
(	O
answer	pointer
,	O
str	pointer
)	O
;	O
asn1_delete_structure	function
(	O
&	O
value	pointer
)	O
;	O
}	O
else	O
{	O
len	int
=	O
sizeof	O
(	O
str2	array
)	O
;	O
result	int
=	O
asn1_read_value	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.id-at-organizationalUnitName"	pointer
,	O
str2	array
,	O
&	O
len	int
)	O
;	O
if	O
(	O
!	O
strcmp	function
(	O
str	pointer
,	O
str2	array
)	O
)	O
{	O
asn1_create_element	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.X520OrganizationalUnitName"	pointer
,	O
&	O
value	pointer
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
asn1_read_value	function
(	O
cert	pointer
,	O
name3	array
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
asn1_der_decoding	function
(	O
&	O
value	pointer
,	O
str	pointer
,	O
len	int
,	O
errorDescription	pointer
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
asn1_read_value	function
(	O
value	pointer
,	O
""	pointer
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
strcpy	function
(	O
name3	array
,	O
str	pointer
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
asn1_read_value	function
(	O
value	pointer
,	O
name3	array
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
str	pointer
[	O
len	int
]	O
=	O
0	int
;	O
strcat	function
(	O
answer	pointer
,	O
" OU="	pointer
)	O
;	O
strcat	function
(	O
answer	pointer
,	O
str	pointer
)	O
;	O
asn1_delete_structure	function
(	O
&	O
value	pointer
)	O
;	O
}	O
}	O
}	O
}	O
k2	int
++	O
;	O
}	O
while	O
(	O
1	int
)	O
;	O
k	int
++	O
;	O
}	O
while	O
(	O
1	int
)	O
;	O
}	O
static	O
void	O
create_CRL	function
(	O
ASN1_TYPE	O
cert_def	pointer
,	O
unsigned	O
char	O
*	O
der	pointer
,	O
int	O
*	O
der_len	int
)	O
{	O
int	O
result	int
,	O
k	int
,	O
len	int
;	O
unsigned	O
char	O
str	pointer
[	O
1024	int
]	O
;	O
const	O
unsigned	O
char	O
*	O
str2	array
;	O
ASN1_TYPE	O
crl	pointer
=	O
ASN1_TYPE_EMPTY	O
;	O
ASN1_TYPE	O
value	pointer
=	O
ASN1_TYPE_EMPTY	O
;	O
char	O
errorDescription	pointer
[	O
ASN1_MAX_ERROR_DESCRIPTION_SIZE	int
]	O
;	O
int	O
max_len	int
;	O
max_len	int
=	O
*	O
der_len	int
;	O
result	int
=	O
asn1_create_element	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.CertificateList"	pointer
,	O
&	O
crl	pointer
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.version"	pointer
,	O
"v2"	pointer
,	O
0	int
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
result	int
=	O
asn1_read_value	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.id-dsa-with-sha1"	pointer
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.signature.algorithm"	pointer
,	O
str	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.signature.parameters"	pointer
,	O
NULL	O
,	O
0	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.issuer"	pointer
,	O
"rdnSequence"	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.issuer.rdnSequence"	pointer
,	O
"NEW"	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.issuer.rdnSequence.?LAST"	pointer
,	O
"NEW"	pointer
,	O
1	int
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
result	int
=	O
asn1_read_value	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.id-at-countryName"	pointer
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.issuer.rdnSequence.?LAST.?LAST.type"	pointer
,	O
str	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_create_element	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.X520countryName"	pointer
,	O
&	O
value	pointer
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
value	pointer
,	O
""	pointer
,	O
"US"	pointer
,	O
2	int
)	O
;	O
*	O
der_len	int
=	O
max_len	int
;	O
result	int
=	O
asn1_der_coding	function
(	O
value	pointer
,	O
""	pointer
,	O
der	pointer
,	O
der_len	int
,	O
errorDescription	pointer
)	O
;	O
asn1_delete_structure	function
(	O
&	O
value	pointer
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.issuer.rdnSequence.?LAST.?LAST.value"	pointer
,	O
der	pointer
,	O
*	O
der_len	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.issuer.rdnSequence"	pointer
,	O
"NEW"	pointer
,	O
4	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.issuer.rdnSequence.?LAST"	pointer
,	O
"NEW"	pointer
,	O
4	int
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
result	int
=	O
asn1_read_value	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.id-at-organizationName"	pointer
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.issuer.rdnSequence.?LAST.?LAST.type"	pointer
,	O
str	pointer
,	O
8	int
)	O
;	O
result	int
=	O
asn1_create_element	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.X520OrganizationName"	pointer
,	O
&	O
value	pointer
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
value	pointer
,	O
""	pointer
,	O
"printableString"	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
value	pointer
,	O
"printableString"	pointer
,	O
"gov"	pointer
,	O
3	int
)	O
;	O
*	O
der_len	int
=	O
max_len	int
;	O
result	int
=	O
asn1_der_coding	function
(	O
value	pointer
,	O
""	pointer
,	O
der	pointer
,	O
der_len	int
,	O
errorDescription	pointer
)	O
;	O
asn1_delete_structure	function
(	O
&	O
value	pointer
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.issuer.rdnSequence.?LAST.?LAST.value"	pointer
,	O
der	pointer
,	O
*	O
der_len	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.issuer.rdnSequence"	pointer
,	O
"NEW"	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.issuer.rdnSequence.?LAST"	pointer
,	O
"NEW"	pointer
,	O
1	int
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
result	int
=	O
asn1_read_value	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.id-at-organizationalUnitName"	pointer
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.issuer.rdnSequence.?LAST.?LAST.type"	pointer
,	O
str	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_create_element	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.X520OrganizationalUnitName"	pointer
,	O
&	O
value	pointer
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
value	pointer
,	O
""	pointer
,	O
"printableString"	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
value	pointer
,	O
"printableString"	pointer
,	O
"nist"	pointer
,	O
4	int
)	O
;	O
*	O
der_len	int
=	O
max_len	int
;	O
result	int
=	O
asn1_der_coding	function
(	O
value	pointer
,	O
""	pointer
,	O
der	pointer
,	O
der_len	int
,	O
errorDescription	pointer
)	O
;	O
asn1_delete_structure	function
(	O
&	O
value	pointer
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.issuer.rdnSequence.?LAST.?LAST.value"	pointer
,	O
der	pointer
,	O
*	O
der_len	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.thisUpdate"	pointer
,	O
"utcTime"	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.thisUpdate.utcTime"	pointer
,	O
"970801000000Z"	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.nextUpdate"	pointer
,	O
"utcTime"	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.nextUpdate.utcTime"	pointer
,	O
"970808000000Z"	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.revokedCertificates"	pointer
,	O
"NEW"	pointer
,	O
1	int
)	O
;	O
str	pointer
[	O
0	int
]	O
=	O
18	int
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.revokedCertificates.?LAST.userCertificate"	pointer
,	O
str	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.revokedCertificates.?LAST.revocationDate"	pointer
,	O
"utcTime"	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.revokedCertificates.?LAST.revocationDate.utcTime"	pointer
,	O
"970731000000Z"	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.revokedCertificates.?LAST.crlEntryExtensions"	pointer
,	O
"NEW"	pointer
,	O
1	int
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
result	int
=	O
asn1_read_value	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.id-ce-cRLReasons"	pointer
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.revokedCertificates.?LAST.crlEntryExtensions.?LAST.extnID"	pointer
,	O
str	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.revokedCertificates.?LAST.crlEntryExtensions.?LAST.critical"	pointer
,	O
"FALSE"	pointer
,	O
1	int
)	O
;	O
str2	array
=	O
(	O
const	O
unsigned	O
char	O
*	O
)	O
"\x0a\x01\x01"	pointer
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.revokedCertificates.?LAST.crlEntryExtensions.?LAST.extnValue"	pointer
,	O
str2	array
,	O
3	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"tbsCertList.crlExtensions"	pointer
,	O
NULL	O
,	O
0	int
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
result	int
=	O
asn1_read_value	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.id-dsa-with-sha1"	pointer
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"signatureAlgorithm.algorithm"	pointer
,	O
str	pointer
,	O
1	int
)	O
;	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"signatureAlgorithm.parameters"	pointer
,	O
NULL	O
,	O
0	int
)	O
;	O
*	O
der_len	int
=	O
max_len	int
;	O
result	int
=	O
asn1_der_coding	function
(	O
crl	pointer
,	O
"tbsCertList"	pointer
,	O
der	pointer
,	O
der_len	int
,	O
errorDescription	pointer
)	O
;	O
if	O
(	O
result	int
!=	O
ASN1_SUCCESS	int
)	O
{	O
printf	function
(	O
"\n'tbsCertList' encoding creation: ERROR\n"	pointer
)	O
;	O
return	O
;	O
}	O
result	int
=	O
asn1_write_value	function
(	O
crl	pointer
,	O
"signature"	pointer
,	O
str2	array
,	O
46	int
*	O
8	int
)	O
;	O
*	O
der_len	int
=	O
max_len	int
;	O
result	int
=	O
asn1_der_coding	function
(	O
crl	pointer
,	O
""	pointer
,	O
der	pointer
,	O
der_len	int
,	O
errorDescription	pointer
)	O
;	O
if	O
(	O
result	int
!=	O
ASN1_SUCCESS	int
)	O
{	O
printf	function
(	O
"\n'crl1' encoding creation: ERROR\n"	pointer
)	O
;	O
return	O
;	O
}	O
printf	function
(	O
"-----------------\nCrl1 Encoding:\nNumber of bytes=%i\n"	pointer
,	O
*	O
der_len	int
)	O
;	O
for	O
(	O
k	int
=	O
0	int
;	O
k	int
<	O
*	O
der_len	int
;	O
k	int
++	O
)	O
printf	function
(	O
"%02x "	pointer
,	O
der	pointer
[	O
k	int
]	O
)	O
;	O
printf	function
(	O
"\n-----------------\n"	pointer
)	O
;	O
asn1_delete_structure	function
(	O
&	O
crl	pointer
)	O
;	O
}	O
static	O
void	O
get_CRL	function
(	O
ASN1_TYPE	O
cert_def	pointer
,	O
unsigned	O
char	O
*	O
der	pointer
,	O
int	O
der_len	int
)	O
{	O
int	O
result	int
,	O
len	int
,	O
start	pointer
,	O
end	pointer
;	O
unsigned	O
char	O
str	pointer
[	O
1024	int
]	O
,	O
str2	array
[	O
1024	int
]	O
;	O
ASN1_TYPE	O
crl2	pointer
=	O
ASN1_TYPE_EMPTY	O
;	O
char	O
errorDescription	pointer
[	O
ASN1_MAX_ERROR_DESCRIPTION_SIZE	int
]	O
;	O
asn1_create_element	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.CertificateList"	pointer
,	O
&	O
crl2	pointer
)	O
;	O
result	int
=	O
asn1_der_decoding	function
(	O
&	O
crl2	pointer
,	O
der	pointer
,	O
der_len	int
,	O
errorDescription	pointer
)	O
;	O
if	O
(	O
result	int
!=	O
ASN1_SUCCESS	int
)	O
{	O
printf	function
(	O
"Problems with DER encoding\n"	pointer
)	O
;	O
return	O
;	O
}	O
get_Name_type	function
(	O
cert_def	pointer
,	O
crl2	pointer
,	O
"tbsCertList.issuer"	pointer
,	O
str	pointer
)	O
;	O
printf	function
(	O
"crl2:\nissuer: %s\n"	pointer
,	O
str	pointer
)	O
;	O
len	int
=	O
sizeof	O
(	O
str	pointer
)	O
-	O
1	int
;	O
result	int
=	O
asn1_read_value	function
(	O
crl2	pointer
,	O
"signatureAlgorithm.algorithm"	pointer
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
result	int
=	O
asn1_read_value	function
(	O
cert_def	pointer
,	O
"PKIX1Implicit88.id-dsa-with-sha1"	pointer
,	O
str2	array
,	O
&	O
len	int
)	O
;	O
if	O
(	O
!	O
strcmp	function
(	O
(	O
char	O
*	O
)	O
str	pointer
,	O
(	O
char	O
*	O
)	O
str2	array
)	O
)	O
{	O
result	int
=	O
asn1_der_decoding_startEnd	function
(	O
crl2	pointer
,	O
der	pointer
,	O
der_len	int
,	O
"tbsCertList"	pointer
,	O
&	O
start	pointer
,	O
&	O
end	pointer
)	O
;	O
result	int
=	O
asn1_read_value	function
(	O
crl2	pointer
,	O
"signature"	pointer
,	O
str	pointer
,	O
&	O
len	int
)	O
;	O
}	O
asn1_delete_structure	function
(	O
&	O
crl2	pointer
)	O
;	O
}	O
extern	O
const	O
ASN1_ARRAY_TYPE	O
pkix_asn1_tab	array
[	O
]	O
;	O
int	O
main	function
(	O
int	O
argc	int
,	O
char	O
*	O
argv	array
[	O
]	O
)	O
{	O
int	O
result	int
,	O
der_len	int
;	O
unsigned	O
char	O
der	pointer
[	O
1024	int
]	O
;	O
ASN1_TYPE	O
PKIX1Implicit88	pointer
=	O
ASN1_TYPE_EMPTY	O
;	O
char	O
errorDescription	pointer
[	O
ASN1_MAX_ERROR_DESCRIPTION_SIZE	int
]	O
;	O
if	O
(	O
1	int
)	O
result	int
=	O
asn1_array2tree	function
(	O
pkix_asn1_tab	array
,	O
&	O
PKIX1Implicit88	pointer
,	O
errorDescription	pointer
)	O
;	O
else	O
result	int
=	O
asn1_parser2tree	function
(	O
"pkix.asn"	pointer
,	O
&	O
PKIX1Implicit88	pointer
,	O
errorDescription	pointer
)	O
;	O
if	O
(	O
result	int
!=	O
ASN1_SUCCESS	int
)	O
{	O
asn1_perror	function
(	O
result	int
)	O
;	O
printf	function
(	O
"%s\n"	pointer
,	O
errorDescription	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
der_len	int
=	O
1024	int
;	O
create_CRL	function
(	O
PKIX1Implicit88	pointer
,	O
der	pointer
,	O
&	O
der_len	int
)	O
;	O
get_CRL	function
(	O
PKIX1Implicit88	pointer
,	O
der	pointer
,	O
der_len	int
)	O
;	O
asn1_delete_structure	function
(	O
&	O
PKIX1Implicit88	pointer
)	O
;	O
return	O
0	int
;	O
}	O
