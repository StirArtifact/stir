typedef	O
struct	O
singleton_entry_t	struct
{	O
EChar	char
ClassName	pointer
[	O
50	int
]	O
;	O
OBJID	int
id	int
;	O
}	O
SINGLETON_ENTRY	struct
;	O
SINGLETON_ENTRY	struct
singletons	array
[	O
MAX_SINGLETONS	int
]	O
;	O
ESint32	int
nItems	int
;	O
ESint32	int
SINGLETONOnLoad	function
(	O
CLASSID	int
Idc	int
)	O
{	O
ESint32	int
i	int
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
MAX_SINGLETONS	int
;	O
i	int
++	O
)	O
singletons	array
[	O
i	int
]	O
.	O
id	int
=	O
-	O
1	int
;	O
nItems	int
=	O
0	int
;	O
return	O
0	int
;	O
}	O
ESint32	int
SINGLETONOnUnload	function
(	O
CLASSID	int
Idc	int
)	O
{	O
return	O
0	int
;	O
}	O
ESint32	int
EDMAPROC	O
SINGLETONRegisterZU32rS32	function
(	O
CLASSID	int
idc	int
,	O
EPChar	pointer
cn	pointer
,	O
OBJID	int
id	int
)	O
{	O
ESint32	int
i	int
;	O
if	O
(	O
nItems	int
==	O
MAX_SINGLETONS	int
)	O
{	O
edma_printf	function
(	O
"[SINGLETON] ** ERROR: I can't define more singletons"	pointer
)	O
;	O
return	O
-	O
1	int
;	O
}	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
nItems	int
;	O
i	int
++	O
)	O
{	O
if	O
(	O
singletons	array
[	O
i	int
]	O
.	O
id	int
!=	O
-	O
1	int
)	O
if	O
(	O
strcmp	function
(	O
singletons	array
[	O
i	int
]	O
.	O
ClassName	pointer
,	O
cn	pointer
)	O
==	O
0	int
)	O
break	O
;	O
}	O
if	O
(	O
i	int
==	O
nItems	int
)	O
{	O
strcpy	function
(	O
singletons	array
[	O
nItems	int
]	O
.	O
ClassName	pointer
,	O
cn	pointer
)	O
;	O
if	O
(	O
id	int
==	O
-	O
1	int
)	O
singletons	array
[	O
nItems	int
]	O
.	O
id	int
=	O
edma_new_obj	function
(	O
cn	pointer
,	O
NULL	O
)	O
;	O
else	O
singletons	array
[	O
nItems	int
]	O
.	O
id	int
=	O
id	int
;	O
}	O
nItems	int
++	O
;	O
return	O
0	int
;	O
}	O
ESint32	int
EDMAPROC	O
SINGLETONInstanceZrO	function
(	O
CLASSID	int
idc	int
,	O
EPChar	pointer
cn	pointer
)	O
{	O
ESint32	int
i	int
;	O
for	O
(	O
i	int
=	O
0	int
;	O
i	int
<	O
nItems	int
;	O
i	int
++	O
)	O
{	O
if	O
(	O
singletons	array
[	O
i	int
]	O
.	O
id	int
!=	O
-	O
1	int
)	O
if	O
(	O
strcmp	function
(	O
singletons	array
[	O
i	int
]	O
.	O
ClassName	pointer
,	O
cn	pointer
)	O
==	O
0	int
)	O
break	O
;	O
}	O
if	O
(	O
i	int
==	O
nItems	int
)	O
{	O
edma_printf	function
(	O
"[SINGLETON] Don't found any instance of class %s"	pointer
,	O
cn	pointer
)	O
;	O
return	O
-	O
1	int
;	O
}	O
return	O
singletons	array
[	O
i	int
]	O
.	O
id	int
;	O
}	O
