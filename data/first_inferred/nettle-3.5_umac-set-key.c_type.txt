static	O
void	O
umac_kdf	function
(	O
struct	O
aes128_ctx	struct
*	O
aes	pointer
,	O
unsigned	O
index	function
,	O
unsigned	O
length	long
,	O
uint8_t	char
*	O
dst	pointer
)	O
{	O
uint8_t	char
block	array
[	O
AES_BLOCK_SIZE	int
]	O
;	O
uint64_t	long
count	long
;	O
WRITE_UINT64	O
(	O
block	array
,	O
(	O
uint64_t	long
)	O
index	function
)	O
;	O
for	O
(	O
count	long
=	O
1	int
;	O
length	long
>=	O
AES_BLOCK_SIZE	int
;	O
length	long
-=	O
AES_BLOCK_SIZE	int
,	O
dst	pointer
+=	O
AES_BLOCK_SIZE	int
,	O
count	long
++	O
)	O
{	O
WRITE_UINT64	O
(	O
block	array
+	O
8	int
,	O
count	long
)	O
;	O
aes128_encrypt	O
(	O
aes	pointer
,	O
AES_BLOCK_SIZE	int
,	O
dst	pointer
,	O
block	array
)	O
;	O
}	O
if	O
(	O
length	long
>	O
0	int
)	O
{	O
WRITE_UINT64	O
(	O
block	array
+	O
8	int
,	O
count	long
)	O
;	O
aes128_encrypt	O
(	O
aes	pointer
,	O
AES_BLOCK_SIZE	int
,	O
block	array
,	O
block	array
)	O
;	O
memcpy	function
(	O
dst	pointer
,	O
block	array
,	O
length	long
)	O
;	O
}	O
}	O
void	O
_umac_set_key	O
(	O
uint32_t	int
*	O
l1_key	array
,	O
uint32_t	int
*	O
l2_key	array
,	O
uint64_t	long
*	O
l3_key1	array
,	O
uint32_t	int
*	O
l3_key2	array
,	O
struct	O
aes128_ctx	struct
*	O
aes	pointer
,	O
const	O
uint8_t	char
*	O
key	pointer
,	O
unsigned	O
n	int
)	O
{	O
unsigned	O
size	int
;	O
uint8_t	char
buffer	array
[	O
UMAC_KEY_SIZE	O
]	O
;	O
aes128_set_encrypt_key	O
(	O
aes	pointer
,	O
key	pointer
)	O
;	O
size	int
=	O
UMAC_BLOCK_SIZE	int
/	O
4	int
+	O
4	int
*	O
(	O
n	int
-	O
1	int
)	O
;	O
umac_kdf	function
(	O
aes	pointer
,	O
1	int
,	O
size	int
*	O
sizeof	O
(	O
uint32_t	int
)	O
,	O
(	O
uint8_t	char
*	O
)	O
l1_key	array
)	O
;	O
BE_SWAP32_N	O
(	O
size	int
,	O
l1_key	array
)	O
;	O
size	int
=	O
6	int
*	O
n	int
;	O
umac_kdf	function
(	O
aes	pointer
,	O
2	int
,	O
size	int
*	O
sizeof	O
(	O
uint32_t	int
)	O
,	O
(	O
uint8_t	char
*	O
)	O
l2_key	array
)	O
;	O
_umac_l2_init	O
(	O
size	int
,	O
l2_key	array
)	O
;	O
size	int
=	O
8	int
*	O
n	int
;	O
umac_kdf	function
(	O
aes	pointer
,	O
3	int
,	O
size	int
*	O
sizeof	O
(	O
uint64_t	long
)	O
,	O
(	O
uint8_t	char
*	O
)	O
l3_key1	array
)	O
;	O
_umac_l3_init	O
(	O
size	int
,	O
l3_key1	array
)	O
;	O
umac_kdf	function
(	O
aes	pointer
,	O
4	int
,	O
n	int
*	O
sizeof	O
(	O
uint32_t	int
)	O
,	O
(	O
uint8_t	char
*	O
)	O
l3_key2	array
)	O
;	O
umac_kdf	function
(	O
aes	pointer
,	O
0	int
,	O
UMAC_KEY_SIZE	O
,	O
buffer	array
)	O
;	O
aes128_set_encrypt_key	O
(	O
aes	pointer
,	O
buffer	array
)	O
;	O
}	O
