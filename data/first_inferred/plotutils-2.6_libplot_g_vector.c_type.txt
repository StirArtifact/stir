plVector	struct
*	O
_vscale	function
(	O
plVector	struct
*	O
v	pointer
,	O
double	O
newlen	double
)	O
{	O
double	O
len	long
=	O
VLENGTH	O
(	O
*	O
v	pointer
)	O
;	O
if	O
(	O
len	long
!=	O
0.0	int
)	O
{	O
v	pointer
->	O
x	double
*=	O
newlen	double
/	O
len	long
;	O
v	pointer
->	O
y	double
*=	O
newlen	double
/	O
len	long
;	O
}	O
return	O
(	O
v	pointer
)	O
;	O
}	O
double	O
_xatan2	function
(	O
double	O
y	double
,	O
double	O
x	double
)	O
{	O
if	O
(	O
y	double
==	O
0.0	int
&&	O
x	double
>=	O
0.0	int
)	O
return	O
0.0	int
;	O
else	O
if	O
(	O
y	double
==	O
0.0	int
&&	O
x	double
<	O
0.0	int
)	O
return	O
M_PI	int
;	O
else	O
if	O
(	O
x	double
==	O
0.0	int
&&	O
y	double
>=	O
0.0	int
)	O
return	O
M_PI_2	int
;	O
else	O
if	O
(	O
x	double
==	O
0.0	int
&&	O
y	double
<	O
0.0	int
)	O
return	O
-	O
(	O
M_PI_2	int
)	O
;	O
else	O
return	O
atan2	function
(	O
y	double
,	O
x	double
)	O
;	O
}	O
double	O
_angle_of_arc	function
(	O
plPoint	struct
p0	struct
,	O
plPoint	struct
pp1	struct
,	O
plPoint	struct
pc	struct
)	O
{	O
plVector	struct
v0	struct
,	O
v1	struct
;	O
double	O
cross	double
,	O
angle	double
,	O
angle0	double
;	O
v0	struct
.	O
x	double
=	O
p0	struct
.	O
x	double
-	O
pc	struct
.	O
x	double
;	O
v0	struct
.	O
y	double
=	O
p0	struct
.	O
y	double
-	O
pc	struct
.	O
y	double
;	O
v1	struct
.	O
x	double
=	O
pp1	struct
.	O
x	double
-	O
pc	struct
.	O
x	double
;	O
v1	struct
.	O
y	double
=	O
pp1	struct
.	O
y	double
-	O
pc	struct
.	O
y	double
;	O
angle0	double
=	O
_xatan2	function
(	O
v0	struct
.	O
y	double
,	O
v0	struct
.	O
x	double
)	O
;	O
cross	double
=	O
v0	struct
.	O
x	double
*	O
v1	struct
.	O
y	double
-	O
v1	struct
.	O
x	double
*	O
v0	struct
.	O
y	double
;	O
if	O
(	O
cross	double
==	O
0.0	int
)	O
angle	double
=	O
M_PI	int
;	O
else	O
{	O
double	O
angle1	double
;	O
angle1	double
=	O
_xatan2	function
(	O
v1	struct
.	O
y	double
,	O
v1	struct
.	O
x	double
)	O
;	O
angle	double
=	O
angle1	double
-	O
angle0	double
;	O
if	O
(	O
angle	double
>	O
M_PI	int
)	O
angle	double
-=	O
(	O
2.0	int
*	O
M_PI	int
)	O
;	O
else	O
if	O
(	O
angle	double
<	O
-	O
(	O
M_PI	int
)	O
)	O
angle	double
+=	O
(	O
2.0	int
*	O
M_PI	int
)	O
;	O
}	O
return	O
angle	double
;	O
}	O
plPoint	struct
_truecenter	function
(	O
plPoint	struct
p0	struct
,	O
plPoint	struct
p1	struct
,	O
plPoint	struct
pc	struct
)	O
{	O
plPoint	struct
pm	struct
;	O
plVector	struct
a	struct
,	O
b	struct
,	O
c	char
;	O
double	O
scale	double
;	O
pm	struct
.	O
x	double
=	O
0.5	int
*	O
(	O
p0	struct
.	O
x	double
+	O
p1	struct
.	O
x	double
)	O
;	O
pm	struct
.	O
y	double
=	O
0.5	int
*	O
(	O
p0	struct
.	O
y	double
+	O
p1	struct
.	O
y	double
)	O
;	O
a	struct
.	O
x	double
=	O
-	O
p1	struct
.	O
y	double
+	O
p0	struct
.	O
y	double
;	O
a	struct
.	O
y	double
=	O
p1	struct
.	O
x	double
-	O
p0	struct
.	O
x	double
;	O
b	struct
.	O
x	double
=	O
pc	struct
.	O
x	double
-	O
pm	struct
.	O
x	double
;	O
b	struct
.	O
y	double
=	O
pc	struct
.	O
y	double
-	O
pm	struct
.	O
y	double
;	O
scale	double
=	O
(	O
a	struct
.	O
x	double
*	O
b	struct
.	O
x	double
+	O
a	struct
.	O
y	double
*	O
b	struct
.	O
y	double
)	O
/	O
(	O
a	struct
.	O
x	double
*	O
a	struct
.	O
x	double
+	O
a	struct
.	O
y	double
*	O
a	struct
.	O
y	double
)	O
;	O
c	char
.	O
x	double
=	O
scale	double
*	O
a	struct
.	O
x	double
;	O
c	char
.	O
y	double
=	O
scale	double
*	O
a	struct
.	O
y	double
;	O
pc	struct
.	O
x	double
=	O
pm	struct
.	O
x	double
+	O
c	char
.	O
x	double
;	O
pc	struct
.	O
y	double
=	O
pm	struct
.	O
y	double
+	O
c	char
.	O
y	double
;	O
return	O
pc	struct
;	O
}	O
