rl_vintfunc_t	function
*	O
rl_prep_term_function	pointer
=	O
rl_prep_terminal	function
;	O
rl_voidfunc_t	function
*	O
rl_deprep_term_function	pointer
=	O
rl_deprep_terminal	function
;	O
static	O
void	O
set_winsize	function
PARAMS	O
(	O
(	O
int	O
)	O
)	O
;	O
static	O
int	O
terminal_prepped	int
;	O
static	O
_RL_TTY_CHARS	struct
_rl_tty_chars	struct
,	O
_rl_last_tty_chars	struct
;	O
static	O
void	O
set_winsize	function
(	O
tty	int
)	O
int	O
tty	int
;	O
{	O
struct	O
winsize	struct
w	struct
;	O
if	O
(	O
ioctl	function
(	O
tty	int
,	O
TIOCGWINSZ	int
,	O
&	O
w	struct
)	O
==	O
0	int
)	O
(	O
void	O
)	O
ioctl	function
(	O
tty	int
,	O
TIOCSWINSZ	int
,	O
&	O
w	struct
)	O
;	O
}	O
static	O
TIOTYPE	O
otio	struct
;	O
static	O
void	O
save_tty_chars	function
PARAMS	O
(	O
(	O
TIOTYPE	O
*	O
)	O
)	O
;	O
static	O
int	O
_get_tty_settings	function
PARAMS	O
(	O
(	O
int	O
,	O
TIOTYPE	O
*	O
)	O
)	O
;	O
static	O
int	O
get_tty_settings	function
PARAMS	O
(	O
(	O
int	O
,	O
TIOTYPE	O
*	O
)	O
)	O
;	O
static	O
int	O
_set_tty_settings	function
PARAMS	O
(	O
(	O
int	O
,	O
TIOTYPE	O
*	O
)	O
)	O
;	O
static	O
int	O
set_tty_settings	function
PARAMS	O
(	O
(	O
int	O
,	O
TIOTYPE	O
*	O
)	O
)	O
;	O
static	O
void	O
prepare_terminal_settings	function
PARAMS	O
(	O
(	O
int	O
,	O
TIOTYPE	O
,	O
TIOTYPE	O
*	O
)	O
)	O
;	O
static	O
void	O
set_special_char	function
PARAMS	O
(	O
(	O
Keymap	pointer
,	O
TIOTYPE	O
*	O
,	O
int	O
,	O
rl_command_func_t	function
*	O
)	O
)	O
;	O
static	O
void	O
_rl_bind_tty_special_chars	function
PARAMS	O
(	O
(	O
Keymap	pointer
,	O
TIOTYPE	O
)	O
)	O
;	O
static	O
void	O
save_tty_chars	function
(	O
tiop	pointer
)	O
TIOTYPE	O
*	O
tiop	pointer
;	O
{	O
_rl_last_tty_chars	struct
=	O
_rl_tty_chars	struct
;	O
_rl_tty_chars	struct
.	O
t_eof	char
=	O
tiop	pointer
->	O
c_cc	array
[	O
VEOF	int
]	O
;	O
_rl_tty_chars	struct
.	O
t_eol	char
=	O
tiop	pointer
->	O
c_cc	array
[	O
VEOL	int
]	O
;	O
_rl_tty_chars	struct
.	O
t_eol2	char
=	O
tiop	pointer
->	O
c_cc	array
[	O
VEOL2	int
]	O
;	O
_rl_tty_chars	struct
.	O
t_erase	char
=	O
tiop	pointer
->	O
c_cc	array
[	O
VERASE	int
]	O
;	O
_rl_tty_chars	struct
.	O
t_werase	char
=	O
tiop	pointer
->	O
c_cc	array
[	O
VWERASE	int
]	O
;	O
_rl_tty_chars	struct
.	O
t_kill	char
=	O
tiop	pointer
->	O
c_cc	array
[	O
VKILL	int
]	O
;	O
_rl_tty_chars	struct
.	O
t_reprint	char
=	O
tiop	pointer
->	O
c_cc	array
[	O
VREPRINT	int
]	O
;	O
_rl_intr_char	int
=	O
_rl_tty_chars	struct
.	O
t_intr	char
=	O
tiop	pointer
->	O
c_cc	array
[	O
VINTR	int
]	O
;	O
_rl_quit_char	int
=	O
_rl_tty_chars	struct
.	O
t_quit	char
=	O
tiop	pointer
->	O
c_cc	array
[	O
VQUIT	int
]	O
;	O
_rl_susp_char	int
=	O
_rl_tty_chars	struct
.	O
t_susp	char
=	O
tiop	pointer
->	O
c_cc	array
[	O
VSUSP	int
]	O
;	O
_rl_tty_chars	struct
.	O
t_start	char
=	O
tiop	pointer
->	O
c_cc	array
[	O
VSTART	int
]	O
;	O
_rl_tty_chars	struct
.	O
t_stop	char
=	O
tiop	pointer
->	O
c_cc	array
[	O
VSTOP	int
]	O
;	O
_rl_tty_chars	struct
.	O
t_lnext	char
=	O
tiop	pointer
->	O
c_cc	array
[	O
VLNEXT	int
]	O
;	O
_rl_tty_chars	struct
.	O
t_flush	char
=	O
tiop	pointer
->	O
c_cc	array
[	O
VDISCARD	int
]	O
;	O
}	O
static	O
int	O
_get_tty_settings	function
(	O
tty	int
,	O
tiop	pointer
)	O
int	O
tty	int
;	O
TIOTYPE	O
*	O
tiop	pointer
;	O
{	O
int	O
ioctl_ret	int
;	O
while	O
(	O
1	int
)	O
{	O
ioctl_ret	int
=	O
GETATTR	O
(	O
tty	int
,	O
tiop	pointer
)	O
;	O
if	O
(	O
ioctl_ret	int
<	O
0	int
)	O
{	O
if	O
(	O
errno	O
!=	O
EINTR	int
)	O
return	O
-	O
1	int
;	O
else	O
continue	O
;	O
}	O
if	O
(	O
OUTPUT_BEING_FLUSHED	O
(	O
tiop	pointer
)	O
)	O
{	O
_rl_errmsg	function
(	O
"warning: turning off output flushing"	pointer
)	O
;	O
tiop	pointer
->	O
c_lflag	int
&=	O
~	O
FLUSHO	int
;	O
break	O
;	O
}	O
break	O
;	O
}	O
return	O
0	int
;	O
}	O
static	O
int	O
get_tty_settings	function
(	O
tty	int
,	O
tiop	pointer
)	O
int	O
tty	int
;	O
TIOTYPE	O
*	O
tiop	pointer
;	O
{	O
set_winsize	function
(	O
tty	int
)	O
;	O
errno	O
=	O
0	int
;	O
if	O
(	O
_get_tty_settings	function
(	O
tty	int
,	O
tiop	pointer
)	O
<	O
0	int
)	O
return	O
-	O
1	int
;	O
return	O
0	int
;	O
}	O
static	O
int	O
_set_tty_settings	function
(	O
tty	int
,	O
tiop	pointer
)	O
int	O
tty	int
;	O
TIOTYPE	O
*	O
tiop	pointer
;	O
{	O
while	O
(	O
SETATTR	O
(	O
tty	int
,	O
tiop	pointer
)	O
<	O
0	int
)	O
{	O
if	O
(	O
errno	O
!=	O
EINTR	int
)	O
return	O
-	O
1	int
;	O
errno	O
=	O
0	int
;	O
}	O
return	O
0	int
;	O
}	O
static	O
int	O
set_tty_settings	function
(	O
tty	int
,	O
tiop	pointer
)	O
int	O
tty	int
;	O
TIOTYPE	O
*	O
tiop	pointer
;	O
{	O
if	O
(	O
_set_tty_settings	function
(	O
tty	int
,	O
tiop	pointer
)	O
<	O
0	int
)	O
return	O
-	O
1	int
;	O
return	O
0	int
;	O
}	O
static	O
void	O
prepare_terminal_settings	function
(	O
meta_flag	int
,	O
oldtio	struct
,	O
tiop	pointer
)	O
int	O
meta_flag	int
;	O
TIOTYPE	O
oldtio	struct
,	O
*	O
tiop	pointer
;	O
{	O
_rl_echoing_p	int
=	O
(	O
oldtio	struct
.	O
c_lflag	int
&	O
ECHO	int
)	O
;	O
_rl_echoctl	int
=	O
(	O
oldtio	struct
.	O
c_lflag	int
&	O
ECHOCTL	int
)	O
;	O
tiop	pointer
->	O
c_lflag	int
&=	O
~	O
(	O
ICANON	int
|	O
ECHO	int
)	O
;	O
if	O
(	O
(	O
unsigned	O
char	O
)	O
oldtio	struct
.	O
c_cc	array
[	O
VEOF	int
]	O
!=	O
(	O
unsigned	O
char	O
)	O
_POSIX_VDISABLE	char
)	O
_rl_eof_char	int
=	O
oldtio	struct
.	O
c_cc	array
[	O
VEOF	int
]	O
;	O
if	O
(	O
(	O
(	O
tiop	pointer
->	O
c_cflag	int
&	O
CSIZE	int
)	O
==	O
CS8	int
)	O
||	O
meta_flag	int
)	O
tiop	pointer
->	O
c_iflag	int
&=	O
~	O
(	O
ISTRIP	int
|	O
INPCK	int
)	O
;	O
tiop	pointer
->	O
c_iflag	int
&=	O
~	O
(	O
ICRNL	int
|	O
INLCR	int
)	O
;	O
tiop	pointer
->	O
c_lflag	int
|=	O
ISIG	int
;	O
tiop	pointer
->	O
c_cc	array
[	O
VMIN	int
]	O
=	O
1	int
;	O
tiop	pointer
->	O
c_cc	array
[	O
VTIME	int
]	O
=	O
0	int
;	O
if	O
(	O
OUTPUT_BEING_FLUSHED	O
(	O
tiop	pointer
)	O
)	O
{	O
tiop	pointer
->	O
c_lflag	int
&=	O
~	O
FLUSHO	int
;	O
oldtio	struct
.	O
c_lflag	int
&=	O
~	O
FLUSHO	int
;	O
}	O
tiop	pointer
->	O
c_cc	array
[	O
VLNEXT	int
]	O
=	O
_POSIX_VDISABLE	char
;	O
}	O
void	O
rl_prep_terminal	function
(	O
meta_flag	int
)	O
int	O
meta_flag	int
;	O
{	O
int	O
tty	int
,	O
nprep	int
;	O
TIOTYPE	O
tio	struct
;	O
if	O
(	O
terminal_prepped	int
)	O
return	O
;	O
_rl_block_sigint	function
(	O
)	O
;	O
tty	int
=	O
rl_instream	pointer
?	O
fileno	function
(	O
rl_instream	pointer
)	O
:	O
fileno	function
(	O
stdin	pointer
)	O
;	O
if	O
(	O
get_tty_settings	function
(	O
tty	int
,	O
&	O
tio	struct
)	O
<	O
0	int
)	O
{	O
if	O
(	O
errno	O
==	O
ENOTTY	int
||	O
errno	O
==	O
EINVAL	int
||	O
errno	O
==	O
ENOTSUP	O
)	O
_rl_echoing_p	int
=	O
1	int
;	O
_rl_release_sigint	function
(	O
)	O
;	O
return	O
;	O
}	O
otio	struct
=	O
tio	struct
;	O
if	O
(	O
_rl_bind_stty_chars	int
)	O
{	O
if	O
(	O
rl_editing_mode	int
==	O
vi_mode	int
)	O
rl_tty_unset_default_bindings	function
(	O
vi_insertion_keymap	array
)	O
;	O
else	O
rl_tty_unset_default_bindings	function
(	O
_rl_keymap	pointer
)	O
;	O
}	O
save_tty_chars	function
(	O
&	O
otio	struct
)	O
;	O
RL_SETSTATE	O
(	O
RL_STATE_TTYCSAVED	int
)	O
;	O
if	O
(	O
_rl_bind_stty_chars	int
)	O
{	O
if	O
(	O
rl_editing_mode	int
==	O
vi_mode	int
)	O
_rl_bind_tty_special_chars	function
(	O
vi_insertion_keymap	array
,	O
tio	struct
)	O
;	O
else	O
_rl_bind_tty_special_chars	function
(	O
_rl_keymap	pointer
,	O
tio	struct
)	O
;	O
}	O
prepare_terminal_settings	function
(	O
meta_flag	int
,	O
otio	struct
,	O
&	O
tio	struct
)	O
;	O
if	O
(	O
set_tty_settings	function
(	O
tty	int
,	O
&	O
tio	struct
)	O
<	O
0	int
)	O
{	O
_rl_release_sigint	function
(	O
)	O
;	O
return	O
;	O
}	O
if	O
(	O
_rl_enable_keypad	int
)	O
_rl_control_keypad	function
(	O
1	int
)	O
;	O
nprep	int
=	O
TPX_PREPPED	int
;	O
if	O
(	O
_rl_enable_bracketed_paste	int
)	O
{	O
fprintf	function
(	O
rl_outstream	pointer
,	O
BRACK_PASTE_INIT	pointer
)	O
;	O
nprep	int
|=	O
TPX_BRACKPASTE	int
;	O
}	O
fflush	function
(	O
rl_outstream	pointer
)	O
;	O
terminal_prepped	int
=	O
nprep	int
;	O
RL_SETSTATE	O
(	O
RL_STATE_TERMPREPPED	int
)	O
;	O
_rl_release_sigint	function
(	O
)	O
;	O
}	O
void	O
rl_deprep_terminal	function
(	O
)	O
{	O
int	O
tty	int
;	O
if	O
(	O
terminal_prepped	int
==	O
0	int
)	O
return	O
;	O
_rl_block_sigint	function
(	O
)	O
;	O
tty	int
=	O
rl_instream	pointer
?	O
fileno	function
(	O
rl_instream	pointer
)	O
:	O
fileno	function
(	O
stdin	pointer
)	O
;	O
if	O
(	O
terminal_prepped	int
&	O
TPX_BRACKPASTE	int
)	O
fprintf	function
(	O
rl_outstream	pointer
,	O
BRACK_PASTE_FINI	pointer
)	O
;	O
if	O
(	O
_rl_enable_keypad	int
)	O
_rl_control_keypad	function
(	O
0	int
)	O
;	O
fflush	function
(	O
rl_outstream	pointer
)	O
;	O
if	O
(	O
set_tty_settings	function
(	O
tty	int
,	O
&	O
otio	struct
)	O
<	O
0	int
)	O
{	O
_rl_release_sigint	function
(	O
)	O
;	O
return	O
;	O
}	O
terminal_prepped	int
=	O
0	int
;	O
RL_UNSETSTATE	O
(	O
RL_STATE_TERMPREPPED	int
)	O
;	O
_rl_release_sigint	function
(	O
)	O
;	O
}	O
int	O
rl_tty_set_echoing	function
(	O
u	int
)	O
int	O
u	int
;	O
{	O
int	O
o	int
;	O
o	int
=	O
_rl_echoing_p	int
;	O
_rl_echoing_p	int
=	O
u	int
;	O
return	O
o	int
;	O
}	O
int	O
rl_restart_output	function
(	O
count	int
,	O
key	int
)	O
int	O
count	int
,	O
key	int
;	O
{	O
int	O
fildes	int
=	O
fileno	function
(	O
rl_outstream	pointer
)	O
;	O
tcflow	function
(	O
fildes	int
,	O
TCOON	int
)	O
;	O
return	O
0	int
;	O
}	O
int	O
rl_stop_output	function
(	O
count	int
,	O
key	int
)	O
int	O
count	int
,	O
key	int
;	O
{	O
int	O
fildes	int
=	O
fileno	function
(	O
rl_instream	pointer
)	O
;	O
tcflow	function
(	O
fildes	int
,	O
TCOOFF	int
)	O
;	O
return	O
0	int
;	O
}	O
static	O
void	O
set_special_char	function
(	O
kmap	pointer
,	O
tiop	pointer
,	O
sc	int
,	O
func	pointer
)	O
Keymap	pointer
kmap	pointer
;	O
TIOTYPE	O
*	O
tiop	pointer
;	O
int	O
sc	int
;	O
rl_command_func_t	function
*	O
func	pointer
;	O
{	O
unsigned	O
char	O
uc	char
;	O
uc	char
=	O
tiop	pointer
->	O
c_cc	array
[	O
sc	int
]	O
;	O
if	O
(	O
uc	char
!=	O
(	O
unsigned	O
char	O
)	O
_POSIX_VDISABLE	char
&&	O
kmap	pointer
[	O
uc	char
]	O
.	O
type	char
==	O
ISFUNC	int
)	O
kmap	pointer
[	O
uc	char
]	O
.	O
function	pointer
=	O
func	pointer
;	O
}	O
static	O
void	O
_rl_bind_tty_special_chars	function
(	O
kmap	pointer
,	O
ttybuff	struct
)	O
Keymap	pointer
kmap	pointer
;	O
TIOTYPE	O
ttybuff	struct
;	O
{	O
SET_SPECIAL	O
(	O
VERASE	int
,	O
rl_rubout	function
)	O
;	O
SET_SPECIAL	O
(	O
VKILL	int
,	O
rl_unix_line_discard	function
)	O
;	O
SET_SPECIAL	O
(	O
VLNEXT	int
,	O
rl_quoted_insert	function
)	O
;	O
if	O
(	O
rl_editing_mode	int
==	O
vi_mode	int
)	O
SET_SPECIAL	O
(	O
VWERASE	int
,	O
rl_vi_unix_word_rubout	function
)	O
;	O
else	O
SET_SPECIAL	O
(	O
VWERASE	int
,	O
rl_unix_word_rubout	function
)	O
;	O
}	O
void	O
rltty_set_default_bindings	function
(	O
kmap	pointer
)	O
Keymap	pointer
kmap	pointer
;	O
{	O
TIOTYPE	O
ttybuff	struct
;	O
int	O
tty	int
;	O
tty	int
=	O
fileno	function
(	O
rl_instream	pointer
)	O
;	O
if	O
(	O
get_tty_settings	function
(	O
tty	int
,	O
&	O
ttybuff	struct
)	O
==	O
0	int
)	O
_rl_bind_tty_special_chars	function
(	O
kmap	pointer
,	O
ttybuff	struct
)	O
;	O
}	O
void	O
rl_tty_set_default_bindings	function
(	O
kmap	pointer
)	O
Keymap	pointer
kmap	pointer
;	O
{	O
rltty_set_default_bindings	function
(	O
kmap	pointer
)	O
;	O
}	O
void	O
rl_tty_unset_default_bindings	function
(	O
kmap	pointer
)	O
Keymap	pointer
kmap	pointer
;	O
{	O
if	O
(	O
RL_ISSTATE	O
(	O
RL_STATE_TTYCSAVED	int
)	O
==	O
0	int
)	O
return	O
;	O
RESET_SPECIAL	O
(	O
_rl_tty_chars	struct
.	O
t_erase	char
)	O
;	O
RESET_SPECIAL	O
(	O
_rl_tty_chars	struct
.	O
t_kill	char
)	O
;	O
RESET_SPECIAL	O
(	O
_rl_tty_chars	struct
.	O
t_lnext	char
)	O
;	O
RESET_SPECIAL	O
(	O
_rl_tty_chars	struct
.	O
t_werase	char
)	O
;	O
}	O
static	O
TIOTYPE	O
sigstty	struct
,	O
nosigstty	struct
;	O
static	O
int	O
tty_sigs_disabled	int
=	O
0	int
;	O
int	O
_rl_disable_tty_signals	function
(	O
)	O
{	O
if	O
(	O
tty_sigs_disabled	int
)	O
return	O
0	int
;	O
if	O
(	O
_get_tty_settings	function
(	O
fileno	function
(	O
rl_instream	pointer
)	O
,	O
&	O
sigstty	struct
)	O
<	O
0	int
)	O
return	O
-	O
1	int
;	O
nosigstty	struct
=	O
sigstty	struct
;	O
nosigstty	struct
.	O
c_lflag	int
&=	O
~	O
ISIG	int
;	O
nosigstty	struct
.	O
c_iflag	int
&=	O
~	O
IXON	int
;	O
if	O
(	O
_set_tty_settings	function
(	O
fileno	function
(	O
rl_instream	pointer
)	O
,	O
&	O
nosigstty	struct
)	O
<	O
0	int
)	O
return	O
(	O
_set_tty_settings	function
(	O
fileno	function
(	O
rl_instream	pointer
)	O
,	O
&	O
sigstty	struct
)	O
)	O
;	O
tty_sigs_disabled	int
=	O
1	int
;	O
return	O
0	int
;	O
}	O
int	O
_rl_restore_tty_signals	function
(	O
)	O
{	O
int	O
r	int
;	O
if	O
(	O
tty_sigs_disabled	int
==	O
0	int
)	O
return	O
0	int
;	O
r	int
=	O
_set_tty_settings	function
(	O
fileno	function
(	O
rl_instream	pointer
)	O
,	O
&	O
sigstty	struct
)	O
;	O
if	O
(	O
r	int
==	O
0	int
)	O
tty_sigs_disabled	int
=	O
0	int
;	O
return	O
r	int
;	O
}	O
