typedef	O
struct	O
_pSLstring_Type	struct
{	O
struct	O
_pSLstring_Type	struct
*	O
next	pointer
;	O
unsigned	O
int	O
ref_count	int
;	O
unsigned	O
long	O
hash	long
;	O
unsigned	O
int	O
len	int
;	O
char	O
bytes	pointer
[	O
1	int
]	O
;	O
}	O
SLstring_Type	struct
;	O
static	O
SLstring_Type	struct
*	O
String_Hash_Table	array
[	O
SLSTRING_HASH_TABLE_SIZE	int
]	O
;	O
static	O
char	O
Single_Char_Strings	array
[	O
256	int
*	O
2	int
]	O
;	O
static	O
SLstring_Type	struct
*	O
SLS_Free_Store	array
[	O
MAX_FREE_STORE_LEN	int
]	O
;	O
typedef	O
struct	O
{	O
SLstring_Type	struct
*	O
sls	pointer
;	O
char	O
*	O
str	pointer
;	O
}	O
Cached_String_Type	struct
;	O
static	O
char	O
*	O
Deleted_String	pointer
=	O
"*deleted*"	pointer
;	O
static	O
Cached_String_Type	struct
Cached_Strings	array
[	O
NUM_CACHED_STRINGS	int
]	O
;	O
_INLINE_	O
static	O
void	O
cache_string	function
(	O
SLstring_Type	struct
*	O
sls	pointer
)	O
{	O
Cached_String_Type	struct
*	O
cs	short
;	O
cs	short
=	O
GET_CACHED_STRING	O
(	O
sls	pointer
->	O
bytes	pointer
)	O
;	O
cs	short
->	O
str	pointer
=	O
sls	pointer
->	O
bytes	pointer
;	O
cs	short
->	O
sls	pointer
=	O
sls	pointer
;	O
}	O
_INLINE_	O
static	O
void	O
uncache_string	function
(	O
char	O
*	O
s	pointer
)	O
{	O
Cached_String_Type	struct
*	O
cs	short
;	O
cs	short
=	O
GET_CACHED_STRING	O
(	O
s	pointer
)	O
;	O
if	O
(	O
cs	short
->	O
str	pointer
==	O
s	pointer
)	O
{	O
cs	short
->	O
sls	pointer
=	O
NULL	O
;	O
cs	short
->	O
str	pointer
=	O
Deleted_String	pointer
;	O
}	O
}	O
typedef	O
unsigned	O
long	O
uint32	long
;	O
_INLINE_	O
unsigned	O
long	O
_pSLstring_hash	function
(	O
unsigned	O
char	O
*	O
s	pointer
,	O
unsigned	O
char	O
*	O
smax	pointer
)	O
{	O
register	O
uint32	long
a	pointer
,	O
b	pointer
,	O
c	int
;	O
unsigned	O
int	O
length	int
=	O
(	O
unsigned	O
int	O
)	O
(	O
smax	pointer
-	O
s	pointer
)	O
;	O
unsigned	O
int	O
len	int
=	O
length	int
;	O
a	pointer
=	O
b	pointer
=	O
0x9e3779b9	int
;	O
c	int
=	O
0	int
;	O
while	O
(	O
len	int
>=	O
12	int
)	O
{	O
a	pointer
+=	O
(	O
s	pointer
[	O
0	int
]	O
+	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
1	int
]	O
<<	O
8	int
)	O
+	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
2	int
]	O
<<	O
16	int
)	O
+	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
3	int
]	O
<<	O
24	int
)	O
)	O
;	O
b	pointer
+=	O
(	O
s	pointer
[	O
4	int
]	O
+	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
5	int
]	O
<<	O
8	int
)	O
+	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
6	int
]	O
<<	O
16	int
)	O
+	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
7	int
]	O
<<	O
24	int
)	O
)	O
;	O
c	int
+=	O
(	O
s	pointer
[	O
8	int
]	O
+	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
9	int
]	O
<<	O
8	int
)	O
+	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
10	int
]	O
<<	O
16	int
)	O
+	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
11	int
]	O
<<	O
24	int
)	O
)	O
;	O
mix	O
(	O
a	pointer
,	O
b	pointer
,	O
c	int
)	O
;	O
s	pointer
+=	O
12	int
;	O
len	int
-=	O
12	int
;	O
}	O
c	int
+=	O
length	int
;	O
switch	O
(	O
len	int
)	O
{	O
case	O
11	int
:	O
c	int
+=	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
10	int
]	O
<<	O
24	int
)	O
;	O
case	O
10	int
:	O
c	int
+=	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
9	int
]	O
<<	O
16	int
)	O
;	O
case	O
9	int
:	O
c	int
+=	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
8	int
]	O
<<	O
8	int
)	O
;	O
case	O
8	int
:	O
b	pointer
+=	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
7	int
]	O
<<	O
24	int
)	O
;	O
case	O
7	int
:	O
b	pointer
+=	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
6	int
]	O
<<	O
16	int
)	O
;	O
case	O
6	int
:	O
b	pointer
+=	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
5	int
]	O
<<	O
8	int
)	O
;	O
case	O
5	int
:	O
b	pointer
+=	O
s	pointer
[	O
4	int
]	O
;	O
case	O
4	int
:	O
a	pointer
+=	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
3	int
]	O
<<	O
24	int
)	O
;	O
case	O
3	int
:	O
a	pointer
+=	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
2	int
]	O
<<	O
16	int
)	O
;	O
case	O
2	int
:	O
a	pointer
+=	O
(	O
(	O
uint32	long
)	O
s	pointer
[	O
1	int
]	O
<<	O
8	int
)	O
;	O
case	O
1	int
:	O
a	pointer
+=	O
s	pointer
[	O
0	int
]	O
;	O
}	O
mix	O
(	O
a	pointer
,	O
b	pointer
,	O
c	int
)	O
;	O
return	O
(	O
unsigned	O
long	O
)	O
c	int
;	O
}	O
unsigned	O
long	O
_pSLcompute_string_hash	function
(	O
char	O
*	O
s	pointer
)	O
{	O
Cached_String_Type	struct
*	O
cs	short
;	O
cs	short
=	O
GET_CACHED_STRING	O
(	O
s	pointer
)	O
;	O
if	O
(	O
cs	short
->	O
str	pointer
==	O
s	pointer
)	O
return	O
cs	short
->	O
sls	pointer
->	O
hash	long
;	O
return	O
_pSLstring_hash	function
(	O
(	O
unsigned	O
char	O
*	O
)	O
s	pointer
,	O
(	O
unsigned	O
char	O
*	O
)	O
s	pointer
+	O
strlen	function
(	O
s	pointer
)	O
)	O
;	O
}	O
_INLINE_	O
static	O
SLstring_Type	struct
*	O
find_string	function
(	O
char	O
*	O
s	pointer
,	O
unsigned	O
int	O
len	int
,	O
unsigned	O
long	O
hash	long
)	O
{	O
SLstring_Type	struct
*	O
sls	pointer
;	O
sls	pointer
=	O
String_Hash_Table	array
[	O
(	O
unsigned	O
int	O
)	O
MAP_HASH_TO_INDEX	O
(	O
hash	long
)	O
]	O
;	O
if	O
(	O
sls	pointer
==	O
NULL	O
)	O
return	O
NULL	O
;	O
do	O
{	O
if	O
(	O
(	O
sls	pointer
->	O
hash	long
==	O
hash	long
)	O
&&	O
(	O
sls	pointer
->	O
len	int
==	O
len	int
)	O
&&	O
(	O
0	int
==	O
strncmp	function
(	O
s	pointer
,	O
sls	pointer
->	O
bytes	pointer
,	O
len	int
)	O
)	O
)	O
break	O
;	O
sls	pointer
=	O
sls	pointer
->	O
next	pointer
;	O
}	O
while	O
(	O
sls	pointer
!=	O
NULL	O
)	O
;	O
return	O
sls	pointer
;	O
}	O
_INLINE_	O
static	O
SLstring_Type	struct
*	O
find_slstring	function
(	O
char	O
*	O
s	pointer
,	O
unsigned	O
long	O
hash	long
)	O
{	O
SLstring_Type	struct
*	O
sls	pointer
;	O
sls	pointer
=	O
String_Hash_Table	array
[	O
MAP_HASH_TO_INDEX	O
(	O
hash	long
)	O
]	O
;	O
while	O
(	O
sls	pointer
!=	O
NULL	O
)	O
{	O
if	O
(	O
s	pointer
==	O
sls	pointer
->	O
bytes	pointer
)	O
return	O
sls	pointer
;	O
sls	pointer
=	O
sls	pointer
->	O
next	pointer
;	O
}	O
return	O
sls	pointer
;	O
}	O
_INLINE_	O
static	O
SLstring_Type	struct
*	O
allocate_sls	function
(	O
unsigned	O
int	O
len	int
)	O
{	O
SLstring_Type	struct
*	O
sls	pointer
;	O
if	O
(	O
(	O
len	int
<	O
MAX_FREE_STORE_LEN	int
)	O
&&	O
(	O
NULL	O
!=	O
(	O
sls	pointer
=	O
SLS_Free_Store	array
[	O
len	int
]	O
)	O
)	O
)	O
{	O
SLS_Free_Store	array
[	O
len	int
]	O
=	O
NULL	O
;	O
return	O
sls	pointer
;	O
}	O
sls	pointer
=	O
(	O
SLstring_Type	struct
*	O
)	O
SLmalloc	O
(	O
len	int
+	O
sizeof	O
(	O
SLstring_Type	struct
)	O
)	O
;	O
if	O
(	O
sls	pointer
!=	O
NULL	O
)	O
sls	pointer
->	O
len	int
=	O
len	int
;	O
return	O
sls	pointer
;	O
}	O
_INLINE_	O
static	O
void	O
free_sls	function
(	O
SLstring_Type	struct
*	O
sls	pointer
)	O
{	O
unsigned	O
int	O
len	int
=	O
sls	pointer
->	O
len	int
;	O
if	O
(	O
(	O
len	int
<	O
MAX_FREE_STORE_LEN	int
)	O
&&	O
(	O
SLS_Free_Store	array
[	O
len	int
]	O
==	O
NULL	O
)	O
)	O
{	O
SLS_Free_Store	array
[	O
len	int
]	O
=	O
sls	pointer
;	O
return	O
;	O
}	O
SLfree	O
(	O
(	O
char	O
*	O
)	O
sls	pointer
)	O
;	O
}	O
_INLINE_	O
static	O
char	O
*	O
create_long_string	function
(	O
char	O
*	O
s	pointer
,	O
unsigned	O
int	O
len	int
,	O
unsigned	O
long	O
hash	long
)	O
{	O
SLstring_Type	struct
*	O
sls	pointer
;	O
sls	pointer
=	O
find_string	function
(	O
s	pointer
,	O
len	int
,	O
hash	long
)	O
;	O
if	O
(	O
sls	pointer
!=	O
NULL	O
)	O
{	O
sls	pointer
->	O
ref_count	int
++	O
;	O
cache_string	function
(	O
sls	pointer
)	O
;	O
return	O
sls	pointer
->	O
bytes	pointer
;	O
}	O
sls	pointer
=	O
allocate_sls	function
(	O
len	int
)	O
;	O
if	O
(	O
sls	pointer
==	O
NULL	O
)	O
return	O
NULL	O
;	O
strncpy	function
(	O
sls	pointer
->	O
bytes	pointer
,	O
s	pointer
,	O
len	int
)	O
;	O
sls	pointer
->	O
bytes	pointer
[	O
len	int
]	O
=	O
0	int
;	O
sls	pointer
->	O
ref_count	int
=	O
1	int
;	O
sls	pointer
->	O
hash	long
=	O
hash	long
;	O
cache_string	function
(	O
sls	pointer
)	O
;	O
hash	long
=	O
MAP_HASH_TO_INDEX	O
(	O
hash	long
)	O
;	O
sls	pointer
->	O
next	pointer
=	O
String_Hash_Table	array
[	O
(	O
unsigned	O
int	O
)	O
hash	long
]	O
;	O
String_Hash_Table	array
[	O
(	O
unsigned	O
int	O
)	O
hash	long
]	O
=	O
sls	pointer
;	O
return	O
sls	pointer
->	O
bytes	pointer
;	O
}	O
_INLINE_	O
static	O
char	O
*	O
create_short_string	function
(	O
char	O
*	O
s	pointer
,	O
unsigned	O
int	O
len	int
)	O
{	O
char	O
ch	int
;	O
if	O
(	O
len	int
)	O
ch	int
=	O
*	O
s	pointer
;	O
else	O
ch	int
=	O
0	int
;	O
len	int
=	O
2	int
*	O
(	O
unsigned	O
int	O
)	O
(	O
(	O
unsigned	O
char	O
)	O
ch	int
)	O
;	O
Single_Char_Strings	array
[	O
len	int
]	O
=	O
ch	int
;	O
Single_Char_Strings	array
[	O
len	int
+	O
1	int
]	O
=	O
0	int
;	O
return	O
Single_Char_Strings	array
+	O
len	int
;	O
}	O
_INLINE_	O
static	O
SLstr_Type	char
*	O
create_nstring	function
(	O
char	O
*	O
s	pointer
,	O
unsigned	O
int	O
len	int
,	O
unsigned	O
long	O
*	O
hash_ptr	pointer
)	O
{	O
unsigned	O
long	O
hash	long
;	O
if	O
(	O
len	int
<	O
2	int
)	O
return	O
create_short_string	function
(	O
s	pointer
,	O
len	int
)	O
;	O
hash	long
=	O
_pSLstring_hash	function
(	O
(	O
unsigned	O
char	O
*	O
)	O
s	pointer
,	O
(	O
unsigned	O
char	O
*	O
)	O
(	O
s	pointer
+	O
len	int
)	O
)	O
;	O
*	O
hash_ptr	pointer
=	O
hash	long
;	O
return	O
create_long_string	function
(	O
s	pointer
,	O
len	int
,	O
hash	long
)	O
;	O
}	O
SLstr_Type	char
*	O
SLang_create_nslstring	function
(	O
char	O
*	O
s	pointer
,	O
unsigned	O
int	O
len	int
)	O
{	O
unsigned	O
long	O
hash	long
;	O
if	O
(	O
s	pointer
==	O
NULL	O
)	O
return	O
NULL	O
;	O
return	O
create_nstring	function
(	O
s	pointer
,	O
len	int
,	O
&	O
hash	long
)	O
;	O
}	O
char	O
*	O
_pSLstring_make_hashed_string	function
(	O
char	O
*	O
s	pointer
,	O
unsigned	O
int	O
len	int
,	O
unsigned	O
long	O
*	O
hashptr	pointer
)	O
{	O
unsigned	O
long	O
hash	long
;	O
if	O
(	O
s	pointer
==	O
NULL	O
)	O
return	O
NULL	O
;	O
hash	long
=	O
_pSLstring_hash	function
(	O
(	O
unsigned	O
char	O
*	O
)	O
s	pointer
,	O
(	O
unsigned	O
char	O
*	O
)	O
s	pointer
+	O
len	int
)	O
;	O
*	O
hashptr	pointer
=	O
hash	long
;	O
if	O
(	O
len	int
<	O
2	int
)	O
return	O
create_short_string	function
(	O
s	pointer
,	O
len	int
)	O
;	O
return	O
create_long_string	function
(	O
s	pointer
,	O
len	int
,	O
hash	long
)	O
;	O
}	O
char	O
*	O
_pSLstring_dup_hashed_string	function
(	O
char	O
*	O
s	pointer
,	O
unsigned	O
long	O
hash	long
)	O
{	O
unsigned	O
int	O
len	int
;	O
Cached_String_Type	struct
*	O
cs	short
;	O
if	O
(	O
s	pointer
==	O
NULL	O
)	O
return	O
NULL	O
;	O
if	O
(	O
s	pointer
[	O
0	int
]	O
==	O
0	int
)	O
return	O
create_short_string	function
(	O
s	pointer
,	O
0	int
)	O
;	O
if	O
(	O
s	pointer
[	O
1	int
]	O
==	O
0	int
)	O
return	O
create_short_string	function
(	O
s	pointer
,	O
1	int
)	O
;	O
cs	short
=	O
GET_CACHED_STRING	O
(	O
s	pointer
)	O
;	O
if	O
(	O
cs	short
->	O
str	pointer
==	O
s	pointer
)	O
{	O
cs	short
->	O
sls	pointer
->	O
ref_count	int
+=	O
1	int
;	O
return	O
s	pointer
;	O
}	O
len	int
=	O
strlen	function
(	O
s	pointer
)	O
;	O
return	O
create_long_string	function
(	O
s	pointer
,	O
len	int
,	O
hash	long
)	O
;	O
}	O
char	O
*	O
_pSLstring_dup_slstring	function
(	O
char	O
*	O
s	pointer
)	O
{	O
SLstring_Type	struct
*	O
sls	pointer
;	O
Cached_String_Type	struct
*	O
cs	short
;	O
if	O
(	O
s	pointer
==	O
NULL	O
)	O
return	O
s	pointer
;	O
cs	short
=	O
GET_CACHED_STRING	O
(	O
s	pointer
)	O
;	O
if	O
(	O
cs	short
->	O
str	pointer
==	O
s	pointer
)	O
{	O
cs	short
->	O
sls	pointer
->	O
ref_count	int
+=	O
1	int
;	O
return	O
s	pointer
;	O
}	O
if	O
(	O
(	O
s	pointer
[	O
0	int
]	O
==	O
0	int
)	O
||	O
(	O
s	pointer
[	O
1	int
]	O
==	O
0	int
)	O
)	O
return	O
s	pointer
;	O
sls	pointer
=	O
(	O
SLstring_Type	struct
*	O
)	O
(	O
s	pointer
-	O
offsetof	O
(	O
SLstring_Type	struct
,	O
bytes	pointer
[	O
0	int
]	O
)	O
)	O
;	O
sls	pointer
->	O
ref_count	int
++	O
;	O
cache_string	function
(	O
sls	pointer
)	O
;	O
return	O
s	pointer
;	O
}	O
static	O
void	O
free_sls_string	function
(	O
SLstring_Type	struct
*	O
sls	pointer
)	O
{	O
SLstring_Type	struct
*	O
sls1	pointer
,	O
*	O
prev	pointer
;	O
unsigned	O
long	O
hash	long
=	O
sls	pointer
->	O
hash	long
;	O
hash	long
=	O
MAP_HASH_TO_INDEX	O
(	O
hash	long
)	O
;	O
sls1	pointer
=	O
String_Hash_Table	array
[	O
(	O
unsigned	O
int	O
)	O
hash	long
]	O
;	O
prev	pointer
=	O
NULL	O
;	O
while	O
(	O
sls1	pointer
!=	O
sls	pointer
)	O
{	O
prev	pointer
=	O
sls1	pointer
;	O
sls1	pointer
=	O
sls1	pointer
->	O
next	pointer
;	O
}	O
if	O
(	O
prev	pointer
!=	O
NULL	O
)	O
prev	pointer
->	O
next	pointer
=	O
sls	pointer
->	O
next	pointer
;	O
else	O
String_Hash_Table	array
[	O
(	O
unsigned	O
int	O
)	O
hash	long
]	O
=	O
sls	pointer
->	O
next	pointer
;	O
free_sls	function
(	O
sls	pointer
)	O
;	O
}	O
_INLINE_	O
static	O
void	O
free_long_string	function
(	O
char	O
*	O
s	pointer
,	O
unsigned	O
long	O
hash	long
)	O
{	O
SLstring_Type	struct
*	O
sls	pointer
;	O
if	O
(	O
NULL	O
==	O
(	O
sls	pointer
=	O
find_slstring	function
(	O
s	pointer
,	O
hash	long
)	O
)	O
)	O
{	O
SLang_verror	function
(	O
SL_APPLICATION_ERROR	O
,	O
"invalid attempt to free string:%s"	pointer
,	O
s	pointer
)	O
;	O
return	O
;	O
}	O
sls	pointer
->	O
ref_count	int
--	O
;	O
if	O
(	O
sls	pointer
->	O
ref_count	int
!=	O
0	int
)	O
{	O
return	O
;	O
}	O
uncache_string	function
(	O
s	pointer
)	O
;	O
free_sls_string	function
(	O
sls	pointer
)	O
;	O
}	O
void	O
SLang_free_slstring	function
(	O
char	O
*	O
s	pointer
)	O
{	O
unsigned	O
long	O
hash	long
;	O
unsigned	O
int	O
len	int
;	O
Cached_String_Type	struct
*	O
cs	short
;	O
if	O
(	O
s	pointer
==	O
NULL	O
)	O
return	O
;	O
cs	short
=	O
GET_CACHED_STRING	O
(	O
s	pointer
)	O
;	O
if	O
(	O
cs	short
->	O
str	pointer
==	O
s	pointer
)	O
{	O
SLstring_Type	struct
*	O
sls	pointer
=	O
cs	short
->	O
sls	pointer
;	O
if	O
(	O
sls	pointer
->	O
ref_count	int
<=	O
1	int
)	O
{	O
cs	short
->	O
sls	pointer
=	O
NULL	O
;	O
cs	short
->	O
str	pointer
=	O
Deleted_String	pointer
;	O
free_sls_string	function
(	O
sls	pointer
)	O
;	O
}	O
else	O
sls	pointer
->	O
ref_count	int
-=	O
1	int
;	O
return	O
;	O
}	O
if	O
(	O
(	O
len	int
=	O
strlen	function
(	O
s	pointer
)	O
)	O
<	O
2	int
)	O
return	O
;	O
hash	long
=	O
_pSLstring_hash	function
(	O
(	O
unsigned	O
char	O
*	O
)	O
s	pointer
,	O
(	O
unsigned	O
char	O
*	O
)	O
s	pointer
+	O
len	int
)	O
;	O
free_long_string	function
(	O
s	pointer
,	O
hash	long
)	O
;	O
}	O
char	O
*	O
SLang_create_slstring	function
(	O
char	O
*	O
s	pointer
)	O
{	O
unsigned	O
long	O
hash	long
;	O
Cached_String_Type	struct
*	O
cs	short
;	O
if	O
(	O
s	pointer
==	O
NULL	O
)	O
return	O
NULL	O
;	O
cs	short
=	O
GET_CACHED_STRING	O
(	O
s	pointer
)	O
;	O
if	O
(	O
cs	short
->	O
str	pointer
==	O
s	pointer
)	O
{	O
cs	short
->	O
sls	pointer
->	O
ref_count	int
+=	O
1	int
;	O
return	O
s	pointer
;	O
}	O
return	O
create_nstring	function
(	O
s	pointer
,	O
strlen	function
(	O
s	pointer
)	O
,	O
&	O
hash	long
)	O
;	O
}	O
void	O
_pSLfree_hashed_string	function
(	O
char	O
*	O
s	pointer
,	O
unsigned	O
int	O
len	int
,	O
unsigned	O
long	O
hash	long
)	O
{	O
if	O
(	O
(	O
s	pointer
==	O
NULL	O
)	O
||	O
(	O
len	int
<	O
2	int
)	O
)	O
return	O
;	O
free_long_string	function
(	O
s	pointer
,	O
hash	long
)	O
;	O
}	O
char	O
*	O
_pSLallocate_slstring	function
(	O
unsigned	O
int	O
len	int
)	O
{	O
SLstring_Type	struct
*	O
sls	pointer
=	O
allocate_sls	function
(	O
len	int
)	O
;	O
if	O
(	O
sls	pointer
==	O
NULL	O
)	O
return	O
NULL	O
;	O
sls	pointer
->	O
hash	long
=	O
0	int
;	O
return	O
sls	pointer
->	O
bytes	pointer
;	O
}	O
void	O
_pSLunallocate_slstring	function
(	O
char	O
*	O
s	pointer
,	O
unsigned	O
int	O
len	int
)	O
{	O
SLstring_Type	struct
*	O
sls	pointer
;	O
(	O
void	O
)	O
len	int
;	O
if	O
(	O
s	pointer
==	O
NULL	O
)	O
return	O
;	O
sls	pointer
=	O
(	O
SLstring_Type	struct
*	O
)	O
(	O
s	pointer
-	O
offsetof	O
(	O
SLstring_Type	struct
,	O
bytes	pointer
[	O
0	int
]	O
)	O
)	O
;	O
free_sls	function
(	O
sls	pointer
)	O
;	O
}	O
char	O
*	O
_pSLcreate_via_alloced_slstring	function
(	O
char	O
*	O
s	pointer
,	O
unsigned	O
int	O
len	int
)	O
{	O
unsigned	O
long	O
hash	long
;	O
SLstring_Type	struct
*	O
sls	pointer
;	O
if	O
(	O
s	pointer
==	O
NULL	O
)	O
return	O
NULL	O
;	O
if	O
(	O
len	int
<	O
2	int
)	O
{	O
char	O
*	O
s1	pointer
=	O
create_short_string	function
(	O
s	pointer
,	O
len	int
)	O
;	O
_pSLunallocate_slstring	function
(	O
s	pointer
,	O
len	int
)	O
;	O
return	O
s1	pointer
;	O
}	O
hash	long
=	O
_pSLstring_hash	function
(	O
(	O
unsigned	O
char	O
*	O
)	O
s	pointer
,	O
(	O
unsigned	O
char	O
*	O
)	O
s	pointer
+	O
len	int
)	O
;	O
sls	pointer
=	O
find_string	function
(	O
s	pointer
,	O
len	int
,	O
hash	long
)	O
;	O
if	O
(	O
sls	pointer
!=	O
NULL	O
)	O
{	O
sls	pointer
->	O
ref_count	int
++	O
;	O
_pSLunallocate_slstring	function
(	O
s	pointer
,	O
len	int
)	O
;	O
s	pointer
=	O
sls	pointer
->	O
bytes	pointer
;	O
cache_string	function
(	O
sls	pointer
)	O
;	O
return	O
s	pointer
;	O
}	O
sls	pointer
=	O
(	O
SLstring_Type	struct
*	O
)	O
(	O
s	pointer
-	O
offsetof	O
(	O
SLstring_Type	struct
,	O
bytes	pointer
[	O
0	int
]	O
)	O
)	O
;	O
sls	pointer
->	O
ref_count	int
=	O
1	int
;	O
sls	pointer
->	O
hash	long
=	O
hash	long
;	O
cache_string	function
(	O
sls	pointer
)	O
;	O
hash	long
=	O
MAP_HASH_TO_INDEX	O
(	O
hash	long
)	O
;	O
sls	pointer
->	O
next	pointer
=	O
String_Hash_Table	array
[	O
(	O
unsigned	O
int	O
)	O
hash	long
]	O
;	O
String_Hash_Table	array
[	O
(	O
unsigned	O
int	O
)	O
hash	long
]	O
=	O
sls	pointer
;	O
return	O
s	pointer
;	O
}	O
char	O
*	O
SLang_concat_slstrings	function
(	O
char	O
*	O
a	pointer
,	O
char	O
*	O
b	pointer
)	O
{	O
unsigned	O
int	O
lena	int
,	O
len	int
;	O
char	O
*	O
c	int
;	O
lena	int
=	O
strlen	function
(	O
a	pointer
)	O
;	O
len	int
=	O
lena	int
+	O
strlen	function
(	O
b	pointer
)	O
;	O
c	int
=	O
_pSLallocate_slstring	function
(	O
len	int
)	O
;	O
if	O
(	O
c	int
==	O
NULL	O
)	O
return	O
NULL	O
;	O
strcpy	function
(	O
c	int
,	O
a	pointer
)	O
;	O
strcpy	function
(	O
c	int
+	O
lena	int
,	O
b	pointer
)	O
;	O
return	O
_pSLcreate_via_alloced_slstring	function
(	O
c	int
,	O
len	int
)	O
;	O
}	O
unsigned	O
int	O
_pSLstring_bytelen	function
(	O
SLstr_Type	char
*	O
s	pointer
)	O
{	O
Cached_String_Type	struct
*	O
cs	short
;	O
cs	short
=	O
GET_CACHED_STRING	O
(	O
s	pointer
)	O
;	O
if	O
(	O
cs	short
->	O
str	pointer
==	O
s	pointer
)	O
return	O
cs	short
->	O
sls	pointer
->	O
len	int
;	O
return	O
strlen	function
(	O
s	pointer
)	O
;	O
}	O
void	O
_pSLang_free_slstring	function
(	O
SLstr_Type	char
*	O
s	pointer
)	O
{	O
Cached_String_Type	struct
*	O
cs	short
;	O
SLstring_Type	struct
*	O
sls	pointer
;	O
if	O
(	O
s	pointer
==	O
NULL	O
)	O
return	O
;	O
cs	short
=	O
GET_CACHED_STRING	O
(	O
s	pointer
)	O
;	O
if	O
(	O
cs	short
->	O
str	pointer
==	O
s	pointer
)	O
{	O
sls	pointer
=	O
cs	short
->	O
sls	pointer
;	O
if	O
(	O
sls	pointer
->	O
ref_count	int
<=	O
1	int
)	O
{	O
cs	short
->	O
sls	pointer
=	O
NULL	O
;	O
cs	short
->	O
str	pointer
=	O
Deleted_String	pointer
;	O
free_sls_string	function
(	O
sls	pointer
)	O
;	O
}	O
else	O
sls	pointer
->	O
ref_count	int
-=	O
1	int
;	O
return	O
;	O
}	O
if	O
(	O
(	O
s	pointer
[	O
0	int
]	O
==	O
0	int
)	O
||	O
(	O
s	pointer
[	O
1	int
]	O
==	O
0	int
)	O
)	O
return	O
;	O
sls	pointer
=	O
(	O
SLstring_Type	struct
*	O
)	O
(	O
s	pointer
-	O
offsetof	O
(	O
SLstring_Type	struct
,	O
bytes	pointer
[	O
0	int
]	O
)	O
)	O
;	O
if	O
(	O
sls	pointer
->	O
ref_count	int
>	O
1	int
)	O
{	O
sls	pointer
->	O
ref_count	int
--	O
;	O
return	O
;	O
}	O
free_long_string	function
(	O
s	pointer
,	O
sls	pointer
->	O
hash	long
)	O
;	O
}	O
unsigned	O
long	O
_pSLstring_get_hash	function
(	O
SLstr_Type	char
*	O
s	pointer
)	O
{	O
SLstring_Type	struct
*	O
sls	pointer
;	O
if	O
(	O
s	pointer
[	O
0	int
]	O
==	O
0	int
)	O
return	O
_pSLstring_hash	function
(	O
(	O
unsigned	O
char	O
*	O
)	O
s	pointer
,	O
(	O
unsigned	O
char	O
*	O
)	O
s	pointer
)	O
;	O
if	O
(	O
s	pointer
[	O
1	int
]	O
==	O
0	int
)	O
return	O
_pSLstring_hash	function
(	O
(	O
unsigned	O
char	O
*	O
)	O
s	pointer
,	O
(	O
unsigned	O
char	O
*	O
)	O
s	pointer
+	O
1	int
)	O
;	O
sls	pointer
=	O
(	O
SLstring_Type	struct
*	O
)	O
(	O
s	pointer
-	O
offsetof	O
(	O
SLstring_Type	struct
,	O
bytes	pointer
[	O
0	int
]	O
)	O
)	O
;	O
return	O
sls	pointer
->	O
hash	long
;	O
}	O
