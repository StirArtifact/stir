struct	O
wget_thread_st	struct
{	O
gl_thread_t	O
tid	long
;	O
}	O
;	O
struct	O
wget_thread_mutex_st	struct
{	O
gl_lock_t	*
mutex	*
;	O
}	O
;	O
struct	O
wget_thread_cond_st	struct
{	O
gl_cond_t	struct
cond	struct
;	O
}	O
;	O
int	O
wget_thread_mutex_init	function
(	O
wget_thread_mutex	*
*	O
mutex	*
)	O
{	O
*	O
mutex	*
=	O
wget_malloc	function
(	O
sizeof	O
(	O
struct	O
wget_thread_mutex_st	struct
)	O
)	O
;	O
if	O
(	O
!	O
*	O
mutex	*
)	O
return	O
WGET_E_MEMORY	int
;	O
return	O
glthread_lock_init	function
(	O
&	O
(	O
(	O
*	O
mutex	*
)	O
->	O
mutex	*
)	O
)	O
;	O
}	O
int	O
wget_thread_mutex_destroy	function
(	O
wget_thread_mutex	*
*	O
mutex	*
)	O
{	O
int	O
rc	int
=	O
glthread_lock_destroy	function
(	O
&	O
(	O
*	O
mutex	*
)	O
->	O
mutex	*
)	O
;	O
xfree	function
(	O
*	O
mutex	*
)	O
;	O
return	O
rc	int
;	O
}	O
void	O
wget_thread_mutex_lock	function
(	O
wget_thread_mutex	*
mutex	*
)	O
{	O
glthread_lock_lock	function
(	O
&	O
mutex	*
->	O
mutex	union
)	O
;	O
}	O
void	O
wget_thread_mutex_unlock	function
(	O
wget_thread_mutex	*
mutex	*
)	O
{	O
glthread_lock_unlock	function
(	O
&	O
mutex	*
->	O
mutex	union
)	O
;	O
}	O
int	O
wget_thread_cond_init	function
(	O
wget_thread_cond	*
*	O
cond	*
)	O
{	O
*	O
cond	*
=	O
wget_malloc	function
(	O
sizeof	O
(	O
struct	O
wget_thread_cond_st	struct
)	O
)	O
;	O
if	O
(	O
!	O
*	O
cond	*
)	O
return	O
WGET_E_MEMORY	int
;	O
return	O
glthread_cond_init	function
(	O
&	O
(	O
(	O
*	O
cond	*
)	O
->	O
cond	union
)	O
)	O
;	O
}	O
int	O
wget_thread_cond_destroy	function
(	O
wget_thread_cond	*
*	O
cond	*
)	O
{	O
int	O
rc	int
=	O
glthread_cond_destroy	function
(	O
&	O
(	O
*	O
cond	*
)	O
->	O
cond	union
)	O
;	O
xfree	function
(	O
*	O
cond	*
)	O
;	O
return	O
rc	int
;	O
}	O
int	O
wget_thread_cond_signal	function
(	O
wget_thread_cond	struct
cond	*
)	O
{	O
return	O
glthread_cond_broadcast	function
(	O
&	O
cond	*
->	O
cond	union
)	O
;	O
}	O
int	O
wget_thread_cond_wait	function
(	O
wget_thread_cond	*
cond	*
,	O
wget_thread_mutex	*
mutex	*
,	O
long	O
long	O
ms	long
)	O
{	O
if	O
(	O
ms	int
<=	O
0	int
)	O
return	O
glthread_cond_wait	function
(	O
&	O
cond	*
->	O
cond	union
,	O
&	O
mutex	*
->	O
mutex	union
)	O
;	O
struct	O
timespec	struct
ts	struct
;	O
gettime	function
(	O
&	O
ts	*
)	O
;	O
ms	int
+=	O
ts	struct
.	O
tv_sec	long
*	O
1000LL	int
+	O
ts	struct
.	O
tv_nsec	long
/	O
1000000	int
;	O
ts	struct
.	O
tv_sec	long
=	O
ms	long
/	O
1000	int
;	O
ts	struct
.	O
tv_nsec	long
=	O
(	O
ms	int
%	O
1000	int
)	O
*	O
1000000	int
;	O
return	O
glthread_cond_timedwait	function
(	O
&	O
cond	*
->	O
cond	union
,	O
&	O
mutex	*
->	O
mutex	union
,	O
&	O
ts	char
)	O
;	O
}	O
int	O
wget_thread_start	function
(	O
wget_thread	*
*	O
thread	*
,	O
void	O
*	O
(	O
*	O
start_routine	*
)	O
(	O
void	O
*	O
)	O
,	O
void	O
*	O
arg	*
,	O
WGET_GCC_UNUSED	O
int	O
flags	int
)	O
{	O
if	O
(	O
wget_thread_support	function
(	O
)	O
)	O
{	O
*	O
thread	*
=	O
wget_malloc	function
(	O
sizeof	O
(	O
struct	O
wget_thread_st	struct
)	O
)	O
;	O
if	O
(	O
!	O
*	O
thread	*
)	O
return	O
WGET_E_MEMORY	int
;	O
return	O
glthread_create	function
(	O
&	O
(	O
(	O
*	O
thread	*
)	O
->	O
tid	long
)	O
,	O
start_routine	*
,	O
arg	*
)	O
;	O
}	O
*	O
thread	*
=	O
NULL	O
;	O
start_routine	function
(	O
arg	*
)	O
;	O
return	O
0	int
;	O
}	O
int	O
wget_thread_cancel	function
(	O
WGET_GCC_UNUSED	O
wget_thread	*
thread	*
)	O
{	O
return	O
0	int
;	O
}	O
int	O
wget_thread_kill	function
(	O
WGET_GCC_UNUSED	O
wget_thread	*
thread	*
,	O
WGET_GCC_UNUSED	O
int	O
sig	int
)	O
{	O
return	O
0	int
;	O
}	O
int	O
wget_thread_join	function
(	O
wget_thread	*
*	O
thread	*
)	O
{	O
if	O
(	O
thread	long
&&	O
*	O
thread	*
&&	O
(	O
*	O
thread	*
)	O
->	O
tid	long
)	O
{	O
int	O
rc	int
=	O
glthread_join	function
(	O
(	O
*	O
thread	*
)	O
->	O
tid	long
,	O
NULL	O
)	O
;	O
xfree	function
(	O
*	O
thread	*
)	O
;	O
return	O
rc	int
;	O
}	O
if	O
(	O
wget_thread_support	function
(	O
)	O
)	O
{	O
errno	O
=	O
ESRCH	int
;	O
return	O
-	O
1	int
;	O
}	O
return	O
0	int
;	O
}	O
wget_thread_id	O
wget_thread_self	function
(	O
void	O
)	O
{	O
return	O
gl_thread_self	function
(	O
)	O
;	O
}	O
bool	bool
wget_thread_support	function
(	O
void	O
)	O
{	O
return	O
true	int
;	O
}	O