extern	O
FILE	struct
*	O
dap_err	pointer
;	O
static	O
int	O
orient	int
;	O
static	O
int	O
bboxx0	int
,	O
bboxy0	int
,	O
bboxx1	int
,	O
bboxy1	int
;	O
static	O
FILE	struct
*	O
pict_out	pointer
=	O
NULL	O
;	O
static	O
int	O
pageno	int
;	O
static	O
double	O
*	O
*	O
ptbuf	pointer
;	O
static	O
int	O
ptnext	int
=	O
0	int
;	O
static	O
char	O
*	O
charbuf	pointer
;	O
static	O
int	O
charnext	int
=	O
0	int
;	O
extern	O
char	O
*	O
dap_psname	pointer
;	O
void	O
dap_initpict	function
(	O
)	O
{	O
double	O
*	O
ptmem	pointer
;	O
int	O
p	double
;	O
ptmem	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
2	int
*	O
dap_maxpts	int
,	O
"dap_maxpts"	pointer
)	O
;	O
ptbuf	pointer
=	O
(	O
double	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
*	O
)	O
*	O
dap_maxpts	int
,	O
"dap_maxpts"	pointer
)	O
;	O
for	O
(	O
p	double
=	O
0	int
;	O
p	double
<	O
dap_maxpts	int
;	O
p	double
++	O
)	O
ptbuf	pointer
[	O
p	double
]	O
=	O
ptmem	pointer
+	O
p	double
*	O
2	int
;	O
charbuf	pointer
=	O
dap_malloc	function
(	O
dap_maxchar	int
+	O
1	int
,	O
"dap_maxchar"	pointer
)	O
;	O
}	O
static	O
double	O
(	O
*	O
pict_newpoint	function
(	O
double	O
x	array
,	O
double	O
y	double
)	O
)	O
[	O
2	int
]	O
{	O
double	O
(	O
*	O
pt	double
)	O
[	O
2	int
]	O
;	O
if	O
(	O
ptnext	int
<	O
dap_maxpts	int
)	O
{	O
ptbuf	pointer
[	O
ptnext	int
]	O
[	O
0	int
]	O
=	O
x	array
;	O
ptbuf	pointer
[	O
ptnext	int
]	O
[	O
1	int
]	O
=	O
y	double
;	O
pt	double
=	O
(	O
double	O
(	O
*	O
)	O
[	O
2	int
]	O
)	O
ptbuf	pointer
[	O
ptnext	int
]	O
;	O
ptnext	int
++	O
;	O
}	O
else	O
{	O
fputs	function
(	O
"(pict_newpoint) Too many points.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
return	O
pt	double
;	O
}	O
char	O
*	O
pict_newstr	function
(	O
char	O
*	O
str	array
)	O
{	O
int	O
s	int
;	O
char	O
*	O
s0	pointer
;	O
s0	pointer
=	O
charbuf	pointer
+	O
charnext	int
;	O
if	O
(	O
str	array
)	O
{	O
for	O
(	O
s	int
=	O
0	int
;	O
str	array
[	O
s	int
]	O
;	O
s	int
++	O
)	O
{	O
if	O
(	O
charnext	int
<	O
dap_maxchar	int
)	O
charbuf	pointer
[	O
charnext	int
++	O
]	O
=	O
str	array
[	O
s	int
]	O
;	O
else	O
{	O
fputs	function
(	O
"(pict_newstr) Too many characters.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
}	O
charbuf	pointer
[	O
charnext	int
++	O
]	O
=	O
'\0'	O
;	O
return	O
s0	pointer
;	O
}	O
void	O
pict_init	function
(	O
int	O
or	int
,	O
int	O
bbx0	int
,	O
int	O
bby0	int
,	O
int	O
bbx1	int
,	O
int	O
bby1	int
,	O
int	O
npages	int
)	O
{	O
time_t	long
t	double
;	O
if	O
(	O
!	O
pict_out	pointer
)	O
{	O
if	O
(	O
!	O
(	O
pict_out	pointer
=	O
fopen	function
(	O
dap_psname	pointer
,	O
"w"	pointer
)	O
)	O
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(pict_init) Can't create .ps file: %s\n"	pointer
,	O
dap_psname	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
orient	int
=	O
or	int
;	O
bboxx0	int
=	O
bbx0	int
;	O
bboxy0	int
=	O
bby0	int
;	O
bboxx1	int
=	O
bbx1	int
;	O
bboxy1	int
=	O
bby1	int
;	O
fputs	function
(	O
"%!PS-Adobe-2.0\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fprintf	function
(	O
pict_out	pointer
,	O
"%%Title: %s\n"	pointer
,	O
dap_psname	pointer
)	O
;	O
fputs	function
(	O
"%%Creator: ps.c\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"%%CreationDate: "	pointer
,	O
pict_out	pointer
)	O
;	O
time	function
(	O
&	O
t	double
)	O
;	O
fputs	function
(	O
ctime	function
(	O
&	O
t	double
)	O
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"%%For: bassein@localhost.localdomain (,,,,)\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fprintf	function
(	O
pict_out	pointer
,	O
"%s %s\n"	pointer
,	O
"%%Orientation:"	pointer
,	O
(	O
(	O
orient	int
==	O
'p'	O
)	O
?	O
"Portrait"	pointer
:	O
"Landscape"	pointer
)	O
)	O
;	O
fprintf	function
(	O
pict_out	pointer
,	O
"%s %d %d %d %d\n"	pointer
,	O
"%%BoundingBox:"	pointer
,	O
bboxx0	int
,	O
bboxy0	int
,	O
bboxx1	int
,	O
bboxy1	int
)	O
;	O
fprintf	function
(	O
pict_out	pointer
,	O
"%s %d\n"	pointer
,	O
"%%Pages:"	pointer
,	O
npages	int
)	O
;	O
fputs	function
(	O
"%%BeginSetup\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"%%IncludeFeature: *PageSize Letter\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"%%EndSetup\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"%%Magnification: 1.0000\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"%%EndComments\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"/cp {closepath} bind def /gr {grestore} bind def /gs {gsave} bind def\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"/sa {save} bind def /rs {restore} bind def /l {lineto} bind def\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"/rl {rlineto} bind def /ar {arc} bind def\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"/m {moveto} bind def /rm {rmoveto} bind def /n {newpath} bind def\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"/f {fill} bind def /s {stroke} bind def /sh {show} bind def\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"/slw {setlinewidth} bind def /sg {setgray} bind def /rot {rotate} bind def\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"/sc {scale} bind def /sd {setdash} bind def /ff {findfont} bind def\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"/sf {setfont} bind def /scf {scalefont} bind def /sw {stringwidth} bind def\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"/tr {translate} bind def\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"%%EndProlog\n"	pointer
,	O
pict_out	pointer
)	O
;	O
pageno	int
=	O
0	int
;	O
}	O
void	O
pict_port	function
(	O
int	O
npages	int
)	O
{	O
pict_init	function
(	O
'p'	O
,	O
0	int
,	O
0	int
,	O
612	int
,	O
792	int
,	O
npages	int
)	O
;	O
}	O
void	O
pict_land	function
(	O
int	O
npages	int
)	O
{	O
pict_init	function
(	O
'l'	O
,	O
0	int
,	O
0	int
,	O
612	int
,	O
792	int
,	O
npages	int
)	O
;	O
}	O
void	O
pict_end	function
(	O
)	O
{	O
fputs	function
(	O
"gr\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"showpage\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"%%Trailer\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fflush	function
(	O
pict_out	pointer
)	O
;	O
}	O
void	O
pict_page	function
(	O
)	O
{	O
if	O
(	O
pageno	int
)	O
{	O
fputs	function
(	O
"gr\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fputs	function
(	O
"showpage\n"	pointer
,	O
pict_out	pointer
)	O
;	O
}	O
pageno	int
++	O
;	O
fprintf	function
(	O
pict_out	pointer
,	O
"%%%%Page: %d %d\n"	pointer
,	O
pageno	int
,	O
pageno	int
)	O
;	O
fputs	function
(	O
"gs\n"	pointer
,	O
pict_out	pointer
)	O
;	O
if	O
(	O
orient	int
==	O
'l'	O
)	O
fprintf	function
(	O
pict_out	pointer
,	O
"%d %d tr 90 rot %d %d tr\n"	pointer
,	O
bboxy0	int
+	O
bboxx1	int
,	O
bboxy0	int
,	O
-	O
bboxx0	int
,	O
-	O
bboxy0	int
)	O
;	O
}	O
void	O
pict_clearpict	function
(	O
pict	struct
*	O
p	double
)	O
{	O
dap_free	function
(	O
p	double
->	O
pict_txt	pointer
,	O
""	pointer
)	O
;	O
p	double
->	O
pict_txt	pointer
=	O
NULL	O
;	O
dap_free	function
(	O
p	double
->	O
pict_font	pointer
,	O
""	pointer
)	O
;	O
p	double
->	O
pict_font	pointer
=	O
NULL	O
;	O
dap_free	function
(	O
p	double
->	O
pict_tpt	pointer
[	O
0	int
]	O
,	O
""	pointer
)	O
;	O
dap_free	function
(	O
p	double
->	O
pict_tang	pointer
,	O
""	pointer
)	O
;	O
p	double
->	O
pict_tang	pointer
=	O
NULL	O
;	O
dap_free	function
(	O
p	double
->	O
pict_pos	pointer
[	O
0	int
]	O
,	O
""	pointer
)	O
;	O
}	O
void	O
pict_initpict	function
(	O
pict	struct
*	O
prev	pointer
,	O
pict	struct
*	O
p	double
)	O
{	O
double	O
*	O
dblmem	pointer
;	O
char	O
*	O
charmem	pointer
;	O
int	O
t	double
;	O
p	double
->	O
pict_npts	int
=	O
0	int
;	O
p	double
->	O
pict_ntxt	int
=	O
0	int
;	O
p	double
->	O
pict_txt	pointer
=	O
(	O
char	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
char	O
*	O
)	O
*	O
dap_maxntxt	int
,	O
"dap_maxntxt"	pointer
)	O
;	O
strcpy	function
(	O
p	double
->	O
pict_type	array
,	O
"LINE"	pointer
)	O
;	O
p	double
->	O
pict_dash	double
=	O
0.0	int
;	O
p	double
->	O
pict_font	pointer
=	O
dap_malloc	function
(	O
dap_maxfont	int
+	O
1	int
,	O
"dap_maxfont"	pointer
)	O
;	O
strcpy	function
(	O
p	double
->	O
pict_font	pointer
,	O
"Helvetica-Bold"	pointer
)	O
;	O
dblmem	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
2	int
*	O
dap_maxntxt	int
,	O
"dap_maxntxt"	pointer
)	O
;	O
p	double
->	O
pict_tpt	pointer
=	O
(	O
double	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
*	O
)	O
*	O
dap_maxntxt	int
,	O
"dap_maxntxt"	pointer
)	O
;	O
for	O
(	O
t	double
=	O
0	int
;	O
t	double
<	O
dap_maxntxt	int
;	O
t	double
++	O
)	O
p	double
->	O
pict_tpt	pointer
[	O
t	double
]	O
=	O
dblmem	pointer
+	O
2	int
*	O
t	double
;	O
p	double
->	O
pict_tang	pointer
=	O
(	O
double	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
double	O
)	O
*	O
dap_maxntxt	int
,	O
"dap_maxntxt"	pointer
)	O
;	O
charmem	pointer
=	O
dap_malloc	function
(	O
3	int
*	O
dap_maxntxt	int
,	O
"dap_maxntxt"	pointer
)	O
;	O
p	double
->	O
pict_pos	pointer
=	O
(	O
char	O
*	O
*	O
)	O
dap_malloc	function
(	O
sizeof	O
(	O
char	O
*	O
)	O
*	O
dap_maxntxt	int
,	O
"dap_maxntxt"	pointer
)	O
;	O
for	O
(	O
t	double
=	O
0	int
;	O
t	double
<	O
dap_maxntxt	int
;	O
t	double
++	O
)	O
p	double
->	O
pict_pos	pointer
[	O
t	double
]	O
=	O
charmem	pointer
+	O
3	int
*	O
t	double
;	O
p	double
->	O
pict_fs	double
=	O
12.0	int
;	O
p	double
->	O
pict_lw	double
=	O
0.4	int
;	O
p	double
->	O
pict_lgray	double
=	O
0.0	int
;	O
p	double
->	O
pict_fgray	double
=	O
-	O
1.0	int
;	O
p	double
->	O
pict_patt	pointer
=	O
NULL	O
;	O
p	double
->	O
pict_next	pointer
=	O
NULL	O
;	O
if	O
(	O
prev	pointer
)	O
prev	pointer
->	O
pict_next	pointer
=	O
p	double
;	O
}	O
void	O
pict_text	function
(	O
pict	struct
*	O
p	double
,	O
char	O
*	O
str	array
,	O
double	O
x	array
,	O
double	O
y	double
,	O
double	O
tang	double
,	O
char	O
pos	array
[	O
]	O
)	O
{	O
if	O
(	O
!	O
str	array
)	O
return	O
;	O
if	O
(	O
p	double
->	O
pict_ntxt	int
<	O
dap_maxntxt	int
-	O
1	int
)	O
{	O
p	double
->	O
pict_txt	pointer
[	O
p	double
->	O
pict_ntxt	int
]	O
=	O
pict_newstr	function
(	O
str	array
)	O
;	O
p	double
->	O
pict_tpt	pointer
[	O
p	double
->	O
pict_ntxt	int
]	O
[	O
0	int
]	O
=	O
x	array
;	O
p	double
->	O
pict_tpt	pointer
[	O
p	double
->	O
pict_ntxt	int
]	O
[	O
1	int
]	O
=	O
y	double
;	O
if	O
(	O
strlen	function
(	O
pos	array
)	O
<=	O
3	int
)	O
{	O
strcpy	function
(	O
p	double
->	O
pict_pos	pointer
[	O
p	double
->	O
pict_ntxt	int
]	O
,	O
pos	array
)	O
;	O
if	O
(	O
(	O
pos	array
[	O
0	int
]	O
!=	O
'l'	O
&&	O
pos	array
[	O
0	int
]	O
!=	O
'c'	O
&&	O
pos	array
[	O
0	int
]	O
!=	O
'r'	O
)	O
||	O
(	O
pos	array
[	O
1	int
]	O
!=	O
't'	O
&&	O
pos	array
[	O
1	int
]	O
!=	O
'm'	O
&&	O
pos	array
[	O
1	int
]	O
!=	O
'b'	O
)	O
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(pict_text) Invalid position string: %s\n"	pointer
,	O
pos	array
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
else	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(pict_text) Position string too long: %s\n"	pointer
,	O
pos	array
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
p	double
->	O
pict_tang	pointer
[	O
p	double
->	O
pict_ntxt	int
]	O
=	O
tang	double
;	O
p	double
->	O
pict_ntxt	int
++	O
;	O
}	O
else	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(pict_text) Too many texts in pict\n"	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
void	O
pict_circle	function
(	O
pict	struct
*	O
p	double
,	O
double	O
cx	double
,	O
double	O
cy	double
,	O
double	O
r	double
)	O
{	O
p	double
->	O
pict_npts	int
=	O
1	int
;	O
strcpy	function
(	O
p	double
->	O
pict_type	array
,	O
"CIRC"	pointer
)	O
;	O
p	double
->	O
pict_pt	pointer
=	O
pict_newpoint	function
(	O
cx	double
,	O
cy	double
)	O
;	O
p	double
->	O
pict_r	double
=	O
r	double
;	O
}	O
void	O
pict_rectangle	function
(	O
pict	struct
*	O
p	double
,	O
double	O
llx	double
,	O
double	O
lly	double
,	O
double	O
sx	double
,	O
double	O
sy	double
)	O
{	O
strcpy	function
(	O
p	double
->	O
pict_type	array
,	O
"LINE"	pointer
)	O
;	O
pict_point	function
(	O
p	double
,	O
llx	double
,	O
lly	double
)	O
;	O
pict_point	function
(	O
p	double
,	O
llx	double
+	O
sx	double
,	O
lly	double
)	O
;	O
pict_point	function
(	O
p	double
,	O
llx	double
+	O
sx	double
,	O
lly	double
+	O
sy	double
)	O
;	O
pict_point	function
(	O
p	double
,	O
llx	double
,	O
lly	double
+	O
sy	double
)	O
;	O
pict_point	function
(	O
p	double
,	O
llx	double
,	O
lly	double
)	O
;	O
}	O
void	O
pict_hrect	function
(	O
pict	struct
*	O
p	double
,	O
double	O
spacing	double
,	O
double	O
x0	double
,	O
double	O
y0	function
,	O
double	O
xside	double
,	O
double	O
yside	double
)	O
{	O
int	O
vlines	int
,	O
hlines	int
;	O
int	O
linen	int
;	O
int	O
ptn	int
;	O
double	O
xl	double
,	O
xr	double
,	O
yb	double
,	O
yt	double
;	O
int	O
even	int
;	O
vlines	int
=	O
(	O
int	O
)	O
floor	function
(	O
yside	double
/	O
spacing	double
)	O
;	O
hlines	int
=	O
(	O
int	O
)	O
floor	function
(	O
xside	double
/	O
spacing	double
)	O
;	O
pict_point	function
(	O
p	double
,	O
x0	double
,	O
y0	function
+	O
yside	double
)	O
;	O
pict_point	function
(	O
p	double
,	O
x0	double
,	O
y0	function
)	O
;	O
pict_point	function
(	O
p	double
,	O
x0	double
+	O
xside	double
,	O
y0	function
)	O
;	O
pict_point	function
(	O
p	double
,	O
x0	double
+	O
xside	double
,	O
y0	function
+	O
yside	double
)	O
;	O
pict_point	function
(	O
p	double
,	O
x0	double
,	O
y0	function
+	O
yside	double
)	O
;	O
for	O
(	O
linen	int
=	O
-	O
vlines	int
,	O
ptn	int
=	O
0	int
,	O
even	int
=	O
0	int
;	O
linen	int
<=	O
hlines	int
;	O
linen	int
++	O
,	O
ptn	int
+=	O
2	int
,	O
even	int
=	O
1	int
-	O
even	int
)	O
{	O
xl	double
=	O
x0	double
+	O
(	O
(	O
double	O
)	O
linen	int
)	O
*	O
spacing	double
;	O
yb	double
=	O
y0	function
;	O
xr	double
=	O
xl	double
+	O
yside	double
;	O
yt	double
=	O
y0	function
+	O
yside	double
;	O
if	O
(	O
xl	double
<	O
x0	double
)	O
{	O
yb	double
+=	O
x0	double
-	O
xl	double
;	O
xl	double
=	O
x0	double
;	O
}	O
if	O
(	O
xr	double
>	O
x0	double
+	O
xside	double
)	O
{	O
if	O
(	O
!	O
even	int
&&	O
xr	double
<	O
x0	double
+	O
xside	double
+	O
spacing	double
)	O
pict_point	function
(	O
p	double
,	O
x0	double
+	O
xside	double
,	O
y0	function
+	O
yside	double
)	O
;	O
yt	double
-=	O
xr	double
-	O
x0	double
-	O
xside	double
;	O
xr	double
=	O
x0	double
+	O
xside	double
;	O
}	O
if	O
(	O
even	int
)	O
{	O
pict_point	function
(	O
p	double
,	O
xl	double
,	O
yb	double
)	O
;	O
pict_point	function
(	O
p	double
,	O
xr	double
,	O
yt	double
)	O
;	O
}	O
else	O
{	O
pict_point	function
(	O
p	double
,	O
xr	double
,	O
yt	double
)	O
;	O
pict_point	function
(	O
p	double
,	O
xl	double
,	O
yb	double
)	O
;	O
}	O
}	O
}	O
void	O
pict_bhrect	function
(	O
pict	struct
*	O
p	double
,	O
double	O
spacing	double
,	O
double	O
x0	double
,	O
double	O
y0	function
,	O
double	O
xside	double
,	O
double	O
yside	double
)	O
{	O
int	O
vlines	int
,	O
hlines	int
;	O
int	O
linen	int
;	O
int	O
ptn	int
;	O
double	O
xl	double
,	O
xr	double
,	O
yb	double
,	O
yt	double
;	O
int	O
even	int
;	O
vlines	int
=	O
(	O
int	O
)	O
floor	function
(	O
yside	double
/	O
spacing	double
)	O
;	O
hlines	int
=	O
(	O
int	O
)	O
floor	function
(	O
xside	double
/	O
spacing	double
)	O
;	O
pict_point	function
(	O
p	double
,	O
x0	double
,	O
y0	function
)	O
;	O
pict_point	function
(	O
p	double
,	O
x0	double
+	O
xside	double
,	O
y0	function
)	O
;	O
pict_point	function
(	O
p	double
,	O
x0	double
+	O
xside	double
,	O
y0	function
+	O
yside	double
)	O
;	O
pict_point	function
(	O
p	double
,	O
x0	double
,	O
y0	function
+	O
yside	double
)	O
;	O
pict_point	function
(	O
p	double
,	O
x0	double
,	O
y0	function
)	O
;	O
for	O
(	O
linen	int
=	O
-	O
vlines	int
,	O
ptn	int
=	O
0	int
,	O
even	int
=	O
0	int
;	O
linen	int
<=	O
hlines	int
;	O
linen	int
++	O
,	O
ptn	int
+=	O
2	int
,	O
even	int
=	O
1	int
-	O
even	int
)	O
{	O
xl	double
=	O
x0	double
+	O
(	O
(	O
double	O
)	O
linen	int
)	O
*	O
spacing	double
;	O
yt	double
=	O
y0	function
+	O
yside	double
;	O
xr	double
=	O
xl	double
+	O
yside	double
;	O
yb	double
=	O
y0	function
;	O
if	O
(	O
xl	double
<	O
x0	double
)	O
{	O
yt	double
-=	O
x0	double
-	O
xl	double
;	O
xl	double
=	O
x0	double
;	O
}	O
if	O
(	O
xr	double
>	O
x0	double
+	O
xside	double
)	O
{	O
if	O
(	O
!	O
even	int
&&	O
xr	double
<	O
x0	double
+	O
xside	double
+	O
spacing	double
)	O
pict_point	function
(	O
p	double
,	O
x0	double
+	O
xside	double
,	O
y0	function
)	O
;	O
yb	double
+=	O
xr	double
-	O
x0	double
-	O
xside	double
;	O
xr	double
=	O
x0	double
+	O
xside	double
;	O
}	O
if	O
(	O
even	int
)	O
{	O
pict_point	function
(	O
p	double
,	O
xl	double
,	O
yt	double
)	O
;	O
pict_point	function
(	O
p	double
,	O
xr	double
,	O
yb	double
)	O
;	O
}	O
else	O
{	O
pict_point	function
(	O
p	double
,	O
xr	double
,	O
yb	double
)	O
;	O
pict_point	function
(	O
p	double
,	O
xl	double
,	O
yt	double
)	O
;	O
}	O
}	O
}	O
void	O
pict_point	function
(	O
pict	struct
*	O
p	double
,	O
double	O
x	array
,	O
double	O
y	double
)	O
{	O
if	O
(	O
!	O
p	double
->	O
pict_npts	int
)	O
{	O
p	double
->	O
pict_minx	double
=	O
x	array
;	O
p	double
->	O
pict_maxx	double
=	O
x	array
;	O
p	double
->	O
pict_miny	double
=	O
y	double
;	O
p	double
->	O
pict_maxy	double
=	O
y	double
;	O
p	double
->	O
pict_pt	pointer
=	O
pict_newpoint	function
(	O
x	array
,	O
y	double
)	O
;	O
}	O
else	O
{	O
if	O
(	O
x	array
<	O
p	double
->	O
pict_minx	double
)	O
p	double
->	O
pict_minx	double
=	O
x	array
;	O
if	O
(	O
x	array
>	O
p	double
->	O
pict_maxx	double
)	O
p	double
->	O
pict_maxx	double
=	O
x	array
;	O
if	O
(	O
y	double
<	O
p	double
->	O
pict_miny	double
)	O
p	double
->	O
pict_miny	double
=	O
y	double
;	O
if	O
(	O
y	double
>	O
p	double
->	O
pict_maxy	double
)	O
p	double
->	O
pict_maxy	double
=	O
y	double
;	O
pict_newpoint	function
(	O
x	array
,	O
y	double
)	O
;	O
}	O
p	double
->	O
pict_npts	int
++	O
;	O
}	O
void	O
pict_line	function
(	O
pict	struct
*	O
p	double
,	O
double	O
x0	double
,	O
double	O
y0	function
,	O
double	O
x1	double
,	O
double	O
y1	function
)	O
{	O
pict_point	function
(	O
p	double
,	O
x0	double
,	O
y0	function
)	O
;	O
pict_point	function
(	O
p	double
,	O
x1	double
,	O
y1	function
)	O
;	O
}	O
void	O
pict_curve	function
(	O
pict	struct
*	O
p	double
,	O
double	O
(	O
*	O
xf	pointer
)	O
(	O
double	O
t	double
)	O
,	O
double	O
(	O
*	O
yf	pointer
)	O
(	O
double	O
t	double
)	O
,	O
double	O
t0	double
,	O
double	O
t1	double
,	O
int	O
nsteps	int
)	O
{	O
int	O
step	function
;	O
double	O
h	double
;	O
double	O
t	double
;	O
h	double
=	O
(	O
t1	double
-	O
t0	double
)	O
/	O
(	O
(	O
double	O
)	O
nsteps	int
)	O
;	O
for	O
(	O
step	function
=	O
0	int
;	O
step	function
<=	O
nsteps	int
;	O
step	function
++	O
)	O
{	O
t	double
=	O
t0	double
+	O
(	O
(	O
double	O
)	O
step	function
)	O
*	O
h	double
;	O
if	O
(	O
xf	pointer
)	O
pict_point	function
(	O
p	double
,	O
(	O
*	O
xf	pointer
)	O
(	O
t	double
)	O
,	O
(	O
*	O
yf	pointer
)	O
(	O
t	double
)	O
)	O
;	O
else	O
pict_point	function
(	O
p	double
,	O
t	double
,	O
(	O
*	O
yf	pointer
)	O
(	O
t	double
)	O
)	O
;	O
}	O
}	O
void	O
pict_scale	function
(	O
pict	struct
*	O
p	double
,	O
double	O
cx	double
,	O
double	O
cy	double
,	O
double	O
sx	double
,	O
double	O
sy	double
)	O
{	O
int	O
ptn	int
;	O
int	O
t	double
;	O
while	O
(	O
p	double
)	O
{	O
if	O
(	O
sx	double
>=	O
sy	double
)	O
p	double
->	O
pict_r	double
*=	O
sy	double
;	O
else	O
p	double
->	O
pict_r	double
*=	O
sx	double
;	O
for	O
(	O
t	double
=	O
0	int
;	O
t	double
<	O
p	double
->	O
pict_ntxt	int
;	O
t	double
++	O
)	O
{	O
p	double
->	O
pict_tpt	pointer
[	O
t	double
]	O
[	O
0	int
]	O
=	O
cx	double
+	O
sx	double
*	O
(	O
p	double
->	O
pict_tpt	pointer
[	O
t	double
]	O
[	O
0	int
]	O
-	O
cx	double
)	O
;	O
p	double
->	O
pict_tpt	pointer
[	O
t	double
]	O
[	O
1	int
]	O
=	O
cy	double
+	O
sy	double
*	O
(	O
p	double
->	O
pict_tpt	pointer
[	O
t	double
]	O
[	O
1	int
]	O
-	O
cy	double
)	O
;	O
}	O
for	O
(	O
ptn	int
=	O
0	int
;	O
ptn	int
<	O
p	double
->	O
pict_npts	int
;	O
ptn	int
++	O
)	O
{	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
=	O
cx	double
+	O
sx	double
*	O
(	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
-	O
cx	double
)	O
;	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
=	O
cy	double
+	O
sy	double
*	O
(	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
-	O
cy	double
)	O
;	O
}	O
p	double
->	O
pict_minx	double
=	O
cx	double
+	O
sx	double
*	O
(	O
p	double
->	O
pict_minx	double
-	O
cx	double
)	O
;	O
p	double
->	O
pict_maxx	double
=	O
cx	double
+	O
sx	double
*	O
(	O
p	double
->	O
pict_maxx	double
-	O
cx	double
)	O
;	O
p	double
->	O
pict_miny	double
=	O
cx	double
+	O
sx	double
*	O
(	O
p	double
->	O
pict_miny	double
-	O
cx	double
)	O
;	O
p	double
->	O
pict_maxy	double
=	O
cx	double
+	O
sx	double
*	O
(	O
p	double
->	O
pict_maxy	double
-	O
cx	double
)	O
;	O
p	double
=	O
p	double
->	O
pict_next	pointer
;	O
}	O
}	O
void	O
pict_rotate	function
(	O
pict	struct
*	O
p	double
,	O
double	O
cx	double
,	O
double	O
cy	double
,	O
double	O
deg	double
,	O
int	O
texttoo	int
)	O
{	O
double	O
c	int
,	O
s	int
;	O
int	O
ptn	int
;	O
double	O
tmpx	double
,	O
tmpy	double
;	O
double	O
angle	double
;	O
int	O
t	double
;	O
angle	double
=	O
3.14159265358979323846	int
/	O
180.0	int
*	O
deg	double
;	O
c	int
=	O
cos	function
(	O
angle	double
)	O
;	O
s	int
=	O
sin	function
(	O
angle	double
)	O
;	O
while	O
(	O
p	double
)	O
{	O
for	O
(	O
t	double
=	O
0	int
;	O
t	double
<	O
p	double
->	O
pict_ntxt	int
;	O
t	double
++	O
)	O
{	O
tmpx	double
=	O
p	double
->	O
pict_tpt	pointer
[	O
t	double
]	O
[	O
0	int
]	O
-	O
cx	double
;	O
tmpy	double
=	O
p	double
->	O
pict_tpt	pointer
[	O
t	double
]	O
[	O
1	int
]	O
-	O
cy	double
;	O
p	double
->	O
pict_tpt	pointer
[	O
t	double
]	O
[	O
0	int
]	O
=	O
cx	double
+	O
c	int
*	O
tmpx	double
-	O
s	int
*	O
tmpy	double
;	O
p	double
->	O
pict_tpt	pointer
[	O
t	double
]	O
[	O
1	int
]	O
=	O
cy	double
+	O
s	int
*	O
tmpx	double
+	O
c	int
*	O
tmpy	double
;	O
p	double
->	O
pict_tang	pointer
[	O
t	double
]	O
+=	O
deg	double
;	O
}	O
for	O
(	O
ptn	int
=	O
0	int
;	O
ptn	int
<	O
p	double
->	O
pict_npts	int
;	O
ptn	int
++	O
)	O
{	O
tmpx	double
=	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
-	O
cx	double
;	O
tmpy	double
=	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
-	O
cy	double
;	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
=	O
cx	double
+	O
c	int
*	O
tmpx	double
-	O
s	int
*	O
tmpy	double
;	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
=	O
cy	double
+	O
s	int
*	O
tmpx	double
+	O
c	int
*	O
tmpy	double
;	O
if	O
(	O
!	O
ptn	int
)	O
{	O
p	double
->	O
pict_minx	double
=	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
;	O
p	double
->	O
pict_maxx	double
=	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
;	O
p	double
->	O
pict_miny	double
=	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
;	O
p	double
->	O
pict_maxy	double
=	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
;	O
}	O
else	O
{	O
if	O
(	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
<	O
p	double
->	O
pict_minx	double
)	O
p	double
->	O
pict_minx	double
=	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
;	O
if	O
(	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
>	O
p	double
->	O
pict_maxx	double
)	O
p	double
->	O
pict_maxx	double
=	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
;	O
if	O
(	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
<	O
p	double
->	O
pict_miny	double
)	O
p	double
->	O
pict_miny	double
=	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
;	O
if	O
(	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
>	O
p	double
->	O
pict_maxy	double
)	O
p	double
->	O
pict_maxy	double
=	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
;	O
}	O
}	O
p	double
=	O
p	double
->	O
pict_next	pointer
;	O
}	O
}	O
void	O
pict_translate	function
(	O
pict	struct
*	O
p	double
,	O
double	O
tx	double
,	O
double	O
ty	double
)	O
{	O
int	O
ptn	int
;	O
int	O
t	double
;	O
while	O
(	O
p	double
)	O
{	O
for	O
(	O
t	double
=	O
0	int
;	O
t	double
<	O
p	double
->	O
pict_ntxt	int
;	O
t	double
++	O
)	O
{	O
p	double
->	O
pict_tpt	pointer
[	O
t	double
]	O
[	O
0	int
]	O
+=	O
tx	double
;	O
p	double
->	O
pict_tpt	pointer
[	O
t	double
]	O
[	O
1	int
]	O
+=	O
ty	double
;	O
}	O
for	O
(	O
ptn	int
=	O
0	int
;	O
ptn	int
<	O
p	double
->	O
pict_npts	int
;	O
ptn	int
++	O
)	O
{	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
+=	O
tx	double
;	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
+=	O
ty	double
;	O
}	O
p	double
->	O
pict_minx	double
+=	O
tx	double
;	O
p	double
->	O
pict_maxx	double
+=	O
tx	double
;	O
p	double
->	O
pict_miny	double
+=	O
ty	double
;	O
p	double
->	O
pict_maxy	double
+=	O
ty	double
;	O
p	double
=	O
p	double
->	O
pict_next	pointer
;	O
}	O
}	O
static	O
void	O
putmode	function
(	O
int	O
mode	int
)	O
{	O
switch	O
(	O
mode	int
)	O
{	O
case	O
's'	O
:	O
fputs	function
(	O
"s\n"	pointer
,	O
pict_out	pointer
)	O
;	O
break	O
;	O
case	O
'f'	O
:	O
fputs	function
(	O
"f\n"	pointer
,	O
pict_out	pointer
)	O
;	O
break	O
;	O
case	O
'p'	O
:	O
fputs	function
(	O
"clip\n"	pointer
,	O
pict_out	pointer
)	O
;	O
break	O
;	O
}	O
}	O
static	O
int	O
picttype	function
(	O
char	O
type	array
[	O
]	O
)	O
{	O
if	O
(	O
!	O
strcmp	function
(	O
type	array
,	O
"LINE"	pointer
)	O
)	O
return	O
LINE	int
;	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
type	array
,	O
"SEGM"	pointer
)	O
)	O
return	O
SEGM	int
;	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
type	array
,	O
"IBEA"	pointer
)	O
)	O
return	O
IBEA	int
;	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
type	array
,	O
"CIRC"	pointer
)	O
)	O
return	O
CIRC	int
;	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
type	array
,	O
"SQUA"	pointer
)	O
)	O
return	O
SQUA	int
;	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
type	array
,	O
"TRIA"	pointer
)	O
)	O
return	O
TRIA	int
;	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
type	array
,	O
"UTRI"	pointer
)	O
)	O
return	O
UTRI	int
;	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
type	array
,	O
"DIAM"	pointer
)	O
)	O
return	O
DIAM	int
;	O
else	O
if	O
(	O
!	O
strcmp	function
(	O
type	array
,	O
"PATT"	pointer
)	O
)	O
return	O
PATT	int
;	O
else	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"bad pict type: %s\n"	pointer
,	O
type	array
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
static	O
void	O
show0	function
(	O
pict	struct
*	O
p	double
,	O
int	O
mode	int
)	O
{	O
int	O
ptn	int
;	O
switch	O
(	O
picttype	function
(	O
p	double
->	O
pict_type	array
)	O
)	O
{	O
case	O
SEGM	int
:	O
if	O
(	O
p	double
->	O
pict_npts	int
%	O
2	int
)	O
{	O
fputs	function
(	O
"(show0) Requested SEGM with odd number of points.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
for	O
(	O
ptn	int
=	O
0	int
;	O
ptn	int
<	O
p	double
->	O
pict_npts	int
;	O
ptn	int
+=	O
2	int
)	O
{	O
fprintf	function
(	O
pict_out	pointer
,	O
"n %.6f %.6f m %.6f %.6f l\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
1	int
]	O
)	O
;	O
putmode	function
(	O
mode	int
)	O
;	O
}	O
break	O
;	O
case	O
IBEA	int
:	O
if	O
(	O
p	double
->	O
pict_npts	int
%	O
2	int
)	O
{	O
fputs	function
(	O
"(show0) Requested IBEA with odd number of points.\n"	pointer
,	O
dap_err	pointer
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
for	O
(	O
ptn	int
=	O
0	int
;	O
ptn	int
<	O
p	double
->	O
pict_npts	int
;	O
ptn	int
+=	O
2	int
)	O
{	O
if	O
(	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
==	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
0	int
]	O
)	O
{	O
fprintf	function
(	O
pict_out	pointer
,	O
"n %.6f %.6f m %.6f %.6f l\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
-	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
+	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
)	O
;	O
putmode	function
(	O
mode	int
)	O
;	O
fprintf	function
(	O
pict_out	pointer
,	O
"n %.6f %.6f m %.6f %.6f l\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
1	int
]	O
)	O
;	O
putmode	function
(	O
mode	int
)	O
;	O
fprintf	function
(	O
pict_out	pointer
,	O
"n %.6f %.6f m %.6f %.6f l\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
0	int
]	O
-	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
1	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
0	int
]	O
+	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
1	int
]	O
)	O
;	O
putmode	function
(	O
mode	int
)	O
;	O
}	O
else	O
if	O
(	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
==	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
1	int
]	O
)	O
{	O
fprintf	function
(	O
pict_out	pointer
,	O
"n %.6f %.6f m %.6f %.6f l\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
-	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
+	O
p	double
->	O
pict_r	double
)	O
;	O
putmode	function
(	O
mode	int
)	O
;	O
fprintf	function
(	O
pict_out	pointer
,	O
"n %.6f %.6f m %.6f %.6f l\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
1	int
]	O
)	O
;	O
putmode	function
(	O
mode	int
)	O
;	O
fprintf	function
(	O
pict_out	pointer
,	O
"n %.6f %.6f m %.6f %.6f l\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
1	int
]	O
-	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
1	int
]	O
+	O
p	double
->	O
pict_r	double
)	O
;	O
putmode	function
(	O
mode	int
)	O
;	O
}	O
else	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(show0) IBEA requested but neither x nor y coordinates match: (%g, %g), (%g, %g)\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
+	O
1	int
]	O
[	O
1	int
]	O
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
break	O
;	O
case	O
UTRI	int
:	O
for	O
(	O
ptn	int
=	O
0	int
;	O
ptn	int
<	O
p	double
->	O
pict_npts	int
;	O
ptn	int
++	O
)	O
{	O
fprintf	function
(	O
pict_out	pointer
,	O
"n %.6f %.6f m %.6f %.6f l %.6f %.6f l %.6f %.6f l\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
-	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
+	O
ONEOVERSQRT3	int
*	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
+	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
+	O
ONEOVERSQRT3	int
*	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
-	O
TWOOVERSQRT3	int
*	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
-	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
+	O
ONEOVERSQRT3	int
*	O
p	double
->	O
pict_r	double
)	O
;	O
putmode	function
(	O
mode	int
)	O
;	O
}	O
break	O
;	O
case	O
DIAM	int
:	O
for	O
(	O
ptn	int
=	O
0	int
;	O
ptn	int
<	O
p	double
->	O
pict_npts	int
;	O
ptn	int
++	O
)	O
{	O
fprintf	function
(	O
pict_out	pointer
,	O
"n %.6f %.6f m %.6f %.6f l %.6f %.6f l %.6f %.6f l %.6f %.6f l\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
-	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
+	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
+	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
-	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
-	O
p	double
->	O
pict_r	double
)	O
;	O
putmode	function
(	O
mode	int
)	O
;	O
}	O
break	O
;	O
case	O
LINE	int
:	O
fprintf	function
(	O
pict_out	pointer
,	O
"n %.6f %.6f m\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
0	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
0	int
]	O
[	O
1	int
]	O
)	O
;	O
for	O
(	O
ptn	int
=	O
1	int
;	O
ptn	int
<	O
p	double
->	O
pict_npts	int
;	O
ptn	int
++	O
)	O
fprintf	function
(	O
pict_out	pointer
,	O
"%.6f %.6f l\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
)	O
;	O
putmode	function
(	O
mode	int
)	O
;	O
break	O
;	O
case	O
CIRC	int
:	O
for	O
(	O
ptn	int
=	O
0	int
;	O
ptn	int
<	O
p	double
->	O
pict_npts	int
;	O
ptn	int
++	O
)	O
{	O
fprintf	function
(	O
pict_out	pointer
,	O
"n %.6f %.6f %.3f 0 360 ar\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
,	O
p	double
->	O
pict_r	double
)	O
;	O
putmode	function
(	O
mode	int
)	O
;	O
}	O
break	O
;	O
case	O
SQUA	int
:	O
for	O
(	O
ptn	int
=	O
0	int
;	O
ptn	int
<	O
p	double
->	O
pict_npts	int
;	O
ptn	int
++	O
)	O
{	O
fprintf	function
(	O
pict_out	pointer
,	O
"n %.6f %.6f m %.6f %.6f l %.6f %.6f l %.6f %.6f l %.6f %.6f l\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
-	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
-	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
+	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
-	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
+	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
+	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
-	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
+	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
-	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
-	O
p	double
->	O
pict_r	double
)	O
;	O
putmode	function
(	O
mode	int
)	O
;	O
}	O
break	O
;	O
case	O
TRIA	int
:	O
for	O
(	O
ptn	int
=	O
0	int
;	O
ptn	int
<	O
p	double
->	O
pict_npts	int
;	O
ptn	int
++	O
)	O
{	O
fprintf	function
(	O
pict_out	pointer
,	O
"n %.6f %.6f m %.6f %.6f l %.6f %.6f l %.6f %.6f l\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
-	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
-	O
ONEOVERSQRT3	int
*	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
+	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
-	O
ONEOVERSQRT3	int
*	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
+	O
TWOOVERSQRT3	int
*	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
-	O
p	double
->	O
pict_r	double
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
-	O
ONEOVERSQRT3	int
*	O
p	double
->	O
pict_r	double
)	O
;	O
putmode	function
(	O
mode	int
)	O
;	O
}	O
break	O
;	O
case	O
PATT	int
:	O
for	O
(	O
ptn	int
=	O
0	int
;	O
ptn	int
<	O
p	double
->	O
pict_npts	int
;	O
ptn	int
++	O
)	O
{	O
fprintf	function
(	O
pict_out	pointer
,	O
"gs n %.6f %.6f tr\n"	pointer
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_pt	pointer
[	O
ptn	int
]	O
[	O
1	int
]	O
)	O
;	O
pict_show	function
(	O
p	double
->	O
pict_patt	pointer
)	O
;	O
fputs	function
(	O
"gr\n"	pointer
,	O
pict_out	pointer
)	O
;	O
}	O
break	O
;	O
}	O
}	O
static	O
pict	struct
*	O
show1	function
(	O
pict	struct
*	O
p	double
)	O
{	O
static	O
int	O
show1init	int
=	O
0	int
;	O
int	O
t	double
;	O
double	O
yoff	double
;	O
int	O
tc	int
;	O
double	O
nfull	double
;	O
double	O
nscript	double
;	O
double	O
nchange	double
;	O
int	O
inscript	int
;	O
double	O
lfact	double
;	O
int	O
i	int
;	O
static	O
char	O
*	O
tpart	pointer
;	O
static	O
char	O
*	O
baret	pointer
;	O
double	O
hside	double
;	O
double	O
efffs	double
;	O
int	O
nlines	int
;	O
int	O
toff	int
;	O
double	O
linespace	double
;	O
linespace	double
=	O
1.4	int
;	O
yoff	double
=	O
0.0	int
;	O
if	O
(	O
!	O
show1init	int
)	O
{	O
show1init	int
=	O
1	int
;	O
tpart	pointer
=	O
dap_malloc	function
(	O
dap_maxtxt	int
+	O
1	int
,	O
"dap_maxtxt"	pointer
)	O
;	O
baret	pointer
=	O
dap_malloc	function
(	O
dap_maxtxt	int
+	O
1	int
,	O
"dap_maxtxt"	pointer
)	O
;	O
}	O
if	O
(	O
p	double
->	O
pict_npts	int
>	O
0	int
)	O
{	O
if	O
(	O
p	double
->	O
pict_fgray	double
>=	O
0.0	int
)	O
{	O
fprintf	function
(	O
pict_out	pointer
,	O
"%.2f sg\n"	pointer
,	O
p	double
->	O
pict_fgray	double
)	O
;	O
show0	function
(	O
p	double
,	O
'f'	O
)	O
;	O
}	O
if	O
(	O
p	double
->	O
pict_lw	double
>=	O
0.0	int
)	O
{	O
fprintf	function
(	O
pict_out	pointer
,	O
"%.2f slw %.2f sg\n"	pointer
,	O
p	double
->	O
pict_lw	double
,	O
p	double
->	O
pict_lgray	double
)	O
;	O
if	O
(	O
p	double
->	O
pict_dash	double
>	O
0.0	int
)	O
fprintf	function
(	O
pict_out	pointer
,	O
"[%.3f] 0 sd\n"	pointer
,	O
p	double
->	O
pict_dash	double
)	O
;	O
show0	function
(	O
p	double
,	O
's'	O
)	O
;	O
if	O
(	O
p	double
->	O
pict_dash	double
>	O
0.0	int
)	O
fputs	function
(	O
"[] 0 sd\n"	pointer
,	O
pict_out	pointer
)	O
;	O
}	O
if	O
(	O
p	double
->	O
pict_patt	pointer
&&	O
strcmp	function
(	O
p	double
->	O
pict_type	array
,	O
"PATT"	pointer
)	O
)	O
show0	function
(	O
p	double
,	O
'p'	O
)	O
;	O
}	O
for	O
(	O
t	double
=	O
0	int
;	O
t	double
<	O
p	double
->	O
pict_ntxt	int
;	O
t	double
++	O
)	O
{	O
for	O
(	O
nlines	int
=	O
1	int
,	O
tc	int
=	O
0	int
;	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
;	O
tc	int
++	O
)	O
{	O
if	O
(	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
==	O
'\n'	O
)	O
nlines	int
++	O
;	O
}	O
switch	O
(	O
p	double
->	O
pict_pos	pointer
[	O
t	double
]	O
[	O
1	int
]	O
)	O
{	O
case	O
't'	O
:	O
yoff	double
=	O
-	O
p	double
->	O
pict_fs	double
;	O
break	O
;	O
case	O
'm'	O
:	O
yoff	double
=	O
-	O
0.2	int
*	O
p	double
->	O
pict_fs	double
+	O
0.5	int
*	O
linespace	double
*	O
p	double
->	O
pict_fs	double
*	O
(	O
double	O
)	O
(	O
nlines	int
-	O
1	int
)	O
;	O
break	O
;	O
case	O
'b'	O
:	O
yoff	double
=	O
linespace	double
*	O
p	double
->	O
pict_fs	double
*	O
(	O
double	O
)	O
(	O
nlines	int
-	O
1	int
)	O
;	O
break	O
;	O
}	O
for	O
(	O
toff	int
=	O
0	int
;	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
toff	int
]	O
;	O
)	O
{	O
for	O
(	O
tc	int
=	O
toff	int
,	O
i	int
=	O
0	int
,	O
inscript	int
=	O
0	int
,	O
nfull	double
=	O
0.0	int
,	O
nscript	double
=	O
0.0	int
,	O
nchange	double
=	O
0.0	int
;	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
&&	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
!=	O
'\n'	O
;	O
tc	int
++	O
)	O
{	O
if	O
(	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
==	O
'^'	O
||	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
==	O
'|'	O
)	O
{	O
inscript	int
=	O
!	O
inscript	int
;	O
nchange	double
+=	O
1.0	int
;	O
}	O
else	O
{	O
if	O
(	O
inscript	int
)	O
nscript	double
+=	O
1.0	int
;	O
else	O
nfull	double
+=	O
1.0	int
;	O
if	O
(	O
i	int
<	O
dap_maxtxt	int
)	O
{	O
if	O
(	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
==	O
'('	O
||	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
==	O
')'	O
)	O
{	O
baret	pointer
[	O
i	int
++	O
]	O
=	O
'\\'	O
;	O
if	O
(	O
i	int
==	O
dap_maxtxt	int
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(show1) Text too long: %s\n"	pointer
,	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
baret	pointer
[	O
i	int
++	O
]	O
=	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
;	O
}	O
else	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(show1) Text too long: %s\n"	pointer
,	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
}	O
baret	pointer
[	O
i	int
]	O
=	O
'\0'	O
;	O
if	O
(	O
!	O
i	int
)	O
continue	O
;	O
lfact	double
=	O
(	O
nfull	double
+	O
SCRIPTF	int
*	O
nscript	double
)	O
/	O
(	O
nfull	double
+	O
nscript	double
+	O
nchange	double
)	O
;	O
if	O
(	O
p	double
->	O
pict_pos	pointer
[	O
t	double
]	O
[	O
2	int
]	O
==	O
' '	O
)	O
{	O
efffs	double
=	O
p	double
->	O
pict_fs	double
;	O
if	O
(	O
nchange	double
>	O
0.0	int
)	O
efffs	double
*=	O
1.4	int
;	O
hside	double
=	O
(	O
(	O
double	O
)	O
strlen	function
(	O
baret	pointer
)	O
)	O
*	O
lfact	double
*	O
p	double
->	O
pict_fs	double
*	O
0.9	int
;	O
fputs	function
(	O
"gs n 1 sg\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fprintf	function
(	O
pict_out	pointer
,	O
"%.6f %.6f tr %.3f rot\n"	pointer
,	O
p	double
->	O
pict_tpt	pointer
[	O
t	double
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_tpt	pointer
[	O
t	double
]	O
[	O
1	int
]	O
,	O
p	double
->	O
pict_tang	pointer
[	O
t	double
]	O
)	O
;	O
switch	O
(	O
p	double
->	O
pict_pos	pointer
[	O
t	double
]	O
[	O
0	int
]	O
)	O
{	O
case	O
'l'	O
:	O
fprintf	function
(	O
pict_out	pointer
,	O
"%.3f %.3f tr\n"	pointer
,	O
-	O
(	O
TBOXF	int
-	O
1.0	int
)	O
*	O
p	double
->	O
pict_fs	double
,	O
yoff	double
-	O
0.5	int
*	O
efffs	double
)	O
;	O
break	O
;	O
case	O
'c'	O
:	O
fprintf	function
(	O
pict_out	pointer
,	O
"%.3f %.3f tr\n"	pointer
,	O
-	O
0.5	int
*	O
hside	double
,	O
yoff	double
-	O
0.5	int
*	O
efffs	double
)	O
;	O
break	O
;	O
case	O
'r'	O
:	O
fprintf	function
(	O
pict_out	pointer
,	O
"%.3f %.3f tr\n"	pointer
,	O
-	O
hside	double
+	O
(	O
TBOXF	int
-	O
1.0	int
)	O
*	O
p	double
->	O
pict_fs	double
,	O
yoff	double
-	O
0.5	int
*	O
efffs	double
)	O
;	O
break	O
;	O
}	O
fprintf	function
(	O
pict_out	pointer
,	O
" 0 0 m %.3f 0 rl 0 %.3f rl %.3f 0 rl cp f\n"	pointer
,	O
hside	double
,	O
TBOXF	int
*	O
efffs	double
,	O
-	O
hside	double
)	O
;	O
fputs	function
(	O
"gr\n"	pointer
,	O
pict_out	pointer
)	O
;	O
}	O
fputs	function
(	O
"gs\n"	pointer
,	O
pict_out	pointer
)	O
;	O
fprintf	function
(	O
pict_out	pointer
,	O
"n %.2f sg\n"	pointer
,	O
p	double
->	O
pict_lgray	double
)	O
;	O
fprintf	function
(	O
pict_out	pointer
,	O
"/%s ff %.3f scf sf\n"	pointer
,	O
p	double
->	O
pict_font	pointer
,	O
p	double
->	O
pict_fs	double
)	O
;	O
fprintf	function
(	O
pict_out	pointer
,	O
"%.6f %.6f tr %.3f rot\n"	pointer
,	O
p	double
->	O
pict_tpt	pointer
[	O
t	double
]	O
[	O
0	int
]	O
,	O
p	double
->	O
pict_tpt	pointer
[	O
t	double
]	O
[	O
1	int
]	O
,	O
p	double
->	O
pict_tang	pointer
[	O
t	double
]	O
)	O
;	O
if	O
(	O
p	double
->	O
pict_pos	pointer
[	O
t	double
]	O
[	O
0	int
]	O
==	O
'c'	O
||	O
p	double
->	O
pict_pos	pointer
[	O
t	double
]	O
[	O
0	int
]	O
==	O
'r'	O
)	O
{	O
fprintf	function
(	O
pict_out	pointer
,	O
"0 %.3f m (%s) sw pop %.3f mul "	pointer
,	O
yoff	double
,	O
baret	pointer
,	O
lfact	double
)	O
;	O
if	O
(	O
p	double
->	O
pict_pos	pointer
[	O
t	double
]	O
[	O
0	int
]	O
==	O
'c'	O
)	O
fputs	function
(	O
"-2 div 0 rm\n"	pointer
,	O
pict_out	pointer
)	O
;	O
else	O
fputs	function
(	O
"neg 0 rm\n"	pointer
,	O
pict_out	pointer
)	O
;	O
}	O
else	O
fprintf	function
(	O
pict_out	pointer
,	O
"0 %.3f m "	pointer
,	O
yoff	double
)	O
;	O
for	O
(	O
tc	int
=	O
toff	int
,	O
inscript	int
=	O
0	int
;	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
&&	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
!=	O
'\n'	O
;	O
)	O
{	O
for	O
(	O
i	int
=	O
0	int
;	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
&&	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
!=	O
'^'	O
&&	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
!=	O
'|'	O
&&	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
!=	O
'\n'	O
;	O
i	int
++	O
,	O
tc	int
++	O
)	O
{	O
if	O
(	O
i	int
<	O
dap_maxtxt	int
)	O
{	O
if	O
(	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
==	O
'('	O
||	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
==	O
')'	O
)	O
{	O
tpart	pointer
[	O
i	int
++	O
]	O
=	O
'\\'	O
;	O
if	O
(	O
i	int
==	O
dap_maxtxt	int
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(show1) Text too long: %s\n"	pointer
,	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
tpart	pointer
[	O
i	int
]	O
=	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
;	O
}	O
else	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(show1) Text too long: %s\n"	pointer
,	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
}	O
tpart	pointer
[	O
i	int
]	O
=	O
'\0'	O
;	O
fprintf	function
(	O
pict_out	pointer
,	O
"(%s) sh "	pointer
,	O
tpart	pointer
)	O
;	O
if	O
(	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
==	O
'^'	O
||	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
==	O
'|'	O
)	O
{	O
if	O
(	O
inscript	int
)	O
{	O
fprintf	function
(	O
pict_out	pointer
,	O
"/%s ff %.3f scf sf\n"	pointer
,	O
p	double
->	O
pict_font	pointer
,	O
p	double
->	O
pict_fs	double
)	O
;	O
if	O
(	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
==	O
'^'	O
)	O
fprintf	function
(	O
pict_out	pointer
,	O
"0 %.3f rm "	pointer
,	O
-	O
SCRIPTH	int
*	O
p	double
->	O
pict_fs	double
)	O
;	O
else	O
fprintf	function
(	O
pict_out	pointer
,	O
"0 %.3f rm "	pointer
,	O
SCRIPTH	int
*	O
p	double
->	O
pict_fs	double
)	O
;	O
inscript	int
=	O
0	int
;	O
}	O
else	O
{	O
fprintf	function
(	O
pict_out	pointer
,	O
"/%s ff %.3f scf sf\n"	pointer
,	O
p	double
->	O
pict_font	pointer
,	O
SCRIPTF	int
*	O
p	double
->	O
pict_fs	double
)	O
;	O
if	O
(	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
tc	int
]	O
==	O
'^'	O
)	O
fprintf	function
(	O
pict_out	pointer
,	O
"0 %.3f rm "	pointer
,	O
SCRIPTH	int
*	O
p	double
->	O
pict_fs	double
)	O
;	O
else	O
fprintf	function
(	O
pict_out	pointer
,	O
"0 %.3f rm "	pointer
,	O
-	O
SCRIPTH	int
*	O
p	double
->	O
pict_fs	double
)	O
;	O
inscript	int
=	O
1	int
;	O
}	O
tc	int
++	O
;	O
}	O
}	O
fputs	function
(	O
"\ngr\n"	pointer
,	O
pict_out	pointer
)	O
;	O
toff	int
=	O
tc	int
;	O
while	O
(	O
p	double
->	O
pict_txt	pointer
[	O
t	double
]	O
[	O
toff	int
]	O
==	O
'\n'	O
)	O
{	O
toff	int
++	O
;	O
yoff	double
-=	O
linespace	double
*	O
p	double
->	O
pict_fs	double
;	O
}	O
}	O
}	O
return	O
p	double
->	O
pict_next	pointer
;	O
}	O
void	O
pict_show	function
(	O
pict	struct
*	O
p	double
)	O
{	O
while	O
(	O
p	double
)	O
p	double
=	O
show1	function
(	O
p	double
)	O
;	O
}	O
void	O
nport	function
(	O
pict	struct
*	O
p	double
,	O
int	O
nplots	int
,	O
int	O
nperpage	int
)	O
{	O
int	O
pn	int
;	O
if	O
(	O
nplots	int
%	O
nperpage	int
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(nport) Number of plots %d not a multiple of number per page %d\n"	pointer
,	O
nplots	int
,	O
nperpage	int
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
pict_port	function
(	O
nplots	int
/	O
nperpage	int
)	O
;	O
for	O
(	O
pn	int
=	O
0	int
;	O
pn	int
<	O
nplots	int
;	O
pn	int
+=	O
nperpage	int
)	O
{	O
pict_page	function
(	O
)	O
;	O
pict_show	function
(	O
p	double
+	O
pn	int
)	O
;	O
}	O
pict_end	function
(	O
)	O
;	O
}	O
void	O
nland	function
(	O
pict	struct
*	O
p	double
,	O
int	O
nplots	int
,	O
int	O
nperpage	int
)	O
{	O
int	O
pn	int
;	O
if	O
(	O
nplots	int
%	O
nperpage	int
)	O
{	O
fprintf	function
(	O
dap_err	pointer
,	O
"(pict_nlandscape) Number of plots %d not a multiple of number per page %d\n"	pointer
,	O
nplots	int
,	O
nperpage	int
)	O
;	O
exit	function
(	O
1	int
)	O
;	O
}	O
pict_land	function
(	O
nplots	int
/	O
nperpage	int
)	O
;	O
for	O
(	O
pn	int
=	O
0	int
;	O
pn	int
<	O
nplots	int
;	O
pn	int
+=	O
nperpage	int
)	O
{	O
pict_page	function
(	O
)	O
;	O
pict_show	function
(	O
p	double
+	O
pn	int
)	O
;	O
}	O
pict_end	function
(	O
)	O
;	O
}	O