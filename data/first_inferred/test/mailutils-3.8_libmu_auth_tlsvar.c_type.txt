int	O
mu_tls_enable	int
=	O
0	int
;	O
int	O
mu_tls_cert_file_checks	int
=	O
MU_TLS_CERT_FILE_CHECKS	O
;	O
int	O
mu_tls_key_file_checks	int
=	O
MU_TLS_KEY_FILE_CHECKS	O
;	O
int	O
mu_tls_ca_file_checks	int
=	O
MU_TLS_CA_FILE_CHECKS	O
;	O
static	O
int	O
check_err	function
(	O
int	O
rc	int
)	O
{	O
switch	O
(	O
rc	int
)	O
{	O
case	O
MU_ERR_PERM_OWNER_MISMATCH	int
:	O
case	O
MU_ERR_PERM_GROUP_WRITABLE	int
:	O
case	O
MU_ERR_PERM_WORLD_WRITABLE	int
:	O
case	O
MU_ERR_PERM_GROUP_READABLE	int
:	O
case	O
MU_ERR_PERM_WORLD_READABLE	int
:	O
case	O
MU_ERR_PERM_LINKED_WRDIR	int
:	O
case	O
MU_ERR_PERM_DIR_IWGRP	int
:	O
case	O
MU_ERR_PERM_DIR_IWOTH	int
:	O
return	O
MU_TLS_CONFIG_UNSAFE	int
;	O
default	O
:	O
return	O
MU_TLS_CONFIG_FAIL	int
;	O
}	O
}	O
int	O
mu_tls_config_check	function
(	O
struct	O
mu_tls_config	struct
const	O
*	O
conf	*
,	O
int	O
verbose	int
)	O
{	O
int	O
rc	int
;	O
int	O
res	int
=	O
MU_TLS_CONFIG_NULL	int
;	O
if	O
(	O
conf	*
->	O
cert_file	*
)	O
{	O
rc	int
=	O
mu_file_safety_check	function
(	O
conf	*
->	O
cert_file	*
,	O
mu_tls_cert_file_checks	int
,	O
-	O
1	int
,	O
NULL	O
)	O
;	O
if	O
(	O
rc	int
)	O
{	O
if	O
(	O
verbose	int
)	O
mu_error	function
(	O
"%s: %s"	*
,	O
conf	*
->	O
cert_file	*
,	O
mu_strerror	function
(	O
rc	int
)	O
)	O
;	O
return	O
check_err	function
(	O
rc	int
)	O
;	O
}	O
res	int
=	O
MU_TLS_CONFIG_OK	int
;	O
}	O
if	O
(	O
conf	*
->	O
key_file	int
)	O
{	O
rc	int
=	O
mu_file_safety_check	function
(	O
conf	*
->	O
key_file	int
,	O
mu_tls_key_file_checks	int
,	O
-	O
1	int
,	O
NULL	O
)	O
;	O
if	O
(	O
rc	int
)	O
{	O
if	O
(	O
verbose	int
)	O
mu_error	function
(	O
"%s: %s"	*
,	O
conf	*
->	O
key_file	*
,	O
mu_strerror	function
(	O
rc	int
)	O
)	O
;	O
return	O
check_err	function
(	O
rc	int
)	O
;	O
}	O
res	int
=	O
MU_TLS_CONFIG_OK	int
;	O
}	O
if	O
(	O
conf	*
->	O
ca_file	*
)	O
{	O
rc	int
=	O
mu_file_safety_check	function
(	O
conf	*
->	O
ca_file	int
,	O
mu_tls_ca_file_checks	int
,	O
-	O
1	int
,	O
NULL	O
)	O
;	O
if	O
(	O
rc	int
)	O
{	O
if	O
(	O
verbose	int
)	O
mu_error	function
(	O
"%s: %s"	*
,	O
conf	*
->	O
ca_file	*
,	O
mu_strerror	function
(	O
rc	int
)	O
)	O
;	O
return	O
check_err	function
(	O
rc	int
)	O
;	O
}	O
res	int
=	O
MU_TLS_CONFIG_OK	int
;	O
}	O
if	O
(	O
conf	*
->	O
priorities	int
)	O
res	int
=	O
MU_TLS_CONFIG_OK	int
;	O
return	O
res	int
;	O
}	O