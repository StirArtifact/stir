void	O
ReportError	function
(	O
PINPUTBUF	*
pibIn	*
,	O
WORD	int
wCode	int
,	O
PSTR	*
szMsg	*
,	O
PSTR	*
szAltMsg	*
)	O
{	O
char	O
cNull	char
=	O
'\0'	O
;	O
BOOL	int
bFatal	int
=	O
wCode	int
&	O
RE_FATAL	int
;	O
BOOL	int
bWarning	int
=	O
wCode	int
&	O
RE_WARNING	int
;	O
wCode	int
&=	O
~	O
(	O
RE_FATAL	int
|	O
RE_WARNING	int
)	O
;	O
if	O
(	O
!	O
szMsg	*
)	O
szMsg	*
=	O
&	O
cNull	char
;	O
if	O
(	O
wCode	int
)	O
{	O
if	O
(	O
bWarning	int
)	O
printf	function
(	O
"*** Warning: "	*
)	O
;	O
else	O
{	O
printf	function
(	O
"*** Error: "	*
)	O
;	O
bFatal	int
|=	O
(	O
pibIn	*
&&	O
(	O
pibIn	*
->	O
cErrors	int
++	O
>	O
MAX_ERRORS	int
)	O
)	O
;	O
}	O
}	O
if	O
(	O
pibIn	*
)	O
{	O
if	O
(	O
pibIn	*
->	O
pfileIn	*
||	O
pibIn	*
->	O
iLNPrev	int
)	O
{	O
printf	function
(	O
"line %d: "	*
,	O
pibIn	*
->	O
iLineNum	int
)	O
;	O
}	O
else	O
{	O
if	O
(	O
wCode	int
!=	O
RE_FILENOTFOUND	int
)	O
{	O
PSTRLEX	array
szTmp	array
;	O
szTmp	array
[	O
MAX_LEX	int
-	O
1	int
]	O
=	O
'\0'	O
;	O
printf	function
(	O
"'%s'...\n  "	*
,	O
strncpy	function
(	O
szTmp	array
,	O
pibIn	*
->	O
pbufOrg	*
,	O
MAX_LEX	int
-	O
1	int
)	O
)	O
;	O
}	O
}	O
}	O
switch	O
(	O
wCode	int
)	O
{	O
case	O
0	int
:	O
break	O
;	O
default	O
:	O
printf	function
(	O
"Unknown error code %x: %s"	*
,	O
wCode	int
,	O
szMsg	*
)	O
;	O
case	O
RE_INIT	int
:	O
printf	function
(	O
"Initialization error."	*
)	O
;	O
break	O
;	O
case	O
RE_FILENOTFOUND	int
:	O
printf	function
(	O
"File not found \"%s\"."	*
,	O
szMsg	*
)	O
;	O
break	O
;	O
case	O
RE_CANNOTOPEN	int
:	O
printf	function
(	O
"Cannot open file \"%s\"."	*
,	O
szMsg	*
)	O
;	O
break	O
;	O
case	O
RE_UNEXPECTED	int
:	O
printf	function
(	O
"Unexpected character '%c' in input file."	*
,	O
*	O
szMsg	*
)	O
;	O
break	O
;	O
case	O
RE_UNEXPESCAPE	int
:	O
printf	function
(	O
"Unexpected escape sequence '%s' in input file."	*
,	O
szMsg	*
)	O
;	O
break	O
;	O
case	O
RE_UNEXPNUMBER	int
:	O
printf	function
(	O
"Unexpected number %s in input file."	*
,	O
szMsg	*
)	O
;	O
break	O
;	O
case	O
RE_EXPECTED	int
:	O
printf	function
(	O
"Expected '%c' before '%c'."	*
,	O
szMsg	*
[	O
1	int
]	O
,	O
szMsg	*
[	O
0	int
]	O
)	O
;	O
break	O
;	O
case	O
RE_LEXEXPECTED	int
:	O
printf	function
(	O
"Expected <%s>"	*
,	O
szMsg	*
)	O
;	O
if	O
(	O
szAltMsg	*
)	O
printf	function
(	O
" before '%s'"	*
,	O
szAltMsg	*
)	O
;	O
break	O
;	O
case	O
RE_BADCONTEXT	int
:	O
printf	function
(	O
"'%s' used in invalid context."	*
,	O
szMsg	*
)	O
;	O
break	O
;	O
case	O
RE_DUPDECL	int
:	O
printf	function
(	O
"Duplicate declaration of model variable '%s'."	*
,	O
szMsg	*
)	O
;	O
break	O
;	O
case	O
RE_DUPSECT	int
:	O
printf	function
(	O
"Only one '%s' section is allowed."	*
,	O
szMsg	*
)	O
;	O
break	O
;	O
case	O
RE_OUTOFMEM	int
:	O
printf	function
(	O
"Out of memory in %s() !"	*
,	O
szMsg	*
)	O
;	O
break	O
;	O
case	O
RE_REDEF	int
:	O
printf	function
(	O
"'%s' redefined."	*
,	O
szMsg	*
)	O
;	O
break	O
;	O
case	O
RE_EQNTOOLONG	int
:	O
printf	function
(	O
"Equation is too long.  Possibly missing terminator."	*
)	O
;	O
break	O
;	O
case	O
RE_BADSTATE	int
:	O
printf	function
(	O
"Invalid state identifier '%s'."	*
,	O
szMsg	*
)	O
;	O
break	O
;	O
case	O
RE_UNDEFINED	int
:	O
printf	function
(	O
"Undefined identifier '%s'."	*
,	O
szMsg	*
)	O
;	O
break	O
;	O
case	O
RE_NOINPDEF	int
:	O
printf	function
(	O
"Input '%s' is not initialized."	*
,	O
szMsg	*
)	O
;	O
break	O
;	O
case	O
RE_NODYNEQN	int
:	O
printf	function
(	O
"State variable '%s' has no dynamics."	*
,	O
szMsg	*
)	O
;	O
break	O
;	O
case	O
RE_NOOUTPUTEQN	int
:	O
printf	function
(	O
"Output variable '%s' is not computed anywhere."	*
,	O
szMsg	*
)	O
;	O
break	O
;	O
case	O
RE_TOOMANYVARS	int
:	O
printf	function
(	O
"Too many %s declarations. Limit is %d."	*
,	O
szMsg	*
,	O
*	O
(	O
PINT	*
)	O
szAltMsg	*
)	O
;	O
break	O
;	O
case	O
RE_POSITIVE	int
:	O
printf	function
(	O
"Positive number expected."	*
)	O
;	O
break	O
;	O
case	O
RE_NAMETOOLONG	int
:	O
printf	function
(	O
"Name %s exceed %d characters."	*
,	O
szMsg	*
,	O
MAX_NAME	*
)	O
;	O
break	O
;	O
case	O
RE_UNBALPAR	int
:	O
printf	function
(	O
"Unbalanced () or equation too long at this line or above."	*
)	O
;	O
break	O
;	O
case	O
RE_NOEND	int
:	O
printf	function
(	O
"End keyword is missing in file %s."	*
,	O
szMsg	*
)	O
;	O
break	O
;	O
}	O
printf	function
(	O
"\n"	*
)	O
;	O
if	O
(	O
szAltMsg	*
&&	O
wCode	int
!=	O
RE_LEXEXPECTED	int
)	O
printf	function
(	O
"%s\n"	*
,	O
szAltMsg	*
)	O
;	O
if	O
(	O
bFatal	int
)	O
{	O
printf	function
(	O
"One or more fatal errors: Exiting...\n\n"	*
)	O
;	O
exit	function
(	O
wCode	int
)	O
;	O
}	O
}	O