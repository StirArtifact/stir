void	O
mu_gdb_bt	function
(	O
)	O
{	O
int	O
i	int
;	O
pid_t	int
master_pid	int
=	O
getpid	function
(	O
)	O
;	O
pid_t	int
pid	int
;	O
static	O
char	O
buf	*
[	O
1024	int
]	O
;	O
static	O
char	O
fname	*
[	O
1024	int
]	O
;	O
int	O
fd	int
;	O
char	O
*	O
argv	*
[	O
8	int
]	O
;	O
if	O
(	O
!	O
mu_program_name	*
)	O
abort	function
(	O
)	O
;	O
sprintf	function
(	O
fname	*
,	O
"/tmp/mailutils.%s.%lu"	*
,	O
mu_program_name	*
,	O
(	O
unsigned	O
long	O
)	O
master_pid	*
)	O
;	O
pid	int
=	O
fork	function
(	O
)	O
;	O
if	O
(	O
pid	int
==	O
(	O
pid_t	int
)	O
-	O
1	int
)	O
abort	function
(	O
)	O
;	O
if	O
(	O
pid	int
)	O
{	O
sleep	function
(	O
10	int
)	O
;	O
abort	function
(	O
)	O
;	O
}	O
for	O
(	O
i	int
=	O
mu_getmaxfd	function
(	O
)	O
;	O
i	int
>=	O
0	int
;	O
i	int
--	O
)	O
close	*
(	O
i	int
)	O
;	O
fd	int
=	O
open	function
(	O
fname	*
,	O
O_WRONLY	int
|	O
O_CREAT	int
,	O
0600	int
)	O
;	O
if	O
(	O
fd	int
==	O
-	O
1	int
)	O
abort	function
(	O
)	O
;	O
dup2	function
(	O
fd	int
,	O
1	int
)	O
;	O
dup2	function
(	O
fd	int
,	O
2	int
)	O
;	O
close	*
(	O
fd	int
)	O
;	O
argv	*
[	O
0	int
]	O
=	O
"/usr/bin/gdb"	*
;	O
argv	*
[	O
1	int
]	O
=	O
(	O
char	O
*	O
)	O
mu_full_program_name	*
;	O
sprintf	function
(	O
buf	*
,	O
"%lu"	*
,	O
(	O
unsigned	O
long	O
)	O
master_pid	*
)	O
;	O
argv	*
[	O
2	int
]	O
=	O
buf	*
;	O
argv	*
[	O
3	int
]	O
=	O
"-ex"	*
;	O
argv	*
[	O
4	int
]	O
=	O
"bt"	*
;	O
argv	*
[	O
5	int
]	O
=	O
"-ex"	*
;	O
argv	*
[	O
6	int
]	O
=	O
"kill"	*
;	O
argv	*
[	O
7	int
]	O
=	O
NULL	O
;	O
execvp	function
(	O
argv	*
[	O
0	int
]	O
,	O
argv	*
)	O
;	O
abort	function
(	O
)	O
;	O
}	O