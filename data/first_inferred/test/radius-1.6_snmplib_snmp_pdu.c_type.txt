struct	O
snmp_pdu	struct
*	O
snmp_pdu_create	function
(	O
int	O
type	int
)	O
{	O
struct	O
snmp_pdu	struct
*	O
pdu	*
;	O
pdu	*
=	O
snmp_alloc	function
(	O
sizeof	O
(	O
*	O
pdu	*
)	O
)	O
;	O
pdu	*
->	O
type	enum
=	O
type	int
;	O
pdu	*
->	O
req_id	int
=	O
0	int
;	O
pdu	*
->	O
err_stat	int
=	O
0	int
;	O
pdu	*
->	O
err_ind	*
=	O
0	int
;	O
pdu	struct
->	O
var	*
=	O
NULL	O
;	O
return	O
pdu	*
;	O
}	O
void	O
snmp_pdu_free	function
(	O
struct	O
snmp_pdu	struct
*	O
pdu	*
)	O
{	O
if	O
(	O
!	O
pdu	*
)	O
return	O
;	O
snmp_var_free_list	function
(	O
pdu	*
->	O
var	*
)	O
;	O
snmp_free	function
(	O
pdu	*
)	O
;	O
}	O
void	O
snmp_pdu_add_var	function
(	O
struct	O
snmp_pdu	struct
*	O
pdu	*
,	O
struct	O
snmp_var	struct
*	O
var	*
)	O
{	O
var	int
->	O
next	*
=	O
pdu	*
->	O
var	*
;	O
pdu	*
->	O
var	enum
=	O
var	int
;	O
}	O
u_char	char
*	O
snmp_pdu_decode	function
(	O
u_char	char
*	O
data	*
,	O
int	O
*	O
length	*
,	O
struct	O
snmp_pdu	struct
*	O
pdu	*
)	O
{	O
u_char	char
*	O
buf	*
=	O
data	*
;	O
u_char	char
type	*
;	O
buf	*
=	O
asn_decode_header	function
(	O
buf	*
,	O
length	*
,	O
&	O
pdu	*
->	O
type	*
)	O
;	O
if	O
(	O
!	O
buf	*
)	O
return	O
NULL	O
;	O
switch	O
(	O
pdu	*
->	O
type	*
)	O
{	O
case	O
SNMP_PDU_RESPONSE	O
:	O
case	O
SNMP_PDU_GET	O
:	O
case	O
SNMP_PDU_GETNEXT	O
:	O
case	O
SNMP_PDU_SET	O
:	O
buf	*
=	O
asn_decode_int	function
(	O
buf	*
,	O
length	*
,	O
&	O
type	*
,	O
&	O
pdu	*
->	O
req_id	int
,	O
sizeof	O
(	O
pdu	*
->	O
req_id	int
)	O
)	O
;	O
if	O
(	O
!	O
buf	*
)	O
break	O
;	O
buf	*
=	O
asn_decode_int	function
(	O
buf	*
,	O
length	*
,	O
&	O
type	*
,	O
&	O
pdu	*
->	O
err_stat	*
,	O
sizeof	O
(	O
pdu	*
->	O
err_stat	*
)	O
)	O
;	O
if	O
(	O
!	O
buf	*
)	O
break	O
;	O
buf	*
=	O
asn_decode_int	function
(	O
buf	*
,	O
length	*
,	O
&	O
type	*
,	O
&	O
pdu	*
->	O
err_ind	*
,	O
sizeof	O
(	O
pdu	*
->	O
err_ind	*
)	O
)	O
;	O
break	O
;	O
default	O
:	O
SNMP_SET_ERRNO	O
(	O
E_SNMP_UNKNOWN_REQ	int
)	O
;	O
buf	*
=	O
NULL	O
;	O
}	O
return	O
buf	*
;	O
}	O
u_char	char
*	O
snmp_pdu_encode	function
(	O
u_char	char
*	O
data	*
,	O
int	O
*	O
length	*
,	O
struct	O
snmp_pdu	struct
*	O
pdu	*
)	O
{	O
u_char	char
*	O
buf	*
=	O
data	*
;	O
buf	*
=	O
asn_encode_int	function
(	O
buf	*
,	O
length	*
,	O
(	O
ASN_UNIVERSAL	O
|	O
ASN_PRIMITIVE	O
|	O
ASN_INTEGER	O
)	O
,	O
pdu	*
->	O
req_id	int
)	O
;	O
BAIL_OUT	O
;	O
buf	*
=	O
asn_encode_int	function
(	O
buf	*
,	O
length	*
,	O
(	O
ASN_UNIVERSAL	O
|	O
ASN_PRIMITIVE	O
|	O
ASN_INTEGER	O
)	O
,	O
pdu	*
->	O
err_stat	*
)	O
;	O
BAIL_OUT	O
;	O
buf	*
=	O
asn_encode_int	function
(	O
buf	*
,	O
length	*
,	O
(	O
ASN_UNIVERSAL	O
|	O
ASN_PRIMITIVE	O
|	O
ASN_INTEGER	O
)	O
,	O
pdu	*
->	O
err_ind	*
)	O
;	O
BAIL_OUT	O
;	O
return	O
buf	*
;	O
}	O