typedef	O
int	O
wget_decompressor_decompress_fn	function
(	O
wget_decompressor	struct
*	O
dc	*
,	O
char	O
*	O
src	*
,	O
size_t	long
srclen	long
)	O
;	O
typedef	O
void	O
wget_decompressor_exit_fn	function
(	O
wget_decompressor	struct
*	O
dc	*
)	O
;	O
struct	O
wget_decompressor_st	struct
{	O
z_stream	struct
z_strm	struct
;	O
wget_decompressor_sink_fn	struct
*	O
sink	*
;	O
wget_decompressor_error_handler	struct
*	O
error_handler	*
;	O
wget_decompressor_decompress_fn	struct
*	O
decompress	*
;	O
wget_decompressor_exit_fn	struct
*	O
exit	*
;	O
void	O
*	O
context	*
;	O
wget_content_encoding	*
encoding	*
;	O
}	O
;	O
static	O
int	O
gzip_init	function
(	O
z_stream	struct
*	O
strm	*
)	O
{	O
memset	function
(	O
strm	*
,	O
0	int
,	O
sizeof	O
(	O
*	O
strm	*
)	O
)	O
;	O
if	O
(	O
inflateInit2	function
(	O
strm	*
,	O
15	int
+	O
32	int
)	O
!=	O
Z_OK	int
)	O
{	O
error_printf	O
(	O
_	O
(	O
"Failed to init gzip decompression\n"	*
)	O
)	O
;	O
return	O
-	O
1	int
;	O
}	O
return	O
0	int
;	O
}	O
static	O
int	O
gzip_decompress	function
(	O
wget_decompressor	struct
*	O
dc	*
,	O
char	O
*	O
src	*
,	O
size_t	long
srclen	long
)	O
{	O
z_stream	struct
*	O
strm	*
;	O
char	O
dst	*
[	O
10240	int
]	O
;	O
int	O
status	int
;	O
if	O
(	O
!	O
srclen	long
)	O
{	O
if	O
(	O
dc	*
->	O
sink	*
)	O
dc	*
->	O
sink	function
(	O
dc	*
->	O
context	*
,	O
""	*
,	O
0	int
)	O
;	O
return	O
0	int
;	O
}	O
strm	*
=	O
&	O
dc	*
->	O
z_strm	*
;	O
strm	*
->	O
next_in	*
=	O
(	O
unsigned	O
char	O
*	O
)	O
src	*
;	O
strm	*
->	O
avail_in	int
=	O
(	O
unsigned	O
int	O
)	O
srclen	long
;	O
do	O
{	O
strm	*
->	O
next_out	*
=	O
(	O
unsigned	O
char	O
*	O
)	O
dst	*
;	O
strm	*
->	O
avail_out	int
=	O
sizeof	O
(	O
dst	*
)	O
;	O
status	int
=	O
inflate	function
(	O
strm	*
,	O
Z_SYNC_FLUSH	int
)	O
;	O
if	O
(	O
(	O
status	int
==	O
Z_OK	int
||	O
status	int
==	O
Z_STREAM_END	int
)	O
&&	O
strm	*
->	O
avail_out	int
<	O
sizeof	O
(	O
dst	*
)	O
)	O
{	O
if	O
(	O
dc	*
->	O
sink	*
)	O
dc	*
->	O
sink	function
(	O
dc	*
->	O
context	*
,	O
dst	*
,	O
sizeof	O
(	O
dst	*
)	O
-	O
strm	*
->	O
avail_out	int
)	O
;	O
}	O
}	O
while	O
(	O
status	int
==	O
Z_OK	int
&&	O
!	O
strm	*
->	O
avail_out	int
)	O
;	O
if	O
(	O
status	int
==	O
Z_OK	int
||	O
status	int
==	O
Z_STREAM_END	int
)	O
return	O
0	int
;	O
error_printf	O
(	O
_	O
(	O
"Failed to uncompress gzip stream (%d)\n"	*
)	O
,	O
status	int
)	O
;	O
return	O
-	O
1	int
;	O
}	O
static	O
void	O
gzip_exit	function
(	O
wget_decompressor	struct
*	O
dc	*
)	O
{	O
int	O
status	int
;	O
if	O
(	O
(	O
status	int
=	O
inflateEnd	function
(	O
&	O
dc	*
->	O
z_strm	struct
)	O
)	O
!=	O
Z_OK	int
)	O
{	O
error_printf	O
(	O
_	O
(	O
"Failed to close gzip stream (%d)\n"	*
)	O
,	O
status	int
)	O
;	O
}	O
}	O
static	O
int	O
deflate_init	function
(	O
z_stream	struct
*	O
strm	*
)	O
{	O
memset	function
(	O
strm	*
,	O
0	int
,	O
sizeof	O
(	O
*	O
strm	*
)	O
)	O
;	O
if	O
(	O
inflateInit	O
(	O
strm	*
)	O
!=	O
Z_OK	int
)	O
{	O
error_printf	O
(	O
_	O
(	O
"Failed to init deflate decompression\n"	*
)	O
)	O
;	O
return	O
-	O
1	int
;	O
}	O
return	O
0	int
;	O
}	O
static	O
int	O
identity	function
(	O
wget_decompressor	struct
*	O
dc	*
,	O
char	O
*	O
src	*
,	O
size_t	long
srclen	long
)	O
{	O
if	O
(	O
dc	*
->	O
sink	*
)	O
dc	*
->	O
sink	*
(	O
dc	*
->	O
context	*
,	O
src	*
,	O
srclen	long
)	O
;	O
return	O
0	int
;	O
}	O
wget_decompressor	struct
*	O
wget_decompress_open	function
(	O
wget_content_encoding	*
encoding	*
,	O
wget_decompressor_sink_fn	struct
*	O
sink	*
,	O
void	O
*	O
context	*
)	O
{	O
int	O
rc	int
=	O
0	int
;	O
wget_decompressor	struct
*	O
dc	*
=	O
wget_calloc	function
(	O
1	int
,	O
sizeof	O
(	O
wget_decompressor	*
)	O
)	O
;	O
if	O
(	O
!	O
dc	*
)	O
return	O
NULL	O
;	O
if	O
(	O
encoding	*
==	O
wget_content_encoding_gzip	int
)	O
{	O
if	O
(	O
(	O
rc	int
=	O
gzip_init	function
(	O
&	O
dc	*
->	O
z_strm	*
)	O
)	O
==	O
0	int
)	O
{	O
dc	*
->	O
decompress	*
=	O
gzip_decompress	int
;	O
dc	*
->	O
exit	int
=	O
gzip_exit	int
;	O
}	O
}	O
else	O
if	O
(	O
encoding	*
==	O
wget_content_encoding_deflate	int
)	O
{	O
if	O
(	O
(	O
rc	int
=	O
deflate_init	function
(	O
&	O
dc	*
->	O
z_strm	*
)	O
)	O
==	O
0	int
)	O
{	O
dc	*
->	O
decompress	*
=	O
gzip_decompress	int
;	O
dc	*
->	O
exit	int
=	O
gzip_exit	int
;	O
}	O
}	O
else	O
if	O
(	O
encoding	*
==	O
wget_content_encoding_bzip2	int
)	O
{	O
}	O
else	O
if	O
(	O
encoding	*
==	O
wget_content_encoding_lzma	int
)	O
{	O
}	O
else	O
if	O
(	O
encoding	*
==	O
wget_content_encoding_brotli	int
)	O
{	O
}	O
else	O
if	O
(	O
encoding	*
==	O
wget_content_encoding_zstd	int
)	O
{	O
}	O
if	O
(	O
!	O
dc	*
->	O
decompress	*
)	O
{	O
debug_printf	O
(	O
"Falling back to Content-Encoding 'identity'\n"	*
)	O
;	O
dc	*
->	O
decompress	int
=	O
identity	int
;	O
}	O
if	O
(	O
rc	int
)	O
{	O
xfree	function
(	O
dc	*
)	O
;	O
return	O
NULL	O
;	O
}	O
dc	*
->	O
encoding	*
=	O
encoding	*
;	O
dc	*
->	O
sink	*
=	O
sink	*
;	O
dc	*
->	O
context	*
=	O
context	*
;	O
return	O
dc	int
;	O
}	O
void	O
wget_decompress_close	function
(	O
wget_decompressor	struct
*	O
dc	*
)	O
{	O
if	O
(	O
dc	*
)	O
{	O
if	O
(	O
dc	*
->	O
exit	function
)	O
dc	*
->	O
exit	function
(	O
dc	int
)	O
;	O
xfree	function
(	O
dc	*
)	O
;	O
}	O
}	O
int	O
wget_decompress	function
(	O
wget_decompressor	struct
*	O
dc	*
,	O
char	O
*	O
src	*
,	O
size_t	long
srclen	long
)	O
{	O
if	O
(	O
dc	*
)	O
{	O
int	O
rc	int
=	O
dc	*
->	O
decompress	*
(	O
dc	*
,	O
src	*
,	O
srclen	long
)	O
;	O
if	O
(	O
rc	int
&&	O
dc	*
->	O
error_handler	*
)	O
dc	*
->	O
error_handler	function
(	O
dc	*
,	O
rc	int
)	O
;	O
}	O
return	O
0	int
;	O
}	O
void	O
wget_decompress_set_error_handler	function
(	O
wget_decompressor	struct
*	O
dc	*
,	O
wget_decompressor_error_handler	struct
*	O
error_handler	*
)	O
{	O
if	O
(	O
dc	*
)	O
dc	*
->	O
error_handler	*
=	O
error_handler	*
;	O
}	O
void	O
*	O
wget_decompress_get_context	function
(	O
wget_decompressor	struct
*	O
dc	*
)	O
{	O
return	O
dc	*
?	O
dc	*
->	O
context	*
:	O
NULL	O
;	O
}	O
static	O
char	O
_encoding_names	array
[	O
wget_content_encoding_max	int
]	O
[	O
9	int
]	O
=	O
{	O
[	O
wget_content_encoding_identity	int
]	O
=	O
"identity"	*
,	O
[	O
wget_content_encoding_gzip	int
]	O
=	O
"gzip"	*
,	O
[	O
wget_content_encoding_deflate	int
]	O
=	O
"deflate"	*
,	O
[	O
wget_content_encoding_xz	int
]	O
=	O
"xz"	*
,	O
[	O
wget_content_encoding_lzma	int
]	O
=	O
"lzma"	*
,	O
[	O
wget_content_encoding_bzip2	int
]	O
=	O
"bzip2"	*
,	O
[	O
wget_content_encoding_brotli	int
]	O
=	O
"br"	*
,	O
[	O
wget_content_encoding_zstd	int
]	O
=	O
"zstd"	*
,	O
}	O
;	O
wget_content_encoding	O
wget_content_encoding_by_name	function
(	O
const	O
char	O
*	O
name	*
)	O
{	O
if	O
(	O
name	*
)	O
{	O
for	O
(	O
wget_content_encoding	O
it	int
=	O
0	int
;	O
it	int
<	O
wget_content_encoding_max	int
;	O
it	int
++	O
)	O
{	O
if	O
(	O
!	O
strcmp	function
(	O
_encoding_names	*
[	O
it	int
]	O
,	O
name	*
)	O
)	O
return	O
it	int
;	O
}	O
if	O
(	O
!	O
strcmp	function
(	O
"none"	*
,	O
name	*
)	O
)	O
return	O
wget_content_encoding_identity	*
;	O
}	O
return	O
wget_content_encoding_unknown	*
;	O
}	O
const	O
char	O
*	O
wget_content_encoding_to_name	function
(	O
wget_content_encoding	enum
type	enum
)	O
{	O
if	O
(	O
type	enum
>=	O
0	int
&&	O
type	int
<	O
wget_content_encoding_max	int
)	O
return	O
_encoding_names	*
[	O
type	int
]	O
;	O
return	O
NULL	O
;	O
}	O